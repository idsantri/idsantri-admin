import{q as y,ap as L,s as O,Y as G,E as V,c as f,o,w as e,g as a,af as P,f as q,G as g,Q as C,a9 as E,l as U,au as K,a as j,e as D,b as I,v as k,F as R,D as J,t as b,J as W}from"./index-DEh4UAKk.js";import{Q as S}from"./QSkeleton-ZGeKECkT.js";import{Q as p}from"./QItemLabel-CulQpTC_.js";import{Q as M,a as _}from"./QItem-BTdNNvAd.js";import{Q as Y}from"./QList-DhKPmN5Y.js";import{Q as z}from"./QSelect-DNJsugZb.js";import{Q as X}from"./QForm-BUEZNW1c.js";import{_ as $}from"./InputSelectArray-DJMMXyVK.js";import{u as Z}from"./useCrudForm-vQEJO8b7.js";import{A as aa}from"./ApiCrud-DGpYTBeQ.js";import{_ as ea}from"./InputToggle-CFQ3roLV.js";import{_ as ta}from"./CardSantriSimple-yMx7zaRM.js";import{g as la}from"./array-object-BytDdNh7.js";import{c as sa}from"./format-date-DBaFa2rd.js";import{f as na,m as ia}from"./hijri-CTUg_lXm.js";class ra extends aa{constructor(){super("mutaallim")}async getSantri(){return(await this._apiGet({endPoint:`${this._path}/santri`})).data}async getSantriId(u){return(await this._apiGet({endPoint:`${this._path}/santri/${u}`})).data}async aktif(){return(await this._apiGet({endPoint:`${this._path}/aktif`})).data}}const A=new ra,ua={__name:"QuranMutaallimForm",props:{data:{type:Object,required:!0}},emits:["successDelete","successSubmit","successUpdate","successCreate"],setup(s,{emit:u}){const i=s,c=u,t=y({marhalah:"Ula",faslah:null,no_absen:null,aktif:1,...i.data}),d=!i.data?.id,v=L("firstInput");O(async()=>{await G(),v.value&&v.value.focus()});const{handleDelete:w,handleCreate:h,handleUpdate:l,loading:n}=Z(A,{emit:c,responseKey:"mutaallim"}),x=async()=>{const Q={santri_id:t.value.santri_id,th_ajaran_h:t.value.th_ajaran_h,marhalah:t.value.marhalah,faslah:t.value.faslah,no_absen:t.value.no_absen,aktif:t.value.aktif};return d?await h(Q,!0):await l(i.data.id,Q,!0)},F=async()=>await w(i.data.id);return(Q,m)=>{const N=V("FormHeader"),T=V("FormLoading"),B=V("FormActions");return o(),f(U,{class:"full-width",style:{"max-width":"425px"}},{default:e(()=>[a(X,{onSubmit:P(x,["prevent"])},{default:e(()=>[a(N,{title:"Input Pendidikan Quran","is-new":d}),g(n)?(o(),f(T,{key:0})):q("",!0),a(C,null,{default:e(()=>[a(E,{dense:"",outlined:"",label:"Nama","model-value":t.value?.nama+" ("+t.value?.santri_id+")",disable:"",filled:"",class:"q-my-sm"},null,8,["model-value"]),a($,{modelValue:t.value.th_ajaran_h,"onUpdate:modelValue":m[0]||(m[0]=r=>t.value.th_ajaran_h=r),url:"tahun-ajaran",label:"Tahun Ajaran *",sort:"desc",class:"q-my-sm",rules:[r=>!!r||"Harus diisi!"],selected:t.value.th_ajaran_h,ref_key:"firstInput",ref:v},null,8,["modelValue","rules","selected"]),a(z,{dense:"",outlined:"",modelValue:t.value.marhalah,"onUpdate:modelValue":m[1]||(m[1]=r=>t.value.marhalah=r),label:"Marhalah *",class:"q-my-sm",rules:[r=>!!r||"Harus diisi!"],options:["Ula","Wustho","Ulya"]},null,8,["modelValue","rules"]),a($,{modelValue:t.value.faslah,"onUpdate:modelValue":m[2]||(m[2]=r=>t.value.faslah=r),url:"faslah-quran",label:"Faslah/Kelas *",class:"q-my-sm",rules:[r=>!!r||"Harus diisi!"]},null,8,["modelValue","rules"]),a(ea,{modelValue:t.value.aktif,"onUpdate:modelValue":m[3]||(m[3]=r=>t.value.aktif=r),label:"Aktif",disable:!t.value.id},null,8,["modelValue","disable"])]),_:1}),a(B,{"btn-delete":!d,onOnDelete:F},null,8,["btn-delete"])]),_:1})]),_:1})}}},oa={key:0},Va={__name:"MutaallimCard",props:{santri:{type:Object}},setup(s){const u=y(!1),i=y({}),c=y([]),t=y(!1);async function d(h){try{t.value=!0;const l=await A.getSantriId(h);c.value=l.mutaallim}catch(l){console.error("ðŸš€ ~ loadMutaallim ~ e:",l)}finally{t.value=!1}}K(async()=>{s.santri?.id?await d(s.santri.id):s.santri?.santri_id&&await d(s.santri.santri_id)});const v=()=>{i.value={santri_id:s.santri.id,nama:s.santri.nama},u.value=!0},w=h=>{i.value=la(c,h),i.value.santri_id=s.santri.id,i.value.nama=s.santri.nama,u.value=!0};return(h,l)=>(o(),f(U,{flat:"",bordered:"",class:"",style:{width:"350px"}},{default:e(()=>[a(C,{class:"bg-green-7 text-green-11 q-pa-sm flex items-center justify-between"},{default:e(()=>[l[3]||(l[3]=j("div",null,"Riwayat Mutaallim",-1)),a(D,{icon:"add",outline:"",dense:"",class:"q-px-sm",disabled:!s.santri.id,onClick:v},null,8,["disabled"])]),_:1}),a(C,{class:"q-pa-sm"},{default:e(()=>[s.santri.id?(o(),f(ta,{key:0,id:s.santri.id,class:"q-mb-sm"},null,8,["id"])):q("",!0),a(Y,{bordered:"",separator:"",class:"rounded-borders"},{default:e(()=>[t.value?(o(),f(M,{key:0,class:"q-px-sm"},{default:e(()=>[a(_,null,{default:e(()=>[a(p,null,{default:e(()=>[a(S,{type:"text"})]),_:1}),a(p,{caption:""},{default:e(()=>[a(S,{type:"text"})]),_:1})]),_:1}),a(_,{avatar:""},{default:e(()=>[a(S,{type:"QRadio"})]),_:1})]),_:1})):c.value?.length?(o(!0),I(R,{key:2},J(c.value,(n,x)=>(o(),f(M,{key:x,active:!!n.aktif,"active-class":"bg-green-1 text-green-10",class:"q-px-sm"},{default:e(()=>[a(_,null,{default:e(()=>[a(p,null,{default:e(()=>[k(b(n.th_ajaran_h)+" | "+b(n.marhalah)+" | "+b(n.faslah),1)]),_:2},1024),a(p,{caption:""},{default:e(()=>[k(b(g(sa)(n.created_at,"dd-MM-yyyy"))+" | "+b(g(na)(g(ia)(n.created_at)))+" ",1),n.aktif?(o(),I("span",oa,[...l[6]||(l[6]=[j("span",null,"|",-1),j("span",{class:"text-weight-bold text-green-10"}," Aktif ",-1)])])):q("",!0)]),_:2},1024)]),_:2},1024),a(_,{avatar:""},{default:e(()=>[a(D,{icon:"edit",dense:"",outline:"",round:"",glossy:"",onClick:F=>w(n.id)},null,8,["onClick"])]),_:2},1024)]),_:2},1032,["active"]))),128)):(o(),f(M,{key:1,class:"q-px-sm"},{default:e(()=>[a(_,null,{default:e(()=>[a(p,null,{default:e(()=>[...l[4]||(l[4]=[k(" Tidak ada data ",-1)])]),_:1}),a(p,{caption:""},{default:e(()=>[...l[5]||(l[5]=[k(" untuk ditampilkan ",-1)])]),_:1})]),_:1}),a(_,{avatar:""},{default:e(()=>[a(D,{icon:"sym_o_exclamation",disable:"",dense:"",outline:"",round:"",color:"green-14"})]),_:1})]),_:1}))]),_:1})]),_:1}),a(W,{modelValue:u.value,"onUpdate:modelValue":l[2]||(l[2]=n=>u.value=n)},{default:e(()=>[a(ua,{data:i.value,onSuccessSubmit:l[0]||(l[0]=n=>d(i.value.santri_id)),onSuccessDelete:l[1]||(l[1]=n=>d(i.value.santri_id))},null,8,["data"])]),_:1},8,["modelValue"])]),_:1}))}},H=[{name:"nama",label:"Nama",align:"left",field:"nama",sortable:!0},{name:"data_akhir",label:"Data Akhir",align:"left",field:"data_akhir",sortable:!0},{name:"th_ajaran_h",label:"Tahun Ajaran",align:"left",field:"th_ajaran_h",sortable:!0},{name:"marhalah",label:"Marhalah",align:"left",field:"marhalah",sortable:!0},{name:"faslah",label:"Faslah/Kelas",align:"left",field:"faslah",sortable:!0}],ja=[{name:"id",label:"ID Santri",align:"center",field:"id",sortable:!0},...H],Da=[{name:"santri_id",label:"ID Santri",align:"center",field:"santri_id",sortable:!0},...H];export{A as M,Va as _,Da as a,ja as c};
