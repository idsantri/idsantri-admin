import{q as m,ap as B,s as A,Y as E,E as p,c as C,o as c,w as s,g as e,af as H,f as D,Q,a9 as k,l as F,a as t,b as q,e as h,v as V,t as b,F as j,D as G,aq as R,G as M,J as O}from"./index-DEh4UAKk.js";import{Q as J}from"./QImg-DaB-_1ak.js";import{Q as _}from"./QItemLabel-CulQpTC_.js";import{Q as S,a as P}from"./QItem-BTdNNvAd.js";import{Q as Y}from"./QList-DhKPmN5Y.js";import{t as z}from"./format-text-DnCGEu2I.js";import{b as K}from"./index-C8LJz6c6.js";import{_ as W}from"./ImageUploader-QRkzN5_s.js";import{Q as X}from"./QForm-BUEZNW1c.js";import{A as Z}from"./Api-Cf9F4lBj.js";import{I as ee}from"./Image-DrE5WQLW.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./index-Cm_fkxN3.js";import"./apiPost-PqFHjFje.js";class ae extends Z{constructor(){super("user")}async get(){return(await this._apiGet({endPoint:this._path})).data}async update(l,d=!1){if(d&&!await this._notifyConfirm("Update profil Anda?"))return!1;const u=await this._apiUpdate({endPoint:`${this._path}`,data:l});return this._showSuccess(u.message),u.data}}const $=new ae,te={__name:"UserForm",props:{data:{type:Object,required:!0}},emits:["successDelete","successSubmit","successUpdate","successCreate"],setup(w,{emit:l}){const d=w,u=l,o=m({...d.data}),i=m(!1),f=B("firstInput");A(async()=>{await E(),f.value&&f.value.focus()});async function x(){const y={username:o.value.username,name:o.value.name,phone:o.value.phone};try{i.value=!0;const n=await $.update(y,!0);n&&(document.getElementById("btn-close-form")?.click(),u("successSubmit",n.user),u("successUpdate",n.user))}catch{}finally{i.value=!1}}return(y,n)=>{const g=p("FormHeader"),U=p("FormLoading"),r=p("FormActions");return c(),C(F,{class:"full-width",style:{"max-width":"425px"}},{default:s(()=>[e(X,{onSubmit:H(x,["prevent"])},{default:s(()=>[e(g,{title:"Update Profil","is-new":!1}),i.value?(c(),C(U,{key:0})):D("",!0),e(Q,null,{default:s(()=>[e(k,{class:"q-my-sm",dense:"",outlined:"",label:"Nama",modelValue:o.value.name,"onUpdate:modelValue":n[0]||(n[0]=a=>o.value.name=a),hint:"",ref_key:"firstInput",ref:f},null,8,["modelValue"]),e(k,{class:"q-my-sm",dense:"",outlined:"",label:"Username",modelValue:o.value.username,"onUpdate:modelValue":n[1]||(n[1]=a=>o.value.username=a),hint:"Anda bisa login dengan username atau email"},null,8,["modelValue"]),e(k,{class:"q-my-sm",dense:"",outlined:"",label:"Nomor Telepon",modelValue:o.value.phone,"onUpdate:modelValue":n[2]||(n[2]=a=>o.value.phone=a),hint:"08123456789"},null,8,["modelValue"])]),_:1}),e(r,{"btn-delete":!1})]),_:1})]),_:1})}}},se={class:"absolute-top-right q-ma-sm"},le={style:{"max-width":"150px"},class:"q-mx-auto"},oe={key:0},ne={class:"float-right"},re={class:"fit row wrap justify-start items-start content-start"},Ue={__name:"ProfileIndex",setup(w){const l=m({}),d=m(!1),u=m(!1),o=m(!1),i=m(!1),f=r=>i.value=r;async function x(){i.value=!1,await n()}async function y(){try{d.value=!0;const r=await $.get();l.value=r.user}catch(r){console.log("ðŸš€ ~ loadData ~ error:",r)}finally{d.value=!1}}async function n(){try{u.value=!0;const r=await ee.user(l.value.id);l.value.image=r?.image_url?r.image_url+`?t=${new Date().getTime()}`:"/user-default.png"}catch(r){console.log("ðŸš€ ~ loadImage ~ error:",r)}finally{u.value=!1}}async function g(){await y(),await n()}A(async()=>{await g()});const U=async()=>{await K("Untuk mengganti password, silakan <strong>logout (keluar)</strong>. Pada halaman login, klik <strong>lupa password</strong>.<br/>Ikuti petunjuk yang diberikan.",0)};return(r,a)=>{const L=p("CardHeader"),N=p("CardLoading"),T=p("CardPage");return c(),C(T,null,{default:s(()=>[e(L,{title:"Profil Pengguna",onOnReload:g}),e(Q,{class:"q-pa-sm"},{default:s(()=>[e(F,{class:"",flat:"",bordered:"",style:{"max-width":"600px"}},{default:s(()=>[e(Q,{class:"q-pa-sm"},{default:s(()=>[t("div",se,[e(h,{icon:"camera",round:"","no-caps":"",dense:"",glossy:"",class:"q-ma-xs q-px-sm",onClick:a[0]||(a[0]=v=>i.value=!0)})]),t("div",le,[e(J,{src:l.value.image,ratio:1,alt:"user","img-style":{borderRadius:"50%",border:"3px",borderColor:"green",borderStyle:"solid"}},null,8,["src"])]),l.value.confirmed_at?D("",!0):(c(),q("div",oe,[...a[3]||(a[3]=[t("div",{class:"text-center q-my-lg"},[t("div",{class:"q-pa-md text-negative bg-red-1",style:{"border-radius":"10px"}},[t("div",null,"Akun Anda belum terkonfirmasi."),t("div",null,"Silakan hubungi Admin!")])],-1)])])),e(Y,{bordered:"",separator:"",class:"q-mt-sm"},{default:s(()=>[e(S,{class:"q-pa-sm"},{default:s(()=>[e(P,null,{default:s(()=>[e(_,{overline:""},{default:s(()=>[...a[4]||(a[4]=[V("User",-1)])]),_:1}),e(_,null,{default:s(()=>[t("table",null,[t("tbody",null,[t("tr",null,[a[5]||(a[5]=t("td",{class:"text-italic text-caption"},"Nama",-1)),t("td",null,b(l.value.name),1)]),t("tr",null,[a[6]||(a[6]=t("td",{class:"text-italic text-caption"},"Email",-1)),t("td",null,b(l.value.email),1)]),t("tr",null,[a[7]||(a[7]=t("td",{class:"text-italic text-caption"},"Username",-1)),t("td",null,b(l.value.username),1)]),t("tr",null,[a[8]||(a[8]=t("td",{class:"text-italic text-caption"},"Telepon",-1)),t("td",null,b(l.value.phone||"-"),1)])])])]),_:1}),e(_,{class:"bg-green-1"},{default:s(()=>[t("div",ne,[e(h,{label:"User",icon:"edit","no-caps":"",dense:"",class:"q-my-xs q-mx-sm q-px-sm",onClick:a[1]||(a[1]=v=>o.value=!0)}),e(h,{label:"Password",icon:"edit","no-caps":"",dense:"",class:"q-my-xs q-mx-sm q-px-sm",onClick:U})])]),_:1})]),_:1})]),_:1}),e(S,{class:"q-pa-sm"},{default:s(()=>[e(P,null,{default:s(()=>[e(_,{overline:""},{default:s(()=>[...a[9]||(a[9]=[V("User Group",-1)])]),_:1}),e(_,null,{default:s(()=>[t("div",re,[(c(!0),q(j,null,G(l.value.roles,(v,I)=>(c(),q("div",{key:I,class:"col-6"},[e(R,{"model-value":v,color:"green",label:M(z)(I),disable:""},null,8,["model-value","label"])]))),128))])]),_:1})]),_:1})]),_:1})]),_:1}),e(N,{showing:d.value},null,8,["showing"])]),_:1})]),_:1})]),_:1}),e(O,{modelValue:o.value,"onUpdate:modelValue":a[2]||(a[2]=v=>o.value=v)},{default:s(()=>[e(te,{data:l.value,onSuccessSubmit:g},null,8,["data"])]),_:1},8,["modelValue"]),e(W,{"show-uploader":i.value,url:`/images/users/${l.value.id}`,width:300,height:300,"img-format":"webp",onUpdateUploader:f,onSuccessUpload:x},null,8,["show-uploader","url"])]),_:1})}}};export{Ue as default};
