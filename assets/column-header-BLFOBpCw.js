import{v as b,R as B,x as U,f as p,o as m,w as t,i as e,a8 as A,Q as q,r as S,y as C,B as I,a4 as N,q as M,a9 as O,ap as P,k as Q,p as x,j as _,F as H,s as T,t as h,z as V}from"./index-1h6WQa8x.js";import{Q as w}from"./QSkeleton-BA_8lTLb.js";import{Q as c}from"./QItemLabel-BCrbjFPh.js";import{Q as j,a as v}from"./QItemSection-CDMonx4a.js";import{Q as E}from"./QList-DG4NG05A.js";import{a as L}from"./api-get-BY6mtHh6.js";import{Q as R}from"./QSpinnerCube-CdFtSnRz.js";import{Q as z}from"./QSelect-DyXiAk3o.js";import{Q as K}from"./QForm-Dcqp4yj8.js";import{a as G}from"./api-post-C74Y7wCj.js";import{a as W}from"./api-update-Damf_6Ly.js";import{a as J}from"./api-delete-BHdy2F2f.js";import{_ as D}from"./InputSelectArray-f2GqfPam.js";import{_ as X}from"./CardSantriSimple-B4aE1WRE.js";import{g as Y}from"./array-object-BytDdNh7.js";import{c as F}from"./format-date-DlwYCgkJ.js";import{a as Z}from"./hijri-BBdEhqDI.js";const aa={key:0},ea={__name:"QuranMutaallimForm",props:{data:{type:Object,required:!0}},emits:["successDelete","successSubmit","successUpdate","successCreate"],setup(i,{emit:f}){const o=i,d=f,l=b({marhalah:"Ula",faslah:null,no_absen:null,aktif:1}),u=b(!1);B(async()=>{Object.assign(l.value,o.data)});const y=async()=>{const r={santri_id:l.value.santri_id,th_ajaran_h:l.value.th_ajaran_h,marhalah:l.value.marhalah,faslah:l.value.faslah,no_absen:l.value.no_absen,aktif:l.value.aktif};let a=null;const s=!l.value.id;s?a=await G({endPoint:"mutaallim",data:r,loading:u}):a=await W({endPoint:`mutaallim/${l.value.id}`,data:r,confirm:!0,notify:!0,loading:u}),a&&(document.getElementById("btn-close-form").click(),d("successSubmit",a?.mutaallim),d(s?"successCreate":"successUpdate",a?.mutaallim))},g=async()=>{const r=l.value.id;await J({endPoint:`mutaallim/${r}`,loading:u})&&(document.getElementById("btn-close-form").click(),d("successDelete",r))};return(r,a)=>{const s=U("FormHeader"),k=U("FormActions");return m(),p(M,{class:"full-width",style:{"max-width":"425px"}},{default:t(()=>[e(K,{onSubmit:A(y,["prevent"])},{default:t(()=>[e(s,{title:"Input Pendidikan Quran","is-new":!l.value.id},null,8,["is-new"]),e(q,null,{default:t(()=>[u.value?(m(),S("div",aa,[e(I,{modelValue:u.value,"onUpdate:modelValue":a[0]||(a[0]=n=>u.value=n),persistent:""},{default:t(()=>[e(R,{color:"green-12",size:"8em",class:"flex q-ma-lg q-mx-auto"})]),_:1},8,["modelValue"])])):C("",!0),e(N,{dense:"",outlined:"",label:"Nama","model-value":l.value?.nama+" ("+l.value?.santri_id+")",disable:"",filled:""},null,8,["model-value"]),e(D,{modelValue:l.value.th_ajaran_h,"onUpdate:modelValue":a[1]||(a[1]=n=>l.value.th_ajaran_h=n),url:"tahun-ajaran",label:"Tahun Ajaran *",sort:"desc",class:"q-mt-sm",rules:[n=>!!n||"Harus diisi!"],selected:l.value.th_ajaran_h},null,8,["modelValue","rules","selected"]),e(z,{dense:"",outlined:"",modelValue:l.value.marhalah,"onUpdate:modelValue":a[2]||(a[2]=n=>l.value.marhalah=n),label:"Marhalah *",class:"q-mt-sm",rules:[n=>!!n||"Harus diisi!"],options:["Ula","Wustho","Ulya"]},null,8,["modelValue","rules"]),e(D,{modelValue:l.value.faslah,"onUpdate:modelValue":a[3]||(a[3]=n=>l.value.faslah=n),url:"faslah-quran",label:"Faslah/Kelas *",class:"q-mt-sm",rules:[n=>!!n||"Harus diisi!"]},null,8,["modelValue","rules"]),e(M,{bordered:"",flat:"",class:"q-px-sm q-mt-sm"},{default:t(()=>[e(O,{modelValue:l.value.aktif,"onUpdate:modelValue":a[4]||(a[4]=n=>l.value.aktif=n),color:"green","true-value":1,"false-value":0,label:"Aktif",disable:!l.value.id},null,8,["modelValue","disable"])]),_:1})]),_:1}),e(k,{"btn-delete":!!l.value.id,onOnDelete:g},null,8,["btn-delete"])]),_:1})]),_:1})}}},la={key:0},ga={__name:"MutaallimCard",props:{santri:{type:Object}},setup(i){const f=b(!1),o=b({}),d=b([]),l=b(!1);async function u(r){const a=await L({endPoint:`mutaallim/santri/${r}`,loading:l});a&&(d.value=a.mutaallim)}P(async()=>{i.santri?.id?await u(i.santri.id):i.santri?.santri_id&&await u(i.santri.santri_id)});const y=()=>{o.value={santri_id:i.santri.id,nama:i.santri.nama},f.value=!0},g=r=>{o.value=Y(d,r),o.value.santri_id=i.santri.id,o.value.nama=i.santri.nama,f.value=!0};return(r,a)=>(m(),p(M,{flat:"",bordered:"",class:"",style:{width:"350px"}},{default:t(()=>[e(q,{class:"bg-green-7 text-green-11 q-pa-sm flex items-center justify-between"},{default:t(()=>[a[3]||(a[3]=Q("div",null,"Riwayat Mutaallim",-1)),e(x,{icon:"add",outline:"",dense:"",class:"q-px-sm",disabled:!i.santri.id,onClick:y},null,8,["disabled"])]),_:1}),e(q,{class:"q-pa-sm"},{default:t(()=>[i.santri.id?(m(),p(X,{key:0,id:i.santri.id,class:"q-mb-sm"},null,8,["id"])):C("",!0),e(E,{bordered:"",separator:"",class:"rounded-borders"},{default:t(()=>[l.value?(m(),p(j,{key:0,class:"q-px-sm"},{default:t(()=>[e(v,null,{default:t(()=>[e(c,null,{default:t(()=>[e(w,{type:"text"})]),_:1}),e(c,{caption:""},{default:t(()=>[e(w,{type:"text"})]),_:1})]),_:1}),e(v,{avatar:""},{default:t(()=>[e(w,{type:"QRadio"})]),_:1})]),_:1})):d.value?.length?(m(!0),S(H,{key:2},T(d.value,(s,k)=>(m(),p(j,{key:k,active:!!s.aktif,"active-class":"bg-green-1 text-green-10",class:"q-px-sm"},{default:t(()=>[e(v,null,{default:t(()=>[e(c,null,{default:t(()=>[_(h(s.th_ajaran_h)+" | "+h(s.marhalah)+" | "+h(s.faslah),1)]),_:2},1024),e(c,{caption:""},{default:t(()=>[_(h(V(F)(s.created_at,"dd-MM-yyyy"))+" | "+h(V(Z)(V(F)(s.created_at,"yyyy-MM-dd")))+" ",1),s.aktif?(m(),S("span",la,[...a[6]||(a[6]=[Q("span",null,"|",-1),Q("span",{class:"text-weight-bold text-green-10"}," Aktif ",-1)])])):C("",!0)]),_:2},1024)]),_:2},1024),e(v,{avatar:""},{default:t(()=>[e(x,{icon:"edit",dense:"",outline:"",round:"",glossy:"",onClick:n=>g(s.id)},null,8,["onClick"])]),_:2},1024)]),_:2},1032,["active"]))),128)):(m(),p(j,{key:1,class:"q-px-sm"},{default:t(()=>[e(v,null,{default:t(()=>[e(c,null,{default:t(()=>[...a[4]||(a[4]=[_(" Tidak ada data ",-1)])]),_:1}),e(c,{caption:""},{default:t(()=>[...a[5]||(a[5]=[_(" untuk ditampilkan ",-1)])]),_:1})]),_:1}),e(v,{avatar:""},{default:t(()=>[e(x,{icon:"sym_o_exclamation",disable:"",dense:"",outline:"",round:"",color:"green-14"})]),_:1})]),_:1}))]),_:1})]),_:1}),e(I,{modelValue:f.value,"onUpdate:modelValue":a[2]||(a[2]=s=>f.value=s)},{default:t(()=>[e(ea,{data:o.value,onSuccessSubmit:a[0]||(a[0]=s=>u(o.value.santri_id)),onSuccessDelete:a[1]||(a[1]=s=>u(o.value.santri_id))},null,8,["data"])]),_:1},8,["modelValue"])]),_:1}))}},$=[{name:"nama",label:"Nama",align:"left",field:"nama",sortable:!0},{name:"data_akhir",label:"Data Akhir",align:"left",field:"data_akhir",sortable:!0},{name:"th_ajaran_h",label:"Tahun Ajaran",align:"left",field:"th_ajaran_h",sortable:!0},{name:"marhalah",label:"Marhalah",align:"left",field:"marhalah",sortable:!0},{name:"faslah",label:"Faslah/Kelas",align:"left",field:"faslah",sortable:!0}],ka=[{name:"id",label:"ID Santri",align:"center",field:"id",sortable:!0},...$],Qa=[{name:"santri_id",label:"ID Santri",align:"center",field:"santri_id",sortable:!0},...$];export{ga as _,Qa as a,ka as c};
