import{Q as L}from"./QSelect-BqMes2y4.js";import{q as r,s as A,E as K,c as F,o as c,w as s,g as a,Q as v,l as q,v as w,t as P,b as g,a as f,F as $,D,af as h,a9 as m,e as b}from"./index-B5Gb-mLe.js";import{Q as S,a as y}from"./QItem-BCXtxr0M.js";import{Q}from"./QBtnGroup-CY-FPBrJ.js";import{Q as U}from"./QForm-CMcK7Ex8.js";import{A as k}from"./AbsensiSetting-BFOOP_du.js";import{L as x}from"./Lists-BoizF34m.js";import"./QField-Bbp2qmBb.js";import"./QChip-D_d4F4g7.js";import"./QItemLabel-CLmt2hLx.js";import"./QMenu-CBRP4CDX.js";import"./selection-BzMZOoQD.js";import"./rtl-DFPa-2ov.js";import"./format-CJebrXOQ.js";import"./ApiCrud-DSLkdATC.js";import"./Api-CNGT1L8P.js";import"./index-w3oJRLyV.js";import"./index-B2zugsq1.js";import"./apiPost-9wQ754O6.js";const E={key:0},M={class:"row"},G={class:"row"},R={key:1,class:"q-my-md text-center"},pe={__name:"AbsensiSetting",setup(z){const u=r(""),V=r([]),_=r([{}]),j=r([{}]),d=r(!1),i=r(!1),o=r({});async function B(){try{i.value=!0,o.value.tingkat_id=u.value.val0,await k.create({data:o.value}),o.value={},await p(u.value.val0)}catch(l){console.error("ðŸš€ ~ addSetting ~ error:",l)}finally{i.value=!1}}async function C(l){try{i.value=!0,await k.remove({id:l}),await p(u.value.val0)}catch(t){console.error("ðŸš€ ~ deleteSetting ~ e:",t)}finally{i.value=!1}}async function N(l){try{i.value=!0,await k.update({id:l.id,data:{bulan:l.bulan,ujian:l.ujian,tingkat_id:l.tingkat_id}}),await p(l.tingkat_id)}catch(t){console.error("ðŸš€ ~ submitUpdate ~ error:",t)}finally{i.value=(!1)``}}async function H(){try{d.value=!0;const l=await x.getByKey("tingkat-pendidikan");V.value=l.tingkat_pendidikan}catch(l){console.log("error get list ",l)}finally{d.value=!1}}async function T(){try{d.value=!0;const l=await x.getByKey("bulan-hijri");_.value=l.bulan_hijri}catch(l){console.log("error get list ",l)}finally{d.value=!1}}async function p(l){try{i.value=!0;const t=await k.getAll({params:{tingkat_id:l}});j.value=t.bulan_ujian}catch(t){console.error("ðŸš€ ~ fetchSetting ~ e:",t)}finally{i.value=!1}}return A(async()=>{await H(),await T()}),(l,t)=>{const I=K("CardLoading");return c(),F(q,{class:"",style:{"max-width":"600px"},bordered:"",flat:""},{default:s(()=>[a(v,{class:"q-pa-sm"},{default:s(()=>[a(L,{dense:"",outlined:"",label:"Pilih Tingkat Pendidikan",modelValue:u.value,"onUpdate:modelValue":[t[0]||(t[0]=e=>u.value=e),t[1]||(t[1]=e=>p(e.val0))],options:V.value,"emit-value":"","map-options":"","option-label":"val1",loading:d.value,behavior:"menu"},null,8,["modelValue","options","loading"]),a(q,{class:"q-mt-sm"},{default:s(()=>[a(v,{class:"bg-green-7 text-green-1 text-subtitle1 q-pa-sm"},{default:s(()=>[w(" Tingkat Pendidikan: "+P(u.value.val1),1)]),_:1}),a(v,{class:"q-pa-sm"},{default:s(()=>[u.value?(c(),g("div",E,[f("div",null,[(c(!0),g($,null,D(j.value,e=>(c(),g("div",{key:e.id},[a(U,{onSubmit:h(n=>N(e),["prevent"])},{default:s(()=>[a(S,{class:"no-padding"},{default:s(()=>[a(y,null,{default:s(()=>[f("div",M,[a(m,{label:"Ujian Ke-?",class:"col-3 q-pr-sm",dense:"",outlined:"",modelValue:e.ujian,"onUpdate:modelValue":n=>e.ujian=n,required:"",mask:"#",rules:[n=>!!n||"Harus diisi!",n=>n>=1&&n<=3||"1, 2, atau 3!"]},null,8,["modelValue","onUpdate:modelValue","rules"]),a(m,{label:"Bulan",class:"col-3 q-pr-sm",dense:"",outlined:"",modelValue:e.bulan,"onUpdate:modelValue":n=>e.bulan=n,required:"",mask:"##",rules:[n=>!!n||"Harus diisi!",n=>n>=1&&n<=12||"1 hingga 12!"]},null,8,["modelValue","onUpdate:modelValue","rules"]),a(m,{class:"col-6",dense:"",outlined:"","model-value":_.value.find(n=>Number(n.val2)==Number(e.bulan))?.val1||"",readonly:""},null,8,["model-value"])])]),_:2},1024),a(y,{side:"",class:"no-padding q-ml-sm"},{default:s(()=>[a(Q,{push:"",class:"q-mb-lg"},{default:s(()=>[a(b,{color:"positive",glossy:"",icon:"save",type:"submit"}),a(b,{color:"negative",glossy:"",icon:"delete",onClick:n=>C(e.id)},null,8,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1032,["onSubmit"])]))),128)),a(U,{onSubmit:h(B,["prevent"]),onReset:t[4]||(t[4]=e=>o.value={})},{default:s(()=>[a(S,{class:"no-padding",style:{"justify-content":"start"}},{default:s(()=>[a(y,null,{default:s(()=>[f("div",G,[a(m,{label:"Ujian Ke-?",class:"col-3 q-pr-sm",dense:"",outlined:"",modelValue:o.value.ujian,"onUpdate:modelValue":t[2]||(t[2]=e=>o.value.ujian=e),required:"",mask:"#",rules:[e=>!!e||"Harus diisi!",e=>e>=1&&e<=3||"1, 2, atau 3!"]},null,8,["modelValue","rules"]),a(m,{label:"Bulan",class:"col-3 q-pr-sm",dense:"",outlined:"",modelValue:o.value.bulan,"onUpdate:modelValue":t[3]||(t[3]=e=>o.value.bulan=e),required:"",mask:"##",rules:[e=>!!e||"Harus diisi!",e=>e>=1&&e<=12||"1 hingga 12!"]},null,8,["modelValue","rules"]),a(m,{class:"col-6",dense:"",outlined:"",readonly:"","model-value":_.value.find(e=>Number(e.val2)==Number(o.value.bulan))?.val1||""},null,8,["model-value"])])]),_:1}),a(y,{side:"",class:"no-padding q-ml-sm"},{default:s(()=>[a(Q,{push:"",class:"q-mb-lg"},{default:s(()=>[a(b,{color:"positive",glossy:"",icon:"save",type:"submit"}),a(b,{color:"negative",glossy:"",icon:"undo",type:"reset"})]),_:1})]),_:1})]),_:1})]),_:1})])])):(c(),g("div",R,"Silakan pilih list tingkat pendidikan!"))]),_:1}),a(v,{class:"bg-green-6 text-green-1 text-caption text-italic q-pa-sm"},{default:s(()=>[...t[5]||(t[5]=[w(" Ujian (1, 2) jika menganut sistem semester atau kuartal (mid semester) ",-1),f("br",null,null,-1),w(" Ujian (1, 2, 3) jika menganut sistem catur wulan ",-1)])]),_:1}),a(I,{showing:d.value||i.value},null,8,["showing"])]),_:1})]),_:1})]),_:1})}}};export{pe as default};
