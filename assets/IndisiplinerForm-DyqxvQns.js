import{a8 as T,ae as R,A as I,s as S,c as U,o as x,w as g,g as t,G as i,q as $,ap as h,Y as A,E as w,af as B,f as K,Q as L,a9 as m,l as M}from"./index-B_fOp8I2.js";import{Q as O}from"./QRating-C3D1e30H.js";import{Q as j}from"./QSelect-udWnZaoN.js";import{Q as E}from"./QForm-XW60lmKZ.js";import{b as q,m as z}from"./hijri-CTUg_lXm.js";import{i as D,f as F}from"./format-date-DBaFa2rd.js";import{_ as N}from"./InputSelectSantriId-CQa7IIQ3.js";import{u as P}from"./lists-store-CD0Hggyp.js";import{_ as G}from"./DropDownAfter-CV4tl_Qw.js";import{_ as Y}from"./InputSelectArray-CnP1463e.js";import{u as J}from"./useCrudForm-DYJRtmbD.js";import{I as W}from"./Indisipliner-BPN3HASI.js";const Q="tatib-santri",X={__name:"InputSelectTatibSantri",props:{modelValue:{},modelModifiers:{}},emits:["update:modelValue"],setup(f){const p=T(f,"modelValue"),u=P(),k=R(u),{loading:e}=k,v=Q.replace(/-/g,"_"),r=I(()=>{const s=u.getStateByKey(v);let o=[];return s.length&&(o=s.filter(n=>n.val0.length!=1).map(n=>`[${n.val0}] ${n.val1}`)),o});function V(s){try{if(!s)return"Pilih pasal dilanggar";const n=(Array.isArray(s)?s:[s]).join("; "),_=/\[(.*?)\]/g,d=n.match(_);return d?"["+d.map(y=>y.slice(1,-1)).join(", ")+"]":""}catch(o){return console.error(o),""}}const b=I(()=>V(p.value));async function c(){await u.fetchList(Q)}return S(async()=>{(!r.value||r.value.length==0)&&await c()}),(s,o)=>(x(),U(j,{dense:"",outlined:"",label:"Pasal dilanggar","emit-value":"","map-options":"",options:r.value,loading:i(e),behavior:"menu",clearable:"",multiple:"",hint:b.value,modelValue:p.value,"onUpdate:modelValue":o[0]||(o[0]=n=>p.value=n)},{after:g(()=>[t(G,{"route-to":"tatib-santri",onReload:c})]),_:1},8,["options","loading","hint","modelValue"]))}},me={__name:"IndisiplinerForm",props:{data:Object},emits:["successDelete","successSubmit","successUpdate","successCreate"],setup(f,{emit:p}){const u=f,k=p,e=$({kategori:3,...u.data}),v=!u.data?.id,r=h("firstInput");S(async()=>{await A(),r.value&&r.value.focus()});const{handleDelete:V,handleCreate:b,handleUpdate:c,loading:s}=J(W,{emit:k,responseKey:"indisipliner"});async function o(){const d={santri_id:e.value.santri_id,tgl_kasus:e.value.tgl_kasus,tgl_sidang:e.value.tgl_sidang,kategori:e.value.kategori,pasal:e.value.pasal?.join("; "),deskripsi:e.value.deskripsi,eksekutor:e.value.eksekutor,saksi:e.value.saksi,takzir:e.value.takzir?.join("; "),keterangan:e.value.keterangan};return v?await b(d,!0):await c(u.data.id,d,!0)}const n=async()=>await V(u.data.id);S(async()=>{e.value.pasal&&(e.value.pasal=e.value.pasal.split(",")),e.value.takzir&&(e.value.takzir=e.value.takzir.split(","))});const _=[{value:1,label:"Sangat Ringan"},{value:2,label:"Ringan"},{value:3,label:"Sedang"},{value:4,label:"Berat"},{value:5,label:"Sangat Berat"}];return(d,l)=>{const y=w("FormHeader"),H=w("FormLoading"),C=w("FormActions");return x(),U(M,{class:"full-width",style:{"max-width":"425px"}},{default:g(()=>[t(E,{onSubmit:B(o,["prevent"])},{default:g(()=>[t(y,{title:"Input Santri Indisipliner","is-new":v}),i(s)?(x(),U(H,{key:0})):K("",!0),t(L,null,{default:g(()=>[t(N,{"active-only":!0,onEmitInput:l[0]||(l[0]=a=>Object.assign(e.value,a)),data:u.data,class:"q-my-sm",ref:e.value.santri_id?null:"firstInput"},null,8,["data"]),t(m,{dense:"",hint:i(D)(e.value.tgl_kasus)?i(F)(e.value.tgl_kasus)+" | "+i(q)(i(z)(e.value.tgl_kasus)):"",class:"q-my-sm",outlined:"",label:"Tanggal Kasus*",modelValue:e.value.tgl_kasus,"onUpdate:modelValue":l[1]||(l[1]=a=>e.value.tgl_kasus=a),type:"date",rules:[a=>!!a||"Harus diisi!"],"error-color":"negative",ref:e.value.santri_id?"firstInput":null},null,8,["hint","modelValue","rules"]),t(m,{dense:"",hint:i(D)(e.value.tgl_sidang)?i(F)(e.value.tgl_sidang)+" | "+i(q)(i(z)(e.value.tgl_sidang)):"",class:"q-my-sm",outlined:"",label:"Tanggal Sidang*",modelValue:e.value.tgl_sidang,"onUpdate:modelValue":l[2]||(l[2]=a=>e.value.tgl_sidang=a),type:"date",rules:[a=>!!a||"Harus diisi!"],"error-color":"negative"},null,8,["hint","modelValue","rules"]),t(j,{dense:"",modelValue:e.value.kategori,"onUpdate:modelValue":l[4]||(l[4]=a=>e.value.kategori=a),class:"q-my-sm",outlined:"",label:"Kategori*",options:_,"emit-value":"","map-options":"",rules:[a=>!!a||"Harus diisi!"],"error-color":"negative",behavior:"menu"},{after:g(()=>[t(O,{class:"",name:"kategori",modelValue:e.value.kategori,"onUpdate:modelValue":l[3]||(l[3]=a=>e.value.kategori=a),max:"5",color:"red",icon:"thumb_down","icon-selected":"thumb_down",size:"1em"},null,8,["modelValue"])]),_:1},8,["modelValue","rules"]),t(X,{class:"q-my-sm",modelValue:e.value.pasal,"onUpdate:modelValue":l[5]||(l[5]=a=>e.value.pasal=a),rules:[a=>!!a||"Harus diisi!"]},null,8,["modelValue","rules"]),t(m,{dense:"",class:"q-my-sm",outlined:"",label:"Deskripsi",modelValue:e.value.deskripsi,"onUpdate:modelValue":l[6]||(l[6]=a=>e.value.deskripsi=a),autogrow:""},null,8,["modelValue"]),t(m,{dense:"",class:"q-my-sm",outlined:"",label:"Eksekutor",modelValue:e.value.eksekutor,"onUpdate:modelValue":l[7]||(l[7]=a=>e.value.eksekutor=a),rules:[a=>!!a||"Harus diisi!"],"error-color":"negative"},null,8,["modelValue","rules"]),t(m,{dense:"",class:"q-my-sm",outlined:"",label:"Saksi",modelValue:e.value.saksi,"onUpdate:modelValue":l[8]||(l[8]=a=>e.value.saksi=a)},null,8,["modelValue"]),t(Y,{modelValue:e.value.takzir,"onUpdate:modelValue":l[9]||(l[9]=a=>e.value.takzir=a),url:"takzir-santri",label:"Takzir",class:"q-my-sm",multiple:""},null,8,["modelValue"]),t(m,{dense:"",class:"q-my-sm",outlined:"",label:"Keterangan",modelValue:e.value.keterangan,"onUpdate:modelValue":l[10]||(l[10]=a=>e.value.keterangan=a),autogrow:""},null,8,["modelValue"])]),_:1}),t(C,{"btn-delete":!v,onOnDelete:n},null,8,["btn-delete"])]),_:1})]),_:1})}}};export{me as _};
