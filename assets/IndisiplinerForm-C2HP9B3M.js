import{a8 as I,A as h,q as w,s as j,c as S,o as U,w as c,g as s,E as _,af as B,f as K,G as i,Q as $,a9 as m,l as A}from"./index-CQ0qIhEP.js";import{Q as L}from"./QRating-C3Y_AyxC.js";import{Q as C}from"./QSelect-DO368R1o.js";import{Q as M}from"./QForm-BKVRYDjQ.js";import{b as x,m as D}from"./hijri-Bs48DFvR.js";import{i as z,f as F}from"./format-date-OVhbBx9F.js";import{_ as O}from"./InputSelectSantriId-CqtUOIOh.js";import{l as R}from"./lists-store-ChrMIcaE.js";import{_ as T}from"./DropDownAfter-DjwH34eY.js";import{L as E}from"./Lists-NDY-gRf7.js";import{_ as N}from"./InputSelectArray-CWQ77YQP.js";import{u as P}from"./useCrudForm-CdMW2jfj.js";import{I as G}from"./Indisipliner-Csd2oXwf.js";const Q="tatib-santri",J={__name:"InputSelectTatibSantri",props:{modelValue:{},modelModifiers:{}},emits:["update:modelValue"],setup(V){const p=I(V,"modelValue"),r=h(()=>y(p.value));function y(t){try{if(!t)return"Pilih pasal dilanggar";const n=(Array.isArray(t)?t:[t]).join("; "),v=/\[(.*?)\]/g,l=n.match(v);return l?"["+l.map(b=>b.slice(1,-1)).join(", ")+"]":""}catch(o){return console.error(o),""}}const e=w(!1),u=w([]),g=R(),d=Q.replace(/-/g,"_");function k(t){let o=[];return t.length&&(o=t.filter(n=>n.val0.length!=1).map(n=>`[${n.val0}] ${n.val1}`)),o}j(async()=>{const t=g.getStateByKey(d);if(t.length)u.value=k(t);else{await f();const o=g.getStateByKey(d);u.value=k(o)}});async function f(){try{e.value=!0;const t=await E.getByKey(Q);g.$patch({[d]:t[d]})}catch(t){console.log("error get list ",t)}finally{e.value=!1}}return(t,o)=>(U(),S(C,{dense:"",outlined:"",label:"Pasal dilanggar","emit-value":"","map-options":"",options:u.value,loading:e.value,behavior:"menu",clearable:"",multiple:"",hint:r.value,modelValue:p.value,"onUpdate:modelValue":o[0]||(o[0]=n=>p.value=n)},{after:c(()=>[s(T,{"route-to":"tatib-santri",onReload:f})]),_:1},8,["options","loading","hint","modelValue"]))}},ue={__name:"IndisiplinerForm",props:{data:Object},emits:["successDelete","successSubmit","successUpdate","successCreate"],setup(V,{emit:p}){const r=V,y=p,e=w({kategori:3,...r.data}),u=!r.data?.id,{handleDelete:g,handleCreate:d,handleUpdate:k,loading:f}=P(G,{emit:y,responseKey:"indisipliner"});async function t(){const v={santri_id:e.value.santri_id,tgl_kasus:e.value.tgl_kasus,tgl_sidang:e.value.tgl_sidang,kategori:e.value.kategori,pasal:e.value.pasal?.join("; "),deskripsi:e.value.deskripsi,eksekutor:e.value.eksekutor,saksi:e.value.saksi,takzir:e.value.takzir?.join("; "),keterangan:e.value.keterangan};return u?await d(v,!0):await k(r.data.id,v,!0)}const o=async()=>await g(r.data.id);j(async()=>{e.value.pasal&&(e.value.pasal=e.value.pasal.split(",")),e.value.takzir&&(e.value.takzir=e.value.takzir.split(","))});const n=[{value:1,label:"Sangat Ringan"},{value:2,label:"Ringan"},{value:3,label:"Sedang"},{value:4,label:"Berat"},{value:5,label:"Sangat Berat"}];return(v,l)=>{const q=_("FormHeader"),b=_("FormLoading"),H=_("FormActions");return U(),S(A,{class:"full-width",style:{"max-width":"425px"}},{default:c(()=>[s(M,{onSubmit:B(t,["prevent"])},{default:c(()=>[s(q,{title:"Input Santri Indisipliner","is-new":u}),i(f)?(U(),S(b,{key:0})):K("",!0),s($,{class:"q-pa-sm"},{default:c(()=>[s(O,{"active-only":!0,onEmitInput:l[0]||(l[0]=a=>Object.assign(e.value,a)),data:r.data,class:"q-my-sm"},null,8,["data"]),s(m,{dense:"",hint:i(z)(e.value.tgl_kasus)?i(F)(e.value.tgl_kasus)+" | "+i(x)(i(D)(e.value.tgl_kasus)):"",class:"q-my-sm",outlined:"",label:"Tanggal Kasus*",modelValue:e.value.tgl_kasus,"onUpdate:modelValue":l[1]||(l[1]=a=>e.value.tgl_kasus=a),type:"date",rules:[a=>!!a||"Harus diisi!"],"error-color":"negative"},null,8,["hint","modelValue","rules"]),s(m,{dense:"",hint:i(z)(e.value.tgl_sidang)?i(F)(e.value.tgl_sidang)+" | "+i(x)(i(D)(e.value.tgl_sidang)):"",class:"q-my-sm",outlined:"",label:"Tanggal Sidang*",modelValue:e.value.tgl_sidang,"onUpdate:modelValue":l[2]||(l[2]=a=>e.value.tgl_sidang=a),type:"date",rules:[a=>!!a||"Harus diisi!"],"error-color":"negative"},null,8,["hint","modelValue","rules"]),s(C,{dense:"",modelValue:e.value.kategori,"onUpdate:modelValue":l[4]||(l[4]=a=>e.value.kategori=a),class:"q-my-sm",outlined:"",label:"Kategori*",options:n,"emit-value":"","map-options":"",rules:[a=>!!a||"Harus diisi!"],"error-color":"negative",behavior:"menu"},{after:c(()=>[s(L,{class:"",name:"kategori",modelValue:e.value.kategori,"onUpdate:modelValue":l[3]||(l[3]=a=>e.value.kategori=a),max:"5",color:"red",icon:"thumb_down","icon-selected":"thumb_down",size:"1em"},null,8,["modelValue"])]),_:1},8,["modelValue","rules"]),s(J,{class:"q-my-sm",modelValue:e.value.pasal,"onUpdate:modelValue":l[5]||(l[5]=a=>e.value.pasal=a),rules:[a=>!!a||"Harus diisi!"]},null,8,["modelValue","rules"]),s(m,{dense:"",class:"q-my-sm",outlined:"",label:"Deskripsi",modelValue:e.value.deskripsi,"onUpdate:modelValue":l[6]||(l[6]=a=>e.value.deskripsi=a),autogrow:""},null,8,["modelValue"]),s(m,{dense:"",class:"q-my-sm",outlined:"",label:"Eksekutor",modelValue:e.value.eksekutor,"onUpdate:modelValue":l[7]||(l[7]=a=>e.value.eksekutor=a),rules:[a=>!!a||"Harus diisi!"],"error-color":"negative"},null,8,["modelValue","rules"]),s(m,{dense:"",class:"q-my-sm",outlined:"",label:"Saksi",modelValue:e.value.saksi,"onUpdate:modelValue":l[8]||(l[8]=a=>e.value.saksi=a)},null,8,["modelValue"]),s(N,{modelValue:e.value.takzir,"onUpdate:modelValue":l[9]||(l[9]=a=>e.value.takzir=a),url:"takzir-santri",label:"Takzir",class:"q-my-sm",multiple:""},null,8,["modelValue"]),s(m,{dense:"",class:"q-my-sm",outlined:"",label:"Keterangan",modelValue:e.value.keterangan,"onUpdate:modelValue":l[10]||(l[10]=a=>e.value.keterangan=a),autogrow:""},null,8,["modelValue"])]),_:1}),s(H,{"btn-delete":!u,onOnDelete:o},null,8,["btn-delete"])]),_:1})]),_:1})}}};export{ue as _};
