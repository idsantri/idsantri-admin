import{q as u,E as y,c as b,o as g,w as d,g as o,af as Q,f as x,G as S,Q as A,a9 as V,l as B,ad as U,A as q,s as I,b as E,J as N}from"./index-CywAldKl.js";import{_ as O}from"./TemplateArray-DcNyiewt.js";import{c as F}from"./format-date-OVhbBx9F.js";import{a as h}from"./hijri-Bs48DFvR.js";import{r as j,d as H,g as K}from"./array-object-BytDdNh7.js";import{Q as $}from"./QForm-C4sObFI3.js";import{_ as L}from"./InputSelectArray-DyxlLLIV.js";import{S as k}from"./Status-DyHB_aFS.js";import{u as G}from"./useCrudForm-w4RpfP1I.js";import"./QItem-C5PltTt6.js";import"./QItemLabel-BFoWDjd1.js";import"./QList-BmuLqQY0.js";import"./id-BuNGTsqN.js";import"./format-number-B34ySHL_.js";import"./QSelect-Bl7xxck0.js";import"./QField-CiR_afiF.js";import"./QChip-DVn2Kp_f.js";import"./QMenu-Cw0XRxru.js";import"./selection-DNdgDFiB.js";import"./rtl-DFPa-2ov.js";import"./format-CJebrXOQ.js";import"./lists-store-DQ90zYsz.js";import"./ArrayCrud-CkcA-ixF.js";import"./DropDownAfter-CIQPy_Pb.js";import"./QBtnDropdown-CzsBb9Zc.js";import"./QBtnGroup-BjmvB1FU.js";import"./ClosePopup-XToRKAjk.js";import"./Lists-BiTHs-DU.js";import"./ApiCrud-iWe9qsRt.js";import"./Api-DNggAt6a.js";import"./index-DpzgZQa-.js";import"./index-BpCflRzf.js";import"./api-error-BDflpWxB.js";const J={__name:"StatusForm",props:{data:{type:Object,required:!0}},emits:["successDelete","successSubmit","successUpdate","successCreate"],setup(w,{emit:i}){const n=w,l=i,a=u({...n.data}),r=!n.data?.id,{handleDelete:p,handleCreate:c,handleUpdate:v,loading:f}=G(k,{emit:l,responseKey:"status"}),_=async()=>{const s={santri_id:a.value.santri_id,status:a.value.status,keterangan:a.value.keterangan};return r?await c(s,!0):await v(n.data.id,s,!0)},t=async()=>await p(n.data.id);return(s,e)=>{const C=y("FormHeader"),D=y("FormLoading"),M=y("FormActions");return g(),b(B,{class:"full-width",style:{"max-width":"425px"}},{default:d(()=>[o($,{onSubmit:Q(_,["prevent"])},{default:d(()=>[o(C,{title:"Input Status","is-new":r}),S(f)?(g(),b(D,{key:0})):x("",!0),o(A,null,{default:d(()=>[o(V,{dense:"",outlined:"",label:"Nama","model-value":a.value?.nama+" ("+a.value?.santri_id+")",disable:"",filled:"",class:"q-my-sm"},null,8,["model-value"]),o(L,{modelValue:a.value.status,"onUpdate:modelValue":e[0]||(e[0]=m=>a.value.status=m),url:"status",label:"Status *",class:"q-my-sm",rules:[m=>!!m||"Harus diisi!"]},null,8,["modelValue","rules"]),o(V,{dense:"",class:"q-my-sm",outlined:"",label:"Keterangan",modelValue:a.value.keterangan,"onUpdate:modelValue":e[1]||(e[1]=m=>a.value.keterangan=m),autogrow:""},null,8,["modelValue"])]),_:1}),o(M,{"btn-delete":!r,onOnDelete:t},null,8,["btn-delete"])]),_:1})]),_:1})}}},Ca={__name:"SantriStatus",setup(w){const i=u(!1),n=u(!1),l=u({}),a=u([]),r=u({}),{params:p}=U();async function c(){try{i.value=!0;const t=await k.santri(p.id);a.value=t.status,r.value=t.santri}catch{console.log("error get status")}finally{i.value=!1}}const v=q(()=>a.value.map(t=>({Tanggal:F(t.created_at,"dd-MM-yyyy")+" | "+h(F(t.created_at,"yyyy-MM-dd")),Status:t.status,Keterangan:t.keterangan||"-",id:t.id})));I(async()=>{await c()});const f=()=>{l.value={santri_id:r.value.id,nama:r.value.nama},n.value=!0},_=({id:t})=>{l.value=K(a,t),l.value.santri_id=r.value.id,l.value.nama=r.value.nama,n.value=!0};return(t,s)=>(g(),E("div",null,[o(O,{data:v.value,spinner:i.value,onAdd:f,onEdit:_},null,8,["data","spinner"]),o(N,{modelValue:n.value,"onUpdate:modelValue":s[3]||(s[3]=e=>n.value=e)},{default:d(()=>[o(J,{data:l.value,onSuccessDelete:s[0]||(s[0]=e=>S(H)(a.value,e)),onSuccessCreate:s[1]||(s[1]=e=>a.value.push(e)),onSuccessUpdate:s[2]||(s[2]=e=>S(j)(a.value,e.id,e))},null,8,["data"])]),_:1},8,["modelValue"])]))}};export{Ca as default};
