import{be as w,q as l,az as C,A as n}from"./index-CTu7YwFB.js";import{A as i}from"./ApbAccount-DUyyhMjo.js";import{A as s}from"./ArrayCrud-CByp4EUn.js";const x=w("accounts-store",()=>{const o=l(!1),r=C([]),d=l(""),u=l(""),c=l(""),p=n(()=>r.value.filter(e=>e.hidden==0).map(e=>({group_name:e.group+": "+e.name,...e})).sort((e,t)=>e.group.localeCompare(t.group))),v=n(()=>{const e=r.value.map(t=>t.category).filter(t=>t!==null);return[...new Set(e)]}),g=n(()=>{if(u.value){const e=r.value.filter(t=>t.category===u.value).map(t=>t.group);return[...new Set(e)].sort()}else{const e=r.value.map(t=>t.group);return[...new Set(e)].sort()}}),y=n(()=>r.value.filter(a=>c.value?a.group===c.value:!0).filter(a=>u.value?a.category===u.value:!0));async function m(e,t){try{o.value=!0,r.value=s.update(r.value,t,{hidden:e}),await i.toggleHidden(t)}catch(a){r.value=s.update(r.value,t,{hidden:!e}),console.error("ðŸš€ ~ toggleHidden ~ err:",a)}finally{o.value=!1}}async function A(e=!0){try{o.value=!0;const t=await i.getAll({notifySuccess:e});r.value=t.accounts}catch(t){console.error("ðŸš€ ~ loadData ~ _err:",t)}finally{o.value=!1}}const f=e=>{r.value=s.updateOrCreate(r.value,e,"id","first")},S=e=>{r.value=s.remove(r.value,e)};async function h(e,t=!0){try{o.value=!0;const a=await i.getById({id:e,notifySuccess:t});f(a.account)}catch(a){console.error("ðŸš€ ~ loadData ~ _err:",a)}finally{o.value=!1}}return{loading:o,accounts:r,filteredAccounts:y,filterText:d,filterCategory:u,filterGroup:c,optionsCategory:v,optionsGroup:g,optionsSelect:p,toggleHidden:m,loadAll:A,loadById:h,add:f,remove:S}},{persist:{storage:sessionStorage}});export{x as u};
