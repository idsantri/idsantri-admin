import{Q as k}from"./QSpinnerCube-clsjI4Wm.js";import{v as p,R as j,x as _,f as w,o as f,w as o,i as t,a8 as z,Q as q,r as y,y as U,k as Q,B as C,a3 as r,z as v,q as S}from"./index-BOc7y3E3.js";import{Q as B}from"./QSelect-Br9kkI5Z.js";import{Q as D}from"./QForm-CxO-I-hC.js";import{a as P}from"./api-post-CPwNAYjq.js";import{a as x}from"./api-update-DaN0juSD.js";import{a as I}from"./api-delete-DLV1eJE-.js";import{i as N,f as F}from"./format-date-DlwYCgkJ.js";import{_ as H}from"./InputSelectSantriId-YUp-qAi8.js";import{_ as d}from"./InputSelectArray-GW0fQ7ez.js";import{_ as $}from"./FormHeader-pf3CU3SV.js";const E={key:0},Y={__name:"IzinPesantrenForm",props:{data:Object},emits:["successDelete","successSubmit","successUpdate","successCreate"],setup(c,{emit:g}){const m=c,u=g,e=p({pengajuan:"Baru",tujuan:"Sesuai alamat rumah"}),n=p(!1);async function V(){const s={santri_id:e.value.santri_id,sifat:e.value.sifat,pengajuan:e.value.pengajuan,dari_tgl:e.value.dari_tgl,durasi:e.value.durasi,keperluan:e.value.keperluan,keterangan:e.value.keterangan,tujuan:e.value.tujuan,catatan:e.value.catatan};let l=null;const i=!e.value.id;i?l=await P({endPoint:"izin-pesantren",data:s,loading:n}):l=await x({endPoint:`izin-pesantren/${e.value.id}`,data:s,confirm:!0,notify:!0,loading:n}),l&&(document.getElementById("btn-close-form").click(),u("successSubmit",l?.izin_pesantren),u(i?"successCreate":"successUpdate",l?.izin_pesantren))}const b=async()=>{const s=e.value.id;await I({endPoint:`izin-pesantren/${s}`,loading:n})&&(document.getElementById("btn-close-form").click(),u("successDelete",s))};return j(async()=>{Object.assign(e.value,m.data)}),(s,l)=>{const i=_("FormActions");return f(),w(S,{class:"full-width",style:{"max-width":"425px"}},{default:o(()=>[t(D,{onSubmit:z(V,["prevent"])},{default:o(()=>[t($,{title:"Input Izin Santri","is-new":!e.value.id},null,8,["is-new"]),t(q,{class:"q-pa-sm"},{default:o(()=>[n.value?(f(),y("div",E,[t(C,{modelValue:n.value,"onUpdate:modelValue":l[0]||(l[0]=a=>n.value=a),persistent:""},{default:o(()=>[t(k,{color:"green-12",size:"8em",class:"flex q-ma-lg q-mx-auto"})]),_:1},8,["modelValue"])])):U("",!0),Q("div",null,[t(H,{"active-only":!0,onEmitInput:l[1]||(l[1]=a=>Object.assign(e.value,a)),data:m.data},null,8,["data"]),t(d,{modelValue:e.value.sifat,"onUpdate:modelValue":l[2]||(l[2]=a=>e.value.sifat=a),url:"sifat-izin",label:"Sifat",class:"q-mt-sm",rules:[a=>!!a||"Harus diisi!"]},null,8,["modelValue","rules"]),t(B,{label:"Pengajuan",modelValue:e.value.pengajuan,"onUpdate:modelValue":l[3]||(l[3]=a=>e.value.pengajuan=a),dense:"",outlined:"",class:"q-mt-sm",options:["Baru","Perpanjangan ke-1","Perpanjangan ke-2"],disable:e.value.sifat!="Pulang"},null,8,["modelValue","disable"]),t(r,{dense:"",hint:v(N)(e.value.dari_tgl)?v(F)(e.value.dari_tgl):"",class:"q-mt-sm",outlined:"",label:"Tanggal (M)*",modelValue:e.value.dari_tgl,"onUpdate:modelValue":l[4]||(l[4]=a=>e.value.dari_tgl=a),type:"date",rules:[a=>!!a||"Harus diisi!"],"error-color":"negative"},null,8,["hint","modelValue","rules"]),t(r,{dense:"",hint:"",class:"q-mt-sm",outlined:"",label:"Durasi (hari)*",modelValue:e.value.durasi,"onUpdate:modelValue":l[5]||(l[5]=a=>e.value.durasi=a),rules:[a=>!!a||"Harus diisi!",a=>!a||!isNaN(a)||"Hanya angka"],"error-color":"negative"},null,8,["modelValue","rules"]),t(d,{modelValue:e.value.keperluan,"onUpdate:modelValue":l[6]||(l[6]=a=>e.value.keperluan=a),url:"keperluan-izin",label:"Keperluan *",class:"q-mt-sm",rules:[a=>!!a||"Harus diisi!"]},null,8,["modelValue","rules"]),t(d,{modelValue:e.value.keterangan,"onUpdate:modelValue":l[7]||(l[7]=a=>e.value.keterangan=a),url:"keterangan-izin",label:"Keterangan",class:"q-mt-sm"},null,8,["modelValue"]),t(r,{dense:"",class:"q-mt-sm",outlined:"",label:"Tujuan",modelValue:e.value.tujuan,"onUpdate:modelValue":l[8]||(l[8]=a=>e.value.tujuan=a),autogrow:""},null,8,["modelValue"]),t(r,{dense:"",class:"q-mt-sm",outlined:"",label:"Catatan",modelValue:e.value.catatan,"onUpdate:modelValue":l[9]||(l[9]=a=>e.value.catatan=a),autogrow:""},null,8,["modelValue"])])]),_:1}),t(i,{"btn-delete":!!e.value.id,onOnDelete:b},null,8,["btn-delete"])]),_:1})]),_:1})}}};export{Y as _};
