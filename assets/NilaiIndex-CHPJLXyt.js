import{ad as B,q as x,s as E,E as D,c as g,o as n,w as t,g as e,n as T,v as f,p as K,e as h,Q as k,l as L,a as l,G as Q,b as d,F,D as N,t as o,a4 as H}from"./index-hOL5A6cm.js";import{Q as A}from"./QItemLabel-Cay7Uljr.js";import{Q as V,a as j}from"./QItem-BANBEVbr.js";import{Q as G}from"./QList-psTvccOF.js";import{Q as z}from"./QSpace-B4DiJt71.js";import{Q as I}from"./QSkeleton-CRG1b9Bx.js";import{Q as J,a as u}from"./QTable-fdgK0zKb.js";import{Q as y}from"./QTr-BU_7HvY1.js";import{Q as q}from"./QTd-Yg8ttfxq.js";import{Q as O}from"./QMarkupTable-B-16obXc.js";import{C as U}from"./ClosePopup-B4SXiw2W.js";import{a as P}from"./api-get-CNiX5O7p.js";import{_ as W}from"./FilterKelas-0m5bPWPK.js";import{_ as X}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./QSelect-DH-3drUQ.js";import"./QChip-hOI8Fwk1.js";import"./QMenu-sXy5Axos.js";import"./selection-DaCFfV6A.js";import"./rtl-DFPa-2ov.js";import"./format-CJebrXOQ.js";import"./use-fullscreen-Bf_st-kF.js";import"./index-D-qXO6AO.js";import"./index-uhNqAWVd.js";import"./api-error-rS4-Nvfb.js";import"./QToolbar-CHx5tulD.js";import"./api-get-lists-CMdbdU8-.js";const Y=["innerHTML"],Z={key:0},aa={key:1},ea={key:0},ta={key:1},la={key:2},sa={key:0},ra={key:1},ia={key:0,class:"text-italic text-negative"},na={key:1},oa={class:"text-left"},da={class:"text-left"},ua={class:"text-right"},_a={class:"text-right"},ma={class:"text-right"},ca={class:"text-right"},fa={class:"text-right"},pa={class:"bg-green-2 text-weight-bold text-right text-green-10"},ga={__name:"NilaiIndex",setup(ha){const{params:m}=B(),p=x([{}]),R=x(!1),C=x(""),c=x([{}]),w=x([]),M=[{name:"no_absen",label:"No",align:"center",field:a=>a.no_absen,format:a=>`${a||""}`,sortable:!0},{name:"kelas_id",label:"ID Kelas",align:"center",field:a=>a.kelas_id,format:a=>`${a}`,sortable:!0},{name:"santri_id",label:"ID Santri",align:"center",field:a=>a.santri_id,format:a=>`${a}`,sortable:!0},{name:"nama",label:"Nama",align:"left",field:a=>a.nama,sortable:!0},{name:"rerata_1",label:"Rerata-1",align:"right",field:a=>a.rerata_1?parseFloat(a.rerata_1).toFixed(1):null,sortable:!0},{name:"rerata_2",label:"Rerata-2",align:"right",field:a=>a.rerata_2?parseFloat(a.rerata_2).toFixed(1):null,sortable:!0},{name:"rerata_3",label:"Rerata-3",align:"right",field:a=>a.rerata_3?parseFloat(a.rerata_3).toFixed(1):null,sortable:!0},{name:"rerata_4",label:"Rerata-4",align:"right",field:a=>a.rerata_4?parseFloat(a.rerata_4).toFixed(1):null,sortable:!0},{name:"rerata_akhir",label:"R. Akhir",align:"right",field:a=>a.rerata_akhir?parseFloat(a.rerata_akhir).toFixed(1):null,sortable:!0}];async function S(a){if(a.expand=!a.expand,a.expand){w.value[a.key]=!0,c.value[a.key]=null;const i=await P({endPoint:"nilai-mapel",params:{kelas_id:a.key,category:"rapor"}});w.value[a.key]=!1,c.value[a.key]=i.nilai}}E(async()=>{if(m.th_ajaran_h&&m.tingkat_id&&m.kelas){const a=await P({endPoint:"nilai-mapel/rerata",params:{th_ajaran_h:m.th_ajaran_h,tingkat_id:m.tingkat_id,kelas:m.kelas,category:"rapor"},loading:R});p.value=a.nilai}});function _(a,i){let b=0,v=0;if(a?.length){a.forEach(r=>{r[i]!==null&&(b+=parseFloat(r[i]),v++)});const s=b/v;return isNaN(s)?null:s.toFixed(1)}else return null}return(a,i)=>{const b=D("CardHeader"),v=D("CardPage");return n(),g(v,null,{default:t(()=>[e(b,{title:"Data Nilai Mata Pelajaran","show-reload":!1},{buttons:t(()=>[e(h,{icon:"settings_accessibility",label:"Nilai Ahwal",to:"/madrasah/nilai-ahwal",outline:"",dense:"","no-caps":"",class:"q-px-sm"})]),more:t(()=>[e(G,null,{default:t(()=>[T((n(),g(V,{to:"/madrasah/mapel"},{default:t(()=>[e(j,null,{default:t(()=>[e(A,null,{default:t(()=>[...i[1]||(i[1]=[f(" Mata Pelajaran ",-1)])]),_:1})]),_:1}),e(j,{avatar:""},{default:t(()=>[e(K,{name:"settings"})]),_:1})]),_:1})),[[U]])]),_:1})]),_:1}),e(k,{class:"q-pa-sm"},{default:t(()=>[e(W,{"show-ujian-ke":!1,"start-url":"/madrasah/nilai-mapel/rerata",onDataFilter:i[0]||(i[0]=s=>C.value=s),title:"Filter Data: <span class='text-weight-medium'>Nilai Mapel (Rerata)</span>"})]),_:1}),e(k,{class:"q-pa-sm"},{default:t(()=>[e(L,{class:"",bordered:"",flat:""},{default:t(()=>[e(k,{class:"bg-green-8 text-green-1 text-subtitle1 q-pa-sm flex flex-center"},{default:t(()=>[l("span",{innerHTML:C.value+" ➡️ <em class='text-weight-light'>Kategori: </em> <strong>Nilai Rapor</strong>"||""},null,8,Y),e(z),e(h,{dense:"",icon:"download",label:"Excel","no-caps":"",class:"bg-green-11 text-green-10 q-px-md q-mr-sm",to:"/madrasah/nilai-mapel/download"}),e(h,{dense:"",icon:"upload",label:"Excel","no-caps":"",class:"bg-green-11 text-green-10 q-px-md",to:"/madrasah/nilai-mapel/upload"})]),_:1}),!Q(m).th_ajaran_h||!Q(m).tingkat_id||!Q(m).kelas?(n(),g(k,{key:0,class:"q-pa-sm"},{default:t(()=>[...i[2]||(i[2]=[l("div",{class:"text-center q-pa-lg text-negative text-italic"}," Tentukan Tahun Ajaran, Tingkat Pendidikan, dan Kelas! ",-1)])]),_:1})):(n(),g(k,{key:1,class:"q-pa-sm"},{default:t(()=>[R.value?(n(),d("div",Z,[e(I,{type:"text",height:"4rem"})])):(n(),d("div",aa,[e(J,{flat:"",rows:p.value,columns:M,"row-key":"kelas_id","rows-per-page-options":[10,25,50,100,0],class:"my-sticky-header-table"},{header:t(s=>[e(y,{props:s,class:""},{default:t(()=>[e(u),e(u),e(u),e(u),e(u,{class:"text-left"},{default:t(()=>[...i[3]||(i[3]=[f("Retata Kelas",-1)])]),_:1}),e(u,{class:"text-right"},{default:t(()=>[f(o(_(p.value,"rerata_1")),1)]),_:1}),e(u,{class:"text-right"},{default:t(()=>[f(o(_(p.value,"rerata_2")),1)]),_:1}),e(u,{class:"text-right"},{default:t(()=>[f(o(_(p.value,"rerata_3")),1)]),_:1}),e(u,{class:"text-right"},{default:t(()=>[f(o(_(p.value,"rerata_4")),1)]),_:1}),e(u,{class:"text-right"},{default:t(()=>[f(o(_(p.value,"rerata_akhir")),1)]),_:1})]),_:1},8,["props"]),e(y,{props:s},{default:t(()=>[e(u,{"auto-width":""},{default:t(()=>[...i[4]||(i[4]=[f("!",-1)])]),_:1}),(n(!0),d(F,null,N(s.cols,r=>(n(),g(u,{key:r.name,props:s},{default:t(()=>[f(o(r.label),1)]),_:2},1032,["props"]))),128))]),_:2},1032,["props"])]),body:t(s=>[e(y,{props:s},{default:t(()=>[e(q,{"auto-width":""},{default:t(()=>[e(h,{size:"sm",color:"green",round:"",dense:"",onClick:r=>S(s),icon:s.expand?"remove":"add"},null,8,["onClick","icon"])]),_:2},1024),(n(!0),d(F,null,N(s.cols,r=>(n(),g(q,{key:r.name,props:s},{default:t(()=>[r.name=="kelas_id"?(n(),d("span",ea,[e(h,{label:r.value,dense:"",outline:"",class:"q-px-md text-green-10",to:`/madrasah/kelas/${r.value}/nilai-mapel`},null,8,["label","to"])])):r.name=="santri_id"?(n(),d("span",ta,[e(h,{label:r.value,dense:"",outline:"",class:"q-px-md text-green-10",to:`/santri/${r.value}`},null,8,["label","to"])])):(n(),d("span",la,o(r.value),1))]),_:2},1032,["props"]))),128))]),_:2},1032,["props"]),T(e(y,{props:s},{default:t(()=>[e(q,{colspan:"100%"},{default:t(()=>[w.value[s.row.kelas_id]?(n(),d("div",sa,[e(I,{height:"100px"})])):(n(),d("div",ra,[c.value[s.row.kelas_id]?.length==0?(n(),d("div",ia," Tidak ada data untuk ditampilkan! ")):(n(),d("div",na,[e(O,{flat:"",dense:"",class:"bg-green-1",separator:"cell"},{default:t(()=>[i[6]||(i[6]=l("thead",{class:"bg-green-2 text-weight-medium text-right"},[l("tr",null,[l("td",{class:"text-left",style:{width:"80px"}},"ID (Kode)"),l("td",{class:"text-left"},"Mata Pelajaran"),l("td",{style:{width:"50px"}},"N-1"),l("td",{style:{width:"50px"}},"N-2"),l("td",{style:{width:"50px"}},"N-3"),l("td",{style:{width:"50px"}},"N-4"),l("td",{style:{width:"65px"}},"Rerata")])],-1)),l("tbody",null,[(n(!0),d(F,null,N(c.value[s.row.kelas_id],(r,$)=>(n(),d("tr",{key:$},[l("td",oa,o(r.id),1),l("td",da,o(r.name),1),l("td",ua,o(r.nilai_1),1),l("td",_a,o(r.nilai_2),1),l("td",ma,o(r.nilai_3),1),l("td",ca,o(r.nilai_4),1),l("td",fa,o(r.rerata?parseFloat(r.rerata).toFixed(1):null),1)]))),128))]),l("tfoot",pa,[l("tr",null,[i[5]||(i[5]=l("td",{colspan:"2",class:"text-left"},"Rerata",-1)),l("td",null,o(_(c.value[s.row.kelas_id],"nilai_1")),1),l("td",null,o(_(c.value[s.row.kelas_id],"nilai_2")),1),l("td",null,o(_(c.value[s.row.kelas_id],"nilai_3")),1),l("td",null,o(_(c.value[s.row.kelas_id],"nilai_4")),1),l("td",null,o(_(c.value[s.row.kelas_id],"rerata")),1)])])]),_:2},1024)]))]))]),_:2},1024)]),_:2},1032,["props"]),[[H,s.expand]])]),_:1},8,["rows"])]))]),_:1}))]),_:1})]),_:1})]),_:1})}}},Va=X(ga,[["__scopeId","data-v-9ba3271a"]]);export{Va as default};
