import{A as m,B as g,c as b,o as D,w as u,b as s,ad as x,e as B,C as w,Q as M,a7 as C,y as Q,ab as h,q as I,W as U,f as $,G as q}from"./index-Bjf6jOrL.js";import{_ as N}from"./TemplateArray-NzDrgwGn.js";import{c as V}from"./format-date-DlwYCgkJ.js";import{a as O}from"./hijri--5qD4USW.js";import{r as j,d as E,g as H}from"./array-object-BytDdNh7.js";import{Q as K}from"./QForm-CQ61mLzh.js";import{_ as G}from"./InputSelectArray-DTVIQacW.js";import{A as L}from"./ApiCrud-Cz799mD5.js";import{u as P}from"./useCrudForm-D9Qtfi7L.js";import"./QItemSection-D4HO8eJd.js";import"./QItemLabel-Clz1Xits.js";import"./QList-DrJ2aexG.js";import"./id-BuNGTsqN.js";import"./format-number-B34ySHL_.js";import"./QSelect-BCDk0qVl.js";import"./QChip-CKBUwVMq.js";import"./QMenu-DO2tkYnP.js";import"./selection-C-yT_gHt.js";import"./rtl-DFPa-2ov.js";import"./format-CJebrXOQ.js";import"./lists-store-Ddm_j1AX.js";import"./DropDownAfter-BWotgQpI.js";import"./QBtnDropdown-CATaFFO-.js";import"./QBtnGroup-BZf-O_co.js";import"./ClosePopup-Ced6Y-Os.js";import"./Lists-DcfSSLIw.js";import"./Api-v4AqqFFf.js";import"./index-BRCx2Z00.js";import"./index-DV84x6RN.js";import"./api-error-C_UMNjEa.js";class R extends L{constructor(){super("domisili")}async santri(l){return(await this._apiGet({endPoint:`${this._path}/santri/${l}`})).data}}const F=new R,T={__name:"DomisiliForm",props:{data:{type:Object,required:!0}},emits:["successDelete","successSubmit","successUpdate","successCreate"],setup(p,{emit:l}){const o=p,r=l,e=m({...o.data}),n=!o.data?.id,{handleDelete:c,handleCreate:v,handleUpdate:f,loading:_}=P(F,{emit:r,responseKey:"domisili"}),y=async()=>{const i={santri_id:e.value.santri_id,domisili:e.value.domisili,keterangan:e.value.keterangan};return n?await v(i,!0):await f(o.data.id,i,!0)},a=async()=>await c(o.data.id);return(i,t)=>{const k=g("FormHeader"),S=g("FormLoading"),A=g("FormActions");return D(),b(Q,{class:"full-width",style:{"max-width":"425px"}},{default:u(()=>[s(K,{onSubmit:x(y,["prevent"])},{default:u(()=>[s(k,{title:"Input Domisili","is-new":n}),w(_)?(D(),b(S,{key:0})):B("",!0),s(M,null,{default:u(()=>[s(C,{class:"q-my-sm",dense:"",outlined:"",label:"Nama","model-value":e.value?.nama+" ("+e.value?.santri_id+")",disable:"",filled:""},null,8,["model-value"]),s(G,{class:"q-my-sm",modelValue:e.value.domisili,"onUpdate:modelValue":t[0]||(t[0]=d=>e.value.domisili=d),url:"domisili",label:"Domisili *",rules:[d=>!!d||"Harus diisi!"]},null,8,["modelValue","rules"]),s(C,{class:"q-my-sm",dense:"",outlined:"",label:"Keterangan",modelValue:e.value.keterangan,"onUpdate:modelValue":t[1]||(t[1]=d=>e.value.keterangan=d),autogrow:""},null,8,["modelValue"])]),_:1}),s(A,{"btn-delete":!n,onOnDelete:a},null,8,["btn-delete"])]),_:1})]),_:1})}}},Fe={__name:"SantriDomisili",setup(p){const l=m(!1),o=m(!1),r=m({}),e=m([]),n=m({}),{params:c}=h();async function v(){try{l.value=!0;const a=await F.santri(c.id);e.value=a.domisili,n.value=a.santri}catch{console.log("error get domisili")}finally{l.value=!1}}const f=I(()=>e.value.map(a=>({Tanggal:V(a.created_at,"dd-MM-yyyy")+" | "+O(V(a.created_at,"yyyy-MM-dd")),Domisili:a.domisili,Keterangan:a.keterangan||"-",id:a.id})));U(async()=>{await v()});const _=()=>{r.value={santri_id:n.value.id,nama:n.value.nama},o.value=!0},y=({id:a})=>{r.value=H(e,a),r.value.santri_id=n.value.id,r.value.nama=n.value.nama,o.value=!0};return(a,i)=>(D(),$("div",null,[s(N,{data:f.value,spinner:l.value,onAdd:_,onEdit:y},null,8,["data","spinner"]),s(q,{modelValue:o.value,"onUpdate:modelValue":i[3]||(i[3]=t=>o.value=t)},{default:u(()=>[s(T,{data:r.value,title:"Input Domisili",onSuccessDelete:i[0]||(i[0]=t=>w(E)(e.value,t)),onSuccessCreate:i[1]||(i[1]=t=>e.value.push(t)),onSuccessUpdate:i[2]||(i[2]=t=>w(j)(e.value,t.id,t))},null,8,["data"])]),_:1},8,["modelValue"])]))}};export{Fe as default};
