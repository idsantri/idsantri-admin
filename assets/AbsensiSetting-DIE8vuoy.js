import{Q as H}from"./QSelect-Br9kkI5Z.js";import{v as u,R as T,r as d,o as r,i as a,w as l,Q as g,q as w,j as _,t as $,F as I,s as F,a8 as Q,k as y,a3 as m,p as v}from"./index-BOc7y3E3.js";import{Q as D}from"./QSpinnerCube-clsjI4Wm.js";import{Q as x,a as f}from"./QItemSection-U4VUPMG0.js";import{Q as S}from"./QBtnGroup-CNPGzkQV.js";import{Q as U}from"./QForm-CxO-I-hC.js";import{a as G}from"./api-delete-DLV1eJE-.js";import{a as q}from"./api-get-DUTCLQ7F.js";import{a as K}from"./api-post-CPwNAYjq.js";import{a as M}from"./api-update-DaN0juSD.js";import"./QChip-DferuxmN.js";import"./QItemLabel-CrvmL7Ku.js";import"./QMenu-iXJrGXAP.js";import"./selection-CUoFkLvB.js";import"./rtl-DFPa-2ov.js";import"./format-CJebrXOQ.js";import"./index-CHOBZr16.js";import"./index-CdkvXyXH.js";import"./api-error-CtGrtfSx.js";const R={class:"",style:{"max-width":"600px"}},z={key:0},A={key:0,class:"q-pa-md"},E={key:1},L={class:"row"},J={class:"row"},O={key:1,class:"q-my-md text-center"},fe={__name:"AbsensiSetting",setup(W){const o=u(""),j=u([]),b=u([{}]),V=u([{}]),k=u(!1),p=u(!1),i=u({});async function h(){if(i.value.tingkat_id=o.value.val0,await K({endPoint:"absensi/settings",data:i.value}))return i.value={},c(o.value.val0)}async function P(n){if(await G({endPoint:`absensi/settings/${n}`,loading:p}))return c(o.value.val0)}async function B(n){await M({endPoint:`absensi/settings/${n.id}`,data:{bulan:n.bulan,ujian:n.ujian,tingkat_id:n.tingkat_id},loading:p,confirm:!1}),await c(n.tingkat_id)}async function N(){const n=await q({endPoint:"lists/tingkat-pendidikan",loading:k});j.value=n.tingkat_pendidikan}async function C(){const n=await q({endPoint:"lists/bulan-hijri",loading:k});b.value=n.bulan_hijri}async function c(n){const s=await q({endPoint:`absensi/settings?tingkat_id=${n}`,loading:p});V.value=s.bulan_ujian}return T(async()=>{await N(),await C()}),(n,s)=>(r(),d("div",R,[a(w,null,{default:l(()=>[a(g,{class:"q-pa-sm"},{default:l(()=>[a(H,{dense:"",outlined:"",label:"Pilih Tingkat Pendidikan",modelValue:o.value,"onUpdate:modelValue":[s[0]||(s[0]=e=>o.value=e),s[1]||(s[1]=e=>c(e.val0))],options:j.value,"emit-value":"","map-options":"","option-label":"val1",loading:k.value,behavior:"menu"},null,8,["modelValue","options","loading"])]),_:1})]),_:1}),a(w,{class:"q-mt-sm"},{default:l(()=>[a(g,{class:"bg-green-8 text-green-1 text-subtitle1 q-pa-sm"},{default:l(()=>[_(" Tingkat Pendidikan: "+$(o.value.val1),1)]),_:1}),a(g,{class:"q-pa-sm"},{default:l(()=>[o.value?(r(),d("div",z,[p.value?(r(),d("div",A,[a(D,{color:"green-12",size:"8em",class:"flex q-mx-auto"})])):(r(),d("div",E,[(r(!0),d(I,null,F(V.value,e=>(r(),d("div",{key:e.id},[a(U,{onSubmit:Q(t=>B(e),["prevent"])},{default:l(()=>[a(x,{class:"no-padding"},{default:l(()=>[a(f,null,{default:l(()=>[y("div",L,[a(m,{label:"Ujian Ke-?",class:"col-3 q-pr-sm",dense:"",outlined:"",modelValue:e.ujian,"onUpdate:modelValue":t=>e.ujian=t,required:"",mask:"#",rules:[t=>!!t||"Harus diisi!",t=>t>=1&&t<=3||"1, 2, atau 3!"]},null,8,["modelValue","onUpdate:modelValue","rules"]),a(m,{label:"Bulan",class:"col-3 q-pr-sm",dense:"",outlined:"",modelValue:e.bulan,"onUpdate:modelValue":t=>e.bulan=t,required:"",mask:"##",rules:[t=>!!t||"Harus diisi!",t=>t>=1&&t<=12||"1 hingga 12!"]},null,8,["modelValue","onUpdate:modelValue","rules"]),a(m,{class:"col-6",dense:"",outlined:"","model-value":b.value.find(t=>Number(t.val2)==Number(e.bulan))?.val1||"",readonly:""},null,8,["model-value"])])]),_:2},1024),a(f,{side:"",class:"no-padding q-ml-sm"},{default:l(()=>[a(S,{push:"",class:"q-mb-lg"},{default:l(()=>[a(v,{color:"positive",glossy:"",icon:"save",type:"submit"}),a(v,{color:"negative",glossy:"",icon:"delete",onClick:t=>P(e.id)},null,8,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1032,["onSubmit"])]))),128)),a(U,{onSubmit:Q(h,["prevent"]),onReset:s[4]||(s[4]=e=>i.value={})},{default:l(()=>[a(x,{class:"no-padding",style:{"justify-content":"start"}},{default:l(()=>[a(f,null,{default:l(()=>[y("div",J,[a(m,{label:"Ujian Ke-?",class:"col-3 q-pr-sm",dense:"",outlined:"",modelValue:i.value.ujian,"onUpdate:modelValue":s[2]||(s[2]=e=>i.value.ujian=e),required:"",mask:"#",rules:[e=>!!e||"Harus diisi!",e=>e>=1&&e<=3||"1, 2, atau 3!"]},null,8,["modelValue","rules"]),a(m,{label:"Bulan",class:"col-3 q-pr-sm",dense:"",outlined:"",modelValue:i.value.bulan,"onUpdate:modelValue":s[3]||(s[3]=e=>i.value.bulan=e),required:"",mask:"##",rules:[e=>!!e||"Harus diisi!",e=>e>=1&&e<=12||"1 hingga 12!"]},null,8,["modelValue","rules"]),a(m,{class:"col-6",dense:"",outlined:"",readonly:"","model-value":b.value.find(e=>Number(e.val2)==Number(i.value.bulan))?.val1||""},null,8,["model-value"])])]),_:1}),a(f,{side:"",class:"no-padding q-ml-sm"},{default:l(()=>[a(S,{push:"",class:"q-mb-lg"},{default:l(()=>[a(v,{color:"positive",glossy:"",icon:"save",type:"submit"}),a(v,{color:"negative",glossy:"",icon:"undo",type:"reset"})]),_:1})]),_:1})]),_:1})]),_:1})]))])):(r(),d("div",O," Silakan pilih list tingkat pendidikan! "))]),_:1}),a(g,{class:"bg-green-7 text-green-1 text-caption text-italic q-pa-sm"},{default:l(()=>[...s[5]||(s[5]=[_(" Ujian (1, 2) jika menganut sistem semester atau kuartal (mid semester) ",-1),y("br",null,null,-1),_(" Ujian (1, 2, 3) jika menganut sistem catur wulan ",-1)])]),_:1})]),_:1})]))}};export{fe as default};
