import{Q as z}from"./QSpinnerCube-BbU3LkI7.js";import{v as k,R as x,f as U,o as V,w as d,i as s,x as B,a8 as D,Q as $,r as C,y as I,k as j,B as H,a4 as r,z as o,q as N}from"./index-Cju_WcQt.js";import{Q as E}from"./QRating-DK0wJ0L9.js";import{Q as q}from"./QSelect-D99lhOsm.js";import{Q as F}from"./QForm-B-IeWzDf.js";import{b as _,m as y}from"./hijri-BBdEhqDI.js";import{i as S,f as w}from"./format-date-DlwYCgkJ.js";import{a as O}from"./api-post-P8g4q4LG.js";import{a as P}from"./api-update-Dm-9pXju.js";import{a as R}from"./api-delete-BEmNpbPy.js";import{_ as T}from"./FormHeader-BlagXmst.js";import{_ as K}from"./InputSelectSantriId-BlpghIQA.js";import{g as A}from"./api-get-lists-BfH1ZDRf.js";import{l as L}from"./lists-store-Bv-Q7-f0.js";import{_ as M}from"./DropDownAfter-UGjzP48R.js";import{_ as h}from"./InputSelectArray-G7sFmwYz.js";const f="tatib-santri",G={__name:"InputSelectTatibSantri",props:{selected:{type:String}},setup(b){const p=b;function c(){let t="";return p.selected&&(t=u(p.selected)),t}function u(t){let a="";const i=/\[(.*?)\]/g,l=t.match(i);return l&&(a=l.map(Q=>Q.slice(1,-1)).join(", ")),a}const e=k(!1),n=k([]),m=L();function v(t){let a=[];return t.length&&(a=t.filter(i=>i.val0.length!=1).map(i=>`[${i.val0}] ${i.val1}`)),a}x(async()=>{const t=m.getByStateName(f);if(t.length)n.value=v(t);else{await g();const a=m.getByStateName(f);n.value=v(a)}});async function g(){const t=await A({key:f,loading:e,sort:"asc"});m.$patch({[f]:t})}return(t,a)=>(V(),U(q,{dense:"",outlined:"",label:"Pasal dilanggar","emit-value":"","map-options":"",options:n.value,loading:e.value,behavior:"menu",clearable:"",multiple:"",hint:c()},{after:d(()=>[s(M,{"route-to":"tatib-santri",onReload:g})]),_:1},8,["options","loading","hint"]))}},J={key:0},pe={__name:"IndisiplinerForm",props:{data:Object},emits:["successDelete","successSubmit","successUpdate","successCreate"],setup(b,{emit:p}){const c=b,u=p,e=k({kategori:3}),n=k(!1);async function m(){const t={santri_id:e.value.santri_id,tgl_kasus:e.value.tgl_kasus,tgl_sidang:e.value.tgl_sidang,kategori:e.value.kategori,pasal:e.value.pasal?.join("; "),deskripsi:e.value.deskripsi,eksekutor:e.value.eksekutor,saksi:e.value.saksi,takzir:e.value.takzir?.join("; "),keterangan:e.value.keterangan};let a=null;const i=!e.value.id;i?a=await O({endPoint:"indisipliner",data:t,loading:n}):a=await P({endPoint:`indisipliner/${e.value.id}`,data:t,confirm:!0,notify:!0,loading:n}),a&&(document.getElementById("btn-close-form").click(),u("successSubmit",a?.indisipliner),u(i?"successCreate":"successUpdate",a?.indisipliner))}const v=async()=>{const t=e.value.id;await R({endPoint:`indisipliner/${t}`,loading:n})&&(document.getElementById("btn-close-form").click(),u("successDelete",t))};x(async()=>{Object.assign(e.value,c.data),e.value.pasal&&(e.value.pasal=e.value.pasal.split(",")),e.value.takzir&&(e.value.takzir=e.value.takzir.split(","))});const g=[{value:1,label:"Sangat Ringan"},{value:2,label:"Ringan"},{value:3,label:"Sedang"},{value:4,label:"Berat"},{value:5,label:"Sangat Berat"}];return(t,a)=>{const i=B("FormActions");return V(),U(N,{class:"full-width",style:{"max-width":"425px"}},{default:d(()=>[s(F,{onSubmit:D(m,["prevent"])},{default:d(()=>[s(T,{title:"Input Santri Indisipliner","is-new":!e.value.id},null,8,["is-new"]),s($,{class:"q-pa-sm"},{default:d(()=>[n.value?(V(),C("div",J,[s(H,{modelValue:n.value,"onUpdate:modelValue":a[0]||(a[0]=l=>n.value=l),persistent:""},{default:d(()=>[s(z,{color:"green-12",size:"8em",class:"flex q-ma-lg q-mx-auto"})]),_:1},8,["modelValue"])])):I("",!0),j("div",null,[s(K,{"active-only":!0,onEmitInput:a[1]||(a[1]=l=>Object.assign(e.value,l)),data:c.data},null,8,["data"]),s(r,{dense:"",hint:o(S)(e.value.tgl_kasus)?o(w)(e.value.tgl_kasus)+" | "+o(_)(o(y)(e.value.tgl_kasus)):"",class:"q-mt-sm",outlined:"",label:"Tanggal Kasus*",modelValue:e.value.tgl_kasus,"onUpdate:modelValue":a[2]||(a[2]=l=>e.value.tgl_kasus=l),type:"date",rules:[l=>!!l||"Harus diisi!"],"error-color":"negative"},null,8,["hint","modelValue","rules"]),s(r,{dense:"",hint:o(S)(e.value.tgl_sidang)?o(w)(e.value.tgl_sidang)+" | "+o(_)(o(y)(e.value.tgl_sidang)):"",class:"q-mt-sm",outlined:"",label:"Tanggal Sidang*",modelValue:e.value.tgl_sidang,"onUpdate:modelValue":a[3]||(a[3]=l=>e.value.tgl_sidang=l),type:"date",rules:[l=>!!l||"Harus diisi!"],"error-color":"negative"},null,8,["hint","modelValue","rules"]),s(q,{dense:"",modelValue:e.value.kategori,"onUpdate:modelValue":a[5]||(a[5]=l=>e.value.kategori=l),class:"q-mt-sm",outlined:"",label:"Kategori*",options:g,"emit-value":"","map-options":"",rules:[l=>!!l||"Harus diisi!"],"error-color":"negative",behavior:"menu"},{after:d(()=>[s(E,{class:"",name:"kategori",modelValue:e.value.kategori,"onUpdate:modelValue":a[4]||(a[4]=l=>e.value.kategori=l),max:"5",color:"red",icon:"thumb_down","icon-selected":"thumb_down",size:"1em"},null,8,["modelValue"])]),_:1},8,["modelValue","rules"]),s(G,{class:"q-mt-sm",modelValue:e.value.pasal,"onUpdate:modelValue":a[6]||(a[6]=l=>e.value.pasal=l),rules:[l=>!!l||"Harus diisi!"],selected:e.value.pasal?e.value.pasal.join("; "):""},null,8,["modelValue","rules","selected"]),s(r,{dense:"",class:"q-mt-sm",outlined:"",label:"Deskripsi",modelValue:e.value.deskripsi,"onUpdate:modelValue":a[7]||(a[7]=l=>e.value.deskripsi=l),autogrow:""},null,8,["modelValue"]),s(r,{dense:"",class:"q-mt-sm",outlined:"",label:"Eksekutor",modelValue:e.value.eksekutor,"onUpdate:modelValue":a[8]||(a[8]=l=>e.value.eksekutor=l),rules:[l=>!!l||"Harus diisi!"],"error-color":"negative"},null,8,["modelValue","rules"]),s(r,{dense:"",class:"q-mt-sm",outlined:"",label:"Saksi",modelValue:e.value.saksi,"onUpdate:modelValue":a[9]||(a[9]=l=>e.value.saksi=l)},null,8,["modelValue"]),s(h,{modelValue:e.value.takzir,"onUpdate:modelValue":a[10]||(a[10]=l=>e.value.takzir=l),url:"takzir-santri",label:"Takzir",class:"q-mt-sm",multiple:""},null,8,["modelValue"]),s(r,{dense:"",class:"q-mt-sm",outlined:"",label:"Keterangan",modelValue:e.value.keterangan,"onUpdate:modelValue":a[11]||(a[11]=l=>e.value.keterangan=l),autogrow:""},null,8,["modelValue"])])]),_:1}),s(i,{"btn-delete":!!e.value.id,onOnDelete:v},null,8,["btn-delete"])]),_:1})]),_:1})}}};export{pe as _};
