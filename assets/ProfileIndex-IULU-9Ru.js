import{Q as U}from"./QSpace-CR7bsMEl.js";import{v as i,R as $,f as z,o as u,w as t,i as e,q as _,Q as g,k as l,r as d,y as V,p as m,j as w,t as v,F as E,s as F,a9 as L,z as M,B as C,a8 as G,a4 as y,m as R,n as O}from"./index-1h6WQa8x.js";import{Q as P}from"./QSpinnerCube-CdFtSnRz.js";import{Q as H}from"./QImg-_Bkf3zut.js";import{Q as p}from"./QItemLabel-BCrbjFPh.js";import{Q as S,a as I}from"./QItemSection-CDMonx4a.js";import{Q as J}from"./QList-DG4NG05A.js";import{Q as K}from"./QForm-Dcqp4yj8.js";import{Q as W}from"./QPage-B_WVg178.js";import{C as X}from"./ClosePopup-DlITPM1C.js";import{a as h}from"./api-get-BY6mtHh6.js";import{a as Y}from"./api-update-Damf_6Ly.js";import{t as Z}from"./format-text-BhuG3ucy.js";import{b as ee}from"./index-_Ec9HkD1.js";import{_ as ae}from"./ImageUploader-DDr2ClXA.js";import"./index-CpzetzrR.js";import"./api-error-B2Y93K9w.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const le={class:"flex items-center"},te={key:0},se={key:1},oe={class:"absolute-top-right q-ma-sm"},ne={style:{"max-width":"150px"},class:"q-mx-auto"},re={key:0},ie={class:"float-right"},ue={class:"fit row wrap justify-start items-start content-start"},de={key:0},Ie={__name:"ProfileIndex",setup(me){const s=i({}),q=i(!1),B=i(!1),b=i(!1),f=i(!1),n=i({}),c=i(!1),N=r=>c.value=r;async function A(){c.value=!1,await x()}async function Q(){const r=await h({endPoint:"user",loading:q});s.value=r.user}async function x(){const r=await h({endPoint:`images/users/${s.value.id}`,loading:B});s.value.image=r.image_url||"/user-default.png"}$(async()=>{await Q(),await x()});async function T(){await Y({endPoint:"user",data:{username:n.value.username,name:n.value.name,phone:n.value.phone},confirm:!0,notify:!0,loading:f})&&(document.getElementById("btn-close").click(),await Q(),await x())}function j(){Object.assign(n.value,s.value),b.value=!0}const D=async()=>{await ee("Untuk mengganti password, silakan <strong>logout (keluar)</strong>. Pada halaman login, klik <strong>lupa password</strong>.<br/>Ikuti petunjuk yang diberikan.",0)};return(r,a)=>(u(),z(W,{class:"q-pa-sm"},{default:t(()=>[e(_,{class:"",style:{"max-width":"600px"}},{default:t(()=>[e(g,{class:"bg-green-7 text-green-11 q-pa-sm"},{default:t(()=>[l("div",le,[a[6]||(a[6]=l("div",{class:"text-subtitle2"},"Profil Pengguna",-1)),e(U)])]),_:1}),e(g,{class:"q-pa-sm"},{default:t(()=>[q.value?(u(),d("div",te,[e(P,{color:"green-12",size:"8em",class:"flex q-ma-lg q-mx-auto"})])):(u(),d("div",se,[l("div",null,[l("div",oe,[e(m,{icon:"camera",round:"","no-caps":"",dense:"",glossy:"",class:"q-ma-xs q-px-sm",onClick:a[0]||(a[0]=o=>c.value=!0)})]),l("div",ne,[e(H,{src:s.value.image,ratio:1,alt:"user","img-style":{borderRadius:"50%",border:"3px",borderColor:"green",borderStyle:"solid"}},null,8,["src"])])]),s.value.confirmed_at?V("",!0):(u(),d("div",re,[...a[7]||(a[7]=[l("div",{class:"text-center q-my-lg"},[l("div",{class:"q-pa-md text-negative bg-red-1",style:{"border-radius":"10px"}},[l("div",null,"Akun Anda belum terkonfirmasi."),l("div",null,"Silakan hubungi Admin!")])],-1)])])),e(J,{bordered:"",separator:"",class:"q-mt-sm"},{default:t(()=>[e(S,{class:"q-pa-sm"},{default:t(()=>[e(I,null,{default:t(()=>[e(p,{overline:""},{default:t(()=>[...a[8]||(a[8]=[w("User",-1)])]),_:1}),e(p,null,{default:t(()=>[l("table",null,[l("tbody",null,[l("tr",null,[a[9]||(a[9]=l("td",{class:"text-italic text-caption"}," Nama ",-1)),l("td",null,v(s.value.name),1)]),l("tr",null,[a[10]||(a[10]=l("td",{class:"text-italic text-caption"}," Email ",-1)),l("td",null,v(s.value.email),1)]),l("tr",null,[a[11]||(a[11]=l("td",{class:"text-italic text-caption"}," Username ",-1)),l("td",null,v(s.value.username),1)]),l("tr",null,[a[12]||(a[12]=l("td",{class:"text-italic text-caption"}," Telepon ",-1)),l("td",null,v(s.value.phone||"-"),1)])])])]),_:1}),e(p,{class:"bg-green-1"},{default:t(()=>[l("div",ie,[e(m,{label:"User",icon:"edit","no-caps":"",dense:"",class:"q-my-xs q-mx-sm q-px-sm",onClick:j}),e(m,{label:"Password",icon:"edit","no-caps":"",dense:"",class:"q-my-xs q-mx-sm q-px-sm",onClick:D})])]),_:1})]),_:1})]),_:1}),e(S,{class:"q-pa-sm"},{default:t(()=>[e(I,null,{default:t(()=>[e(p,{overline:""},{default:t(()=>[...a[13]||(a[13]=[w("User Group",-1)])]),_:1}),e(p,null,{default:t(()=>[l("div",ue,[(u(!0),d(E,null,F(s.value.roles,(o,k)=>(u(),d("div",{key:k,class:"col-6"},[e(L,{"model-value":o,color:"green",label:M(Z)(k),disable:""},null,8,["model-value","label"])]))),128))])]),_:1})]),_:1})]),_:1})]),_:1})]))]),_:1})]),_:1}),e(C,{modelValue:b.value,"onUpdate:modelValue":a[5]||(a[5]=o=>b.value=o)},{default:t(()=>[e(_,{class:"full-width",style:{"max-width":"425px"}},{default:t(()=>[e(K,{onSubmit:G(T,["prevent"])},{default:t(()=>[e(g,{class:"bg-green-7 text-green-11 q-pa-sm"},{default:t(()=>[...a[14]||(a[14]=[w(" Update Username ",-1)])]),_:1}),e(g,null,{default:t(()=>[f.value?(u(),d("div",de,[e(C,{modelValue:f.value,"onUpdate:modelValue":a[1]||(a[1]=o=>f.value=o),persistent:""},{default:t(()=>[e(P,{color:"green-12",size:"8em",class:"flex q-ma-lg q-mx-auto"})]),_:1},8,["modelValue"])])):V("",!0),e(y,{dense:"",outlined:"",label:"Nama",modelValue:n.value.name,"onUpdate:modelValue":a[2]||(a[2]=o=>n.value.name=o),hint:""},null,8,["modelValue"]),e(y,{class:"q-mt-sm",dense:"",outlined:"",label:"Username",modelValue:n.value.username,"onUpdate:modelValue":a[3]||(a[3]=o=>n.value.username=o),hint:"Anda bisa login dengan username atau email"},null,8,["modelValue"]),e(y,{class:"q-mt-sm",dense:"",outlined:"",label:"Nomor Telepon",modelValue:n.value.phone,"onUpdate:modelValue":a[4]||(a[4]=o=>n.value.phone=o),hint:"08123456789"},null,8,["modelValue"])]),_:1}),e(R,{class:"flex bg-green-6"},{default:t(()=>[e(U),O(e(m,{label:"Tutup",class:"bg-green-11","no-caps":"",id:"btn-close"},null,512),[[X]]),e(m,{type:"submit",label:"Simpan",class:"bg-green-10 text-green-11","no-caps":""})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(ae,{"show-uploader":c.value,url:`/images/users/${s.value.id}`,width:300,height:300,"img-format":"webp",onUpdateUploader:N,onSuccessUpload:A},null,8,["show-uploader","url"])]),_:1}))}};export{Ie as default};
