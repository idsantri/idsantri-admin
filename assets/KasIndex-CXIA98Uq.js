import{Q as A}from"./QToolbarTitle-Bi7GnpK1.js";import{A as i,W as F,K as O,B as x,c as D,o as G,w as t,b as a,ad as M,e as J,C as V,Q as w,a7 as k,y as $,a as B,v as r,g as C,t as g,a3 as L,G as N}from"./index-0PBDf7I0.js";import{Q as P}from"./QToolbar-CIornAnt.js";import{Q as m}from"./QTd-DvkorYHR.js";import{Q as H}from"./QTr-Bh2iSNP6.js";import{Q as R}from"./QTable-CnpmsB23.js";import{Q as W}from"./QPage-B2JjDCGV.js";import{a as z}from"./api-get-CJU_3mwN.js";import{d as S}from"./format-number-B34ySHL_.js";import{Q as E}from"./QSelect-Cpr8vW2V.js";import{Q as X}from"./QForm-ieTYlGnS.js";import{_ as Y}from"./InputCurrency-BAH_-sXF.js";import{u as Z}from"./useCrudForm-C4qLnD9W.js";import{A as h}from"./ApiCrud-CgUuq5zB.js";import{U as ee}from"./UgtGt-C6bDR6Kl.js";import{_ as ae}from"./ReportViewer-DaVvWWjD.js";import"./QList-BR1VLd4M.js";import"./QMarkupTable-s8nx6cOi.js";import"./use-fullscreen-u92Ep5d8.js";import"./index-BXLuJznK.js";import"./index-BDNa_dSq.js";import"./api-error-C1WPqECD.js";import"./QChip-DG5_EyRB.js";import"./QItemSection-DpSW8XO7.js";import"./QItemLabel-DR97WW3U.js";import"./QMenu-3oalsLjd.js";import"./selection-DeDWR_N3.js";import"./rtl-DFPa-2ov.js";import"./format-CJebrXOQ.js";import"./Api--YdEMrhi.js";class le extends h{constructor(){super("ugt/kas")}}const te=new le,ne={__name:"UgtKasForm",props:{data:Object},emits:["successDelete","successSubmit","successUpdate","successCreate"],setup(Q,{emit:y}){const f=Q,b=y,n=i({keperluan:"Biaya Administrasi GT",keterangan:"Lunas",flag:"+"}),p=i(!1),d=i({}),c=!f.data?.id,{handleDelete:U,handleCreate:v,handleUpdate:q,loading:_}=Z(te,{emit:b,responseKey:"kas"});F(async()=>{Object.assign(n.value,f.data)});const K=async()=>{const e=JSON.parse(JSON.stringify(n.value));return delete e.id,c?await v(e,!0):await q(f.data.id,e,!0)},s=async()=>await U(f.data.id);async function o(e){try{p.value=!0;const l=await ee.getById({id:e,notifySuccess:!1});d.value=l.gt}catch{d.value.nama="Data tidak ditemukan",d.value.pjgt_nama="Data tidak ditemukan"}finally{p.value=!1}}return O(()=>n.value.gt_id,async(e,l)=>{d.value.nama="",d.value.pjgt_nama="",e!=l&&await o(e)},{immediate:!0}),(e,l)=>{const T=x("FormHeader"),I=x("FormLoading"),j=x("FormActions");return G(),D($,{class:"full-width",style:{"max-width":"425px"}},{default:t(()=>[a(X,{onSubmit:M(K,["prevent"])},{default:t(()=>[a(T,{title:"Input Kas UGT","is-new":c}),V(_)?(G(),D(I,{key:0})):J("",!0),a(w,{class:"q-pa-sm"},{default:t(()=>[a(k,{dense:"",hint:"Diisi oleh sistem",class:"",outlined:"",label:"ID",modelValue:n.value.id,"onUpdate:modelValue":l[0]||(l[0]=u=>n.value.id=u),disable:"",filled:""},null,8,["modelValue"]),a($,{class:"q-my-sm",flat:"",bordered:""},{default:t(()=>[a(w,{class:"q-pa-sm"},{default:t(()=>[l[8]||(l[8]=B("div",{class:"text-caption"}," Jika terkait dengan administrasi GT ",-1)),a(k,{dense:"",class:"q-my-sm",outlined:"",label:"GT ID",modelValue:n.value.gt_id,"onUpdate:modelValue":l[1]||(l[1]=u=>n.value.gt_id=u),clearable:"",debounce:"500"},null,8,["modelValue"]),a(k,{dense:"",class:"q-my-sm",outlined:"",label:"Nama GT",modelValue:d.value.nama,"onUpdate:modelValue":l[2]||(l[2]=u=>d.value.nama=u),disable:"",filled:"",loading:p.value},null,8,["modelValue","loading"]),a(k,{dense:"",class:"q-my-sm",outlined:"",label:"Nama PJGT",modelValue:d.value.pjgt_nama,"onUpdate:modelValue":l[3]||(l[3]=u=>d.value.pjgt_nama=u),disable:"",filled:"",loading:p.value},null,8,["modelValue","loading"])]),_:1})]),_:1}),a(k,{dense:"",class:"q-my-sm",outlined:"",label:"Keperluan",modelValue:n.value.keperluan,"onUpdate:modelValue":l[4]||(l[4]=u=>n.value.keperluan=u)},null,8,["modelValue"]),a(E,{dense:"",class:"q-my-sm",outlined:"",label:"Kas Masuk/Keluar",modelValue:n.value.flag,"onUpdate:modelValue":l[5]||(l[5]=u=>n.value.flag=u),options:[{value:"+",label:"Masuk"},{value:"-",label:"Keluar"}],"emit-value":"","map-options":"","error-color":"negative",behavior:"menu"},null,8,["modelValue"]),a(Y,{dense:"",class:"q-my-sm",outlined:"",modelValue:n.value.nominal,"onUpdate:modelValue":l[6]||(l[6]=u=>n.value.nominal=u),required:"",label:"Nominal"},null,8,["modelValue"]),a(k,{dense:"",class:"q-my-sm",outlined:"",label:"Keterangan",modelValue:n.value.keterangan,"onUpdate:modelValue":l[7]||(l[7]=u=>n.value.keterangan=u),autogrow:""},null,8,["modelValue"])]),_:1}),a(j,{"btn-delete":!c,onOnDelete:s},null,8,["btn-delete"])]),_:1})]),_:1})}}},oe={class:"q-gutter-sm"},Be={__name:"KasIndex",setup(Q){const y=i([]),f=i(!1),b=i(""),n=i(!1),p=i({}),d=i("");async function c(){n.value=!1;const s=await z({endPoint:"ugt/kas",loading:f});s&&(y.value=s.kas)}function U(){p.value={},n.value=!0}const v=i(!1);async function q(s){d.value=`reports/ugt/kuitansi/view?id=${s.id}`,v.value=!0}function _(s){const o=s.masuk?"+":"-",e=s.masuk||s.keluar,l={id:s.id,gt_id:s.gt_id,keperluan:s.keperluan,keterangan:s.keterangan,flag:o,nominal:e};p.value=l,n.value=!0}F(async()=>{await c()});const K=[{name:"id",label:"ID",align:"left",field:"id",sortable:!0},{name:"tgl_m",label:"Tanggal",align:"left",field:"tgl_m",sortable:!0},{name:"keperluan",label:"Keperluan",align:"left",field:"keperluan",sortable:!0},{name:"keterangan",label:"Keterangan",align:"left",field:"keterangan",sortable:!0},{name:"masuk",label:"Masuk",align:"right",field:"masuk",sortable:!0},{name:"keluar",label:"Keluar",align:"right",field:"keluar",sortable:!0},{name:"saldo",label:"Saldo",align:"right",field:"saldo",sortable:!0},{name:"cr_by",label:"By",align:"left",field:"cr_by",sortable:!0},{name:"edit",label:"!",align:"center",field:"",sortable:!1}];return(s,o)=>(G(),D(W,{class:"q-pa-sm"},{default:t(()=>[a($,{class:""},{default:t(()=>[a(w,{class:"bg-green-8 no-padding"},{default:t(()=>[a(P,{class:"no-padding no-margin"},{default:t(()=>[a(A,{class:"text-subtitle1 q-ml-sm text-green-11"},{default:t(()=>[...o[6]||(o[6]=[r(" Kas UGT ",-1)])]),_:1}),a(C,{dense:"",class:"q-px-md q-mr-sm text-green-10",label:"Tambah","no-caps":"",icon:"add",color:"green-2",onClick:U})]),_:1})]),_:1}),a(w,{class:"no-padding"},{default:t(()=>[a(R,{rows:y.value,loading:f.value,"rows-per-page-options":[10,25,50,100,0],pagination:{page:999},class:"dt q-px-sm",columns:K,filter:b.value,"no-data-label":"Tidak ada data untuk ditampilkan!","no-results-label":"Tidak ditemukan kata kunci yang sesuai dengan pencarian Anda!","row-key":"name",onRowClick:o[1]||(o[1]=(e,l,T)=>_(e,l,T))},{"top-right":t(()=>[a(k,{outlined:"",dense:"",debounce:"300",modelValue:b.value,"onUpdate:modelValue":o[0]||(o[0]=e=>b.value=e),placeholder:"Cari"},{append:t(()=>[a(L,{name:"search"})]),_:1},8,["modelValue"])]),body:t(e=>[a(H,{props:e},{default:t(()=>[a(m,{key:"id",props:e},{default:t(()=>[r(g(e.row.id),1)]),_:2},1032,["props"]),a(m,{key:"tgl_m",props:e},{default:t(()=>[r(g(e.row.tgl_m),1)]),_:2},1032,["props"]),a(m,{key:"keperluan",props:e},{default:t(()=>[r(g(e.row.gt_id?`${e.row.keperluan} (${e.row.gt_id})`:e.row.keperluan),1)]),_:2},1032,["props"]),a(m,{key:"keterangan",props:e},{default:t(()=>[r(g(e.row.keterangan),1)]),_:2},1032,["props"]),a(m,{key:"masuk",props:e},{default:t(()=>[r(g(V(S)(e.row.masuk)),1)]),_:2},1032,["props"]),a(m,{key:"keluar",props:e},{default:t(()=>[r(g(V(S)(e.row.keluar)),1)]),_:2},1032,["props"]),a(m,{key:"saldo",props:e},{default:t(()=>[r(g(V(S)(e.row.saldo)),1)]),_:2},1032,["props"]),a(m,{key:"cr_by",props:e},{default:t(()=>[r(g(e.row.cr_by),1)]),_:2},1032,["props"]),a(m,{key:"edit",props:e},{default:t(()=>[B("div",oe,[a(C,{icon:"edit","no-caps":"",color:"green-10",outline:"",dense:"",class:"q-px-md",onClick:l=>_(e.row)},null,8,["onClick"]),a(C,{icon:"print","no-caps":"",color:"green-10",outline:"",dense:"",class:"q-px-md",onClick:l=>q(e.row),disable:!e.row.gt_id},null,8,["onClick","disable"])])]),_:2},1032,["props"])]),_:2},1032,["props"])]),_:1},8,["rows","loading","filter"])]),_:1})]),_:1}),a(N,{persistent:"",modelValue:n.value,"onUpdate:modelValue":o[4]||(o[4]=e=>n.value=e)},{default:t(()=>[a(ne,{data:p.value,onSuccessSubmit:o[2]||(o[2]=e=>c()),onSuccessDelete:o[3]||(o[3]=e=>c())},null,8,["data"])]),_:1},8,["modelValue"]),a(N,{modelValue:v.value,"onUpdate:modelValue":o[5]||(o[5]=e=>v.value=e)},{default:t(()=>[a(ae,{url:d.value},null,8,["url"])]),_:1},8,["modelValue"])]),_:1}))}};export{Be as default};
