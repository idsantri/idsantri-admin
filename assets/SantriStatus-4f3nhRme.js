import{A as u,B as w,c as b,o as g,w as m,b as n,ab as x,e as A,C as S,Q as D,a5 as C,x as $,a9 as B,q as M,U as Q,f as U,E}from"./index-DwrbA0R8.js";import{_ as q}from"./TemplateArray-hLUfA21F.js";import{c as V}from"./format-date-DlwYCgkJ.js";import{a as I}from"./hijri-BBdEhqDI.js";import{r as N,d as O,g as j}from"./array-object-BytDdNh7.js";import{a as G}from"./api-get-D4W4lze7.js";import{Q as H}from"./QForm-DCEv1Ikv.js";import{_ as K}from"./InputSelectArray-DFe88pva.js";import{A as P}from"./ApiCrud-KwrbSuI8.js";import{u as L}from"./useCrudForm-DF0rM6hG.js";import"./QSpinnerCube-CuByR_Bu.js";import"./QItemSection-CeSY4hvW.js";import"./QItemLabel-Dzdetwv2.js";import"./QList-Cc6jCv1k.js";import"./id-BuNGTsqN.js";import"./format-number-B34ySHL_.js";import"./index-B6LiMDVO.js";import"./index-BlZcD66n.js";import"./api-error-DGWaEiw1.js";import"./QSelect-CrgZ1FsI.js";import"./QChip-DvUCR8tL.js";import"./QMenu-BEnErdhw.js";import"./selection-DRCgFU0J.js";import"./rtl-DFPa-2ov.js";import"./format-CJebrXOQ.js";import"./lists-store-Cp7AZ7Mr.js";import"./DropDownAfter-D2Wgui76.js";import"./QBtnDropdown-DqbNLFX1.js";import"./QBtnGroup-CPjXoyXA.js";import"./ClosePopup-kZj4_oIv.js";import"./Lists-g9uME9Wy.js";import"./Api-DWdZFNbG.js";class R extends P{constructor(){super("status")}async santri(i){throw await this._apiGet({endPoint:`${this._path}/santri/${i}`}),new Error("not implemented yet")}async lists(){throw await this._apiGet({endPoint:`${this._path}/lists`}),new Error("not implemented yet")}}const T=new R,z={__name:"StatusForm",props:{data:{type:Object,required:!0}},emits:["successDelete","successSubmit","successUpdate","successCreate"],setup(p,{emit:i}){const o=p,l=i,t=u({...o.data}),r=!o.data?.id,{handleDelete:c,handleCreate:f,handleUpdate:v,loading:_}=L(T,{emit:l,responseKey:"status"}),y=async()=>{const s={santri_id:t.value.santri_id,status:t.value.status,keterangan:t.value.keterangan};return r?await f(s,!0):await v(o.data.id,s,!0)},a=async()=>await c(o.data.id);return(s,e)=>{const h=w("FormHeader"),F=w("FormLoading"),k=w("FormActions");return g(),b($,{class:"full-width",style:{"max-width":"425px"}},{default:m(()=>[n(H,{onSubmit:x(y,["prevent"])},{default:m(()=>[n(h,{title:"Input Status","is-new":r}),S(_)?(g(),b(F,{key:0})):A("",!0),n(D,null,{default:m(()=>[n(C,{dense:"",outlined:"",label:"Nama","model-value":t.value?.nama+" ("+t.value?.santri_id+")",disable:"",filled:"",class:"q-my-sm"},null,8,["model-value"]),n(K,{modelValue:t.value.status,"onUpdate:modelValue":e[0]||(e[0]=d=>t.value.status=d),url:"status",label:"Status *",class:"q-my-sm",rules:[d=>!!d||"Harus diisi!"]},null,8,["modelValue","rules"]),n(C,{dense:"",class:"q-my-sm",outlined:"",label:"Keterangan",modelValue:t.value.keterangan,"onUpdate:modelValue":e[1]||(e[1]=d=>t.value.keterangan=d),autogrow:""},null,8,["modelValue"])]),_:1}),n(k,{"btn-delete":!r,onOnDelete:a},null,8,["btn-delete"])]),_:1})]),_:1})}}},xt={__name:"SantriStatus",setup(p){const i=u(!1),o=u(!1),l=u({}),t=u([]),r=u({}),{params:c}=B();async function f(){const a=await G({endPoint:`status/santri/${c.id}`,loading:i});a.status&&(t.value=a.status,r.value=a.santri)}const v=M(()=>t.value.map(a=>({Tanggal:V(a.created_at,"dd-MM-yyyy")+" | "+I(V(a.created_at,"yyyy-MM-dd")),Status:a.status,Keterangan:a.keterangan||"-",id:a.id})));Q(async()=>{await f()});const _=()=>{l.value={santri_id:r.value.id,nama:r.value.nama},o.value=!0},y=({id:a})=>{l.value=j(t,a),l.value.santri_id=r.value.id,l.value.nama=r.value.nama,o.value=!0};return(a,s)=>(g(),U("div",null,[n(q,{data:v.value,spinner:i.value,onAdd:_,onEdit:y},null,8,["data","spinner"]),n(E,{modelValue:o.value,"onUpdate:modelValue":s[3]||(s[3]=e=>o.value=e)},{default:m(()=>[n(z,{data:l.value,onSuccessDelete:s[0]||(s[0]=e=>S(O)(t.value,e)),onSuccessCreate:s[1]||(s[1]=e=>t.value.push(e)),onSuccessUpdate:s[2]||(s[2]=e=>S(N)(t.value,e.id,e))},null,8,["data"])]),_:1},8,["modelValue"])]))}};export{xt as default};
