import{B as _,C as V,c as m,o as u,w as e,g as a,ae as L,f as F,D as k,Q as M,a8 as O,l as D,ag as T,aw as K,a as j,e as q,b as A,y as g,F as E,A as P,t as v,H as R}from"./index-BxW-Zl0Y.js";import{Q as C}from"./QSkeleton-C8aF4tWC.js";import{Q as b}from"./QItemLabel-mC5VkLuy.js";import{Q as S,a as h}from"./QItemSection-Bb15NIFh.js";import{Q as G}from"./QList-50wBOg-c.js";import{a as W}from"./api-get-Voz9MJxZ.js";import{Q as z}from"./QSelect-CFPp42HH.js";import{Q as J}from"./QForm-BpJT9KkR.js";import{_ as U}from"./InputSelectArray-D75SXVep.js";import{u as X}from"./useCrudForm-LUfIVwOp.js";import{A as Y}from"./ApiCrud-B-1sH64C.js";import{_ as Z}from"./CardSantriSimple-BogO6vAF.js";import{g as aa}from"./array-object-BytDdNh7.js";import{c as I}from"./format-date-DlwYCgkJ.js";import{a as ea}from"./hijri--5qD4USW.js";class la extends Y{constructor(){super("mutaallim")}}const ta=new la,sa={__name:"QuranMutaallimForm",props:{data:{type:Object,required:!0}},emits:["successDelete","successSubmit","successUpdate","successCreate"],setup(s,{emit:f}){const i=s,c=f,l=_({marhalah:"Ula",faslah:null,no_absen:null,aktif:1,...i.data}),d=!i.data?.id,{handleDelete:Q,handleCreate:x,handleUpdate:p,loading:t}=X(ta,{emit:c,responseKey:"mutaallim"}),n=async()=>{const y={santri_id:l.value.santri_id,th_ajaran_h:l.value.th_ajaran_h,marhalah:l.value.marhalah,faslah:l.value.faslah,no_absen:l.value.no_absen,aktif:l.value.aktif};return d?await x(y,!0):await p(i.data.id,y,!0)},w=async()=>await Q(i.data.id);return(y,o)=>{const B=V("FormHeader"),N=V("FormLoading"),H=V("FormActions");return u(),m(D,{class:"full-width",style:{"max-width":"425px"}},{default:e(()=>[a(J,{onSubmit:L(n,["prevent"])},{default:e(()=>[a(B,{title:"Input Pendidikan Quran","is-new":d}),k(t)?(u(),m(N,{key:0})):F("",!0),a(M,null,{default:e(()=>[a(O,{dense:"",outlined:"",label:"Nama","model-value":l.value?.nama+" ("+l.value?.santri_id+")",disable:"",filled:"",class:"q-my-sm"},null,8,["model-value"]),a(U,{modelValue:l.value.th_ajaran_h,"onUpdate:modelValue":o[0]||(o[0]=r=>l.value.th_ajaran_h=r),url:"tahun-ajaran",label:"Tahun Ajaran *",sort:"desc",class:"q-my-sm",rules:[r=>!!r||"Harus diisi!"],selected:l.value.th_ajaran_h},null,8,["modelValue","rules","selected"]),a(z,{dense:"",outlined:"",modelValue:l.value.marhalah,"onUpdate:modelValue":o[1]||(o[1]=r=>l.value.marhalah=r),label:"Marhalah *",class:"q-my-sm",rules:[r=>!!r||"Harus diisi!"],options:["Ula","Wustho","Ulya"]},null,8,["modelValue","rules"]),a(U,{modelValue:l.value.faslah,"onUpdate:modelValue":o[2]||(o[2]=r=>l.value.faslah=r),url:"faslah-quran",label:"Faslah/Kelas *",class:"q-my-sm",rules:[r=>!!r||"Harus diisi!"]},null,8,["modelValue","rules"]),a(D,{bordered:"",flat:"",class:"q-px-sm q-my-sm"},{default:e(()=>[a(T,{modelValue:l.value.aktif,"onUpdate:modelValue":o[3]||(o[3]=r=>l.value.aktif=r),color:"green","true-value":1,"false-value":0,label:"Aktif",disable:!l.value.id},null,8,["modelValue","disable"])]),_:1})]),_:1}),a(H,{"btn-delete":!d,onOnDelete:w},null,8,["btn-delete"])]),_:1})]),_:1})}}},na={key:0},ka={__name:"MutaallimCard",props:{santri:{type:Object}},setup(s){const f=_(!1),i=_({}),c=_([]),l=_(!1);async function d(p){const t=await W({endPoint:`mutaallim/santri/${p}`,loading:l});t&&(c.value=t.mutaallim)}K(async()=>{s.santri?.id?await d(s.santri.id):s.santri?.santri_id&&await d(s.santri.santri_id)});const Q=()=>{i.value={santri_id:s.santri.id,nama:s.santri.nama},f.value=!0},x=p=>{i.value=aa(c,p),i.value.santri_id=s.santri.id,i.value.nama=s.santri.nama,f.value=!0};return(p,t)=>(u(),m(D,{flat:"",bordered:"",class:"",style:{width:"350px"}},{default:e(()=>[a(M,{class:"bg-green-7 text-green-11 q-pa-sm flex items-center justify-between"},{default:e(()=>[t[3]||(t[3]=j("div",null,"Riwayat Mutaallim",-1)),a(q,{icon:"add",outline:"",dense:"",class:"q-px-sm",disabled:!s.santri.id,onClick:Q},null,8,["disabled"])]),_:1}),a(M,{class:"q-pa-sm"},{default:e(()=>[s.santri.id?(u(),m(Z,{key:0,id:s.santri.id,class:"q-mb-sm"},null,8,["id"])):F("",!0),a(G,{bordered:"",separator:"",class:"rounded-borders"},{default:e(()=>[l.value?(u(),m(S,{key:0,class:"q-px-sm"},{default:e(()=>[a(h,null,{default:e(()=>[a(b,null,{default:e(()=>[a(C,{type:"text"})]),_:1}),a(b,{caption:""},{default:e(()=>[a(C,{type:"text"})]),_:1})]),_:1}),a(h,{avatar:""},{default:e(()=>[a(C,{type:"QRadio"})]),_:1})]),_:1})):c.value?.length?(u(!0),A(E,{key:2},P(c.value,(n,w)=>(u(),m(S,{key:w,active:!!n.aktif,"active-class":"bg-green-1 text-green-10",class:"q-px-sm"},{default:e(()=>[a(h,null,{default:e(()=>[a(b,null,{default:e(()=>[g(v(n.th_ajaran_h)+" | "+v(n.marhalah)+" | "+v(n.faslah),1)]),_:2},1024),a(b,{caption:""},{default:e(()=>[g(v(k(I)(n.created_at,"dd-MM-yyyy"))+" | "+v(k(ea)(k(I)(n.created_at,"yyyy-MM-dd")))+" ",1),n.aktif?(u(),A("span",na,[...t[6]||(t[6]=[j("span",null,"|",-1),j("span",{class:"text-weight-bold text-green-10"}," Aktif ",-1)])])):F("",!0)]),_:2},1024)]),_:2},1024),a(h,{avatar:""},{default:e(()=>[a(q,{icon:"edit",dense:"",outline:"",round:"",glossy:"",onClick:y=>x(n.id)},null,8,["onClick"])]),_:2},1024)]),_:2},1032,["active"]))),128)):(u(),m(S,{key:1,class:"q-px-sm"},{default:e(()=>[a(h,null,{default:e(()=>[a(b,null,{default:e(()=>[...t[4]||(t[4]=[g(" Tidak ada data ",-1)])]),_:1}),a(b,{caption:""},{default:e(()=>[...t[5]||(t[5]=[g(" untuk ditampilkan ",-1)])]),_:1})]),_:1}),a(h,{avatar:""},{default:e(()=>[a(q,{icon:"sym_o_exclamation",disable:"",dense:"",outline:"",round:"",color:"green-14"})]),_:1})]),_:1}))]),_:1})]),_:1}),a(R,{modelValue:f.value,"onUpdate:modelValue":t[2]||(t[2]=n=>f.value=n)},{default:e(()=>[a(sa,{data:i.value,onSuccessSubmit:t[0]||(t[0]=n=>d(i.value.santri_id)),onSuccessDelete:t[1]||(t[1]=n=>d(i.value.santri_id))},null,8,["data"])]),_:1},8,["modelValue"])]),_:1}))}},$=[{name:"nama",label:"Nama",align:"left",field:"nama",sortable:!0},{name:"data_akhir",label:"Data Akhir",align:"left",field:"data_akhir",sortable:!0},{name:"th_ajaran_h",label:"Tahun Ajaran",align:"left",field:"th_ajaran_h",sortable:!0},{name:"marhalah",label:"Marhalah",align:"left",field:"marhalah",sortable:!0},{name:"faslah",label:"Faslah/Kelas",align:"left",field:"faslah",sortable:!0}],Qa=[{name:"id",label:"ID Santri",align:"center",field:"id",sortable:!0},...$],xa=[{name:"santri_id",label:"ID Santri",align:"center",field:"santri_id",sortable:!0},...$];export{ka as _,xa as a,Qa as c};
