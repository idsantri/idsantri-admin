import{Q as w}from"./QToolbarTitle-Bi6rSosy.js";import{x as c,a7 as p,a6 as f,R as k,G as b,c as h,o as g,w as U,b as j,n as S,a0 as x,q as T,f as A,a as $,s as K}from"./index-Bf-p91mW.js";import{Q as P}from"./QToolbar-CUFZpZSE.js";import{Q}from"./QSpace-DJeipgZa.js";import{l as _}from"./lists-madrasah-store-BA3VUsPV.js";import{Q as v}from"./QSelect-Co09SqkM.js";import{g as B}from"./api-get-lists-tgPOn2h8.js";import{n as q}from"./index-BtaF3-6r.js";const L={__name:"SelectTahunAjaran",props:{startUrl:{type:String,required:!0},routerPush:{type:Boolean,default:!0}},setup(i){const o=i,s=c([]),{params:n}=p(),r=c(n.th_ajaran_h),l=c([]),u=f();return k(async()=>{const e=_().getThAjaran;if(e.length)s.value.th_ajaran=e;else{const a=await B({url:"kelas/lists",key:"th_ajaran",loadingArray:l});_().setThAjaran(a),s.value.th_ajaran=a}}),b(r,(e,a)=>{if(o.routerPush){if(!e){u.push(`${o.startUrl}`);return}if(e!=a){u.push(`${o.startUrl}/${e}`);return}}else return}),(e,a)=>(g(),h(v,{dense:"",outlined:"",label:"Tahun Ajaran",modelValue:r.value,"onUpdate:modelValue":a[0]||(a[0]=t=>r.value=t),options:s.value.th_ajaran,"option-value":"th_ajaran_h","option-label":"th_ajaran_h","emit-value":"","map-options":"",loading:l.value.th_ajaran,behavior:"menu"},null,8,["modelValue","options","loading"]))}},V={__name:"SelectTingkat",props:{startUrl:{type:String,required:!0},routerPush:{type:Boolean,default:!0}},setup(i){const o=i,s=c([]),n=c([]),r=f(),{params:l}=p(),u=c(l.tingkat_id),e=`${o.startUrl}/${l.th_ajaran_h}`;return k(async()=>{if(l.th_ajaran_h){const a=_().getTingkatByTahun(l.th_ajaran_h);if(a.length)s.value.tingkat=a;else{const t=await B({url:"kelas/lists",params:{th_ajaran_h:l.th_ajaran_h},key:"tingkat",loadingArray:n,sort:"asc"});_().addTingkatToTahun(t,l.th_ajaran_h),s.value.tingkat=t}}}),b(u,(a,t)=>{if(o.routerPush){if(!a){r.push(e);return}if(a!=t){r.push(`${e}/${a}`);return}}else return}),(a,t)=>(g(),h(v,{dense:"",outlined:"",label:"Tingkat",modelValue:u.value,"onUpdate:modelValue":t[0]||(t[0]=d=>u.value=d),options:s.value.tingkat,"option-value":"tingkat_id","option-label":"tingkat","emit-value":"","map-options":"",loading:n.value.tingkat,behavior:"menu",clearable:""},null,8,["modelValue","options","loading"]))}},C={__name:"SelectKelas",props:{startUrl:{type:String,required:!0},routerPush:{type:Boolean,default:!0}},emits:["onSelect"],setup(i,{emit:o}){const s=i,n=o,r=c([]),{params:l}=p(),u=c(l.kelas),e=c([]),a=f(),t=`${s.startUrl}/${l.th_ajaran_h}/${l.tingkat_id}`;return k(async()=>{if(l.th_ajaran_h&&l.tingkat_id){const d=_().getKelasByTingkatAndTahun(l.tingkat_id,l.th_ajaran_h);if(d.length)r.value.kelas=d;else{const m=await B({url:"kelas/lists",params:{th_ajaran_h:l.th_ajaran_h,tingkat_id:l.tingkat_id},key:"kelas",loadingArray:e,sort:"asc"});_().addKelasToTingkatByTahun(m,l.tingkat_id,l.th_ajaran_h),r.value.kelas=m}}}),b(u,(d,m)=>{if(s.routerPush){if(!d){a.push(t);return}if(d!=m){let y="";l.set_bulan_ujian?y="/"+l.set_bulan_ujian:l.ujian_ke&&(y="/"+l.ujian_ke),a.push(`${t}/${d}${y}`),n("onSelect",d);return}}else return}),(d,m)=>(g(),h(v,{dense:"",outlined:"",label:"Kelas",modelValue:u.value,"onUpdate:modelValue":m[0]||(m[0]=y=>u.value=y),options:r.value.kelas,"emit-value":"","map-options":"",loading:e.value.kelas,clearable:"",behavior:"menu"},null,8,["modelValue","options","loading"]))}},F={__name:"SelectUjianKe",props:{startUrl:{type:String,required:!0},arrUjian:{type:Array,required:!0},routerPush:{type:Boolean,default:!0}},setup(i){const o=i,s=c([]),{params:n}=p(),r=c(n.ujian_ke),l=f(),u=`${o.startUrl}/${n.th_ajaran_h}/${n.tingkat_id}/${n.kelas}`;return k(()=>{n.th_ajaran_h&&n.tingkat_id&&n.kelas&&(s.value.ujian_ke=_().getUjian.filter(e=>o.arrUjian.includes(e.value)))}),b(r,(e,a)=>{if(o.routerPush){if(!e){l.push(u);return}if(e!=a){l.push(`${u}/${e}`);return}}else return}),(e,a)=>(g(),h(v,{dense:"",outlined:"",label:"Cawu/Semester",modelValue:r.value,"onUpdate:modelValue":a[0]||(a[0]=t=>r.value=t),options:s.value.ujian_ke,"option-value":"value","option-label":"label","emit-value":"","map-options":"",clearable:"",behavior:"menu"},null,8,["modelValue","options"]))}},D={__name:"SelectBulanUjianSetting",props:{startUrl:{type:String,required:!0},routerPush:{type:Boolean,default:!0}},setup(i){const o=i,{params:s}=p(),n=f(),r=c(s.set_bulan_ujian),l=c(!1),u=c([]),e=`${o.startUrl}/${s.th_ajaran_h}/${s.tingkat_id}/${s.kelas||"*"}`;return k(async()=>{if(s.tingkat_id){const a=_().getBulanUjianSettingByTingkatId(s.tingkat_id);if(a.length)u.value.bulan_ujian=a;else{const t=await B({url:"absensi/settings",params:{tingkat_id:s.tingkat_id},key:"bulan_ujian",loading:l});if(!t.length){q("Jadwal ujian untuk jenjang ini belum diatur.<br>Silakan masuk ke menu pengaturan (kanan atas)!");return}_().addBulanUjianSetting(t),u.value.bulan_ujian=t}}}),b(r,(a,t)=>{if(o.routerPush){if(!a){n.push(e);return}if(a!=t){n.push(`${e}/${a}`);return}}else return}),(a,t)=>(g(),h(v,{dense:"",outlined:"",label:"Bulan (Ujian)",modelValue:r.value,"onUpdate:modelValue":t[0]||(t[0]=d=>r.value=d),options:u.value.bulan_ujian,"option-value":"bu","option-label":"bulan_ujian","emit-value":"","map-options":"",loading:l.value,clearable:"",behavior:"menu"},null,8,["modelValue","options","loading"]))}},I={__name:"SelectBulanUjianList",props:{startUrl:{type:String,required:!0},routerPush:{type:Boolean,default:!0}},setup(i){const o=i,{params:s}=p(),n=f(),r=c(s.list_bulan_ujian),l=c(!1),u=c([]),e=`${o.startUrl}/${s.th_ajaran_h}/${s.tingkat_id}`;return k(async()=>{if(s.th_ajaran_h&&s.tingkat_id){const a=_().getBulanUjianListByTahunAndTingkatId(s.th_ajaran_h,s.tingkat_id);if(a.length)u.value=a;else{const t=await B({url:`absensi/${s.absensi}/lists/bulan-ujian`,params:{th_ajaran_h:s.th_ajaran_h,tingkat_id:s.tingkat_id},key:"bulan_ujian",loading:l});if(!t.length){q("Tidak ada laporan untuk filter yang dipilih!");return}_().addBulanUjianList(t),u.value=t}}}),b(r,(a,t)=>{if(o.routerPush){if(!a){n.push(e);return}if(a!=t){n.push(`${e}/${a}`);return}}else return}),(a,t)=>(g(),h(v,{dense:"",outlined:"",label:"Bulan (Ujian)",modelValue:r.value,"onUpdate:modelValue":t[0]||(t[0]=d=>r.value=d),options:u.value,"option-value":"bu","option-label":"bulan_ujian","emit-value":"","map-options":"",loading:l.value,clearable:"",behavior:"menu"},null,8,["modelValue","options","loading"]))}},M={class:"text-subtitle1"},R=["innerHTML"],N={class:"row",style:{"max-width":"1000px",width:"100%"}},H={class:"q-pr-sm"},Z={__name:"FilterKelas",props:{startUrl:{type:String,required:!0},title:{type:String,default:"Filter Kelas"},showTingkat:{type:Boolean,default:!0},showKelas:{type:Boolean,default:!0},showUjianKe:{type:Boolean,default:!1},showSetBulanUjian:{type:Boolean,default:!1},showListBulanUjian:{type:Boolean,default:!1}},emits:["dataFilter"],setup(i,{emit:o}){const s=o,{params:n}=p(),r=c(0);function l(){_().$reset(),r.value++}k(()=>{s("dataFilter",u())});function u(){let e="<em>Tentukan Filter!</em>";if(n.th_ajaran_h&&(e='➡️ <em class="text-weight-light">Tahun Ajaran: </em><strong>'+n.th_ajaran_h+"</strong>"),n.tingkat_id){const a=_().getAllTingkat();if(a.length){const t=a.find(d=>d.tingkat_id==n.tingkat_id);e+=' ➡️ <em class="text-weight-light">Tingkat: </em><strong>'+t.tingkat+"</strong>"}}if(n.kelas&&(e+=' ➡️ <em class="text-weight-light">Kelas: </em><strong>'+n.kelas+"</strong>"),n.ujian_ke){const a=_().getUjian.find(t=>t.value==n.ujian_ke);e+=' ➡️ <em class="text-weight-light">Ujian Ke: </em><strong>'+a.label+"</strong>"}if(n.set_bulan_ujian){const t=_().getBulanUjianSettingByTingkatId(n.tingkat_id).find(d=>d.bu==n.set_bulan_ujian);e+=' ➡️ <em class="text-weight-light">Bulan (Ujian): </em><strong>'+t.bulan_ujian+"</strong>"}if(n.list_bulan_ujian){const t=_().getBulanUjianListByTahunAndTingkatId(n.th_ajaran_h,n.tingkat_id).find(d=>d.bu==n.list_bulan_ujian);e+=' ➡️ <em class="text-weight-light">Bulan (Ujian): </em><strong>'+t.bulan_ujian+"</strong>"}return e}return(e,a)=>(g(),h(K,null,{default:U(()=>[j(S,{class:"q-px-sm q-py-sm bg-green-11"},{default:U(()=>[j(P,{class:"no-padding",style:{"min-height":"0"}},{default:U(()=>[j(w,{class:"text-subtitle1"},{default:U(()=>[T("div",M,[T("span",{innerHTML:i.title},null,8,R)])]),_:1}),j(A,{icon:"sync",dense:"",flat:"",class:"q-mr-xs",onClick:l}),x(e.$slots,"default")]),_:3})]),_:3}),(g(),h(S,{class:"no-padding flex flex-center",key:r.value},{default:U(()=>[T("div",N,[j(L,{class:"col-12 col-md-3 q-pa-sm","start-url":i.startUrl},null,8,["start-url"]),i.showTingkat?(g(),h(V,{key:0,class:"col-12 col-md-3 q-pa-sm","start-url":i.startUrl},null,8,["start-url"])):$("",!0),i.showKelas?(g(),h(C,{key:1,class:"col-12 col-md-3 q-pa-sm","start-url":i.startUrl},null,8,["start-url"])):$("",!0),i.showUjianKe?(g(),h(F,{key:2,class:"col-12 col-md-3 q-pa-sm","start-url":i.startUrl,"arr-ujian":[1,2,3]},null,8,["start-url"])):$("",!0),i.showSetBulanUjian?(g(),h(D,{key:3,class:"col-12 col-md-3 q-pa-sm","start-url":i.startUrl},null,8,["start-url"])):$("",!0),i.showListBulanUjian?(g(),h(I,{key:4,class:"col-12 col-md-3 q-pa-sm","start-url":i.startUrl},null,8,["start-url"])):$("",!0)]),j(Q),T("div",H,[x(e.$slots,"more")])]),_:3}))]),_:3}))}};export{Z as _};
