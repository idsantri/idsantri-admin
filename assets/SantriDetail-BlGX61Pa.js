import{E as x,c as v,o as u,w as e,g as a,Q as $,a as w,t as K,r as la,b as E,F as z,D as na,l as F,n as I,v as S,p as T,q as y,ap as oa,s as M,Y as sa,af as ra,a9 as U,ad as G,A as H,e as g,f as ia,bE as ua,J as W,ae as da,aa as ma,G as R}from"./index-BqUVN04g.js";import{f as J}from"./format-date-OVhbBx9F.js";import{Q as Y}from"./QSpace-B7hgVlkj.js";import{Q as pa}from"./QImg-Bwzqml11.js";import{_ as fa}from"./ImageUploader-DJq1RnwZ.js";import{s as h}from"./santri-store-CLtXDPvq.js";import{b as ca}from"./hijri-BmGMyWvY.js";import{Q as j}from"./QRouteTab-J6Yr11sP.js";import{Q as V}from"./QItemLabel-DzKTdPfL.js";import{Q as C,a as s}from"./QItem-DUdfjGik.js";import{Q as X}from"./QList-DdbQcE6S.js";import{Q as Z}from"./QBtnDropdown-DPLmQl3j.js";import{Q as va}from"./QTabs-ev7GpEaP.js";import{C as q}from"./ClosePopup-CoY99Ng8.js";import{d as _a}from"./dialog-store-IBfQqG_Y.js";import{_ as ga}from"./ReportViewer-61GoirI-.js";import{Q as L}from"./QSelect-EhaZVlxC.js";import{Q as ba}from"./QForm-CS-c3dsq.js";import{e as wa}from"./index-DP0IlF18.js";import{_ as ka}from"./InputSelectArray-oZyiJ_JA.js";import{D as N}from"./DownloadFile-Dn1zSk4O.js";import{S as ya}from"./Santri-p9XHBsoC.js";import{C as Ia}from"./CardListTabel-Azkpnqyf.js";import{f as Sa}from"./format-text-DnCGEu2I.js";import{I as Va}from"./Image-B4GrwFUl.js";import"./id-BuNGTsqN.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./index-BvO-T65Q.js";import"./format-number-B34ySHL_.js";import"./QBtnGroup-CfpWIPz0.js";import"./QMenu-TwKNNlhy.js";import"./selection-DsZt6IZi.js";import"./QResizeObserver-BNcGt9FN.js";import"./rtl-DFPa-2ov.js";import"./QField-DuT44j03.js";import"./QChip-CXOSpxBg.js";import"./format-CJebrXOQ.js";import"./lists-store-DEVGuUp0.js";import"./ArrayCrud-DeaxgM1Q.js";import"./DropDownAfter-Bn7uLIed.js";import"./Lists-7blmMzjy.js";import"./ApiCrud-Dd-6PwhQ.js";import"./Api-DoKbSzYK.js";import"./apiPost-DQEuKb5V.js";import"./QMarkupTable-DLJzRty4.js";const Ca={class:"flex items-center"},qa={class:"text-subtitle2"},ha={class:"col-4 q-pr-sm relative-position"},$a={class:"col"},Qa={class:"text-caption text-italic"},Da={class:"q-mb-sm"},Ua={__name:"CardIdentity",props:{title:String,data:Object,image:String,loading:Boolean,loadingImage:Boolean},setup(_){return(t,k)=>{const d=x("CardLoading");return u(),v(F,{flat:"",bordered:""},{default:e(()=>[a($,{class:"bg-green-7 text-green-11 q-pa-sm"},{default:e(()=>[w("div",Ca,[w("div",qa,K(_.title),1),a(Y)])]),_:1}),a($,{class:"q-pa-sm row"},{default:e(()=>[w("div",ha,[a(pa,{src:_.image,ratio:3/4,alt:"santri"},null,8,["src"]),la(t.$slots,"button"),a(d,{showing:_.loadingImage,message:""},null,8,["showing"])]),w("div",$a,[(u(!0),E(z,null,na(_.data,(l,m)=>(u(),E("div",{key:m},[w("div",Qa,K(m),1),w("div",Da,K(l),1)]))),128))]),a(d,{showing:_.loading},null,8,["showing"])]),_:3})]),_:3})}}},xa={__name:"SantriRelations",props:{santriId:{default:null}},setup(_){const t=_;return(k,d)=>{const l=x("router-view");return u(),v(F,{bordered:"",flat:""},{default:e(()=>[a($,{class:"bg-green-7 text-green-11 no-padding"},{default:e(()=>[a(va,{"no-caps":"","outside-arrows":"","mobile-arrows":"",dense:"","indicator-color":"green-13",align:"left"},{default:e(()=>[a(j,{name:"wali",label:"Wali",to:"/santri/"+t.santriId+"/wali"},null,8,["to"]),a(j,{name:"ortu",label:"Ortu",to:"/santri/"+t.santriId+"/ortu"},null,8,["to"]),a(j,{name:"status",label:"Status",to:"/santri/"+t.santriId+"/status"},null,8,["to"]),a(j,{name:"kelas",label:"Kelas",to:"/santri/"+t.santriId+"/kelas"},null,8,["to"]),a(j,{name:"domisili",label:"Domisili",to:"/santri/"+t.santriId+"/domisili"},null,8,["to"]),a(Y),a(Z,{flat:"",dense:"","dropdown-icon":"more_vert",class:"q-pl-md",color:"green-11"},{default:e(()=>[a(X,null,{default:e(()=>[I((u(),v(C,{to:"/iuran/santri/"+t.santriId},{default:e(()=>[a(s,null,{default:e(()=>[a(V,null,{default:e(()=>[...d[0]||(d[0]=[S("Iuran",-1)])]),_:1})]),_:1}),a(s,{avatar:""},{default:e(()=>[a(T,{name:"payments",flat:""})]),_:1})]),_:1},8,["to"])),[[q]]),I((u(),v(C,{to:"/keamanan/izin-pesantren/santri/"+t.santriId},{default:e(()=>[a(s,null,{default:e(()=>[a(V,null,{default:e(()=>[...d[1]||(d[1]=[S("Izin Pesantren",-1)])]),_:1})]),_:1}),a(s,{avatar:""},{default:e(()=>[a(T,{name:"transfer_within_a_station",flat:""})]),_:1})]),_:1},8,["to"])),[[q]]),I((u(),v(C,{to:"/keamanan/indisipliner/santri/"+t.santriId},{default:e(()=>[a(s,null,{default:e(()=>[a(V,null,{default:e(()=>[...d[2]||(d[2]=[S("Indisipliner",-1)])]),_:1})]),_:1}),a(s,{avatar:""},{default:e(()=>[a(T,{name:"directions_run",flat:""})]),_:1})]),_:1},8,["to"])),[[q]])]),_:1})]),_:1})]),_:1})]),_:1}),a($,{class:"q-pa-sm"},{default:e(()=>[a(l)]),_:1})]),_:1})}}},Ba={__name:"SantriPermohonanBerhentiForm",props:{data:{type:Object,required:!0}},emits:["successSubmit"],setup(_,{emit:t}){const k=_,d=t,l=y({jenis_permohonan:"Berhenti",tunggakan:"Lunas"}),m=y({...k.data}),b=oa("firstInput");M(async()=>{await sa(),b.value&&b.value.focus()});async function c(){const p=JSON.parse(JSON.stringify(l.value));if(!p.tunggakan||!p.jenis_permohonan||!p.alasan||!p.wali_nama||!p.wali_status||!p.wali_hubungan)return wa("Isian tidak lengkap");p.id=m.value.id,d("successSubmit",p),document.getElementById("btn-close-form")?.click()}return(p,n)=>{const B=x("FormHeader"),Q=x("FormActions");return u(),v(F,{class:"full-width",style:{"max-width":"425px"}},{default:e(()=>[a(ba,{onSubmit:ra(c,["prevent"])},{default:e(()=>[a(B,{title:"Permohonan Berhenti","is-new":!0}),a($,null,{default:e(()=>[a(U,{dense:"",class:"q-my-sm",outlined:"",label:"Santri ID",modelValue:m.value.id,"onUpdate:modelValue":n[0]||(n[0]=o=>m.value.id=o),filled:"",disable:""},null,8,["modelValue"]),a(U,{dense:"",class:"q-my-sm",outlined:"",label:"Nama",modelValue:m.value.nama,"onUpdate:modelValue":n[1]||(n[1]=o=>m.value.nama=o),filled:"",disable:""},null,8,["modelValue"]),a(L,{dense:"",class:"q-my-sm",outlined:"",label:"Tunggakan*",modelValue:l.value.tunggakan,"onUpdate:modelValue":n[2]||(n[2]=o=>l.value.tunggakan=o),options:["Lunas","Belum Lunas"],clearable:"","use-input":"","new-value-mode":"add",behavior:"menu",ref_key:"firstInput",ref:b},null,8,["modelValue"]),a(L,{dense:"",class:"q-my-sm",outlined:"",label:"Jenis Permohonan*",modelValue:l.value.jenis_permohonan,"onUpdate:modelValue":n[3]||(n[3]=o=>l.value.jenis_permohonan=o),options:["Berhenti","Cuti/Istirahat"],clearable:"","use-input":"","new-value-mode":"add",behavior:"menu"},null,8,["modelValue"]),a(U,{dense:"",class:"q-my-sm",outlined:"",label:"Alasan*",modelValue:l.value.alasan,"onUpdate:modelValue":n[4]||(n[4]=o=>l.value.alasan=o),autogrow:""},null,8,["modelValue"]),a(F,{class:"",flat:"",bordered:""},{default:e(()=>[a($,{class:"q-py-none q-px-sm"},{default:e(()=>[n[11]||(n[11]=w("div",{class:"text-subtitle2 q-my-sm"},"Identitas Pemohon (Wali)",-1)),a(U,{dense:"",class:"",outlined:"",label:"Nama*",modelValue:l.value.wali_nama,"onUpdate:modelValue":n[5]||(n[5]=o=>l.value.wali_nama=o)},null,8,["modelValue"]),a(U,{dense:"",class:"q-my-sm",outlined:"",label:"Nomor Telepon",modelValue:l.value.wali_no_telepon,"onUpdate:modelValue":n[6]||(n[6]=o=>l.value.wali_no_telepon=o)},null,8,["modelValue"]),a(L,{dense:"",class:"q-my-sm",outlined:"",label:"Bukti Diri",modelValue:l.value.wali_bukti_diri,"onUpdate:modelValue":n[7]||(n[7]=o=>l.value.wali_bukti_diri=o),options:["KTP","SIM"],clearable:"","use-input":"","new-value-mode":"add",behavior:"menu"},null,8,["modelValue"]),a(U,{dense:"",class:"q-my-sm",outlined:"",label:"Nomor / ID Bukti Diri",modelValue:l.value.wali_bukti_diri_id,"onUpdate:modelValue":n[8]||(n[8]=o=>l.value.wali_bukti_diri_id=o)},null,8,["modelValue"]),a(L,{dense:"",class:"q-my-sm",outlined:"",label:"Status*",modelValue:l.value.wali_status,"onUpdate:modelValue":n[9]||(n[9]=o=>l.value.wali_status=o),options:["Wali","Wakil Wali"],clearable:"","use-input":"","new-value-mode":"add",behavior:"menu"},null,8,["modelValue"]),a(ka,{modelValue:l.value.wali_hubungan,"onUpdate:modelValue":n[10]||(n[10]=o=>l.value.wali_hubungan=o),url:"hubungan-wali",label:"Hubungan*",class:"q-my-sm","use-input":"","new-value-mode":"add"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),a(Q,{"btn-delete":!1,labelSubmit:"Cetak",iconSubmit:"print"})]),_:1})]),_:1})}}},ja={key:2},Pa={__name:"DropDownPrint",props:{santri:{type:Object,required:!0}},setup(_){const t=_,k=G(),d=y(!1),l=y(""),m=y(!1),b=H(()=>{const f=t.santri.nama.replace(/\s+/g,"_").toLowerCase();return`${t.santri.id}-${f}.pdf`}),c=y(!1);async function p(){try{c.value=!0,await N.santriRegistrasi(t.santri.id,"registrasi-"+b.value)}catch(f){console.error("Error downloading registrasi:",f)}finally{c.value=!1}}async function n(){try{c.value=!0,await N.santriStandbook(t.santri.id,"standbook-"+b.value)}catch(f){console.error("Error downloading standbook:",f)}finally{c.value=!1}}async function B(){try{c.value=!0,await N.santriKeteranganBerhenti(t.santri.id,"keterangan-berhenti-"+b.value)}catch(f){console.error("Error downloading keterangan berhenti:",f)}finally{c.value=!1}}async function Q(){try{c.value=!0,await N.santriIdCard(t.santri.id,"id-card-"+b.value)}catch(f){console.error("Error downloading id card:",f)}finally{c.value=!1}}function o(){l.value=`reports/santri/registrasi/view?id=${k.params.id}`,m.value=!0}function O(){l.value=`reports/santri/standbook/view?id=${k.params.id}`,m.value=!0}function A(f){d.value=!1;const r=new URLSearchParams(f).toString();l.value=`reports/santri/permohonan-berhenti/view?${r}`,m.value=!0}function D(){l.value=`reports/santri/keterangan-berhenti/view?id=${k.params.id}`,m.value=!0}return(f,r)=>(u(),E(z,null,[a(Z,{color:"green-10","no-caps":"",dense:"",outline:"",class:"q-px-sm text-green-11",disable:c.value},{label:e(()=>[c.value?(u(),v(ua,{key:0,class:"q-mr-sm"})):(u(),v(T,{key:1,name:"print",class:"q-mr-sm"})),f.$q.screen.lt.sm?ia("",!0):(u(),E("span",ja," Cetak / Unduh "))]),default:e(()=>[a(X,null,{default:e(()=>[I((u(),v(C,null,{default:e(()=>[a(s,null,{default:e(()=>[a(V,null,{default:e(()=>[...r[3]||(r[3]=[S("Registrasi",-1)])]),_:1})]),_:1}),a(s,{avatar:""},{default:e(()=>[a(g,{icon:"download",flat:"",onClick:p})]),_:1}),a(s,{avatar:""},{default:e(()=>[a(g,{icon:"print",flat:"",onClick:o})]),_:1})]),_:1})),[[q]]),I((u(),v(C,null,{default:e(()=>[a(s,null,{default:e(()=>[a(V,null,{default:e(()=>[...r[4]||(r[4]=[S("Standbook",-1)])]),_:1})]),_:1}),a(s,{avatar:""},{default:e(()=>[a(g,{icon:"download",flat:"",onClick:n})]),_:1}),a(s,{avatar:""},{default:e(()=>[a(g,{icon:"print",flat:"",onClick:O})]),_:1})]),_:1})),[[q]]),I((u(),v(C,null,{default:e(()=>[a(s,null,{default:e(()=>[a(V,null,{default:e(()=>[...r[5]||(r[5]=[S("Permohonan Berhenti",-1)])]),_:1})]),_:1}),a(s,{avatar:""},{default:e(()=>[a(g,{icon:"download",flat:"",disable:""})]),_:1}),a(s,{avatar:""},{default:e(()=>[a(g,{icon:"print",flat:"",onClick:r[0]||(r[0]=i=>d.value=!0)})]),_:1})]),_:1})),[[q]]),I((u(),v(C,null,{default:e(()=>[a(s,null,{default:e(()=>[a(V,null,{default:e(()=>[...r[6]||(r[6]=[S("Keterangan Berhenti",-1)])]),_:1})]),_:1}),a(s,{avatar:""},{default:e(()=>[a(g,{icon:"download",flat:"",onClick:B})]),_:1}),a(s,{avatar:""},{default:e(()=>[a(g,{icon:"print",flat:"",onClick:D})]),_:1})]),_:1})),[[q]]),I((u(),v(C,null,{default:e(()=>[a(s,null,{default:e(()=>[a(V,null,{default:e(()=>[...r[7]||(r[7]=[S("ID Card",-1)])]),_:1})]),_:1}),a(s,{avatar:""},{default:e(()=>[a(g,{icon:"download",flat:"",onClick:Q})]),_:1}),a(s,{avatar:""},{default:e(()=>[a(g,{icon:"print",flat:"",disable:""})]),_:1})]),_:1})),[[q]])]),_:1})]),_:1},8,["disable"]),a(W,{modelValue:d.value,"onUpdate:modelValue":r[1]||(r[1]=i=>d.value=i)},{default:e(()=>[a(Ba,{onSuccessSubmit:A,data:t.santri},null,8,["data"])]),_:1},8,["modelValue"]),a(W,{modelValue:m.value,"onUpdate:modelValue":r[2]||(r[2]=i=>m.value=i)},{default:e(()=>[a(ga,{url:l.value},null,8,["url"])]),_:1},8,["modelValue"])],64))}},Ra={class:"row"},La={class:"col-12 col-sm-6 col-md-4 q-pa-sm"},Na={class:"col-12 col-sm-6 col-md-5 q-pa-sm"},De={__name:"SantriDetail",setup(_){const{santri:t}=da(h()),k=h(),l=G().params.id,m=_a(),{searchSantri:b,crudSantri:c}=ma(m),p=y(!1),n=y(!1);async function B(){try{n.value=!0;const i=await Va.santri(l);k.setImage(i?.image_url||null)}catch(i){console.error("ðŸš€ ~ loadImage ~ _err:",i)}finally{n.value=!1}}async function Q(){h().$reset();try{p.value=!0;const i=await ya.getById({id:l});i&&(h().setSantri(i.santri),h().setOrtu(i.ortu),h().setWali(i.wali))}catch{}finally{p.value=!1}}const o=H(()=>[{label:"ID",value:t.value.id},{label:"Tanggal Daftar",value:J(t.value.tgl_daftar_m)+" | "+ca(t.value.tgl_daftar_h)},{label:"Tahun Ajaran",value:`${t.value.th_ajaran_h||"-"} | ${t.value.th_ajaran_m||"-"}`}]),O=H(()=>({Nama:`${t.value.nama?t.value.nama?.toUpperCase():""} (${t.value.sex?.toUpperCase()})`,Alamat:Sa(t.value.jl,t.value.rt,t.value.rw,t.value.desa,t.value.kecamatan,t.value.kabupaten,t.value.provinsi,t.value.kode_pos),Kelahiran:`${t.value.tmp_lahir||"-"}, ${J(t.value.tgl_lahir)}`,"Data Akhir":t.value.data_akhir||"-"}));M(async()=>{await Q()});function A(){h().setEdit(),c.value=!0}const D=y(!1),f=i=>D.value=i;async function r(){D.value=!1,await B()}return(i,P)=>{const aa=x("CardHeader"),ea=x("CardPage");return u(),v(ea,null,{default:e(()=>[a(aa,{title:"Data Santri",onOnReload:Q,"show-edit":!0,onOnEdit:A},{buttons:e(()=>[a(g,{label:i.$q.screen.lt.sm?"":"Cari",onClick:P[0]||(P[0]=ta=>b.value=!0),color:"green-2","no-caps":"",dense:"",class:"q-px-sm text-green-10",icon:"search"},null,8,["label"]),a(Pa,{santri:R(t)},null,8,["santri"])]),_:1}),a($,{class:"no-padding"},{default:e(()=>[w("div",Ra,[w("div",La,[a(Ia,{class:"q-mb-sm",data:o.value,loading:p.value,title:"Registrasi"},null,8,["data","loading"]),a(Ua,{class:"q-mb-sm",title:"Identitas",data:O.value,loading:p.value,loadingImage:n.value,image:R(t)?.image_url||"/user-default.png"},{button:e(()=>[a(g,{class:"q-mt-sm full-width",icon:"upload","no-caps":"",label:"Foto",dense:"",size:"sm",outline:"",color:"green-10",onClick:P[1]||(P[1]=ta=>D.value=!0)})]),_:1},8,["data","loading","loadingImage","image"])]),w("div",Na,[a(xa,{"santri-id":R(l)},null,8,["santri-id"])])])]),_:1}),a(fa,{"img-format":"jpg","show-uploader":D.value,url:`/images/santri/${R(l)}`,onUpdateUploader:f,onSuccessUpload:r},null,8,["show-uploader","url"])]),_:1})}}};export{De as default};
