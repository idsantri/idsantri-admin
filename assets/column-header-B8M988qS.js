import{q as y,ap as O,s as G,Y as P,E as V,c as f,o as d,w as e,g as a,af as E,f as q,G as g,Q as C,a9 as K,l as A,au as R,a as D,e as S,b as I,v as k,F as J,D as W,t as b,J as Y}from"./index-BTpW0qoK.js";import{Q as M}from"./QSkeleton-BCz5Lxkz.js";import{Q as p}from"./QItemLabel-BqAZy4kr.js";import{Q as j,a as _}from"./QItem-DMT1Zy__.js";import{Q as z}from"./QList-BRj71z_v.js";import{Q as X}from"./QSelect-DLG5Hk7y.js";import{Q as Z}from"./QForm--SmQKvmu.js";import{_ as $}from"./InputSelectArray-BOnLbkCU.js";import{u as aa}from"./useCrudForm-M6ngSSEa.js";import{A as ea}from"./ApiCrud-D-UyIn70.js";import{_ as ta}from"./InputToggle-QfgHHKTE.js";import{_ as la}from"./CardSantriSimple-DC2Y4JlU.js";import{g as sa}from"./array-object-BytDdNh7.js";import{c as U}from"./format-date-DBaFa2rd.js";import{a as na}from"./hijri-m7PeZ38X.js";class ia extends ea{constructor(){super("mutaallim")}async getSantri(){return(await this._apiGet({endPoint:`${this._path}/santri`})).data}async getSantriId(u){return(await this._apiGet({endPoint:`${this._path}/santri/${u}`})).data}async aktif(){return(await this._apiGet({endPoint:`${this._path}/aktif`})).data}}const N=new ia,ra={__name:"QuranMutaallimForm",props:{data:{type:Object,required:!0}},emits:["successDelete","successSubmit","successUpdate","successCreate"],setup(s,{emit:u}){const i=s,c=u,t=y({marhalah:"Ula",faslah:null,no_absen:null,aktif:1,...i.data}),o=!i.data?.id,v=O("firstInput");G(async()=>{await P(),v.value&&v.value.focus()});const{handleDelete:w,handleCreate:h,handleUpdate:l,loading:n}=aa(N,{emit:c,responseKey:"mutaallim"}),x=async()=>{const Q={santri_id:t.value.santri_id,th_ajaran_h:t.value.th_ajaran_h,marhalah:t.value.marhalah,faslah:t.value.faslah,no_absen:t.value.no_absen,aktif:t.value.aktif};return o?await h(Q,!0):await l(i.data.id,Q,!0)},F=async()=>await w(i.data.id);return(Q,m)=>{const T=V("FormHeader"),H=V("FormLoading"),L=V("FormActions");return d(),f(A,{class:"full-width",style:{"max-width":"425px"}},{default:e(()=>[a(Z,{onSubmit:E(x,["prevent"])},{default:e(()=>[a(T,{title:"Input Pendidikan Quran","is-new":o}),g(n)?(d(),f(H,{key:0})):q("",!0),a(C,null,{default:e(()=>[a(K,{dense:"",outlined:"",label:"Nama","model-value":t.value?.nama+" ("+t.value?.santri_id+")",disable:"",filled:"",class:"q-my-sm"},null,8,["model-value"]),a($,{modelValue:t.value.th_ajaran_h,"onUpdate:modelValue":m[0]||(m[0]=r=>t.value.th_ajaran_h=r),url:"tahun-ajaran",label:"Tahun Ajaran *",sort:"desc",class:"q-my-sm",rules:[r=>!!r||"Harus diisi!"],selected:t.value.th_ajaran_h,ref_key:"firstInput",ref:v},null,8,["modelValue","rules","selected"]),a(X,{dense:"",outlined:"",modelValue:t.value.marhalah,"onUpdate:modelValue":m[1]||(m[1]=r=>t.value.marhalah=r),label:"Marhalah *",class:"q-my-sm",rules:[r=>!!r||"Harus diisi!"],options:["Ula","Wustho","Ulya"]},null,8,["modelValue","rules"]),a($,{modelValue:t.value.faslah,"onUpdate:modelValue":m[2]||(m[2]=r=>t.value.faslah=r),url:"faslah-quran",label:"Faslah/Kelas *",class:"q-my-sm",rules:[r=>!!r||"Harus diisi!"]},null,8,["modelValue","rules"]),a(ta,{modelValue:t.value.aktif,"onUpdate:modelValue":m[3]||(m[3]=r=>t.value.aktif=r),label:"Aktif",disable:!t.value.id},null,8,["modelValue","disable"])]),_:1}),a(L,{"btn-delete":!o,onOnDelete:F},null,8,["btn-delete"])]),_:1})]),_:1})}}},ua={key:0},Qa={__name:"MutaallimCard",props:{santri:{type:Object}},setup(s){const u=y(!1),i=y({}),c=y([]),t=y(!1);async function o(h){try{t.value=!0;const l=await N.getSantriId(h);c.value=l.mutaallim}catch(l){console.error("ðŸš€ ~ loadMutaallim ~ e:",l)}finally{t.value=!1}}R(async()=>{s.santri?.id?await o(s.santri.id):s.santri?.santri_id&&await o(s.santri.santri_id)});const v=()=>{i.value={santri_id:s.santri.id,nama:s.santri.nama},u.value=!0},w=h=>{i.value=sa(c,h),i.value.santri_id=s.santri.id,i.value.nama=s.santri.nama,u.value=!0};return(h,l)=>(d(),f(A,{flat:"",bordered:"",class:"",style:{width:"350px"}},{default:e(()=>[a(C,{class:"bg-green-7 text-green-11 q-pa-sm flex items-center justify-between"},{default:e(()=>[l[3]||(l[3]=D("div",null,"Riwayat Mutaallim",-1)),a(S,{icon:"add",outline:"",dense:"",class:"q-px-sm",disabled:!s.santri.id,onClick:v},null,8,["disabled"])]),_:1}),a(C,{class:"q-pa-sm"},{default:e(()=>[s.santri.id?(d(),f(la,{key:0,id:s.santri.id,class:"q-mb-sm"},null,8,["id"])):q("",!0),a(z,{bordered:"",separator:"",class:"rounded-borders"},{default:e(()=>[t.value?(d(),f(j,{key:0,class:"q-px-sm"},{default:e(()=>[a(_,null,{default:e(()=>[a(p,null,{default:e(()=>[a(M,{type:"text"})]),_:1}),a(p,{caption:""},{default:e(()=>[a(M,{type:"text"})]),_:1})]),_:1}),a(_,{avatar:""},{default:e(()=>[a(M,{type:"QRadio"})]),_:1})]),_:1})):c.value?.length?(d(!0),I(J,{key:2},W(c.value,(n,x)=>(d(),f(j,{key:x,active:!!n.aktif,"active-class":"bg-green-1 text-green-10",class:"q-px-sm"},{default:e(()=>[a(_,null,{default:e(()=>[a(p,null,{default:e(()=>[k(b(n.th_ajaran_h)+" | "+b(n.marhalah)+" | "+b(n.faslah),1)]),_:2},1024),a(p,{caption:""},{default:e(()=>[k(b(g(U)(n.created_at,"dd-MM-yyyy"))+" | "+b(g(na)(g(U)(n.created_at,"yyyy-MM-dd")))+" ",1),n.aktif?(d(),I("span",ua,[...l[6]||(l[6]=[D("span",null,"|",-1),D("span",{class:"text-weight-bold text-green-10"}," Aktif ",-1)])])):q("",!0)]),_:2},1024)]),_:2},1024),a(_,{avatar:""},{default:e(()=>[a(S,{icon:"edit",dense:"",outline:"",round:"",glossy:"",onClick:F=>w(n.id)},null,8,["onClick"])]),_:2},1024)]),_:2},1032,["active"]))),128)):(d(),f(j,{key:1,class:"q-px-sm"},{default:e(()=>[a(_,null,{default:e(()=>[a(p,null,{default:e(()=>[...l[4]||(l[4]=[k(" Tidak ada data ",-1)])]),_:1}),a(p,{caption:""},{default:e(()=>[...l[5]||(l[5]=[k(" untuk ditampilkan ",-1)])]),_:1})]),_:1}),a(_,{avatar:""},{default:e(()=>[a(S,{icon:"sym_o_exclamation",disable:"",dense:"",outline:"",round:"",color:"green-14"})]),_:1})]),_:1}))]),_:1})]),_:1}),a(Y,{modelValue:u.value,"onUpdate:modelValue":l[2]||(l[2]=n=>u.value=n)},{default:e(()=>[a(ra,{data:i.value,onSuccessSubmit:l[0]||(l[0]=n=>o(i.value.santri_id)),onSuccessDelete:l[1]||(l[1]=n=>o(i.value.santri_id))},null,8,["data"])]),_:1},8,["modelValue"])]),_:1}))}},B=[{name:"nama",label:"Nama",align:"left",field:"nama",sortable:!0},{name:"data_akhir",label:"Data Akhir",align:"left",field:"data_akhir",sortable:!0},{name:"th_ajaran_h",label:"Tahun Ajaran",align:"left",field:"th_ajaran_h",sortable:!0},{name:"marhalah",label:"Marhalah",align:"left",field:"marhalah",sortable:!0},{name:"faslah",label:"Faslah/Kelas",align:"left",field:"faslah",sortable:!0}],Va=[{name:"id",label:"ID Santri",align:"center",field:"id",sortable:!0},...B],Da=[{name:"santri_id",label:"ID Santri",align:"center",field:"santri_id",sortable:!0},...B];export{N as M,Qa as _,Da as a,Va as c};
