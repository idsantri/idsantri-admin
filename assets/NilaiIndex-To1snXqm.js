import{ad as B,q as x,s as E,E as D,c as g,o as n,w as t,g as e,n as T,v as f,p as K,e as h,Q as k,l as L,a as l,G as N,b as d,F,D as q,t as o,a4 as A}from"./index-DEh4UAKk.js";import{Q as H}from"./QItemLabel-CulQpTC_.js";import{Q as V,a as j}from"./QItem-BTdNNvAd.js";import{Q as z}from"./QList-DhKPmN5Y.js";import{Q as G}from"./QSpace-B1Gywt8k.js";import{Q as I}from"./QSkeleton-ZGeKECkT.js";import{Q as J,a as u}from"./QTable-6Gk1SYjv.js";import{Q as y}from"./QTr--0CoeY6I.js";import{Q as R}from"./QTd-CjulTPqJ.js";import{Q as O}from"./QMarkupTable-Cqq_cQ7g.js";import{C as U}from"./ClosePopup-BXwyq4AY.js";import{_ as W}from"./FilterKelas-NwyfS8SC.js";import{N as M}from"./NilaiMapel-Cy0PK4Rm.js";import{_ as X}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./QSelect-DNJsugZb.js";import"./QField-69w4fhxK.js";import"./QChip-lnLCnRVJ.js";import"./QMenu-CObjFV0N.js";import"./selection-KIVhQnt8.js";import"./rtl-DFPa-2ov.js";import"./format-CJebrXOQ.js";import"./use-fullscreen-DdVG38xO.js";import"./QToolbar-Dl5hvhW3.js";import"./lists-madrasah-store-BvqnPRbn.js";import"./Kelas-BJKsUCP6.js";import"./ApiCrud-DGpYTBeQ.js";import"./Api-Cf9F4lBj.js";import"./index-C8LJz6c6.js";import"./index-Cm_fkxN3.js";import"./apiPost-PqFHjFje.js";import"./AbsensiSetting-5kUUQKWg.js";const Y=["innerHTML"],Z={key:0},aa={key:1},ea={key:0},ta={key:1},la={key:2},ra={key:0},sa={key:1},ia={key:0,class:"text-italic text-negative"},na={key:1},oa={class:"text-left"},da={class:"text-left"},ua={class:"text-right"},_a={class:"text-right"},ma={class:"text-right"},ca={class:"text-right"},fa={class:"text-right"},pa={class:"bg-green-2 text-weight-bold text-right text-green-10"},ga={__name:"NilaiIndex",setup(ha){const{params:m}=B(),p=x([{}]),w=x(!1),C=x(""),c=x([{}]),Q=x([]),S=[{name:"no_absen",label:"No",align:"center",field:a=>a.no_absen,format:a=>`${a||""}`,sortable:!0},{name:"kelas_id",label:"ID Kelas",align:"center",field:a=>a.kelas_id,format:a=>`${a}`,sortable:!0},{name:"santri_id",label:"ID Santri",align:"center",field:a=>a.santri_id,format:a=>`${a}`,sortable:!0},{name:"nama",label:"Nama",align:"left",field:a=>a.nama,sortable:!0},{name:"rerata_1",label:"Rerata-1",align:"right",field:a=>a.rerata_1?parseFloat(a.rerata_1).toFixed(1):null,sortable:!0},{name:"rerata_2",label:"Rerata-2",align:"right",field:a=>a.rerata_2?parseFloat(a.rerata_2).toFixed(1):null,sortable:!0},{name:"rerata_3",label:"Rerata-3",align:"right",field:a=>a.rerata_3?parseFloat(a.rerata_3).toFixed(1):null,sortable:!0},{name:"rerata_4",label:"Rerata-4",align:"right",field:a=>a.rerata_4?parseFloat(a.rerata_4).toFixed(1):null,sortable:!0},{name:"rerata_akhir",label:"R. Akhir",align:"right",field:a=>a.rerata_akhir?parseFloat(a.rerata_akhir).toFixed(1):null,sortable:!0}];async function P(a){if(a.expand=!a.expand,a.expand)try{Q.value[a.key]=!0,c.value[a.key]=null;const i=await M.getAll({params:{kelas_id:a.key,category:"rapor"},notifySuccess:!1});c.value[a.key]=i.nilai}catch(i){console.error("üöÄ ~ expand ~ error:",i)}finally{Q.value[a.key]=!1}}E(async()=>{if(m.th_ajaran_h&&m.tingkat_id&&m.kelas)try{w.value=!0;const a=await M.rerata({th_ajaran_h:m.th_ajaran_h,tingkat_id:m.tingkat_id,kelas:m.kelas,category:"rapor"});p.value=a.nilai}catch(a){console.error("üöÄ ~ error:",a)}finally{w.value=!1}});function _(a,i){let b=0,v=0;if(a?.length){a.forEach(s=>{s[i]!==null&&(b+=parseFloat(s[i]),v++)});const r=b/v;return isNaN(r)?null:r.toFixed(1)}else return null}return(a,i)=>{const b=D("CardHeader"),v=D("CardPage");return n(),g(v,null,{default:t(()=>[e(b,{title:"Data Nilai Mata Pelajaran","show-reload":!1},{buttons:t(()=>[e(h,{icon:"settings_accessibility",label:"Nilai Ahwal",to:"/madrasah/nilai-ahwal",outline:"",dense:"","no-caps":"",class:"q-px-sm"})]),more:t(()=>[e(z,null,{default:t(()=>[T((n(),g(V,{to:"/madrasah/mapel"},{default:t(()=>[e(j,null,{default:t(()=>[e(H,null,{default:t(()=>[...i[1]||(i[1]=[f(" Mata Pelajaran ",-1)])]),_:1})]),_:1}),e(j,{avatar:""},{default:t(()=>[e(K,{name:"settings"})]),_:1})]),_:1})),[[U]])]),_:1})]),_:1}),e(k,{class:"q-pa-sm"},{default:t(()=>[e(W,{"show-ujian-ke":!1,"start-url":"/madrasah/nilai-mapel/rerata",onDataFilter:i[0]||(i[0]=r=>C.value=r),title:"Filter Data: <span class='text-weight-medium'>Nilai Mapel (Rerata)</span>"})]),_:1}),e(k,{class:"q-pa-sm"},{default:t(()=>[e(L,{class:"",bordered:"",flat:""},{default:t(()=>[e(k,{class:"bg-green-8 text-green-1 text-subtitle1 q-pa-sm flex flex-center"},{default:t(()=>[l("span",{innerHTML:C.value+" ‚û°Ô∏è <em class='text-weight-light'>Kategori: </em> <strong>Nilai Rapor</strong>"||""},null,8,Y),e(G),e(h,{dense:"",icon:"download",label:"Excel","no-caps":"",class:"bg-green-11 text-green-10 q-px-md q-mr-sm",to:"/madrasah/nilai-mapel/download"}),e(h,{dense:"",icon:"upload",label:"Excel","no-caps":"",class:"bg-green-11 text-green-10 q-px-md",to:"/madrasah/nilai-mapel/upload"})]),_:1}),!N(m).th_ajaran_h||!N(m).tingkat_id||!N(m).kelas?(n(),g(k,{key:0,class:"q-pa-sm"},{default:t(()=>[...i[2]||(i[2]=[l("div",{class:"text-center q-pa-lg text-negative text-italic"}," Tentukan Tahun Ajaran, Tingkat Pendidikan, dan Kelas! ",-1)])]),_:1})):(n(),g(k,{key:1,class:"q-pa-sm"},{default:t(()=>[w.value?(n(),d("div",Z,[e(I,{type:"text",height:"4rem"})])):(n(),d("div",aa,[e(J,{flat:"",rows:p.value,columns:S,"row-key":"kelas_id","rows-per-page-options":[10,25,50,100,0],class:"my-sticky-header-table"},{header:t(r=>[e(y,{props:r,class:""},{default:t(()=>[e(u),e(u),e(u),e(u),e(u,{class:"text-left"},{default:t(()=>[...i[3]||(i[3]=[f("Retata Kelas",-1)])]),_:1}),e(u,{class:"text-right"},{default:t(()=>[f(o(_(p.value,"rerata_1")),1)]),_:1}),e(u,{class:"text-right"},{default:t(()=>[f(o(_(p.value,"rerata_2")),1)]),_:1}),e(u,{class:"text-right"},{default:t(()=>[f(o(_(p.value,"rerata_3")),1)]),_:1}),e(u,{class:"text-right"},{default:t(()=>[f(o(_(p.value,"rerata_4")),1)]),_:1}),e(u,{class:"text-right"},{default:t(()=>[f(o(_(p.value,"rerata_akhir")),1)]),_:1})]),_:1},8,["props"]),e(y,{props:r},{default:t(()=>[e(u,{"auto-width":""},{default:t(()=>[...i[4]||(i[4]=[f("!",-1)])]),_:1}),(n(!0),d(F,null,q(r.cols,s=>(n(),g(u,{key:s.name,props:r},{default:t(()=>[f(o(s.label),1)]),_:2},1032,["props"]))),128))]),_:2},1032,["props"])]),body:t(r=>[e(y,{props:r},{default:t(()=>[e(R,{"auto-width":""},{default:t(()=>[e(h,{size:"sm",color:"green",round:"",dense:"",onClick:s=>P(r),icon:r.expand?"remove":"add"},null,8,["onClick","icon"])]),_:2},1024),(n(!0),d(F,null,q(r.cols,s=>(n(),g(R,{key:s.name,props:r},{default:t(()=>[s.name=="kelas_id"?(n(),d("span",ea,[e(h,{label:s.value,dense:"",outline:"",class:"q-px-md text-green-10",to:`/madrasah/kelas/${s.value}/nilai-mapel`},null,8,["label","to"])])):s.name=="santri_id"?(n(),d("span",ta,[e(h,{label:s.value,dense:"",outline:"",class:"q-px-md text-green-10",to:`/santri/${s.value}`},null,8,["label","to"])])):(n(),d("span",la,o(s.value),1))]),_:2},1032,["props"]))),128))]),_:2},1032,["props"]),T(e(y,{props:r},{default:t(()=>[e(R,{colspan:"100%"},{default:t(()=>[Q.value[r.row.kelas_id]?(n(),d("div",ra,[e(I,{height:"100px"})])):(n(),d("div",sa,[c.value[r.row.kelas_id]?.length==0?(n(),d("div",ia," Tidak ada data untuk ditampilkan! ")):(n(),d("div",na,[e(O,{flat:"",dense:"",class:"bg-green-1",separator:"cell"},{default:t(()=>[i[6]||(i[6]=l("thead",{class:"bg-green-2 text-weight-medium text-right"},[l("tr",null,[l("td",{class:"text-left",style:{width:"80px"}},"ID (Kode)"),l("td",{class:"text-left"},"Mata Pelajaran"),l("td",{style:{width:"50px"}},"N-1"),l("td",{style:{width:"50px"}},"N-2"),l("td",{style:{width:"50px"}},"N-3"),l("td",{style:{width:"50px"}},"N-4"),l("td",{style:{width:"65px"}},"Rerata")])],-1)),l("tbody",null,[(n(!0),d(F,null,q(c.value[r.row.kelas_id],(s,$)=>(n(),d("tr",{key:$},[l("td",oa,o(s.id),1),l("td",da,o(s.name),1),l("td",ua,o(s.nilai_1),1),l("td",_a,o(s.nilai_2),1),l("td",ma,o(s.nilai_3),1),l("td",ca,o(s.nilai_4),1),l("td",fa,o(s.rerata?parseFloat(s.rerata).toFixed(1):null),1)]))),128))]),l("tfoot",pa,[l("tr",null,[i[5]||(i[5]=l("td",{colspan:"2",class:"text-left"},"Rerata",-1)),l("td",null,o(_(c.value[r.row.kelas_id],"nilai_1")),1),l("td",null,o(_(c.value[r.row.kelas_id],"nilai_2")),1),l("td",null,o(_(c.value[r.row.kelas_id],"nilai_3")),1),l("td",null,o(_(c.value[r.row.kelas_id],"nilai_4")),1),l("td",null,o(_(c.value[r.row.kelas_id],"rerata")),1)])])]),_:2},1024)]))]))]),_:2},1024)]),_:2},1032,["props"]),[[A,r.expand]])]),_:1},8,["rows"])]))]),_:1}))]),_:1})]),_:1})]),_:1})}}},Ua=X(ga,[["__scopeId","data-v-31d074c4"]]);export{Ua as default};
