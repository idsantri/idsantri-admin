import{q as m,ap as M,s as F,Y as Q,E as D,c as k,o as w,w as c,g as o,af as h,f as B,G as b,Q as U,a9 as V,l as $,ad as q,A as E,b as N,J as O}from"./index-BTpW0qoK.js";import{_ as j}from"./TemplateArray-BNLHffrM.js";import{c as C}from"./format-date-DBaFa2rd.js";import{a as H}from"./hijri-m7PeZ38X.js";import{r as K,d as T,g as G}from"./array-object-BytDdNh7.js";import{Q as L}from"./QForm--SmQKvmu.js";import{_ as R}from"./InputSelectArray-BOnLbkCU.js";import{A as J}from"./ApiCrud-D-UyIn70.js";import{u as P}from"./useCrudForm-M6ngSSEa.js";import"./QItem-DMT1Zy__.js";import"./QItemLabel-BqAZy4kr.js";import"./QList-BRj71z_v.js";import"./id-BuNGTsqN.js";import"./format-number-B34ySHL_.js";import"./QSelect-DLG5Hk7y.js";import"./QField-Diu7Bopo.js";import"./QChip-PJDdAFrm.js";import"./QMenu-DhhOsA7X.js";import"./selection-Wm1ZT_By.js";import"./rtl-DFPa-2ov.js";import"./format-CJebrXOQ.js";import"./lists-store-CFSAcaS7.js";import"./ArrayCrud-DeaxgM1Q.js";import"./DropDownAfter-qGxemBGP.js";import"./QBtnDropdown-D9lR9qYp.js";import"./QBtnGroup-CFuSn3by.js";import"./ClosePopup-Cwi57LE1.js";import"./Lists-Sl_AHsvU.js";import"./Api-DQxWaKXW.js";import"./index-pGTdy6rp.js";import"./index-DSqU_ONB.js";import"./apiPost-CWVr4VWP.js";class Y extends J{constructor(){super("domisili")}async santri(l){return(await this._apiGet({endPoint:`${this._path}/santri/${l}`})).data}}const I=new Y,z={__name:"DomisiliForm",props:{data:{type:Object,required:!0}},emits:["successDelete","successSubmit","successUpdate","successCreate"],setup(f,{emit:l}){const i=f,r=l,e=m({...i.data}),n=!i.data?.id,u=M("firstInput");F(async()=>{await Q(),u.value&&u.value.focus()});const{handleDelete:v,handleCreate:_,handleUpdate:y,loading:g}=P(I,{emit:r,responseKey:"domisili"}),a=async()=>{const t={santri_id:e.value.santri_id,domisili:e.value.domisili,keterangan:e.value.keterangan};return n?await _(t,!0):await y(i.data.id,t,!0)},s=async()=>await v(i.data.id);return(t,p)=>{const S=D("FormHeader"),x=D("FormLoading"),A=D("FormActions");return w(),k($,{class:"full-width",style:{"max-width":"425px"}},{default:c(()=>[o(L,{onSubmit:h(a,["prevent"])},{default:c(()=>[o(S,{title:"Input Domisili","is-new":n}),b(g)?(w(),k(x,{key:0})):B("",!0),o(U,null,{default:c(()=>[o(V,{class:"q-my-sm",dense:"",outlined:"",label:"Nama","model-value":e.value?.nama+" ("+e.value?.santri_id+")",disable:"",filled:""},null,8,["model-value"]),o(R,{class:"q-my-sm",modelValue:e.value.domisili,"onUpdate:modelValue":p[0]||(p[0]=d=>e.value.domisili=d),url:"domisili",label:"Domisili *",rules:[d=>!!d||"Harus diisi!"],ref_key:"firstInput",ref:u},null,8,["modelValue","rules"]),o(V,{class:"q-my-sm",dense:"",outlined:"",label:"Keterangan",modelValue:e.value.keterangan,"onUpdate:modelValue":p[1]||(p[1]=d=>e.value.keterangan=d),autogrow:""},null,8,["modelValue"])]),_:1}),o(A,{"btn-delete":!n,onOnDelete:s},null,8,["btn-delete"])]),_:1})]),_:1})}}},Ae={__name:"SantriDomisili",setup(f){const l=m(!1),i=m(!1),r=m({}),e=m([]),n=m({}),{params:u}=q();async function v(){try{l.value=!0;const a=await I.santri(u.id);e.value=a.domisili,n.value=a.santri}catch{console.log("error get domisili")}finally{l.value=!1}}const _=E(()=>e.value.map(a=>({Tanggal:C(a.created_at,"dd-MM-yyyy")+" | "+H(C(a.created_at,"yyyy-MM-dd")),Domisili:a.domisili,Keterangan:a.keterangan||"-",id:a.id})));F(async()=>{await v()});const y=()=>{r.value={santri_id:n.value.id,nama:n.value.nama},i.value=!0},g=({id:a})=>{r.value=G(e,a),r.value.santri_id=n.value.id,r.value.nama=n.value.nama,i.value=!0};return(a,s)=>(w(),N("div",null,[o(j,{data:_.value,spinner:l.value,onAdd:y,onEdit:g},null,8,["data","spinner"]),o(O,{modelValue:i.value,"onUpdate:modelValue":s[3]||(s[3]=t=>i.value=t)},{default:c(()=>[o(z,{data:r.value,title:"Input Domisili",onSuccessDelete:s[0]||(s[0]=t=>b(T)(e.value,t)),onSuccessCreate:s[1]||(s[1]=t=>e.value.push(t)),onSuccessUpdate:s[2]||(s[2]=t=>b(K)(e.value,t.id,t))},null,8,["data"])]),_:1},8,["modelValue"])]))}};export{Ae as default};
