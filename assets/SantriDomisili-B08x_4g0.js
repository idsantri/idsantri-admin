import{q as m,E as g,c as b,o as D,w as u,g as s,af as x,f as M,G as w,Q,a9 as V,l as h,ad as B,A as I,s as U,b as $,J as q}from"./index-Ba6UWhY3.js";import{_ as E}from"./TemplateArray-Ch1z9xkr.js";import{c as C}from"./format-date-OVhbBx9F.js";import{a as N}from"./hijri-Bs48DFvR.js";import{r as O,d as j,g as H}from"./array-object-BytDdNh7.js";import{Q as K}from"./QForm-C3VJ4N9x.js";import{_ as G}from"./InputSelectArray-DqUoOqO0.js";import{A as L}from"./ApiCrud-8mMJRmXF.js";import{u as J}from"./useCrudForm-D5o-HzNO.js";import"./QItem-DG0wxRWx.js";import"./QItemLabel-DG2jRLkC.js";import"./QList-2dqJxDl-.js";import"./id-BuNGTsqN.js";import"./format-number-B34ySHL_.js";import"./QSelect-dWftgJmx.js";import"./QChip-DSNXL-H8.js";import"./QMenu-UHPuzKke.js";import"./selection-B-msF6Vz.js";import"./rtl-DFPa-2ov.js";import"./format-CJebrXOQ.js";import"./lists-store-DLBzkOkx.js";import"./ArrayCrud-CkcA-ixF.js";import"./DropDownAfter-BAo-xRt5.js";import"./QBtnDropdown-D5OU04bG.js";import"./QBtnGroup-BsC5WeWs.js";import"./ClosePopup-BhmlFoVH.js";import"./Lists-2WkfEIAv.js";import"./Api-BMf39EYj.js";import"./index-CQzYHC66.js";import"./index-ChQSy5Ts.js";import"./api-error-DVIp_c6X.js";class P extends L{constructor(){super("domisili")}async santri(l){return(await this._apiGet({endPoint:`${this._path}/santri/${l}`})).data}}const F=new P,R={__name:"DomisiliForm",props:{data:{type:Object,required:!0}},emits:["successDelete","successSubmit","successUpdate","successCreate"],setup(p,{emit:l}){const o=p,r=l,e=m({...o.data}),n=!o.data?.id,{handleDelete:c,handleCreate:v,handleUpdate:f,loading:_}=J(F,{emit:r,responseKey:"domisili"}),y=async()=>{const i={santri_id:e.value.santri_id,domisili:e.value.domisili,keterangan:e.value.keterangan};return n?await v(i,!0):await f(o.data.id,i,!0)},a=async()=>await c(o.data.id);return(i,t)=>{const k=g("FormHeader"),S=g("FormLoading"),A=g("FormActions");return D(),b(h,{class:"full-width",style:{"max-width":"425px"}},{default:u(()=>[s(K,{onSubmit:x(y,["prevent"])},{default:u(()=>[s(k,{title:"Input Domisili","is-new":n}),w(_)?(D(),b(S,{key:0})):M("",!0),s(Q,null,{default:u(()=>[s(V,{class:"q-my-sm",dense:"",outlined:"",label:"Nama","model-value":e.value?.nama+" ("+e.value?.santri_id+")",disable:"",filled:""},null,8,["model-value"]),s(G,{class:"q-my-sm",modelValue:e.value.domisili,"onUpdate:modelValue":t[0]||(t[0]=d=>e.value.domisili=d),url:"domisili",label:"Domisili *",rules:[d=>!!d||"Harus diisi!"]},null,8,["modelValue","rules"]),s(V,{class:"q-my-sm",dense:"",outlined:"",label:"Keterangan",modelValue:e.value.keterangan,"onUpdate:modelValue":t[1]||(t[1]=d=>e.value.keterangan=d),autogrow:""},null,8,["modelValue"])]),_:1}),s(A,{"btn-delete":!n,onOnDelete:a},null,8,["btn-delete"])]),_:1})]),_:1})}}},ke={__name:"SantriDomisili",setup(p){const l=m(!1),o=m(!1),r=m({}),e=m([]),n=m({}),{params:c}=B();async function v(){try{l.value=!0;const a=await F.santri(c.id);e.value=a.domisili,n.value=a.santri}catch{console.log("error get domisili")}finally{l.value=!1}}const f=I(()=>e.value.map(a=>({Tanggal:C(a.created_at,"dd-MM-yyyy")+" | "+N(C(a.created_at,"yyyy-MM-dd")),Domisili:a.domisili,Keterangan:a.keterangan||"-",id:a.id})));U(async()=>{await v()});const _=()=>{r.value={santri_id:n.value.id,nama:n.value.nama},o.value=!0},y=({id:a})=>{r.value=H(e,a),r.value.santri_id=n.value.id,r.value.nama=n.value.nama,o.value=!0};return(a,i)=>(D(),$("div",null,[s(E,{data:f.value,spinner:l.value,onAdd:_,onEdit:y},null,8,["data","spinner"]),s(q,{modelValue:o.value,"onUpdate:modelValue":i[3]||(i[3]=t=>o.value=t)},{default:u(()=>[s(R,{data:r.value,title:"Input Domisili",onSuccessDelete:i[0]||(i[0]=t=>w(j)(e.value,t)),onSuccessCreate:i[1]||(i[1]=t=>e.value.push(t)),onSuccessUpdate:i[2]||(i[2]=t=>w(O)(e.value,t.id,t))},null,8,["data"])]),_:1},8,["modelValue"])]))}};export{ke as default};
