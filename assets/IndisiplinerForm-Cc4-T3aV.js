import{a4 as j,q as H,A as _,U as D,c as w,o as S,w as c,b as t,B as y,ab as $,e as K,C as i,Q as h,a5 as g,x as A}from"./index-DwrbA0R8.js";import{Q as L}from"./QRating-0g1C7LP5.js";import{Q as F}from"./QSelect-CrgZ1FsI.js";import{Q as O}from"./QForm-DCEv1Ikv.js";import{b as U,m as q}from"./hijri-BBdEhqDI.js";import{i as x,f as z}from"./format-date-DlwYCgkJ.js";import{_ as M}from"./InputSelectSantriId-bdXDP9_G.js";import{l as R}from"./lists-store-Cp7AZ7Mr.js";import{_ as T}from"./DropDownAfter-D2Wgui76.js";import{L as N}from"./Lists-g9uME9Wy.js";import{_ as E}from"./InputSelectArray-DFe88pva.js";import{u as P}from"./useCrudForm-DF0rM6hG.js";import{A as G}from"./ApiCrud-KwrbSuI8.js";const C="tatib-santri",J={__name:"InputSelectTatibSantri",props:{modelValue:{},modelModifiers:{}},emits:["update:modelValue"],setup(k){const d=j(k,"modelValue"),u=H(()=>d.value?b(d.value.join("; ")):"Pilih pasal dilanggar");function b(s){let o="";const n=/\[(.*?)\]/g,p=s.match(n);return p&&(o=p.map(l=>l.slice(1,-1)).join(", ")),o}const e=_(!1),r=_([]),v=R(),m=C.replace(/-/g,"_");function f(s){let o=[];return s.length&&(o=s.filter(n=>n.val0.length!=1).map(n=>`[${n.val0}] ${n.val1}`)),o}D(async()=>{const s=v.getStateByKey(m);if(s.length)r.value=f(s);else{await V();const o=v.getStateByKey(m);r.value=f(o)}});async function V(){try{e.value=!0;const s=await N.getByKey(C);v.$patch({[m]:s[m]})}catch(s){console.log("error get list ",s)}finally{e.value=!1}}return(s,o)=>(S(),w(F,{dense:"",outlined:"",label:"Pasal dilanggar","emit-value":"","map-options":"",options:r.value,loading:e.value,behavior:"menu",clearable:"",multiple:"",hint:u.value,modelValue:d.value,"onUpdate:modelValue":o[0]||(o[0]=n=>d.value=n)},{after:c(()=>[t(T,{"route-to":"tatib-santri",onReload:V})]),_:1},8,["options","loading","hint","modelValue"]))}};class W extends G{constructor(){super("indisipliner")}}const X=new W,me={__name:"IndisiplinerForm",props:{data:Object},emits:["successDelete","successSubmit","successUpdate","successCreate"],setup(k,{emit:d}){const u=k,b=d,e=_({kategori:3}),r=!u.data?.id,{handleDelete:v,handleCreate:m,handleUpdate:f,loading:V}=P(X,{emit:b,responseKey:"indisipliner"});async function s(){const p={santri_id:e.value.santri_id,tgl_kasus:e.value.tgl_kasus,tgl_sidang:e.value.tgl_sidang,kategori:e.value.kategori,pasal:e.value.pasal?.join("; "),deskripsi:e.value.deskripsi,eksekutor:e.value.eksekutor,saksi:e.value.saksi,takzir:e.value.takzir?.join("; "),keterangan:e.value.keterangan};return r?await m(p,!0):await f(u.data.id,p,!0)}const o=async()=>await v(u.data.id);D(async()=>{Object.assign(e.value,u.data),e.value.pasal&&(e.value.pasal=e.value.pasal.split(",")),e.value.takzir&&(e.value.takzir=e.value.takzir.split(","))});const n=[{value:1,label:"Sangat Ringan"},{value:2,label:"Ringan"},{value:3,label:"Sedang"},{value:4,label:"Berat"},{value:5,label:"Sangat Berat"}];return(p,l)=>{const Q=y("FormHeader"),B=y("FormLoading"),I=y("FormActions");return S(),w(A,{class:"full-width",style:{"max-width":"425px"}},{default:c(()=>[t(O,{onSubmit:$(s,["prevent"])},{default:c(()=>[t(Q,{title:"Input Santri Indisipliner","is-new":r}),i(V)?(S(),w(B,{key:0})):K("",!0),t(h,{class:"q-pa-sm"},{default:c(()=>[t(M,{"active-only":!0,onEmitInput:l[0]||(l[0]=a=>Object.assign(e.value,a)),data:u.data,class:"q-my-sm"},null,8,["data"]),t(g,{dense:"",hint:i(x)(e.value.tgl_kasus)?i(z)(e.value.tgl_kasus)+" | "+i(U)(i(q)(e.value.tgl_kasus)):"",class:"q-my-sm",outlined:"",label:"Tanggal Kasus*",modelValue:e.value.tgl_kasus,"onUpdate:modelValue":l[1]||(l[1]=a=>e.value.tgl_kasus=a),type:"date",rules:[a=>!!a||"Harus diisi!"],"error-color":"negative"},null,8,["hint","modelValue","rules"]),t(g,{dense:"",hint:i(x)(e.value.tgl_sidang)?i(z)(e.value.tgl_sidang)+" | "+i(U)(i(q)(e.value.tgl_sidang)):"",class:"q-my-sm",outlined:"",label:"Tanggal Sidang*",modelValue:e.value.tgl_sidang,"onUpdate:modelValue":l[2]||(l[2]=a=>e.value.tgl_sidang=a),type:"date",rules:[a=>!!a||"Harus diisi!"],"error-color":"negative"},null,8,["hint","modelValue","rules"]),t(F,{dense:"",modelValue:e.value.kategori,"onUpdate:modelValue":l[4]||(l[4]=a=>e.value.kategori=a),class:"q-my-sm",outlined:"",label:"Kategori*",options:n,"emit-value":"","map-options":"",rules:[a=>!!a||"Harus diisi!"],"error-color":"negative",behavior:"menu"},{after:c(()=>[t(L,{class:"",name:"kategori",modelValue:e.value.kategori,"onUpdate:modelValue":l[3]||(l[3]=a=>e.value.kategori=a),max:"5",color:"red",icon:"thumb_down","icon-selected":"thumb_down",size:"1em"},null,8,["modelValue"])]),_:1},8,["modelValue","rules"]),t(J,{class:"q-my-sm",modelValue:e.value.pasal,"onUpdate:modelValue":l[5]||(l[5]=a=>e.value.pasal=a),rules:[a=>!!a||"Harus diisi!"]},null,8,["modelValue","rules"]),t(g,{dense:"",class:"q-my-sm",outlined:"",label:"Deskripsi",modelValue:e.value.deskripsi,"onUpdate:modelValue":l[6]||(l[6]=a=>e.value.deskripsi=a),autogrow:""},null,8,["modelValue"]),t(g,{dense:"",class:"q-my-sm",outlined:"",label:"Eksekutor",modelValue:e.value.eksekutor,"onUpdate:modelValue":l[7]||(l[7]=a=>e.value.eksekutor=a),rules:[a=>!!a||"Harus diisi!"],"error-color":"negative"},null,8,["modelValue","rules"]),t(g,{dense:"",class:"q-my-sm",outlined:"",label:"Saksi",modelValue:e.value.saksi,"onUpdate:modelValue":l[8]||(l[8]=a=>e.value.saksi=a)},null,8,["modelValue"]),t(E,{modelValue:e.value.takzir,"onUpdate:modelValue":l[9]||(l[9]=a=>e.value.takzir=a),url:"takzir-santri",label:"Takzir",class:"q-my-sm",multiple:""},null,8,["modelValue"]),t(g,{dense:"",class:"q-my-sm",outlined:"",label:"Keterangan",modelValue:e.value.keterangan,"onUpdate:modelValue":l[10]||(l[10]=a=>e.value.keterangan=a),autogrow:""},null,8,["modelValue"])]),_:1}),t(I,{"btn-delete":!r,onOnDelete:o},null,8,["btn-delete"])]),_:1})]),_:1})}}};export{me as _};
