import{Q as f}from"./QItemLabel-97msGuv9.js";import{Q as y,a as h}from"./QItemSection-CL0X_XCy.js";import{Q as P}from"./QSelect-D99lhOsm.js";import{a2 as S,v as r,R as k,f as I,o as N,w as o,i as l,a8 as q,Q as x,bF as C,bG as D,j as v,t as m,a4 as u,m as T,n as _,p,Z as G,q as U}from"./index-Cju_WcQt.js";import{Q as B}from"./QSpace-e5nOhYJp.js";import{Q as $}from"./QForm-B-IeWzDf.js";import{C as E}from"./ClosePopup-POBKOZoS.js";import{a as H}from"./api-get-C-ZFMqL_.js";import{a as L}from"./api-post-P8g4q4LG.js";import{a as M}from"./api-update-Dm-9pXju.js";import{a as O}from"./api-delete-BEmNpbPy.js";import{l as R}from"./loading-store-By6xlJ3p.js";import{_ as A}from"./FormHeader-BlagXmst.js";import{_ as F}from"./InputSelectSantriId-BlpghIQA.js";import{_ as J}from"./InputSelectArray-G7sFmwYz.js";const da={__name:"GtCrud",props:{isNew:Boolean,data:Object},emits:["successSubmit","successDelete"],setup(b,{emit:j}){const{loadingMain:d}=S(R()),s=b,g=j,a=r({}),i=r([]),c=r(!1);function w(){a.value.pjgt_nama=i.value.find(n=>n.id==a.value?.pjgt_id)?.nama,a.value.pjgt_wilayah=i.value.find(n=>n.id==a.value?.pjgt_id)?.wilayah}async function V(){const n={pjgt_id:a.value.pjgt_id,santri_id:a.value.santri_id,th_ajaran_h:a.value.th_ajaran_h,telepon:a.value.telepon,email:a.value.email,keterangan:a.value.keterangan};let t=null;s.isNew?t=await L({endPoint:"ugt/gt",data:n,loading:d}):t=await M({endPoint:`ugt/gt/${a.value.id}`,data:n,confirm:!0,notify:!0,loading:d}),t&&(document.getElementById("btn-close-crud").click(),g("successSubmit",t?.gt))}const Q=async()=>{await O({endPoint:`ugt/gt/${a.value.id}`,loading:d})&&(document.getElementById("btn-close-crud").click(),g("successDelete"))};return k(async()=>{Object.assign(a.value,s.data);const n=await H({endPoint:"ugt/pjgt",loading:c});i.value=n.pjgt}),(n,t)=>(N(),I(U,{class:"full-width",style:{"max-width":"425px"}},{default:o(()=>[l($,{onSubmit:q(V,["prevent"])},{default:o(()=>[l(A,{title:"Input Data GT","is-new":s.isNew},null,8,["is-new"]),l(x,{class:"q-pa-sm"},{default:o(()=>[l(F,{"active-only":!0,onEmitInput:t[0]||(t[0]=e=>Object.assign(a.value,e)),data:s.data},null,8,["data"]),l(P,{class:"q-mt-sm",dense:"",outlined:"",label:"PJGT ID*",modelValue:a.value.pjgt_id,"onUpdate:modelValue":[t[1]||(t[1]=e=>a.value.pjgt_id=e),w],options:i.value,"emit-value":"","map-options":"","option-value":"id","option-label":"id","error-color":"negative",loading:c.value,"use-input":"",clearable:"",behavior:"menu"},{option:o(e=>[l(y,C(D(e.itemProps)),{default:o(()=>[l(h,null,{default:o(()=>[l(f,null,{default:o(()=>[v(m(e.opt.id)+" â€” "+m(e.opt.nama),1)]),_:2},1024),l(f,{caption:""},{default:o(()=>[v(m(e.opt.wilayah),1)]),_:2},1024)]),_:2},1024)]),_:2},1040)]),_:1},8,["modelValue","options","loading"]),l(u,{dense:"",hint:a.value.pjgt_wilayah,class:"q-mt-sm",outlined:"",label:"Nama PJGT",modelValue:a.value.pjgt_nama,"onUpdate:modelValue":t[2]||(t[2]=e=>a.value.pjgt_nama=e),disable:"",filled:""},null,8,["hint","modelValue"]),l(J,{modelValue:a.value.th_ajaran_h,"onUpdate:modelValue":t[3]||(t[3]=e=>a.value.th_ajaran_h=e),url:"tahun-ajaran",label:"Tahun Ajaran *",sort:"desc",class:"q-mt-sm",rules:[e=>!!e||"Harus diisi!"],selected:a.value.th_ajaran_h},null,8,["modelValue","rules","selected"]),l(u,{dense:"",hint:"08123456789",class:"q-mt-sm",outlined:"",label:"Telepon",modelValue:a.value.telepon,"onUpdate:modelValue":t[4]||(t[4]=e=>a.value.telepon=e),rules:[e=>!e||!isNaN(e)||"Hanya angka!"],"error-color":"negative"},null,8,["modelValue","rules"]),l(u,{dense:"",class:"q-mt-sm",outlined:"",label:"Email GT",modelValue:a.value.email,"onUpdate:modelValue":t[5]||(t[5]=e=>a.value.email=e)},null,8,["modelValue"]),l(u,{dense:"",class:"q-mt-sm",outlined:"",label:"Keterangan",modelValue:a.value.keterangan,"onUpdate:modelValue":t[6]||(t[6]=e=>a.value.keterangan=e),autogrow:""},null,8,["modelValue"])]),_:1}),l(T,{class:"flex bg-green-6"},{default:o(()=>[_(l(p,{label:"Hapus",class:"bg-red text-red-1","no-caps":"",onClick:Q},null,512),[[G,!n.$props.isNew]]),l(B),_(l(p,{label:"Tutup",class:"bg-green-11","no-caps":"",id:"btn-close-crud"},null,512),[[E]]),l(p,{type:"submit",label:"Simpan",class:"bg-green-10 text-green-11","no-caps":""})]),_:1})]),_:1})]),_:1}))}};export{da as _};
