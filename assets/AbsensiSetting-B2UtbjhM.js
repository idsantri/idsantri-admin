import{Q as T}from"./QSelect-CFPp42HH.js";import{B as u,X as $,C as I,c as F,o as r,w as l,g as a,Q as g,l as q,y,t as L,b as v,a as f,F as A,A as D,ae as Q,a8 as d,e as b}from"./index-BxW-Zl0Y.js";import{Q as U,a as k}from"./QItemSection-Bb15NIFh.js";import{Q as S}from"./QBtnGroup-CADL4x2_.js";import{Q as x}from"./QForm-BpJT9KkR.js";import{a as G}from"./api-delete-DVooG0LH.js";import{a as V}from"./api-get-Voz9MJxZ.js";import{a as K}from"./api-post-BLbzhtF7.js";import{a as M}from"./api-update-DI117ad0.js";import"./QChip-QYCUWT9t.js";import"./QItemLabel-mC5VkLuy.js";import"./QMenu-BSoZfA32.js";import"./selection-B5a09GT2.js";import"./rtl-DFPa-2ov.js";import"./format-CJebrXOQ.js";import"./index-BVb4nAdI.js";import"./index-BSCwVkgJ.js";import"./api-error-CztaqWte.js";const E={key:0},R={class:"row"},X={class:"row"},z={key:1,class:"q-my-md text-center"},ge={__name:"AbsensiSetting",setup(J){const o=u(""),j=u([]),_=u([{}]),w=u([{}]),m=u(!1),p=u(!1),i=u({});async function h(){if(i.value.tingkat_id=o.value.val0,await K({endPoint:"absensi/settings",data:i.value}))return i.value={},c(o.value.val0)}async function B(n){if(await G({endPoint:`absensi/settings/${n}`,loading:p}))return c(o.value.val0)}async function P(n){await M({endPoint:`absensi/settings/${n.id}`,data:{bulan:n.bulan,ujian:n.ujian,tingkat_id:n.tingkat_id},loading:p,confirm:!1}),await c(n.tingkat_id)}async function C(){const n=await V({endPoint:"lists/tingkat-pendidikan",loading:m});j.value=n.tingkat_pendidikan}async function N(){const n=await V({endPoint:"lists/bulan-hijri",loading:m});_.value=n.bulan_hijri}async function c(n){const s=await V({endPoint:`absensi/settings?tingkat_id=${n}`,loading:p});w.value=s.bulan_ujian}return $(async()=>{await C(),await N()}),(n,s)=>{const H=I("CardLoading");return r(),F(q,{class:"",style:{"max-width":"600px"},bordered:"",flat:""},{default:l(()=>[a(g,{class:"q-pa-sm"},{default:l(()=>[a(T,{dense:"",outlined:"",label:"Pilih Tingkat Pendidikan",modelValue:o.value,"onUpdate:modelValue":[s[0]||(s[0]=e=>o.value=e),s[1]||(s[1]=e=>c(e.val0))],options:j.value,"emit-value":"","map-options":"","option-label":"val1",loading:m.value,behavior:"menu"},null,8,["modelValue","options","loading"]),a(q,{class:"q-mt-sm"},{default:l(()=>[a(g,{class:"bg-green-7 text-green-1 text-subtitle1 q-pa-sm"},{default:l(()=>[y(" Tingkat Pendidikan: "+L(o.value.val1),1)]),_:1}),a(g,{class:"q-pa-sm"},{default:l(()=>[o.value?(r(),v("div",E,[f("div",null,[(r(!0),v(A,null,D(w.value,e=>(r(),v("div",{key:e.id},[a(x,{onSubmit:Q(t=>P(e),["prevent"])},{default:l(()=>[a(U,{class:"no-padding"},{default:l(()=>[a(k,null,{default:l(()=>[f("div",R,[a(d,{label:"Ujian Ke-?",class:"col-3 q-pr-sm",dense:"",outlined:"",modelValue:e.ujian,"onUpdate:modelValue":t=>e.ujian=t,required:"",mask:"#",rules:[t=>!!t||"Harus diisi!",t=>t>=1&&t<=3||"1, 2, atau 3!"]},null,8,["modelValue","onUpdate:modelValue","rules"]),a(d,{label:"Bulan",class:"col-3 q-pr-sm",dense:"",outlined:"",modelValue:e.bulan,"onUpdate:modelValue":t=>e.bulan=t,required:"",mask:"##",rules:[t=>!!t||"Harus diisi!",t=>t>=1&&t<=12||"1 hingga 12!"]},null,8,["modelValue","onUpdate:modelValue","rules"]),a(d,{class:"col-6",dense:"",outlined:"","model-value":_.value.find(t=>Number(t.val2)==Number(e.bulan))?.val1||"",readonly:""},null,8,["model-value"])])]),_:2},1024),a(k,{side:"",class:"no-padding q-ml-sm"},{default:l(()=>[a(S,{push:"",class:"q-mb-lg"},{default:l(()=>[a(b,{color:"positive",glossy:"",icon:"save",type:"submit"}),a(b,{color:"negative",glossy:"",icon:"delete",onClick:t=>B(e.id)},null,8,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1032,["onSubmit"])]))),128)),a(x,{onSubmit:Q(h,["prevent"]),onReset:s[4]||(s[4]=e=>i.value={})},{default:l(()=>[a(U,{class:"no-padding",style:{"justify-content":"start"}},{default:l(()=>[a(k,null,{default:l(()=>[f("div",X,[a(d,{label:"Ujian Ke-?",class:"col-3 q-pr-sm",dense:"",outlined:"",modelValue:i.value.ujian,"onUpdate:modelValue":s[2]||(s[2]=e=>i.value.ujian=e),required:"",mask:"#",rules:[e=>!!e||"Harus diisi!",e=>e>=1&&e<=3||"1, 2, atau 3!"]},null,8,["modelValue","rules"]),a(d,{label:"Bulan",class:"col-3 q-pr-sm",dense:"",outlined:"",modelValue:i.value.bulan,"onUpdate:modelValue":s[3]||(s[3]=e=>i.value.bulan=e),required:"",mask:"##",rules:[e=>!!e||"Harus diisi!",e=>e>=1&&e<=12||"1 hingga 12!"]},null,8,["modelValue","rules"]),a(d,{class:"col-6",dense:"",outlined:"",readonly:"","model-value":_.value.find(e=>Number(e.val2)==Number(i.value.bulan))?.val1||""},null,8,["model-value"])])]),_:1}),a(k,{side:"",class:"no-padding q-ml-sm"},{default:l(()=>[a(S,{push:"",class:"q-mb-lg"},{default:l(()=>[a(b,{color:"positive",glossy:"",icon:"save",type:"submit"}),a(b,{color:"negative",glossy:"",icon:"undo",type:"reset"})]),_:1})]),_:1})]),_:1})]),_:1})])])):(r(),v("div",z,"Silakan pilih list tingkat pendidikan!"))]),_:1}),a(g,{class:"bg-green-6 text-green-1 text-caption text-italic q-pa-sm"},{default:l(()=>[...s[5]||(s[5]=[y(" Ujian (1, 2) jika menganut sistem semester atau kuartal (mid semester) ",-1),f("br",null,null,-1),y(" Ujian (1, 2, 3) jika menganut sistem catur wulan ",-1)])]),_:1}),a(H,{showing:m.value||p.value},null,8,["showing"])]),_:1})]),_:1})]),_:1})}}};export{ge as default};
