import{Q as A}from"./QToolbarTitle-CH0GyKDM.js";import{A as d,U as F,J as O,B as C,c as D,o as G,w as t,b as a,ab as J,e as M,C as V,Q as w,a5 as k,x as $,a as B,t as r,g as K,z as g,a1 as L,E as N}from"./index-DwrbA0R8.js";import{Q as P}from"./QToolbar-BCLZ34c-.js";import{Q as m}from"./QTd-CWnMEFGa.js";import{Q as H}from"./QTr-R9A0HBj-.js";import{Q as R}from"./QTable-BIqFScuN.js";import{Q as z}from"./QPage-BU8r9xHl.js";import{a as E}from"./api-get-D4W4lze7.js";import{d as S}from"./format-number-B34ySHL_.js";import{Q as W}from"./QSelect-CrgZ1FsI.js";import{Q as X}from"./QForm-DCEv1Ikv.js";import{_ as Y}from"./InputCurrency-eCUqEcSC.js";import{u as Z}from"./useCrudForm-DF0rM6hG.js";import{A as h}from"./ApiCrud-KwrbSuI8.js";import{U as ee}from"./UgtGt-DPyYeUC8.js";import{_ as ae}from"./ReportViewer-25QRZbnp.js";import"./QList-Cc6jCv1k.js";import"./QMarkupTable-DzcRgr6j.js";import"./use-fullscreen-C-VxiWHj.js";import"./index-B6LiMDVO.js";import"./index-BlZcD66n.js";import"./api-error-DGWaEiw1.js";import"./QChip-DvUCR8tL.js";import"./QItemSection-CeSY4hvW.js";import"./QItemLabel-Dzdetwv2.js";import"./QMenu-BEnErdhw.js";import"./selection-DRCgFU0J.js";import"./rtl-DFPa-2ov.js";import"./format-CJebrXOQ.js";import"./Api-DWdZFNbG.js";class le extends h{constructor(){super("ugt/kas")}}const te=new le,ne={__name:"UgtKasForm",props:{data:Object},emits:["successDelete","successSubmit","successUpdate","successCreate"],setup(Q,{emit:y}){const f=Q,b=y,n=d({keperluan:"Biaya Administrasi GT",keterangan:"Lunas",flag:"+"}),p=d(!1),i=d({}),c=!f.data?.id,{handleDelete:U,handleCreate:v,handleUpdate:q,loading:_}=Z(te,{emit:b,responseKey:"kas"});F(async()=>{Object.assign(n.value,f.data)});const x=async()=>{const e=JSON.parse(JSON.stringify(n.value));return delete e.id,c?await v(e,!0):await q(f.data.id,e,!0)},s=async()=>await U(f.data.id);async function o(e){try{p.value=!0;const l=await ee.getById({id:e,notifySuccess:!1});i.value=l.gt}catch{i.value.nama="Data tidak ditemukan",i.value.pjgt_nama="Data tidak ditemukan"}finally{p.value=!1}}return O(()=>n.value.gt_id,async(e,l)=>{i.value.nama="",i.value.pjgt_nama="",e!=l&&await o(e)},{immediate:!0}),(e,l)=>{const T=C("FormHeader"),I=C("FormLoading"),j=C("FormActions");return G(),D($,{class:"full-width",style:{"max-width":"425px"}},{default:t(()=>[a(X,{onSubmit:J(x,["prevent"])},{default:t(()=>[a(T,{title:"Input Kas UGT","is-new":c}),V(_)?(G(),D(I,{key:0})):M("",!0),a(w,{class:"q-pa-sm"},{default:t(()=>[a(k,{dense:"",hint:"Diisi oleh sistem",class:"",outlined:"",label:"ID",modelValue:n.value.id,"onUpdate:modelValue":l[0]||(l[0]=u=>n.value.id=u),disable:"",filled:""},null,8,["modelValue"]),a($,{class:"q-my-sm",flat:"",bordered:""},{default:t(()=>[a(w,{class:"q-pa-sm"},{default:t(()=>[l[8]||(l[8]=B("div",{class:"text-caption"}," Jika terkait dengan administrasi GT ",-1)),a(k,{dense:"",class:"q-my-sm",outlined:"",label:"GT ID",modelValue:n.value.gt_id,"onUpdate:modelValue":l[1]||(l[1]=u=>n.value.gt_id=u),clearable:"",debounce:"500"},null,8,["modelValue"]),a(k,{dense:"",class:"q-my-sm",outlined:"",label:"Nama GT",modelValue:i.value.nama,"onUpdate:modelValue":l[2]||(l[2]=u=>i.value.nama=u),disable:"",filled:"",loading:p.value},null,8,["modelValue","loading"]),a(k,{dense:"",class:"q-my-sm",outlined:"",label:"Nama PJGT",modelValue:i.value.pjgt_nama,"onUpdate:modelValue":l[3]||(l[3]=u=>i.value.pjgt_nama=u),disable:"",filled:"",loading:p.value},null,8,["modelValue","loading"])]),_:1})]),_:1}),a(k,{dense:"",class:"q-my-sm",outlined:"",label:"Keperluan",modelValue:n.value.keperluan,"onUpdate:modelValue":l[4]||(l[4]=u=>n.value.keperluan=u)},null,8,["modelValue"]),a(W,{dense:"",class:"q-my-sm",outlined:"",label:"Kas Masuk/Keluar",modelValue:n.value.flag,"onUpdate:modelValue":l[5]||(l[5]=u=>n.value.flag=u),options:[{value:"+",label:"Masuk"},{value:"-",label:"Keluar"}],"emit-value":"","map-options":"","error-color":"negative",behavior:"menu"},null,8,["modelValue"]),a(Y,{dense:"",class:"q-my-sm",outlined:"",modelValue:n.value.nominal,"onUpdate:modelValue":l[6]||(l[6]=u=>n.value.nominal=u),required:"",label:"Nominal"},null,8,["modelValue"]),a(k,{dense:"",class:"q-my-sm",outlined:"",label:"Keterangan",modelValue:n.value.keterangan,"onUpdate:modelValue":l[7]||(l[7]=u=>n.value.keterangan=u),autogrow:""},null,8,["modelValue"])]),_:1}),a(j,{"btn-delete":!c,onOnDelete:s},null,8,["btn-delete"])]),_:1})]),_:1})}}},oe={class:"q-gutter-sm"},Be={__name:"KasIndex",setup(Q){const y=d([]),f=d(!1),b=d(""),n=d(!1),p=d({}),i=d("");async function c(){n.value=!1;const s=await E({endPoint:"ugt/kas",loading:f});s&&(y.value=s.kas)}function U(){p.value={},n.value=!0}const v=d(!1);async function q(s){i.value=`reports/ugt/kuitansi/view?id=${s.id}`,v.value=!0}function _(s){const o=s.masuk?"+":"-",e=s.masuk||s.keluar,l={id:s.id,gt_id:s.gt_id,keperluan:s.keperluan,keterangan:s.keterangan,flag:o,nominal:e};p.value=l,n.value=!0}F(async()=>{await c()});const x=[{name:"id",label:"ID",align:"left",field:"id",sortable:!0},{name:"tgl_m",label:"Tanggal",align:"left",field:"tgl_m",sortable:!0},{name:"keperluan",label:"Keperluan",align:"left",field:"keperluan",sortable:!0},{name:"keterangan",label:"Keterangan",align:"left",field:"keterangan",sortable:!0},{name:"masuk",label:"Masuk",align:"right",field:"masuk",sortable:!0},{name:"keluar",label:"Keluar",align:"right",field:"keluar",sortable:!0},{name:"saldo",label:"Saldo",align:"right",field:"saldo",sortable:!0},{name:"cr_by",label:"By",align:"left",field:"cr_by",sortable:!0},{name:"edit",label:"!",align:"center",field:"",sortable:!1}];return(s,o)=>(G(),D(z,{class:"q-pa-sm"},{default:t(()=>[a($,{class:""},{default:t(()=>[a(w,{class:"bg-green-8 no-padding"},{default:t(()=>[a(P,{class:"no-padding no-margin"},{default:t(()=>[a(A,{class:"text-subtitle1 q-ml-sm text-green-11"},{default:t(()=>[...o[6]||(o[6]=[r(" Kas UGT ",-1)])]),_:1}),a(K,{dense:"",class:"q-px-md q-mr-sm text-green-10",label:"Tambah","no-caps":"",icon:"add",color:"green-2",onClick:U})]),_:1})]),_:1}),a(w,{class:"no-padding"},{default:t(()=>[a(R,{rows:y.value,loading:f.value,"rows-per-page-options":[10,25,50,100,0],pagination:{page:999},class:"dt q-px-sm",columns:x,filter:b.value,"no-data-label":"Tidak ada data untuk ditampilkan!","no-results-label":"Tidak ditemukan kata kunci yang sesuai dengan pencarian Anda!","row-key":"name",onRowClick:o[1]||(o[1]=(e,l,T)=>_(e,l,T))},{"top-right":t(()=>[a(k,{outlined:"",dense:"",debounce:"300",modelValue:b.value,"onUpdate:modelValue":o[0]||(o[0]=e=>b.value=e),placeholder:"Cari"},{append:t(()=>[a(L,{name:"search"})]),_:1},8,["modelValue"])]),body:t(e=>[a(H,{props:e},{default:t(()=>[a(m,{key:"id",props:e},{default:t(()=>[r(g(e.row.id),1)]),_:2},1032,["props"]),a(m,{key:"tgl_m",props:e},{default:t(()=>[r(g(e.row.tgl_m),1)]),_:2},1032,["props"]),a(m,{key:"keperluan",props:e},{default:t(()=>[r(g(e.row.gt_id?`${e.row.keperluan} (${e.row.gt_id})`:e.row.keperluan),1)]),_:2},1032,["props"]),a(m,{key:"keterangan",props:e},{default:t(()=>[r(g(e.row.keterangan),1)]),_:2},1032,["props"]),a(m,{key:"masuk",props:e},{default:t(()=>[r(g(V(S)(e.row.masuk)),1)]),_:2},1032,["props"]),a(m,{key:"keluar",props:e},{default:t(()=>[r(g(V(S)(e.row.keluar)),1)]),_:2},1032,["props"]),a(m,{key:"saldo",props:e},{default:t(()=>[r(g(V(S)(e.row.saldo)),1)]),_:2},1032,["props"]),a(m,{key:"cr_by",props:e},{default:t(()=>[r(g(e.row.cr_by),1)]),_:2},1032,["props"]),a(m,{key:"edit",props:e},{default:t(()=>[B("div",oe,[a(K,{icon:"edit","no-caps":"",color:"green-10",outline:"",dense:"",class:"q-px-md",onClick:l=>_(e.row)},null,8,["onClick"]),a(K,{icon:"print","no-caps":"",color:"green-10",outline:"",dense:"",class:"q-px-md",onClick:l=>q(e.row),disable:!e.row.gt_id},null,8,["onClick","disable"])])]),_:2},1032,["props"])]),_:2},1032,["props"])]),_:1},8,["rows","loading","filter"])]),_:1})]),_:1}),a(N,{persistent:"",modelValue:n.value,"onUpdate:modelValue":o[4]||(o[4]=e=>n.value=e)},{default:t(()=>[a(ne,{data:p.value,onSuccessSubmit:o[2]||(o[2]=e=>c()),onSuccessDelete:o[3]||(o[3]=e=>c())},null,8,["data"])]),_:1},8,["modelValue"]),a(N,{modelValue:v.value,"onUpdate:modelValue":o[5]||(o[5]=e=>v.value=e)},{default:t(()=>[a(ae,{url:i.value},null,8,["url"])]),_:1},8,["modelValue"])]),_:1}))}};export{Be as default};
