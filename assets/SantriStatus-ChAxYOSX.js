import{q as u,ap as Q,s as C,Y as A,E as g,c as k,o as S,w as c,g as o,af as B,f as U,G as w,Q as q,a9 as V,l as E,ad as N,A as O,b as h,J as j}from"./index-BjwPH8FF.js";import{_ as H}from"./TemplateArray-BOKb9xpI.js";import{c as F}from"./format-date-DBaFa2rd.js";import{a as K}from"./hijri-m7PeZ38X.js";import{r as T,d as $,g as L}from"./array-object-BytDdNh7.js";import{Q as R}from"./QForm-B-tb8GAo.js";import{_ as G}from"./InputSelectArray-m6KANiN-.js";import{S as D}from"./Status-BTJNgp7k.js";import{u as J}from"./useCrudForm-d1k0sjgN.js";import"./QItem-CsqH32k4.js";import"./QItemLabel-BFTSoDAR.js";import"./QList-B01KHQyb.js";import"./id-BuNGTsqN.js";import"./format-number-B34ySHL_.js";import"./QSelect-DG0UTNMZ.js";import"./QField-ByOWwheS.js";import"./QChip-DvWKrUSh.js";import"./QMenu-BekTf8G3.js";import"./selection-DiJ6Q-Vu.js";import"./rtl-DFPa-2ov.js";import"./format-CJebrXOQ.js";import"./lists-store-MtkfrqvS.js";import"./ArrayCrud-DeaxgM1Q.js";import"./DropDownAfter-fp8kMr4A.js";import"./QBtnDropdown-DCLbnrW2.js";import"./QBtnGroup-UJjf5I6N.js";import"./ClosePopup-UiwGJ_I-.js";import"./Lists-Cka2Qv50.js";import"./ApiCrud-ggAtBQJ_.js";import"./Api-Dq7M9uDD.js";import"./index-C-UlpWnA.js";import"./index-nmeLrqlN.js";import"./apiPost-Bua6HjJD.js";const Y={__name:"StatusForm",props:{data:{type:Object,required:!0}},emits:["successDelete","successSubmit","successUpdate","successCreate"],setup(b,{emit:i}){const n=b,l=i,a=u({...n.data}),r=!n.data?.id,m=Q("firstInput");C(async()=>{await A(),m.value&&m.value.focus()});const{handleDelete:f,handleCreate:v,handleUpdate:_,loading:y}=J(D,{emit:l,responseKey:"status"}),t=async()=>{const e={santri_id:a.value.santri_id,status:a.value.status,keterangan:a.value.keterangan};return r?await v(e,!0):await _(n.data.id,e,!0)},s=async()=>await f(n.data.id);return(e,p)=>{const I=g("FormHeader"),x=g("FormLoading"),M=g("FormActions");return S(),k(E,{class:"full-width",style:{"max-width":"425px"}},{default:c(()=>[o(R,{onSubmit:B(t,["prevent"])},{default:c(()=>[o(I,{title:"Input Status","is-new":r}),w(y)?(S(),k(x,{key:0})):U("",!0),o(q,null,{default:c(()=>[o(V,{dense:"",outlined:"",label:"Nama","model-value":a.value?.nama+" ("+a.value?.santri_id+")",disable:"",filled:"",class:"q-my-sm"},null,8,["model-value"]),o(G,{modelValue:a.value.status,"onUpdate:modelValue":p[0]||(p[0]=d=>a.value.status=d),url:"status",label:"Status *",class:"q-my-sm",rules:[d=>!!d||"Harus diisi!"],ref_key:"firstInput",ref:m},null,8,["modelValue","rules"]),o(V,{dense:"",class:"q-my-sm",outlined:"",label:"Keterangan",modelValue:a.value.keterangan,"onUpdate:modelValue":p[1]||(p[1]=d=>a.value.keterangan=d),autogrow:""},null,8,["modelValue"])]),_:1}),o(M,{"btn-delete":!r,onOnDelete:s},null,8,["btn-delete"])]),_:1})]),_:1})}}},xa={__name:"SantriStatus",setup(b){const i=u(!1),n=u(!1),l=u({}),a=u([]),r=u({}),{params:m}=N();async function f(){try{i.value=!0;const t=await D.santri(m.id);a.value=t.status,r.value=t.santri}catch{console.log("error get status")}finally{i.value=!1}}const v=O(()=>a.value.map(t=>({Tanggal:F(t.created_at,"dd-MM-yyyy")+" | "+K(F(t.created_at,"yyyy-MM-dd")),Status:t.status,Keterangan:t.keterangan||"-",id:t.id})));C(async()=>{await f()});const _=()=>{l.value={santri_id:r.value.id,nama:r.value.nama},n.value=!0},y=({id:t})=>{l.value=L(a,t),l.value.santri_id=r.value.id,l.value.nama=r.value.nama,n.value=!0};return(t,s)=>(S(),h("div",null,[o(H,{data:v.value,spinner:i.value,onAdd:_,onEdit:y},null,8,["data","spinner"]),o(j,{modelValue:n.value,"onUpdate:modelValue":s[3]||(s[3]=e=>n.value=e)},{default:c(()=>[o(Y,{data:l.value,onSuccessDelete:s[0]||(s[0]=e=>w($)(a.value,e)),onSuccessCreate:s[1]||(s[1]=e=>a.value.push(e)),onSuccessUpdate:s[2]||(s[2]=e=>w(T)(a.value,e.id,e))},null,8,["data"])]),_:1},8,["modelValue"])]))}};export{xa as default};
