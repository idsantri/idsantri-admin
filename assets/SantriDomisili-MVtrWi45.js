import{B as m,C as g,c as b,o as D,w as u,g as s,ae as A,f as B,D as w,Q as M,a8 as C,l as Q,ac as h,v as I,X as U,b as $,H as q}from"./index-BSwPLBvN.js";import{_ as H}from"./TemplateArray-DMCxN__-.js";import{c as V}from"./format-date-DlwYCgkJ.js";import{a as N}from"./hijri--5qD4USW.js";import{r as O,d as j,g as E}from"./array-object-BytDdNh7.js";import{Q as K}from"./QForm-pLnIPDm5.js";import{_ as L}from"./InputSelectArray-CW313qGw.js";import{A as G}from"./ApiCrud-CsgpJEPb.js";import{u as P}from"./useCrudForm-Di2BQFx5.js";import"./QItemSection-WqxvrlOw.js";import"./QItemLabel-CIOWhTht.js";import"./QList-Dn-IYx8z.js";import"./id-BuNGTsqN.js";import"./format-number-B34ySHL_.js";import"./QSelect-BjGQaI4Q.js";import"./QChip-Br_mmnnr.js";import"./QMenu-BnIg5_Ug.js";import"./selection-CiLPAPFJ.js";import"./rtl-DFPa-2ov.js";import"./format-CJebrXOQ.js";import"./lists-store-BQBJ2JOd.js";import"./DropDownAfter-B_WHSSYE.js";import"./QBtnDropdown-C4ZtMkBn.js";import"./QBtnGroup-CFUVAF62.js";import"./ClosePopup-9H5qeAFV.js";import"./Lists-kDpWTKyN.js";import"./Api-gH9zfM44.js";import"./index-DWKPJyX7.js";import"./index-BaAeepf0.js";import"./api-error-CD6hOSn6.js";class R extends G{constructor(){super("domisili")}async santri(l){return(await this._apiGet({endPoint:`${this._path}/santri/${l}`})).data}}const F=new R,T={__name:"DomisiliForm",props:{data:{type:Object,required:!0}},emits:["successDelete","successSubmit","successUpdate","successCreate"],setup(p,{emit:l}){const o=p,r=l,e=m({...o.data}),n=!o.data?.id,{handleDelete:c,handleCreate:v,handleUpdate:f,loading:_}=P(F,{emit:r,responseKey:"domisili"}),y=async()=>{const i={santri_id:e.value.santri_id,domisili:e.value.domisili,keterangan:e.value.keterangan};return n?await v(i,!0):await f(o.data.id,i,!0)},a=async()=>await c(o.data.id);return(i,t)=>{const k=g("FormHeader"),S=g("FormLoading"),x=g("FormActions");return D(),b(Q,{class:"full-width",style:{"max-width":"425px"}},{default:u(()=>[s(K,{onSubmit:A(y,["prevent"])},{default:u(()=>[s(k,{title:"Input Domisili","is-new":n}),w(_)?(D(),b(S,{key:0})):B("",!0),s(M,null,{default:u(()=>[s(C,{class:"q-my-sm",dense:"",outlined:"",label:"Nama","model-value":e.value?.nama+" ("+e.value?.santri_id+")",disable:"",filled:""},null,8,["model-value"]),s(L,{class:"q-my-sm",modelValue:e.value.domisili,"onUpdate:modelValue":t[0]||(t[0]=d=>e.value.domisili=d),url:"domisili",label:"Domisili *",rules:[d=>!!d||"Harus diisi!"]},null,8,["modelValue","rules"]),s(C,{class:"q-my-sm",dense:"",outlined:"",label:"Keterangan",modelValue:e.value.keterangan,"onUpdate:modelValue":t[1]||(t[1]=d=>e.value.keterangan=d),autogrow:""},null,8,["modelValue"])]),_:1}),s(x,{"btn-delete":!n,onOnDelete:a},null,8,["btn-delete"])]),_:1})]),_:1})}}},Fe={__name:"SantriDomisili",setup(p){const l=m(!1),o=m(!1),r=m({}),e=m([]),n=m({}),{params:c}=h();async function v(){try{l.value=!0;const a=await F.santri(c.id);e.value=a.domisili,n.value=a.santri}catch{console.log("error get domisili")}finally{l.value=!1}}const f=I(()=>e.value.map(a=>({Tanggal:V(a.created_at,"dd-MM-yyyy")+" | "+N(V(a.created_at,"yyyy-MM-dd")),Domisili:a.domisili,Keterangan:a.keterangan||"-",id:a.id})));U(async()=>{await v()});const _=()=>{r.value={santri_id:n.value.id,nama:n.value.nama},o.value=!0},y=({id:a})=>{r.value=E(e,a),r.value.santri_id=n.value.id,r.value.nama=n.value.nama,o.value=!0};return(a,i)=>(D(),$("div",null,[s(H,{data:f.value,spinner:l.value,onAdd:_,onEdit:y},null,8,["data","spinner"]),s(q,{modelValue:o.value,"onUpdate:modelValue":i[3]||(i[3]=t=>o.value=t)},{default:u(()=>[s(T,{data:r.value,title:"Input Domisili",onSuccessDelete:i[0]||(i[0]=t=>w(j)(e.value,t)),onSuccessCreate:i[1]||(i[1]=t=>e.value.push(t)),onSuccessUpdate:i[2]||(i[2]=t=>w(O)(e.value,t.id,t))},null,8,["data"])]),_:1},8,["modelValue"])]))}};export{Fe as default};
