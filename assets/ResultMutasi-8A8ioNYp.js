import{v as p,a4 as A,R as I,f,o as c,w as t,i as a,q as M,p as k,n as w,j as o,_ as y,Q as U,t as _,m as V,k as N,B as R}from"./index-BOc7y3E3.js";import{Q as b}from"./QItemLabel-CrvmL7Ku.js";import{Q,a as s}from"./QItemSection-U4VUPMG0.js";import{Q as $}from"./QList-DGdmu--E.js";import{Q as L}from"./QBtnDropdown-BmLRcAl8.js";import{Q as O,a as n}from"./QTable-CATdYY-T.js";import{Q as D}from"./QTr-fSHomvuw.js";import{Q as r}from"./QTd-Nz-8Jtk4.js";import{Q as E}from"./QPage-BVhxSLxX.js";import{C as v}from"./ClosePopup-CcGROVC7.js";import{a as H}from"./api-delete-DLV1eJE-.js";import{a as C}from"./api-get-DUTCLQ7F.js";import{_ as j}from"./EditMutasi-Crwrn6G6.js";import{a as G}from"./api-post-CPwNAYjq.js";import{l as K}from"./loading-store-Dk6OalC_.js";import{n as W}from"./index-CdkvXyXH.js";import{_ as z}from"./CardHeader-B086-4Fs.js";import"./QBtnGroup-CNPGzkQV.js";import"./QMenu-iXJrGXAP.js";import"./selection-CUoFkLvB.js";import"./QMarkupTable-Dp9ldZmi.js";import"./QSelect-Br9kkI5Z.js";import"./QChip-DferuxmN.js";import"./rtl-DFPa-2ov.js";import"./format-CJebrXOQ.js";import"./use-fullscreen-DZQzNGwS.js";import"./index-CHOBZr16.js";import"./api-error-CtGrtfSx.js";import"./QToolbarTitle-DS7gKC4A.js";import"./QToolbar-DD9_B9vM.js";import"./QSpace-CoisEuyS.js";import"./QInnerLoading-GSbaVWQs.js";import"./QForm-CxO-I-hC.js";import"./InputSelectArray-GW0fQ7ez.js";import"./api-get-lists-CRvCG-zL.js";import"./lists-store-BaLrngMx.js";import"./lists-data-L-iOlbK0.js";import"./DropDownAfter-DERgTKys.js";import"./api-update-DaN0juSD.js";const Va={__name:"ResultMutasi",setup(F){const d=p([]),u=p(!1),g=p(!1),x=p({}),{loadingMain:q}=A(K());async function m(){const l=await C({endPoint:"mutasi",loading:u});l&&(d.value=l.mutasi.map(e=>({...e,tk:e.tingkat_id+" "+e.kelas})))}I(async()=>{await m()});async function P(l){x.value=l,g.value=!0}async function S(){await G({endPoint:"mutasi/execute",data:null,loading:u,confirm:!0,message:`<hr><span style="color:blue">Update Domisili?</span><hr>
		<em>
			<strong>Peringatan:</strong>
			<ul style="margin:0">
				<li>Pastikan semua keperluan Administrasi (terkait domisili asal) telah selesai!</li>
				<li>Sebaiknya data di-download/ diunduh terlebih dahulu sebagai backup!</li>
				<li>Setelah update selesai, semua data mutasi akan <strong>dihapus</strong>!</li>
			</ul>
		</em>`})&&await m()}async function B(){await H({endPoint:"mutasi/clean",loading:u,message:"Hapus semua data mutasi?"})&&(d.value=[])}async function T(){const l=await C({endPoint:"export/mutasi",loading:q,notify:!0});if(!l)return;if(!l.url)return W("Url tidak ditemukan");const e=document.createElement("a");e.href=l.url,e.click(),e.remove()}return(l,e)=>(c(),f(E,{class:"q-pa-sm"},{default:t(()=>[a(M,{class:""},{default:t(()=>[a(z,{title:"Data Mutasi Domisili",onOnReload:m},{right:t(()=>[a(k,{icon:"tune",label:"Atur Mutasi",dense:"",outline:"","no-caps":"",class:"q-ml-sm q-px-sm",to:"/mutasi/start"}),a(L,{flat:"",dense:"","dropdown-icon":"more_vert",class:"q-ml-sm",color:"green-11"},{default:t(()=>[a($,null,{default:t(()=>[w((c(),f(Q,{to:"/info/download"},{default:t(()=>[a(s,null,{default:t(()=>[a(b,null,{default:t(()=>[...e[1]||(e[1]=[o("Cetak",-1)])]),_:1})]),_:1}),a(s,{avatar:""},{default:t(()=>[a(y,{name:"print",flat:""})]),_:1})]),_:1})),[[v]]),w((c(),f(Q,{onClick:T,clickable:""},{default:t(()=>[a(s,null,{default:t(()=>[a(b,null,{default:t(()=>[...e[2]||(e[2]=[o("Unduh/Download",-1)])]),_:1})]),_:1}),a(s,{avatar:""},{default:t(()=>[a(y,{name:"download",flat:""})]),_:1})]),_:1})),[[v]]),w((c(),f(Q,{onClick:B,clickable:""},{default:t(()=>[a(s,null,{default:t(()=>[a(b,null,{default:t(()=>[...e[3]||(e[3]=[o("Hapus Semua",-1)])]),_:1})]),_:1}),a(s,{avatar:""},{default:t(()=>[a(y,{name:"delete_forever",flat:""})]),_:1})]),_:1})),[[v]])]),_:1})]),_:1})]),_:1}),a(U,{class:"q-pa-sm"},{default:t(()=>[a(O,{class:"q-pa-sm",rows:d.value,loading:u.value,"rows-per-page-options":[10,25,50,75,100,0],flat:"",bordered:""},{header:t(i=>[a(D,{props:i},{default:t(()=>[a(n,{key:"santri_id",props:i,class:"text-left"},{default:t(()=>[...e[4]||(e[4]=[o(" ID Santri ",-1)])]),_:1},8,["props"]),a(n,{key:"nama",props:i},{default:t(()=>[...e[5]||(e[5]=[o(" Nama ",-1)])]),_:1},8,["props"]),a(n,{key:"tk",props:i},{default:t(()=>[...e[6]||(e[6]=[o(" Tingkat â€” Kelas ",-1)])]),_:1},8,["props"]),a(n,{key:"domisili",props:i},{default:t(()=>[...e[7]||(e[7]=[o(" Domisili (Asal) ",-1)])]),_:1},8,["props"]),a(n,{key:"new_domisili",props:i},{default:t(()=>[...e[8]||(e[8]=[o(" Domisili (Baru) ",-1)])]),_:1},8,["props"]),a(n,{class:"text-center"})]),_:2},1032,["props"])]),body:t(i=>[a(D,{props:i},{default:t(()=>[a(r,{key:"santri_id",props:i,class:"text-left"},{default:t(()=>[a(k,{label:i.row.santri_id,outline:"",color:"green-10",class:"text-caption q-px-sm",dense:"",to:`/santri/${i.row.santri_id}`},null,8,["label","to"])]),_:2},1032,["props"]),a(r,{key:"nama",props:i},{default:t(()=>[o(_(i.row.nama),1)]),_:2},1032,["props"]),a(r,{key:"tk",props:i},{default:t(()=>[o(_(i.row.tk),1)]),_:2},1032,["props"]),a(r,{key:"domisili",props:i},{default:t(()=>[o(_(i.row.domisili),1)]),_:2},1032,["props"]),a(r,{key:"new_domisili",props:i},{default:t(()=>[o(_(i.row.new_domisili),1)]),_:2},1032,["props"]),a(r,{key:"id",props:i,class:"text-center"},{default:t(()=>[a(k,{icon:"edit",flat:"",color:"green-10",onClick:J=>P(i.row)},null,8,["onClick"])]),_:2},1032,["props"])]),_:2},1032,["props"])]),_:1},8,["rows","loading"])]),_:1}),a(V,{class:"q-pa-sm bg-green-7 text-green-11 row"},{default:t(()=>[e[9]||(e[9]=N("div",{class:"col text-italic"}," 1) Teliti kembali sebelum Anda menekan tombol Update; 2) Lakukan backup data dengan menekan tombol download!; ",-1)),a(k,{style:{"max-width":"150px"},class:"col bg-green-8 q-ml-md",label:"Update Domisili",glossy:"","no-caps":"",dense:"",outline:"",icon:"settings_applications",disable:!d.value.length>0,onClick:S},null,8,["disable"])]),_:1})]),_:1}),a(R,{modelValue:g.value,"onUpdate:modelValue":e[0]||(e[0]=i=>g.value=i)},{default:t(()=>[a(j,{data:x.value,api:!0,onOnDelete:m,onOnSubmit:m},null,8,["data"])]),_:1},8,["modelValue"])]),_:1}))}};export{Va as default};
