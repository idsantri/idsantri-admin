import{Q as L}from"./QSpace-CR7bsMEl.js";import{f,o as u,w as e,i as a,Q as x,k as g,t as A,r as I,a0 as na,F as X,s as oa,q as P,v as b,x as sa,n as k,j as $,_ as E,ad as ia,a5 as O,R as Y,a8 as ra,y as da,B as M,a4 as C,z as D,m as ua,p as m,a2 as Z,a7 as aa}from"./index-1h6WQa8x.js";import{Q as ma}from"./QPage-B_WVg178.js";import{f as H}from"./format-date-DlwYCgkJ.js";import{_ as pa}from"./CardColumn-374xbtaQ.js";import{Q as K}from"./QSpinnerCube-CdFtSnRz.js";import{Q as fa}from"./QImg-_Bkf3zut.js";import{_ as ca}from"./ImageUploader-DDr2ClXA.js";import{s as B}from"./santri-store-B0W6NRUd.js";import{b as ga}from"./hijri-BBdEhqDI.js";import{Q as h}from"./QRouteTab-w1IThm_t.js";import{Q as S}from"./QItemLabel-BCrbjFPh.js";import{Q as q,a as d}from"./QItemSection-CDMonx4a.js";import{Q as ea}from"./QList-DG4NG05A.js";import{Q as ta}from"./QBtnDropdown-BuGH-2yX.js";import{Q as _a}from"./QTabs-q7eXOXOC.js";import{C as V}from"./ClosePopup-DlITPM1C.js";import{d as va}from"./dialog-store-Di-kASAs.js";import{a as G}from"./api-get-BY6mtHh6.js";import{a as z}from"./api-download-DiJAjdRL.js";import{_ as ba}from"./ReportViewer-mjAysFQV.js";import{Q as T}from"./QSelect-DyXiAk3o.js";import{Q as wa}from"./QForm-Dcqp4yj8.js";import{_ as ka}from"./FormHeader-Daie5yON.js";import{e as Va}from"./index-_Ec9HkD1.js";import{_ as $a}from"./InputSelectArray-f2GqfPam.js";import{l as Sa}from"./loading-store-De2ZIFfx.js";import"./id-BuNGTsqN.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./index-CpzetzrR.js";import"./format-number-B34ySHL_.js";import"./QBtnGroup-GiM85D-N.js";import"./QMenu-C8eKSCkY.js";import"./selection-Bkxc-DqK.js";import"./QResizeObserver-BGqO9aRk.js";import"./rtl-DFPa-2ov.js";import"./api-error-B2Y93K9w.js";import"./QChip-DJ1cSnO8.js";import"./format-CJebrXOQ.js";import"./QToolbarTitle-DdD-fGk3.js";import"./QToolbar-vKMNabI2.js";import"./api-get-lists-BZgeu587.js";import"./lists-store-DUO5Gnb9.js";import"./lists-data-L-iOlbK0.js";import"./DropDownAfter-vvhC7sAZ.js";const qa={class:"flex items-center"},Ia={class:"text-subtitle2"},xa={key:0},Qa={key:1,class:"row"},ya={class:"col-4 q-pr-sm"},Ca={key:0},Da={class:"col"},Ua={class:"text-caption text-italic"},ha={class:"q-mb-sm"},Ba={__name:"CardImage",props:{title:String,data:Object,image:String,loading:Boolean,loadingImage:Boolean},setup(_){return(t,l)=>(u(),f(P,null,{default:e(()=>[a(x,{class:"bg-green-7 text-green-11 q-pa-sm"},{default:e(()=>[g("div",qa,[g("div",Ia,A(_.title),1),a(L)])]),_:1}),a(x,{class:"q-pa-sm"},{default:e(()=>[_.loading?(u(),I("div",xa,[a(K,{color:"green-12",size:"8em",class:"flex q-ma-lg q-mx-auto"})])):(u(),I("div",Qa,[g("div",ya,[_.loadingImage?(u(),I("div",Ca,[a(K,{color:"green-12",size:"4em",class:"flex q-ma-sm q-mx-auto"})])):(u(),f(fa,{key:1,src:_.image,ratio:3/4,alt:"santri"},null,8,["src"])),na(t.$slots,"button")]),g("div",Da,[(u(!0),I(X,null,oa(_.data,(s,r)=>(u(),I("div",{key:r},[g("div",Ua,A(r),1),g("div",ha,A(s),1)]))),128))])]))]),_:3})]),_:3}))}},Pa={__name:"SantriRelations",props:{santriId:{default:null}},setup(_){const t=_,l=b(0);return(s,r)=>{const p=sa("router-view");return u(),f(P,{key:l.value},{default:e(()=>[g("button",{onClick:r[0]||(r[0]=v=>l.value++),id:"btn-rerender-santri-relations",style:{display:"none"}}," rerender "),a(_a,{"no-caps":"","outside-arrows":"","mobile-arrows":"",class:"bg-green-7 text-green-11 shadow-2",dense:"","indicator-color":"green-13",align:"left"},{default:e(()=>[a(h,{name:"wali",label:"Wali",to:"/santri/"+t.santriId+"/wali"},null,8,["to"]),a(h,{name:"ortu",label:"Ortu",to:"/santri/"+t.santriId+"/ortu"},null,8,["to"]),a(h,{name:"status",label:"Status",to:"/santri/"+t.santriId+"/status"},null,8,["to"]),a(h,{name:"kelas",label:"Kelas",to:"/santri/"+t.santriId+"/kelas"},null,8,["to"]),a(h,{name:"domisili",label:"Domisili",to:"/santri/"+t.santriId+"/domisili"},null,8,["to"]),a(L),a(ta,{flat:"",dense:"","dropdown-icon":"more_vert",class:"q-pl-md",color:"green-11"},{default:e(()=>[a(ea,null,{default:e(()=>[k((u(),f(q,{to:"/iuran/santri/"+t.santriId},{default:e(()=>[a(d,null,{default:e(()=>[a(S,null,{default:e(()=>[...r[1]||(r[1]=[$("Iuran",-1)])]),_:1})]),_:1}),a(d,{avatar:""},{default:e(()=>[a(E,{name:"payments",flat:""})]),_:1})]),_:1},8,["to"])),[[V]]),k((u(),f(q,{to:"/keamanan/izin-pesantren/santri/"+t.santriId},{default:e(()=>[a(d,null,{default:e(()=>[a(S,null,{default:e(()=>[...r[2]||(r[2]=[$("Izin Pesantren",-1)])]),_:1})]),_:1}),a(d,{avatar:""},{default:e(()=>[a(E,{name:"transfer_within_a_station",flat:""})]),_:1})]),_:1},8,["to"])),[[V]]),k((u(),f(q,{to:"/keamanan/indisipliner/santri/"+t.santriId},{default:e(()=>[a(d,null,{default:e(()=>[a(S,null,{default:e(()=>[...r[3]||(r[3]=[$("Indisipliner",-1)])]),_:1})]),_:1}),a(d,{avatar:""},{default:e(()=>[a(E,{name:"directions_run",flat:""})]),_:1})]),_:1},8,["to"])),[[V]])]),_:1})]),_:1})]),_:1}),a(x,{class:"q-pa-sm"},{default:e(()=>[(u(),f(ia,null,{default:e(()=>[a(p)]),fallback:e(()=>[a(K,{color:"green-12",size:"8em",class:"flex q-mx-auto"})]),_:1}))]),_:1})]),_:1})}}},ja={key:0},Na={__name:"PermohonanBerhenti",emits:["submitted"],setup(_,{emit:t}){const l=b({jenis_permohonan:"Berhenti",tunggakan:"Lunas"}),{santri:s}=O(B()),r=b(!1),p=t;Y(async()=>{});async function v(){const c=JSON.parse(JSON.stringify(l.value));if(!c.tunggakan||!c.jenis_permohonan||!c.alasan||!c.wali_nama||!c.wali_status||!c.wali_hubungan)return Va("Isian tidak lengkap");c.id=s.id,p("submitted",c),document.getElementById("btn-close").click()}return(c,n)=>(u(),f(P,{class:"full-width",style:{"max-width":"425px"}},{default:e(()=>[a(wa,{onSubmit:ra(v,["prevent"])},{default:e(()=>[a(ka,{title:"Permohonan Berhenti","is-new":!0}),a(x,{class:"q-pa-sm"},{default:e(()=>[r.value?(u(),I("div",ja,[a(M,{modelValue:r.value,"onUpdate:modelValue":n[0]||(n[0]=o=>r.value=o),persistent:""},{default:e(()=>[a(K,{color:"green-12",size:"8em",class:"flex q-ma-lg q-mx-auto"})]),_:1},8,["modelValue"])])):da("",!0),a(C,{dense:"",class:"",outlined:"",label:"Santri ID",modelValue:D(s).id,"onUpdate:modelValue":n[1]||(n[1]=o=>D(s).id=o),filled:"",disable:""},null,8,["modelValue"]),a(C,{dense:"",class:"q-mt-sm",outlined:"",label:"Nama",modelValue:D(s).nama,"onUpdate:modelValue":n[2]||(n[2]=o=>D(s).nama=o),filled:"",disable:""},null,8,["modelValue"]),a(T,{dense:"",class:"q-mt-sm",outlined:"",label:"Tunggakan*",modelValue:l.value.tunggakan,"onUpdate:modelValue":n[3]||(n[3]=o=>l.value.tunggakan=o),options:["Lunas","Belum Lunas"],clearable:"","use-input":"","new-value-mode":"add",behavior:"menu"},null,8,["modelValue"]),a(T,{dense:"",class:"q-mt-sm",outlined:"",label:"Jenis Permohonan*",modelValue:l.value.jenis_permohonan,"onUpdate:modelValue":n[4]||(n[4]=o=>l.value.jenis_permohonan=o),options:["Berhenti","Cuti/Istirahat"],clearable:"","use-input":"","new-value-mode":"add",behavior:"menu"},null,8,["modelValue"]),a(C,{dense:"",class:"q-mt-sm",outlined:"",label:"Alasan*",modelValue:l.value.alasan,"onUpdate:modelValue":n[5]||(n[5]=o=>l.value.alasan=o),autogrow:""},null,8,["modelValue"]),a(P,{class:"q-mt-sm",flat:"",bordered:""},{default:e(()=>[a(x,{class:"q-pa-sm"},{default:e(()=>[n[12]||(n[12]=g("div",{class:"text-subtitle2"}," Identitas Pemohon (Wali) ",-1)),a(C,{dense:"",class:"",outlined:"",label:"Nama*",modelValue:l.value.wali_nama,"onUpdate:modelValue":n[6]||(n[6]=o=>l.value.wali_nama=o)},null,8,["modelValue"]),a(C,{dense:"",class:"q-mt-sm",outlined:"",label:"Nomor Telepon",modelValue:l.value.wali_no_telepon,"onUpdate:modelValue":n[7]||(n[7]=o=>l.value.wali_no_telepon=o)},null,8,["modelValue"]),a(T,{dense:"",class:"q-mt-sm",outlined:"",label:"Bukti Diri",modelValue:l.value.wali_bukti_diri,"onUpdate:modelValue":n[8]||(n[8]=o=>l.value.wali_bukti_diri=o),options:["KTP","SIM"],clearable:"","use-input":"","new-value-mode":"add",behavior:"menu"},null,8,["modelValue"]),a(C,{dense:"",class:"q-mt-sm",outlined:"",label:"Nomor / ID Bukti Diri",modelValue:l.value.wali_bukti_diri_id,"onUpdate:modelValue":n[9]||(n[9]=o=>l.value.wali_bukti_diri_id=o)},null,8,["modelValue"]),a(T,{dense:"",class:"q-mt-sm",outlined:"",label:"Status*",modelValue:l.value.wali_status,"onUpdate:modelValue":n[10]||(n[10]=o=>l.value.wali_status=o),options:["Wali","Wakil Wali"],clearable:"","use-input":"","new-value-mode":"add",behavior:"menu"},null,8,["modelValue"]),a($a,{modelValue:l.value.wali_hubungan,"onUpdate:modelValue":n[11]||(n[11]=o=>l.value.wali_hubungan=o),url:"hubungan-wali",label:"Hubungan*",class:"q-mt-sm","use-input":"","new-value-mode":"add"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),a(ua,{class:"flex bg-green-6"},{default:e(()=>[a(L),k(a(m,{label:"Tutup",class:"bg-green-11","no-caps":"",id:"btn-close"},null,512),[[V]]),a(m,{type:"submit",label:"Print",class:"bg-green-10 text-green-11","no-caps":"",icon:"print"})]),_:1})]),_:1})]),_:1}))}},Ra={__name:"DropDownPrint",props:{santri:{type:Object,required:!0}},setup(_){const t=_,{loadingMain:l}=Z(Sa()),s=aa(),r=b(!1),p=b(""),v=b(!1);async function c(){await z({endPoint:`reports/santri/registrasi/download?id=${s.params.id}`,loading:l,fileName:"registrasi-"+s.params.id,confirm:!0,message:"Download data registrasi?"})}async function n(){await z({endPoint:`reports/santri/standbook/download?id=${s.params.id}`,loading:l,fileName:"standbook-"+s.params.id,confirm:!0,message:"Download standbook?"})}async function o(){await z({endPoint:`reports/santri/keterangan-berhenti/download?id=${s.params.id}`,loading:l,fileName:"keterangan-berhenti-"+s.params.id,confirm:!0,message:"Download Keterangan Berhenti"})}async function j(){await z({endPoint:`reports/santri/id-card/download?id=${s.params.id}`,loading:l,fileName:"card-"+s.params.id+" ~ "+t.santri.nama,confirm:!0,message:"Download ID Card"})}function U(){p.value=`reports/santri/registrasi/view?id=${s.params.id}`,v.value=!0}function N(){p.value=`reports/santri/standbook/view?id=${s.params.id}`,v.value=!0}function W(R){r.value=!1;const i=new URLSearchParams(R).toString();p.value=`reports/santri/permohonan-berhenti/view?${i}`,v.value=!0}function F(){p.value=`reports/santri/keterangan-berhenti/view?id=${s.params.id}`,v.value=!0}return(R,i)=>(u(),I(X,null,[a(ta,{color:"green-10",label:"Cetak",icon:"print","no-caps":"",class:"text-green-11 q-px-md",size:"sm"},{default:e(()=>[a(ea,null,{default:e(()=>[k((u(),f(q,null,{default:e(()=>[a(d,null,{default:e(()=>[a(S,null,{default:e(()=>[...i[3]||(i[3]=[$("Registrasi",-1)])]),_:1})]),_:1}),a(d,{avatar:""},{default:e(()=>[a(m,{icon:"download",flat:"",onClick:c})]),_:1}),a(d,{avatar:""},{default:e(()=>[a(m,{icon:"print",flat:"",onClick:U})]),_:1})]),_:1})),[[V]]),k((u(),f(q,null,{default:e(()=>[a(d,null,{default:e(()=>[a(S,null,{default:e(()=>[...i[4]||(i[4]=[$("Standbook",-1)])]),_:1})]),_:1}),a(d,{avatar:""},{default:e(()=>[a(m,{icon:"download",flat:"",onClick:n})]),_:1}),a(d,{avatar:""},{default:e(()=>[a(m,{icon:"print",flat:"",onClick:N})]),_:1})]),_:1})),[[V]]),k((u(),f(q,null,{default:e(()=>[a(d,null,{default:e(()=>[a(S,null,{default:e(()=>[...i[5]||(i[5]=[$("Permohonan Berhenti",-1)])]),_:1})]),_:1}),a(d,{avatar:""},{default:e(()=>[a(m,{icon:"download",flat:"",disable:""})]),_:1}),a(d,{avatar:""},{default:e(()=>[a(m,{icon:"print",flat:"",onClick:i[0]||(i[0]=Q=>r.value=!0)})]),_:1})]),_:1})),[[V]]),k((u(),f(q,null,{default:e(()=>[a(d,null,{default:e(()=>[a(S,null,{default:e(()=>[...i[6]||(i[6]=[$("Keterangan Berhenti",-1)])]),_:1})]),_:1}),a(d,{avatar:""},{default:e(()=>[a(m,{icon:"download",flat:"",onClick:o})]),_:1}),a(d,{avatar:""},{default:e(()=>[a(m,{icon:"print",flat:"",onClick:F})]),_:1})]),_:1})),[[V]]),k((u(),f(q,null,{default:e(()=>[a(d,null,{default:e(()=>[a(S,null,{default:e(()=>[...i[7]||(i[7]=[$("ID Card",-1)])]),_:1})]),_:1}),a(d,{avatar:""},{default:e(()=>[a(m,{icon:"download",flat:"",onClick:j})]),_:1}),a(d,{avatar:""},{default:e(()=>[a(m,{icon:"print",flat:"",disable:""})]),_:1})]),_:1})),[[V]])]),_:1})]),_:1}),a(M,{modelValue:r.value,"onUpdate:modelValue":i[1]||(i[1]=Q=>r.value=Q)},{default:e(()=>[a(Na,{onSubmitted:W})]),_:1},8,["modelValue"]),a(M,{modelValue:v.value,"onUpdate:modelValue":i[2]||(i[2]=Q=>v.value=Q)},{default:e(()=>[a(ba,{url:p.value},null,8,["url"])]),_:1},8,["modelValue"])],64))}},za={class:"flex items-center"},Ta={class:"row"},Oa={class:"col-12 col-sm-6 col-md-4 q-pa-sm"},Ka={class:"col-12 col-sm-6 col-md-5 q-pa-sm"},Be={__name:"SantriDetail",setup(_){const t=O({}),l=O({}),s=O({}),p=aa().params.id,v=va(),{searchSantri:c,crudSantri:n}=Z(v),o=b({}),j=b({}),U=b(!1),N=b(!1);async function W(){const w=await G({endPoint:`images/santri/${p}`,loading:N});t.image_url=w.image_url}async function F(){const w=await G({endPoint:`santri/${p}`,loading:U});w.santri&&(Object.assign(t,w.santri),Object.assign(l,w.wali),Object.assign(s,w.ortu))}Y(async()=>{await F(),o.value={ID:t.id,"Tanggal Daftar":H(t.tgl_daftar_m)+" | "+ga(t.tgl_daftar_h),"Tahun Ajaran":`${t.th_ajaran_h||"-"} | ${t.th_ajaran_m||"-"}`},j.value={Nama:`${t.nama?.toUpperCase()} (${t.sex?.toUpperCase()})`,Alamat:`${t.jl||" "} RT ${String(t.rt||0).padStart(3,0)} RW ${String(t.rw||0).padStart(3,"0")} ${t.desa||" "} ${t.kecamatan||" "} ${t.kabupaten||" "} ${t.provinsi||" "} ${t.kode_pos||" "}`.replace(/\s\s+/g," "),Kelahiran:`${t.tmp_lahir||"-"}, ${H(t.tgl_lahir)}`,"Data Akhir":t.data_akhir||"-"},B().setSantri(t),B().setOrtu(s),B().setWali(l)});function R(){B().setEdit(),n.value=!0}const i=b(!1),Q=w=>i.value=w;async function la(){i.value=!1,await W()}return(w,y)=>(u(),f(ma,{class:"q-pa-sm"},{default:e(()=>[a(P,{class:""},{default:e(()=>[a(x,{class:"bg-green-8 text-green-11 q-pa-sm"},{default:e(()=>[g("div",za,[y[2]||(y[2]=g("div",{class:"text-subtitle1"},"Data Santri",-1)),a(L),a(m,{onClick:J=>null,size:"sm",color:"green-2",class:"text-green-10 q-mr-sm",icon:"sync",disable:""}),a(m,{label:"Cari",onClick:y[0]||(y[0]=J=>c.value=!0),size:"sm",color:"green-2",class:"text-green-10 q-mr-sm",icon:"search"}),a(m,{"no-caps":"",size:"sm",color:"green-2",class:"text-green-10 q-mr-sm",icon:"edit",label:"Edit",onClick:R}),a(Ra,{santri:t},null,8,["santri"])])]),_:1}),a(x,{class:"no-padding"},{default:e(()=>[g("div",Ta,[g("div",Oa,[a(pa,{class:"q-mb-sm",data:o.value,loading:U.value,title:"Registrasi"},null,8,["data","loading"]),a(Ba,{class:"q-mb-sm",title:"Identitas",data:j.value,loading:U.value,loadingImage:N.value,image:t?.image_url||"/user-default.png"},{button:e(()=>[a(m,{class:"q-mt-sm full-width",icon:"upload","no-caps":"",label:"Foto",dense:"",size:"sm",outline:"",color:"green-10",onClick:y[1]||(y[1]=J=>i.value=!0)})]),_:1},8,["data","loading","loadingImage","image"])]),g("div",Ka,[a(Pa,{"santri-id":D(p)},null,8,["santri-id"])])])]),_:1})]),_:1}),a(ca,{"img-format":"jpg","show-uploader":i.value,url:`/images/santri/${D(p)}`,onUpdateUploader:Q,onSuccessUpload:la},null,8,["show-uploader","url"])]),_:1}))}};export{Be as default};
