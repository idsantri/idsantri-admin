import{Q as L}from"./QSpace-DIvX2TzF.js";import{a9 as A,A as x,U as E,c as g,o as n,w as e,b as t,x as z,Q as w,a as l,g as h,l as Q,t as m,a1 as j,C as F,f as d,F as N,y as q,z as o,a0 as V}from"./index-DwrbA0R8.js";import{Q as C}from"./QItemLabel-Dzdetwv2.js";import{Q as M,a as b}from"./QItemSection-CeSY4hvW.js";import{Q as H}from"./QList-Cc6jCv1k.js";import{Q as G}from"./QBtnDropdown-DqbNLFX1.js";import{Q as P}from"./QSkeleton-BtQ289R_.js";import{Q as U,a as u}from"./QTable-BIqFScuN.js";import{Q as v}from"./QTr-R9A0HBj-.js";import{Q as R}from"./QTd-CWnMEFGa.js";import{Q as J}from"./QMarkupTable-DzcRgr6j.js";import{Q as O}from"./QPage-BU8r9xHl.js";import{C as S}from"./ClosePopup-kZj4_oIv.js";import{a as $}from"./api-get-D4W4lze7.js";import{_ as W}from"./FilterKelas-6Sj-0c5t.js";import{_ as X}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./QBtnGroup-CPjXoyXA.js";import"./QMenu-BEnErdhw.js";import"./selection-DRCgFU0J.js";import"./QSelect-CrgZ1FsI.js";import"./QChip-DvUCR8tL.js";import"./rtl-DFPa-2ov.js";import"./format-CJebrXOQ.js";import"./use-fullscreen-C-VxiWHj.js";import"./index-B6LiMDVO.js";import"./index-BlZcD66n.js";import"./api-error-DGWaEiw1.js";import"./QToolbarTitle-CH0GyKDM.js";import"./QToolbar-BCLZ34c-.js";import"./lists-madrasah-store-BHcaFkmm.js";import"./api-get-lists-8M14e61j.js";const Y=["innerHTML"],Z={key:0},aa={key:1},ta={key:0},ea={key:1},la={key:2},sa={key:0},ra={key:1},ia={key:0,class:"text-italic text-negative"},na={key:1},oa={class:"text-left"},da={class:"text-left"},ua={class:"text-right"},_a={class:"text-right"},ma={class:"text-right"},fa={class:"text-right"},pa={class:"text-right"},ca={class:"bg-green-2 text-weight-bold text-right text-green-10"},ga={__name:"NilaiIndex",setup(xa){const{params:f}=A(),c=x([{}]),T=x(!1),D=x(""),p=x([{}]),y=x([]),B=[{name:"no_absen",label:"No",align:"center",field:a=>a.no_absen,format:a=>`${a||""}`,sortable:!0},{name:"kelas_id",label:"ID Kelas",align:"center",field:a=>a.kelas_id,format:a=>`${a}`,sortable:!0},{name:"santri_id",label:"ID Santri",align:"center",field:a=>a.santri_id,format:a=>`${a}`,sortable:!0},{name:"nama",label:"Nama",align:"left",field:a=>a.nama,sortable:!0},{name:"rerata_1",label:"Rerata-1",align:"right",field:a=>a.rerata_1?parseFloat(a.rerata_1).toFixed(1):null,sortable:!0},{name:"rerata_2",label:"Rerata-2",align:"right",field:a=>a.rerata_2?parseFloat(a.rerata_2).toFixed(1):null,sortable:!0},{name:"rerata_3",label:"Rerata-3",align:"right",field:a=>a.rerata_3?parseFloat(a.rerata_3).toFixed(1):null,sortable:!0},{name:"rerata_4",label:"Rerata-4",align:"right",field:a=>a.rerata_4?parseFloat(a.rerata_4).toFixed(1):null,sortable:!0},{name:"rerata_akhir",label:"R. Akhir",align:"right",field:a=>a.rerata_akhir?parseFloat(a.rerata_akhir).toFixed(1):null,sortable:!0}];async function K(a){if(a.expand=!a.expand,a.expand){y.value[a.key]=!0,p.value[a.key]=null;const i=await $({endPoint:"nilai-mapel",params:{kelas_id:a.key,category:"rapor"}});y.value[a.key]=!1,p.value[a.key]=i.nilai}}E(async()=>{if(f.th_ajaran_h&&f.tingkat_id&&f.kelas){const a=await $({endPoint:"nilai-mapel/rerata",params:{th_ajaran_h:f.th_ajaran_h,tingkat_id:f.tingkat_id,kelas:f.kelas,category:"rapor"},loading:T});c.value=a.nilai}});function _(a,i){let s=0,r=0;if(a?.length){a.forEach(I=>{I[i]!==null&&(s+=parseFloat(I[i]),r++)});const k=s/r;return isNaN(k)?null:k.toFixed(1)}else return null}return(a,i)=>(n(),g(O,{class:"q-pa-sm"},{default:e(()=>[t(W,{"show-ujian-ke":!1,"start-url":"/madrasah/nilai-mapel/rerata",onDataFilter:i[0]||(i[0]=s=>D.value=s),title:"Filter Data: <span class='text-weight-medium'>Nilai Mapel (Rerata)</span>"}),t(z,{class:"q-mt-sm"},{default:e(()=>[t(w,{class:"bg-green-8 text-green-1 text-subtitle1 q-pa-sm flex flex-center"},{default:e(()=>[l("span",{innerHTML:D.value+" ➡️ <em class='text-weight-light'>Kategori: </em> <strong>Nilai Rapor</strong>"||""},null,8,Y),t(L),t(h,{dense:"",icon:"download",label:"Excel","no-caps":"",class:"bg-green-11 text-green-10 q-px-md q-mr-sm",to:"/madrasah/nilai-mapel/download"}),t(h,{dense:"",icon:"upload",label:"Excel","no-caps":"",class:"bg-green-11 text-green-10 q-px-md q-mr-sm",to:"/madrasah/nilai-mapel/upload"}),t(G,{outline:"","no-caps":"",class:"text-green-11 q-px-md",size:"",dense:"","dropdown-icon":"more_vert"},{default:e(()=>[t(H,null,{default:e(()=>[Q((n(),g(M,{to:"/madrasah/mapel"},{default:e(()=>[t(b,null,{default:e(()=>[t(C,null,{default:e(()=>[...i[1]||(i[1]=[m(" Mata Pelajaran ",-1)])]),_:1})]),_:1}),t(b,{avatar:""},{default:e(()=>[t(j,{name:"settings"})]),_:1})]),_:1})),[[S]]),Q((n(),g(M,{to:"/madrasah/nilai-ahwal"},{default:e(()=>[t(b,null,{default:e(()=>[t(C,null,{default:e(()=>[...i[2]||(i[2]=[m(" Nilai Ahwal ",-1)])]),_:1})]),_:1}),t(b,{avatar:""},{default:e(()=>[t(j,{name:"settings_accessibility"})]),_:1})]),_:1})),[[S]])]),_:1})]),_:1})]),_:1}),!F(f).th_ajaran_h||!F(f).tingkat_id||!F(f).kelas?(n(),g(w,{key:0,class:"q-pa-sm"},{default:e(()=>[...i[3]||(i[3]=[l("div",{class:"text-center q-pa-lg text-negative text-italic"}," Tentukan Tahun Ajaran, Tingkat Pendidikan, dan Kelas! ",-1)])]),_:1})):(n(),g(w,{key:1,class:"q-pa-sm"},{default:e(()=>[T.value?(n(),d("div",Z,[t(P,{type:"text",height:"4rem"})])):(n(),d("div",aa,[t(U,{flat:"",rows:c.value,columns:B,"row-key":"kelas_id","rows-per-page-options":[10,25,50,100,0],class:"my-sticky-header-table"},{header:e(s=>[t(v,{props:s,class:""},{default:e(()=>[t(u),t(u),t(u),t(u),t(u,{class:"text-left"},{default:e(()=>[...i[4]||(i[4]=[m("Retata Kelas",-1)])]),_:1}),t(u,{class:"text-right"},{default:e(()=>[m(o(_(c.value,"rerata_1")),1)]),_:1}),t(u,{class:"text-right"},{default:e(()=>[m(o(_(c.value,"rerata_2")),1)]),_:1}),t(u,{class:"text-right"},{default:e(()=>[m(o(_(c.value,"rerata_3")),1)]),_:1}),t(u,{class:"text-right"},{default:e(()=>[m(o(_(c.value,"rerata_4")),1)]),_:1}),t(u,{class:"text-right"},{default:e(()=>[m(o(_(c.value,"rerata_akhir")),1)]),_:1})]),_:1},8,["props"]),t(v,{props:s},{default:e(()=>[t(u,{"auto-width":""},{default:e(()=>[...i[5]||(i[5]=[m("!",-1)])]),_:1}),(n(!0),d(N,null,q(s.cols,r=>(n(),g(u,{key:r.name,props:s},{default:e(()=>[m(o(r.label),1)]),_:2},1032,["props"]))),128))]),_:2},1032,["props"])]),body:e(s=>[t(v,{props:s},{default:e(()=>[t(R,{"auto-width":""},{default:e(()=>[t(h,{size:"sm",color:"green",round:"",dense:"",onClick:r=>K(s),icon:s.expand?"remove":"add"},null,8,["onClick","icon"])]),_:2},1024),(n(!0),d(N,null,q(s.cols,r=>(n(),g(R,{key:r.name,props:s},{default:e(()=>[r.name=="kelas_id"?(n(),d("span",ta,[t(h,{label:r.value,dense:"",outline:"",class:"q-px-md text-green-10",to:`/madrasah/kelas/${r.value}/nilai-mapel`},null,8,["label","to"])])):r.name=="santri_id"?(n(),d("span",ea,[t(h,{label:r.value,dense:"",outline:"",class:"q-px-md text-green-10",to:`/santri/${r.value}`},null,8,["label","to"])])):(n(),d("span",la,o(r.value),1))]),_:2},1032,["props"]))),128))]),_:2},1032,["props"]),Q(t(v,{props:s},{default:e(()=>[t(R,{colspan:"100%"},{default:e(()=>[y.value[s.row.kelas_id]?(n(),d("div",sa,[t(P,{height:"100px"})])):(n(),d("div",ra,[p.value[s.row.kelas_id]?.length==0?(n(),d("div",ia," Tidak ada data untuk ditampilkan! ")):(n(),d("div",na,[t(J,{flat:"",dense:"",class:"bg-green-1",separator:"cell"},{default:e(()=>[i[7]||(i[7]=l("thead",{class:"bg-green-2 text-weight-medium text-right"},[l("tr",null,[l("td",{class:"text-left",style:{width:"80px"}}," ID (Kode) "),l("td",{class:"text-left"}," Mata Pelajaran "),l("td",{style:{width:"50px"}}," N-1 "),l("td",{style:{width:"50px"}}," N-2 "),l("td",{style:{width:"50px"}}," N-3 "),l("td",{style:{width:"50px"}}," N-4 "),l("td",{style:{width:"65px"}}," Rerata ")])],-1)),l("tbody",null,[(n(!0),d(N,null,q(p.value[s.row.kelas_id],(r,k)=>(n(),d("tr",{key:k},[l("td",oa,o(r.id),1),l("td",da,o(r.name),1),l("td",ua,o(r.nilai_1),1),l("td",_a,o(r.nilai_2),1),l("td",ma,o(r.nilai_3),1),l("td",fa,o(r.nilai_4),1),l("td",pa,o(r.rerata?parseFloat(r.rerata).toFixed(1):null),1)]))),128))]),l("tfoot",ca,[l("tr",null,[i[6]||(i[6]=l("td",{colspan:"2",class:"text-left"}," Rerata ",-1)),l("td",null,o(_(p.value[s.row.kelas_id],"nilai_1")),1),l("td",null,o(_(p.value[s.row.kelas_id],"nilai_2")),1),l("td",null,o(_(p.value[s.row.kelas_id],"nilai_3")),1),l("td",null,o(_(p.value[s.row.kelas_id],"nilai_4")),1),l("td",null,o(_(p.value[s.row.kelas_id],"rerata")),1)])])]),_:2},1024)]))]))]),_:2},1024)]),_:2},1032,["props"]),[[V,s.expand]])]),_:1},8,["rows"])]))]),_:1}))]),_:1})]),_:1}))}},Oa=X(ga,[["__scopeId","data-v-b0af06cd"]]);export{Oa as default};
