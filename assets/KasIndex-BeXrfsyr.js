import{q as d,ap as j,s as A,Y as J,N as H,E as U,c as S,o as I,w as l,g as a,af as R,f as L,G as w,Q as G,a9 as k,l as N,a as B,v as g,t as c,e as $,p as P,J as F}from"./index-D027sPii.js";import{Q as i}from"./QTd-DIQDiSUy.js";import{Q as E}from"./QTr-NzwIk93Z.js";import{Q as Y}from"./QTable-Dmt98edc.js";import{d as D}from"./format-number-B34ySHL_.js";import{Q as z}from"./QSelect-Ugd6-GYN.js";import{Q as W}from"./QForm-BsHe9OCF.js";import{_ as X}from"./InputCurrency-BcKuOi1T.js";import{u as Z}from"./useCrudForm-m3A4pJ4W.js";import{A as h}from"./ApiCrud-DL4BL-wf.js";import{U as ee}from"./UgtGt-DJ27708T.js";import{_ as ae}from"./ReportViewer-H96eVlUw.js";import{c as le}from"./format-date-DBaFa2rd.js";import{_ as te}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./QList-v8ixJrf5.js";import"./QMarkupTable-ZGyFruYa.js";import"./use-fullscreen-Njtq0hx6.js";import"./QField-C1tA_PuE.js";import"./QChip-C2j8B3tv.js";import"./QItem-D9NARC_U.js";import"./QItemLabel-BkEEHqCi.js";import"./QMenu-kWLrrC8d.js";import"./selection-Bl80UEH0.js";import"./rtl-DFPa-2ov.js";import"./format-CJebrXOQ.js";import"./Api-Ivu-dWRs.js";import"./index-j_lT3OE8.js";import"./index-BDbb42pe.js";import"./apiPost-CKVkSPax.js";import"./id-BuNGTsqN.js";class ne extends h{constructor(){super("ugt/kas")}}const M=new ne,oe={__name:"UgtKasForm",props:{data:Object},emits:["successDelete","successSubmit","successUpdate","successCreate"],setup(Q,{emit:C}){const m=Q,v=C,t=d({keperluan:"Biaya Administrasi GT",keterangan:"Lunas",flag:"+",...m.data}),p=d(!1),r=d({}),f=!m.data?.id,b=j("firstInput");A(async()=>{await J(),b.value&&b.value.focus()});const{handleDelete:y,handleCreate:q,handleUpdate:K,loading:x}=Z(M,{emit:v,responseKey:"kas"}),o=async()=>{const u=JSON.parse(JSON.stringify(t.value));return delete u.id,f?await q(u,!0):await K(m.data.id,u,!0)},n=async()=>await y(m.data.id);async function _(u){try{p.value=!0;const e=await ee.getById({id:u,notifySuccess:!1});r.value=e.gt}catch{r.value.nama="Data tidak ditemukan",r.value.pjgt_nama="Data tidak ditemukan"}finally{p.value=!1}}return H(()=>t.value.gt_id,async(u,e)=>{r.value.nama="",r.value.pjgt_nama="",u!=e&&await _(u)},{immediate:!0}),(u,e)=>{const V=U("FormHeader"),T=U("FormLoading"),O=U("FormActions");return I(),S(N,{class:"full-width",style:{"max-width":"425px"}},{default:l(()=>[a(W,{onSubmit:R(o,["prevent"])},{default:l(()=>[a(V,{title:"Input Kas UGT","is-new":f}),w(x)?(I(),S(T,{key:0})):L("",!0),a(G,null,{default:l(()=>[a(k,{dense:"",hint:"Diisi oleh sistem",class:"",outlined:"",label:"ID",modelValue:t.value.id,"onUpdate:modelValue":e[0]||(e[0]=s=>t.value.id=s),disable:"",filled:""},null,8,["modelValue"]),a(N,{class:"q-my-sm",flat:"",bordered:""},{default:l(()=>[a(G,{class:"q-pa-sm"},{default:l(()=>[e[8]||(e[8]=B("div",{class:"text-caption"},"Jika terkait dengan administrasi GT",-1)),a(k,{dense:"",class:"q-my-sm",outlined:"",label:"GT ID",modelValue:t.value.gt_id,"onUpdate:modelValue":e[1]||(e[1]=s=>t.value.gt_id=s),clearable:"",debounce:"500",ref_key:"firstInput",ref:b},null,8,["modelValue"]),a(k,{dense:"",class:"q-my-sm",outlined:"",label:"Nama GT",modelValue:r.value.nama,"onUpdate:modelValue":e[2]||(e[2]=s=>r.value.nama=s),disable:"",filled:"",loading:p.value},null,8,["modelValue","loading"]),a(k,{dense:"",class:"q-my-sm",outlined:"",label:"Nama PJGT",modelValue:r.value.pjgt_nama,"onUpdate:modelValue":e[3]||(e[3]=s=>r.value.pjgt_nama=s),disable:"",filled:"",loading:p.value},null,8,["modelValue","loading"])]),_:1})]),_:1}),a(k,{dense:"",class:"q-my-sm",outlined:"",label:"Keperluan",modelValue:t.value.keperluan,"onUpdate:modelValue":e[4]||(e[4]=s=>t.value.keperluan=s)},null,8,["modelValue"]),a(z,{dense:"",class:"q-my-sm",outlined:"",label:"Kas Masuk/Keluar",modelValue:t.value.flag,"onUpdate:modelValue":e[5]||(e[5]=s=>t.value.flag=s),options:[{value:"+",label:"Masuk"},{value:"-",label:"Keluar"}],"emit-value":"","map-options":"","error-color":"negative",behavior:"menu"},null,8,["modelValue"]),a(X,{dense:"",class:"q-my-sm",outlined:"",modelValue:t.value.nominal,"onUpdate:modelValue":e[6]||(e[6]=s=>t.value.nominal=s),required:"",label:"Nominal"},null,8,["modelValue"]),a(k,{dense:"",class:"q-my-sm",outlined:"",label:"Keterangan",modelValue:t.value.keterangan,"onUpdate:modelValue":e[7]||(e[7]=s=>t.value.keterangan=s),autogrow:""},null,8,["modelValue"])]),_:1}),a(O,{"btn-delete":!f,onOnDelete:n},null,8,["btn-delete"])]),_:1})]),_:1})}}},se={class:"q-gutter-sm"},ue={__name:"KasIndex",setup(Q){const C=d([]),m=d(!1),v=d(""),t=d(!1),p=d({}),r=d("");async function f(){try{m.value=!0;const o=await M.getAll();C.value=o.kas}catch{console.log("error get kas ugt")}finally{m.value=!1}}function b(){p.value={},t.value=!0}const y=d(!1);async function q(o){r.value=`reports/ugt/kuitansi/view?id=${o.id}`,y.value=!0}function K(o){const n=o.masuk?"+":"-",_=o.masuk||o.keluar,u={id:o.id,gt_id:o.gt_id,keperluan:o.keperluan,keterangan:o.keterangan,flag:n,nominal:_};p.value=u,t.value=!0}A(async()=>{await f()});const x=[{name:"id",label:"ID",align:"left",field:"id",sortable:!0},{name:"tgl_m",label:"Tanggal",align:"left",field:"tgl_m",sortable:!0},{name:"keperluan",label:"Keperluan",align:"left",field:"keperluan",sortable:!0},{name:"keterangan",label:"Keterangan",align:"left",field:"keterangan",sortable:!0},{name:"masuk",label:"Masuk",align:"right",field:"masuk",sortable:!0},{name:"keluar",label:"Keluar",align:"right",field:"keluar",sortable:!0},{name:"saldo",label:"Saldo",align:"right",field:"saldo",sortable:!0},{name:"cr_by",label:"By",align:"left",field:"cr_by",sortable:!0},{name:"edit",label:"!",align:"center",field:"",sortable:!1}];return(o,n)=>{const _=U("CardHeader"),u=U("CardPage");return I(),S(u,null,{default:l(()=>[a(_,{title:"Kas UGT",onOnReload:f,"show-add":!0,onOnAdd:b}),a(G,{class:"q-pa-sm"},{default:l(()=>[a(Y,{bordered:"",flat:"",rows:C.value,loading:m.value,"rows-per-page-options":[10,25,50,100,0],pagination:{page:999},class:"dt q-px-sm",columns:x,filter:v.value,"no-data-label":"Tidak ada data untuk ditampilkan!","no-results-label":"Tidak ditemukan kata kunci yang sesuai dengan pencarian Anda!","row-key":"name",onRowClick:n[1]||(n[1]=(e,V,T)=>K(e,V,T))},{"top-right":l(()=>[a(k,{outlined:"",dense:"",debounce:"300",modelValue:v.value,"onUpdate:modelValue":n[0]||(n[0]=e=>v.value=e),placeholder:"Cari"},{append:l(()=>[a(P,{name:"search"})]),_:1},8,["modelValue"])]),body:l(e=>[a(E,{props:e},{default:l(()=>[a(i,{key:"id",props:e},{default:l(()=>[g(c(e.row.id),1)]),_:2},1032,["props"]),a(i,{key:"tgl_m",props:e,title:"format tanggal dd/mm/yyyy"},{default:l(()=>[g(c(w(le)(e.row.tgl_m,"dd/MM/yyyy")),1)]),_:2},1032,["props"]),a(i,{key:"keperluan",props:e},{default:l(()=>[g(c(e.row.gt_id?`${e.row.keperluan} (${e.row.gt_id})`:e.row.keperluan),1)]),_:2},1032,["props"]),a(i,{key:"keterangan",props:e},{default:l(()=>[g(c(e.row.keterangan),1)]),_:2},1032,["props"]),a(i,{key:"masuk",props:e},{default:l(()=>[g(c(w(D)(e.row.masuk)),1)]),_:2},1032,["props"]),a(i,{key:"keluar",props:e},{default:l(()=>[g(c(w(D)(e.row.keluar)),1)]),_:2},1032,["props"]),a(i,{key:"saldo",props:e},{default:l(()=>[g(c(w(D)(e.row.saldo)),1)]),_:2},1032,["props"]),a(i,{key:"cr_by",props:e},{default:l(()=>[g(c(e.row.cr_by),1)]),_:2},1032,["props"]),a(i,{key:"edit",props:e},{default:l(()=>[B("div",se,[a($,{icon:"edit","no-caps":"",color:"green-10",outline:"",dense:"",class:"q-px-md",onClick:V=>K(e.row)},null,8,["onClick"]),a($,{icon:"print","no-caps":"",color:"green-10",outline:"",dense:"",class:"q-px-md",onClick:V=>q(e.row),disable:!e.row.gt_id},null,8,["onClick","disable"])])]),_:2},1032,["props"])]),_:2},1032,["props"])]),_:1},8,["rows","loading","filter"])]),_:1}),a(F,{persistent:"",modelValue:t.value,"onUpdate:modelValue":n[4]||(n[4]=e=>t.value=e)},{default:l(()=>[a(oe,{data:p.value,onSuccessSubmit:n[2]||(n[2]=e=>f()),onSuccessDelete:n[3]||(n[3]=e=>f())},null,8,["data"])]),_:1},8,["modelValue"]),a(F,{modelValue:y.value,"onUpdate:modelValue":n[5]||(n[5]=e=>y.value=e)},{default:l(()=>[a(ae,{url:r.value},null,8,["url"])]),_:1},8,["modelValue"])]),_:1})}}},Be=te(ue,[["__scopeId","data-v-636b105b"]]);export{Be as default};
