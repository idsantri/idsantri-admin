import{A as u,B as w,c as b,o as g,w as m,b as n,ad as A,e as D,C as S,Q as $,a7 as C,y as x,ab as B,q as M,W as Q,f as U,G as q}from"./index-0PBDf7I0.js";import{_ as E}from"./TemplateArray-nkAij0dh.js";import{c as V}from"./format-date-DlwYCgkJ.js";import{a as I}from"./hijri-BBdEhqDI.js";import{r as G,d as N,g as O}from"./array-object-BytDdNh7.js";import{a as j}from"./api-get-CJU_3mwN.js";import{Q as H}from"./QForm-ieTYlGnS.js";import{_ as K}from"./InputSelectArray-BGoSDEHL.js";import{A as P}from"./ApiCrud-CgUuq5zB.js";import{u as L}from"./useCrudForm-C4qLnD9W.js";import"./QItemSection-DpSW8XO7.js";import"./QItemLabel-DR97WW3U.js";import"./QList-BR1VLd4M.js";import"./id-BuNGTsqN.js";import"./format-number-B34ySHL_.js";import"./index-BXLuJznK.js";import"./index-BDNa_dSq.js";import"./api-error-C1WPqECD.js";import"./QSelect-Cpr8vW2V.js";import"./QChip-DG5_EyRB.js";import"./QMenu-3oalsLjd.js";import"./selection-DeDWR_N3.js";import"./rtl-DFPa-2ov.js";import"./format-CJebrXOQ.js";import"./lists-store-C4dqSiKA.js";import"./DropDownAfter-f-uzuh2w.js";import"./QBtnDropdown-CEycuZRG.js";import"./QBtnGroup-BBlBx6YD.js";import"./ClosePopup-5qpDiF0T.js";import"./Lists-B91eApHM.js";import"./Api--YdEMrhi.js";class R extends P{constructor(){super("status")}async santri(i){throw await this._apiGet({endPoint:`${this._path}/santri/${i}`}),new Error("not implemented yet")}async lists(){throw await this._apiGet({endPoint:`${this._path}/lists`}),new Error("not implemented yet")}}const T=new R,W={__name:"StatusForm",props:{data:{type:Object,required:!0}},emits:["successDelete","successSubmit","successUpdate","successCreate"],setup(p,{emit:i}){const o=p,l=i,t=u({...o.data}),r=!o.data?.id,{handleDelete:c,handleCreate:f,handleUpdate:v,loading:_}=L(T,{emit:l,responseKey:"status"}),y=async()=>{const s={santri_id:t.value.santri_id,status:t.value.status,keterangan:t.value.keterangan};return r?await f(s,!0):await v(o.data.id,s,!0)},a=async()=>await c(o.data.id);return(s,e)=>{const h=w("FormHeader"),F=w("FormLoading"),k=w("FormActions");return g(),b(x,{class:"full-width",style:{"max-width":"425px"}},{default:m(()=>[n(H,{onSubmit:A(y,["prevent"])},{default:m(()=>[n(h,{title:"Input Status","is-new":r}),S(_)?(g(),b(F,{key:0})):D("",!0),n($,null,{default:m(()=>[n(C,{dense:"",outlined:"",label:"Nama","model-value":t.value?.nama+" ("+t.value?.santri_id+")",disable:"",filled:"",class:"q-my-sm"},null,8,["model-value"]),n(K,{modelValue:t.value.status,"onUpdate:modelValue":e[0]||(e[0]=d=>t.value.status=d),url:"status",label:"Status *",class:"q-my-sm",rules:[d=>!!d||"Harus diisi!"]},null,8,["modelValue","rules"]),n(C,{dense:"",class:"q-my-sm",outlined:"",label:"Keterangan",modelValue:t.value.keterangan,"onUpdate:modelValue":e[1]||(e[1]=d=>t.value.keterangan=d),autogrow:""},null,8,["modelValue"])]),_:1}),n(k,{"btn-delete":!r,onOnDelete:a},null,8,["btn-delete"])]),_:1})]),_:1})}}},kt={__name:"SantriStatus",setup(p){const i=u(!1),o=u(!1),l=u({}),t=u([]),r=u({}),{params:c}=B();async function f(){const a=await j({endPoint:`status/santri/${c.id}`,loading:i});a.status&&(t.value=a.status,r.value=a.santri)}const v=M(()=>t.value.map(a=>({Tanggal:V(a.created_at,"dd-MM-yyyy")+" | "+I(V(a.created_at,"yyyy-MM-dd")),Status:a.status,Keterangan:a.keterangan||"-",id:a.id})));Q(async()=>{await f()});const _=()=>{l.value={santri_id:r.value.id,nama:r.value.nama},o.value=!0},y=({id:a})=>{l.value=O(t,a),l.value.santri_id=r.value.id,l.value.nama=r.value.nama,o.value=!0};return(a,s)=>(g(),U("div",null,[n(E,{data:v.value,spinner:i.value,onAdd:_,onEdit:y},null,8,["data","spinner"]),n(q,{modelValue:o.value,"onUpdate:modelValue":s[3]||(s[3]=e=>o.value=e)},{default:m(()=>[n(W,{data:l.value,onSuccessDelete:s[0]||(s[0]=e=>S(N)(t.value,e)),onSuccessCreate:s[1]||(s[1]=e=>t.value.push(e)),onSuccessUpdate:s[2]||(s[2]=e=>S(G)(t.value,e.id,e))},null,8,["data"])]),_:1},8,["modelValue"])]))}};export{kt as default};
