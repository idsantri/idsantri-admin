import{q as g,ad as z,s as K,au as E,E as q,c as y,o as _,w as s,g as e,a,Q as k,e as S,v as T,b as M,F as A,D as O,aj as G,G as u,t as i,J as I,l as $,ap as J,Y,N as W,af as X,f as L,a9 as Z,C as h}from"./index-B_fOp8I2.js";import{Q as P,a as R}from"./QToolbar-CUgTqRRC.js";import{Q as N}from"./QSpace-DcIMlGPs.js";import{a as aa,b as ta,i as ea,f as V}from"./format-date-DBaFa2rd.js";import{f as la,m as Q,b as F}from"./hijri-CTUg_lXm.js";import{_ as na}from"./ReportViewer-DtN3-Gfu.js";import{Q as sa,a as H}from"./QItem-BIr2qAQs.js";import{Q as ra}from"./QList-Bhy1FtzV.js";import{_ as U}from"./IzinPesantrenForm-CXEaJT7F.js";import{I as j}from"./IzinPesantren-CgVQANCx.js";import{_ as oa}from"./CardSantriSimple-TxiBfjhH.js";import{Q as ia}from"./QForm-XW60lmKZ.js";import{_ as ua}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./id-BuNGTsqN.js";import"./format-number-B34ySHL_.js";import"./index-BF457XYG.js";import"./index-Bv8s4jzG.js";import"./QSelect-udWnZaoN.js";import"./QChip-5TM6hDLU.js";import"./QItemLabel-Dzv1rcUf.js";import"./QMenu-BsVEoqbp.js";import"./selection-CtPAXORa.js";import"./rtl-DFPa-2ov.js";import"./format-CJebrXOQ.js";import"./InputSelectSantriId-CQa7IIQ3.js";import"./Santri-W-_fqG8z.js";import"./ApiCrud-DVH4XNNQ.js";import"./Api-BNo_L0HG.js";import"./apiPost-TFI76I_W.js";import"./InputSelectArray-CnP1463e.js";import"./lists-store-CD0Hggyp.js";import"./ArrayCrud-CByp4EUn.js";import"./Lists-CqahsUVd.js";import"./lists-data-CZ3z29xr.js";import"./DropDownAfter-CV4tl_Qw.js";import"./QBtnDropdown-CfBCVMge.js";import"./QBtnGroup-DMJJVPpn.js";import"./ClosePopup-OWfInyoi.js";import"./useCrudForm-DYJRtmbD.js";import"./QSkeleton-DcawcrFc.js";import"./QImg-C4XQLp2C.js";import"./santri-store-D0uKEmX1.js";const da={class:"relative-position"},ma={class:"flex"},pa={__name:"IzinRiwayat",props:{santri_id:{required:!0}},setup(x){const c=x,d=g([]),v=g(!1),l=g(!1),{params:m}=z();K(async()=>{c.santri_id?await p(c.santri_id):d.value=[]}),E(async()=>{c.santri_id?await p(c.santri_id):d.value=[]});async function p(b){try{v.value=!0;const n=await j.getAll({params:{santri_id:b}});d.value=n.izin_pesantren}catch(n){console.log("ðŸš€ ~ getRiwayat ~ error:",n)}finally{v.value=!1}}return(b,n)=>{const o=q("CardLoading");return _(),y($,{flat:"",bordered:"",class:""},{default:s(()=>[e(k,{class:"bg-green-7 no-padding"},{default:s(()=>[e(P,{class:"no-padding no-margin"},{default:s(()=>[e(S,{icon:"sync","no-caps":"",onClick:n[0]||(n[0]=r=>p(x.santri_id)),flat:"",dense:"",class:"q-pl-sm",color:"green-11",title:"Muat ulang"}),e(R,{class:"text-subtitle1 text-green-11 q-px-none"},{default:s(()=>[...n[4]||(n[4]=[T(" Riwayat Perizinan ",-1)])]),_:1}),e(S,{color:"green-11",outline:"",dense:"","no-caps":"",icon:"add",label:"Tambah",class:"q-mr-sm q-px-md",onClick:n[1]||(n[1]=r=>l.value=!0)})]),_:1})]),_:1}),a("div",da,[d.value?.length?(_(),y(k,{key:1,class:"q-pa-sm"},{default:s(()=>[e(ra,{separator:"",bordered:""},{default:s(()=>[(_(!0),M(A,null,O(d.value,(r,f)=>(_(),y(sa,{key:f,class:G([r.id==u(m).id?"bg-green-1":"","q-pa-sm"])},{default:s(()=>[e(H,null,{default:s(()=>[a("table",null,[a("tbody",null,[a("tr",null,[n[6]||(n[6]=a("td",{class:"label"},"Tanggal:",-1)),a("td",ma,[T(i(u(aa)(r.dari_tgl)+" | "+u(la)(u(Q)(r.dari_tgl)))+" ",1),e(N),T(" "+i(r.th_ajaran_h),1)])]),a("tr",null,[n[7]||(n[7]=a("td",{class:"label"},"Izin",-1)),a("td",null,i(r.sifat)+" | "+i(r.durasi)+" hari | "+i(r.pengajuan),1)]),a("tr",null,[n[8]||(n[8]=a("td",{class:"label"},"Keperluan",-1)),a("td",null,i(r.keperluan)+" "+i(r.keterangan?" ("+r.keterangan+")":""),1)]),a("tr",null,[n[9]||(n[9]=a("td",{class:"label"},"Status",-1)),a("td",null,i(r.status),1)])])])]),_:2},1024),e(H,{side:"",class:"no-padding"},{default:s(()=>[e(S,{disable:r.id==u(m).id,icon:"info",glossy:"",dense:"",round:"",outline:"",color:"green",to:`/keamanan/izin-pesantren/${r.id}`},null,8,["disable","to"])]),_:2},1024)]),_:2},1032,["class"]))),128))]),_:1})]),_:1})):(_(),y(k,{key:0,class:"text-italic text-center q-pa-lg"},{default:s(()=>[...n[5]||(n[5]=[T(" Tidak ada untuk ditampilkan ",-1)])]),_:1})),e(o,{showing:v.value},null,8,["showing"])]),e(I,{modelValue:l.value,"onUpdate:modelValue":n[3]||(n[3]=r=>l.value=r)},{default:s(()=>[e(U,{data:{santri_id:x.santri_id,nama:d.value[0]?.nama,data_akhir:d.value[0]?.data_akhir},onSuccessDelete:r=>null,onSuccessSubmit:n[2]||(n[2]=r=>b.$router.push(`/keamanan/izin-pesantren/${r.id}`))},null,8,["data"])]),_:1},8,["modelValue"])]),_:1})}}},fa={__name:"IzinPesantrenKembaliForm",props:{data:Object},emits:["successSubmit"],setup(x,{emit:c}){const d=x,v=c,l=g({...d.data}),m=g(!1),p=J("firstInput");K(async()=>{await Y(),p.value&&p.value.focus()});async function b(){try{m.value=!0;const o=await j.setKembali({id:d.data.id,data:{kembali_tgl:l.value.kembali_tgl},message:"Tetapkan sudah kembali ke pesantren pada tanggal ini?"});o&&(document.getElementById("btn-close-form").click(),v("successSubmit",o?.izin_pesantren))}catch(o){console.error("err set not back",o)}finally{m.value=!1}}async function n(){try{m.value=!0;const o=await j.setKembali({id:d.data.id,data:{kembali_tgl:null},message:"Tetapkan belum kembali ke pesantren?"});o&&(document.getElementById("btn-close-form").click(),v("successSubmit",o?.izin_pesantren))}catch(o){console.error("err set not back",o)}finally{m.value=!1}}return W(()=>l.value.kembali_tgl,o=>{l.value.kembali_tgl=ta(o)}),(o,r)=>{const f=q("FormHeader"),t=q("FormLoading"),D=q("FormActions");return _(),y($,{class:"full-width",style:{"max-width":"425px"}},{default:s(()=>[e(ia,{onSubmit:X(b,["prevent"])},{default:s(()=>[e(f,{title:"Tetapkan Tanggal Kembali","is-new":!1}),m.value?(_(),y(t,{key:0})):L("",!0),e(k,null,{default:s(()=>[e(Z,{dense:"",hint:u(ea)(l.value.kembali_tgl)?u(V)(l.value.kembali_tgl):"",class:"q-my-sm",outlined:"",label:"Tanggal (M)*",modelValue:l.value.kembali_tgl,"onUpdate:modelValue":r[0]||(r[0]=C=>l.value.kembali_tgl=C),type:"datetime-local",rules:[C=>!!C||"Harus diisi!"],"error-color":"negative",ref_key:"firstInput",ref:p},null,8,["hint","modelValue","rules"])]),_:1}),e(D,{"btn-delete":!!x.data.kembali_tgl,onOnDelete:n,"label-delete":"Belum Kembali"},null,8,["btn-delete"])]),_:1})]),_:1})}}},ga={class:"full-width"},ca={colspan:"2"},va={class:"tw:w-full"},ba={__name:"IzinDetail",setup(x){const c=g(!1),d=g(""),v=z(),l=g({}),m=g(!1),p=g(!1),b=g(!1);function n(){d.value=`reports/izin-pesantren/view?id=${l.value.id}`,c.value=!0}async function o(){try{m.value=!0;const f=await j.getById({id:v.params.id});l.value=f.izin_pesantren}catch(f){console.log("ðŸš€ ~ loadData ~ error:",f)}finally{m.value=!1}}K(async()=>{v.params.id&&await o()});function r(f){const t=/\(\+(\d+)\)/g;return f.replace(t,(C,B)=>`(terlambat ${B} hari)`)}return(f,t)=>{const D=q("CardHeader"),C=q("CardLoading"),B=q("CardPage");return _(),y(B,null,{default:s(()=>[e(D,{title:"Detail Izin Pesantren","show-reload":!1}),e(k,{class:"tw:flex tw:flex-col tw:sm:flex-row tw:sm:justify-between tw:gap-2 q-pa-sm",style:{"max-width":"1200px"}},{default:s(()=>[e($,{class:"tw:w-full",flat:"",bordered:""},{default:s(()=>[e(k,{class:"bg-green-7 no-padding"},{default:s(()=>[e(P,{class:"no-padding no-margin"},{default:s(()=>[e(S,{icon:"sync","no-caps":"",onClick:o,flat:"",dense:"",class:"q-pl-sm",color:"green-11",title:"Muat ulang"}),e(R,{class:"text-subtitle1 text-green-11 q-px-none"},{default:s(()=>[...t[6]||(t[6]=[T(" Data Perizinan ",-1)])]),_:1}),e(S,{dense:"",class:"q-px-md q-mr-sm text-green-10",label:"Cetak","no-caps":"",icon:"print",color:"green-11",onClick:n}),e(S,{dense:"",class:"q-px-md q-mr-sm text-green-10",label:"Edit","no-caps":"",icon:"edit",color:"green-11",onClick:t[0]||(t[0]=w=>p.value=!0)})]),_:1})]),_:1}),l.value?(_(),y(k,{key:0,class:"q-pa-sm"},{default:s(()=>[e(oa,{id:l.value.santri_id},null,8,["id"]),e($,{bordered:"",flat:"",class:"q-mt-sm"},{default:s(()=>[e(k,{class:"q-pa-sm text-subtitle1 bg-green-11 flex"},{default:s(()=>[t[7]||(t[7]=T(" Data Izin ",-1)),e(N),e(S,{dense:"",label:"Kembali",icon:"manage_history","no-caps":"",class:"q-px-sm bg-green-10 text-green-12",onClick:t[1]||(t[1]=w=>b.value=!0)})]),_:1}),e(k,{class:"q-pa-sm"},{default:s(()=>[a("table",ga,[a("tbody",null,[a("tr",null,[t[8]||(t[8]=a("td",{class:""},"Sifat:",-1)),a("td",null,i(l.value.sifat),1)]),a("tr",null,[t[9]||(t[9]=a("td",{class:""},"Pengajuan:",-1)),a("td",null,i(l.value.pengajuan),1)]),a("tr",null,[t[10]||(t[10]=a("td",{class:""},"Durasi:",-1)),a("td",null,i(l.value.durasi+" hari"),1)]),a("tr",null,[t[11]||(t[11]=a("td",{class:""},"Dari Tanggal:",-1)),a("td",null,i(u(V)(l.value.dari_tgl)+" | "+u(F)(u(Q)(l.value.dari_tgl))),1)]),a("tr",null,[t[12]||(t[12]=a("td",{class:""},"Sampai Tanggal:",-1)),a("td",null,i(u(V)(l.value.sampai_tgl)+" | "+u(F)(u(Q)(l.value.sampai_tgl))),1)]),a("tr",null,[t[13]||(t[13]=a("td",{class:""},"Keperluan:",-1)),a("td",null,i(l.value.keperluan),1)]),a("tr",null,[t[14]||(t[14]=a("td",{class:""},"Keterangan:",-1)),a("td",null,i(l.value.keterangan??"-"),1)]),a("tr",null,[t[15]||(t[15]=a("td",{class:""},"Tujuan:",-1)),a("td",null,i(l.value.tujuan),1)]),a("tr",null,[t[16]||(t[16]=a("td",{class:""},"Catatan:",-1)),a("td",null,i(l.value.catatan||"-"),1)]),a("tr",null,[a("td",ca,[e(h,{color:"green-8"})])]),a("tr",null,[t[17]||(t[17]=a("td",{class:""},"Kembali:",-1)),a("td",null,i(u(V)(l.value.kembali_tgl)+" | "+u(F)(u(Q)(l.value.kembali_tgl))),1)]),a("tr",null,[t[18]||(t[18]=a("td",{class:""},"Status:",-1)),a("td",null,i(l.value.status?r(l.value.status):""),1)])])]),e(C,{showing:m.value},null,8,["showing"])]),_:1})]),_:1})]),_:1})):L("",!0)]),_:1}),a("div",va,[e(pa,{class:"",santri_id:l.value.santri_id},null,8,["santri_id"])])]),_:1}),e(I,{modelValue:p.value,"onUpdate:modelValue":t[3]||(t[3]=w=>p.value=w)},{default:s(()=>[e(U,{data:l.value,onSuccessDelete:t[2]||(t[2]=w=>f.$router.go(-1)),onSuccessSubmit:o},null,8,["data"])]),_:1},8,["modelValue"]),e(I,{modelValue:b.value,"onUpdate:modelValue":t[4]||(t[4]=w=>b.value=w)},{default:s(()=>[e(fa,{data:{id:l.value.id,kembali_tgl:l.value.kembali_tgl},onSuccessSubmit:o},null,8,["data"])]),_:1},8,["modelValue"]),e(I,{modelValue:c.value,"onUpdate:modelValue":t[5]||(t[5]=w=>c.value=w)},{default:s(()=>[e(na,{url:d.value},null,8,["url"])]),_:1},8,["modelValue"])]),_:1})}}},rt=ua(ba,[["__scopeId","data-v-82ceae78"]]);export{rt as default};
