import{Q as M}from"./QList-BwIiBKrg.js";import{c as $,o as y,w as n,g as e,Q as x,a,t as m,aq as P,l as q,q as c,ac as S,ad as V,s as N,N as U,b as J,v as A,f as K,e as D,F as L,ae as E,A as F,E as j,G as Q,J as G}from"./index-CEqRNMKa.js";import{u as O}from"./apb-accounts-store-DIydPI0j.js";import{Q as z}from"./QSelect-Cq7a2gGZ.js";import{Q as W}from"./QTd-hbrFc-CC.js";import{Q as X}from"./QTable---ca2-S5.js";import{_ as Y}from"./InputSearch-D3gMjWc4.js";import{A as Z}from"./ApbJournal-BeDh4Jxv.js";import{A as tt}from"./ApbTransaction-D0U5_QIE.js";import{c as at}from"./format-date-DBaFa2rd.js";import{f as et,m as ot}from"./hijri-CTUg_lXm.js";import{_ as R}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{_ as st}from"./ApbAccountForm-BJzhcIGj.js";import{T as lt}from"./ToAccount-BQHgQuJs.js";import{T as nt}from"./ToAccountAsset-BAjgz1Uc.js";import{T as it}from"./ToAccountGroup-DMXrdIve.js";import"./ApbAccount-DusW9Daz.js";import"./ApiCrud-DQp7e7nl.js";import"./Api-BLJ5CcMO.js";import"./index-DMQSfvx3.js";import"./index-DUDauND2.js";import"./apiPost-D18tN-j-.js";import"./ArrayCrud-CByp4EUn.js";import"./QField-D4menuIJ.js";import"./QChip-CJrHXeq1.js";import"./QItem-CE7Gw7UR.js";import"./QItemLabel-DHWqC7wC.js";import"./QMenu-CIUGaSD_.js";import"./selection-Dn82c7hT.js";import"./rtl-DFPa-2ov.js";import"./format-CJebrXOQ.js";import"./QMarkupTable-Dw-js6Pc.js";import"./use-fullscreen-CA6Cw_DM.js";import"./id-BuNGTsqN.js";import"./format-number-B34ySHL_.js";import"./QForm-BLkSNr4R.js";import"./useCrudForm-B6DzUwVC.js";import"./QBtnDropdown-xGuuc5eh.js";import"./QBtnGroup-BeWlmbWW.js";import"./ClosePopup-CfU5FfYf.js";import"./apb-account-groups-store-2a3qnIQj.js";const rt={class:"tw:flex tw:items-center tw:flex-wrap tw:justify-between tw:gap-x-4 tw:gap-y-2"},dt={class:""},ut={class:"text-body2"},ct={class:""},mt={class:"text-body2"},pt={class:""},ft={class:"text-body2"},bt={class:""},vt={class:"text-body2"},gt={class:""},_t={class:"text-body2"},wt={class:""},xt={class:""},yt={__name:"CardAccount",props:{account:{type:Object,required:!0}},setup(i){return(p,o)=>(y(),$(q,{flat:"",bordered:""},{default:n(()=>[e(x,{class:"q-pa-sm"},{default:n(()=>[a("div",rt,[a("div",dt,[o[1]||(o[1]=a("div",{class:"text-caption text-italic"},"Akun",-1)),a("div",ut,m(i.account?.id),1)]),a("div",ct,[o[2]||(o[2]=a("div",{class:"text-caption text-italic"},"Kategori",-1)),a("div",mt,m(i.account?.category),1)]),a("div",pt,[o[3]||(o[3]=a("div",{class:"text-caption text-italic"},"Grup",-1)),a("div",ft,m(i.account?.group),1)]),a("div",bt,[o[4]||(o[4]=a("div",{class:"text-caption text-italic"},"Nama",-1)),a("div",vt,m(i.account?.name),1)]),a("div",gt,[o[5]||(o[5]=a("div",{class:"text-caption text-italic"},"Saldo Normal",-1)),a("div",_t,m(i.account?.normal_balance=="D"?"Debit":"Kredit"),1)]),a("div",wt,[a("div",xt,[e(P,{"model-value":i.account?.hidden,"true-value":!0,"false-value":!1,"checked-icon":"check","unchecked-icon":"clear",color:"negative","left-label":"","onUpdate:modelValue":o[0]||(o[0]=(d,f)=>p.$emit("update",{...i.account,hidden:d}))},{default:n(()=>[...o[6]||(o[6]=[a("span",{class:"text-caption text-italic"},"Sembunyikan",-1)])]),_:1},8,["model-value"])])])])]),_:1})]),_:1}))}},ht={class:"q-mb-sm tw:flex tw:items-center tw:justify-between tw:gap-2 tw:flex-wrap"},Tt={class:"tw:flex tw:gap-4 tw:items-center"},kt={class:"bg-transparent text-subtitle2",flat:"",bordered:""},At={class:"bg-transparent text-subtitle2",flat:"",bordered:""},$t={class:"bg-transparent text-subtitle2",flat:"",bordered:""},qt={__name:"CardHistory",props:{account_id:{type:String,required:!0}},setup(i){const p=i,o=c([]),d=c(!1),f=c(null),b=c([]),r=c(null),_=c(!1),h=S(),{query:T}=V(),v=c("");async function u(){try{d.value=!0;const t=await tt.listTahunAjaranAccount(p.account_id);o.value=t.th_ajaran_h}catch(t){console.error("ðŸš€ ~ loadTahunAjaran ~ error:",t)}finally{d.value=!1}}async function w(t){try{_.value=!0;const s=await Z.accountAndTahun(p.account_id,t);b.value=s.journals,r.value=s.budget}catch(s){console.error("ðŸš€ ~ loadJournals ~ error:",s)}finally{_.value=!1}}N(async()=>{await u(),T.th&&(f.value=T.th)}),U(f,async t=>{t?(h.replace({query:{th:t}}),await w(t)):(h.replace({query:{}}),b.value=[])});const k=[{name:"transaction_id",label:"ID Transaksi",align:"center",field:"transaction_id",sortable:!0},{name:"transaction_date",label:"Dibuat (M)",align:"left",field:"transaction_date",format:t=>at(t,"dd-MM-yyyy"),sortable:!0},{name:"hijri",label:"Dibuat (H)",align:"left",field:t=>ot(t.transaction_date),format:t=>et(t),sortable:!0},{name:"description",label:"Keterangan",align:"left",field:"description",sortable:!0,style:"white-space: normal; word-wrap: break-word;"},{name:"account_id",label:"Akun ID",align:"left",field:"account_id",sortable:!0,style:"white-space: normal; word-wrap: break-word;"},{name:"debit",label:"Debit",field:"debit",format:t=>`${t?t.toRupiah():0}`,align:"right",sortable:!0},{name:"credit",label:"Kredit",field:"credit",format:t=>`${t?t.toRupiah():0}`,align:"right",sortable:!0},{name:"balance",label:"Saldo",field:"balance",format:t=>`${t?(Number(t)>=0?"+":"-")+Math.abs(t).toRupiah():0}`,align:"right",sortable:!0,classes:t=>Number(t.balance)>0?"text-primary":"text-negative"}];return(t,s)=>(y(),J(L,null,[e(x,{class:"q-pa-sm bg-green-7 text-green-11"},{default:n(()=>[...s[2]||(s[2]=[A(" Riwayat Transaksi ",-1)])]),_:1}),e(x,{class:"q-pa-sm"},{default:n(()=>[a("div",ht,[e(z,{class:"tw:max-w-sm tw:flex-grow tw:w-full",dense:"",outlined:"",modelValue:f.value,"onUpdate:modelValue":s[0]||(s[0]=l=>f.value=l),options:o.value,label:"Pilih Tahun Ajaran","emit-value":"","map-options":"",loading:d.value,clearable:"",behavior:"menu"},null,8,["modelValue","options","loading"]),e(Y,{class:"tw:max-w-sm tw:flex-grow tw:w-full",label:"Cari",modelValue:v.value,"onUpdate:modelValue":s[1]||(s[1]=l=>v.value=l),disable:!b.value?.length},null,8,["modelValue","disable"])]),r.value?.id?(y(),$(q,{key:0,bordered:"",flat:"",class:"q-mb-sm bg-green-1"},{default:n(()=>[e(x,{class:"q-pa-xs flex items-center justify-between"},{default:n(()=>[a("div",Tt,[a("div",kt,[s[3]||(s[3]=a("span",{class:"text-caption text-italic"}," Total Anggaran: ",-1)),A(" "+m(r.value?.total_budget?.toRupiah()),1)]),a("div",At,[s[4]||(s[4]=a("span",{class:"text-caption text-italic"}," Total Serapan: ",-1)),A(" "+m(r.value?.total_absorbed?.toRupiah()),1)]),a("div",$t,[s[5]||(s[5]=a("span",{class:"text-caption text-italic"}," Total Sisa: ",-1)),A(" "+m((Number(r.value?.total_budget)-Number(r.value?.total_absorbed)).toRupiah()),1)])]),e(D,{disable:!r.value?.id,outline:"","no-caps":"",dense:"",class:"q-px-sm",color:"green-10",label:"Lihat selengkapnya",to:`/apb/budgets/${r.value?.id}`},null,8,["disable","to"])]),_:1})]),_:1})):K("",!0),e(X,{columns:k,bordered:"",flat:"",rows:b.value,loading:_.value,filter:v.value,"rows-per-page-options":[10,25,50,100,0],class:"dt","no-data-label":"Tidak ada data untuk ditampilkan!","no-results-label":"Tidak ditemukan kata kunci yang sesuai dengan pencarian Anda!","row-key":"transaction_id"},{"body-cell-transaction_id":n(l=>[e(W,{props:l},{default:n(()=>[e(D,{label:l.value,"no-caps":"",size:"sm",outline:"",class:"text-green-10",to:`/apb/transactions/${l.value}`},null,8,["label","to"])]),_:2},1032,["props"])]),_:1},8,["rows","loading","filter"])]),_:1})],64))}},jt=R(qt,[["__scopeId","data-v-9b8b8c2d"]]),Ct={__name:"PageDetail",setup(i){const p=V().params,o=S(),d=O(),{loading:f,accounts:b}=E(d),{loadById:r,toggleHidden:_,add:h,remove:T}=d,v=c(0),u=F(()=>b.value.find(l=>l.id==p.id)),w=c(!1),k=async()=>{await r(p.id),v.value++},t=async l=>{h(l),l.id!=u.value.id&&(T(u.value.id),o.replace(`/apb/accounts/${l.id}`))},s=async l=>{await _(l.hidden,l.id)};return N(async()=>{u.value||await k()}),(l,g)=>{const H=j("CardHeader"),B=j("CardLoading"),I=j("CardPage");return y(),$(I,null,{default:n(()=>[e(H,{title:"Detail Akun",onOnReload:k,"show-edit":!0,onOnEdit:g[0]||(g[0]=C=>w.value=!0)},{more:n(()=>[e(M,null,{default:n(()=>[e(lt),e(it),e(nt)]),_:1})]),_:1}),(y(),$(x,{class:"q-pa-sm",key:v.value},{default:n(()=>[e(q,{flat:"",bordered:""},{default:n(()=>[e(B,{showing:Q(f),message:"",size:"4em"},null,8,["showing"]),e(yt,{account:u.value,onUpdate:s},null,8,["account"])]),_:1}),e(q,{flat:"",bordered:"",class:"q-mt-sm"},{default:n(()=>[e(jt,{account_id:u.value?.id},null,8,["account_id"])]),_:1})]),_:1})),e(G,{persistent:"",modelValue:w.value,"onUpdate:modelValue":g[2]||(g[2]=C=>w.value=C)},{default:n(()=>[e(st,{data:u.value,onSuccessSubmit:t,onSuccessDelete:g[1]||(g[1]=()=>{Q(d).remove(u.value.id),l.$router.go(-1)})},null,8,["data"])]),_:1},8,["modelValue"])]),_:1})}}},ga=R(Ct,[["__scopeId","data-v-71113f6c"]]);export{ga as default};
