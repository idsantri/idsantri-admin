import{x as r,R as V,y,c as b,o as _,w as c,b as n,a9 as B,a as C,n as F,a3 as w,s as S,a7 as I,k as x,g as M,z as D,B as U}from"./index-Bf-p91mW.js";import{_ as Q}from"./TemplateArray-DT58ZlLN.js";import{c as k}from"./format-date-DlwYCgkJ.js";import{a as $}from"./hijri-BBdEhqDI.js";import{r as A,d as E,g as O}from"./array-object-BytDdNh7.js";import{a as P}from"./api-get-CiRdORW1.js";import{Q as j}from"./QForm-OmDQHoiq.js";import{a as q}from"./api-post-CHcQycZS.js";import{a as N}from"./api-update-BYe6B3v5.js";import{a as H}from"./api-delete-BVHfd1pG.js";import{_ as K}from"./InputSelectArray-Jz4ksDX6.js";import"./QSpinnerCube-CRIto8Mg.js";import"./QItemSection-Bl4rOme3.js";import"./QItemLabel-sjS6zLD0.js";import"./QList-51Eu5HNp.js";import"./id-BuNGTsqN.js";import"./format-number-B34ySHL_.js";import"./index-D7WC_quC.js";import"./index-BtaF3-6r.js";import"./api-error-C0HjZ2a3.js";import"./QSelect-Co09SqkM.js";import"./QChip-DeZPZCXp.js";import"./QMenu-BvL1IfNl.js";import"./selection-CE9S_xiH.js";import"./rtl-DFPa-2ov.js";import"./format-CJebrXOQ.js";import"./lists-store-F5P_xNBX.js";import"./lists-data-mcTvx2m2.js";import"./DropDownAfter-wYSCUu7Z.js";import"./QBtnDropdown-Br6y2eVM.js";import"./QBtnGroup-BDP931ZD.js";import"./ClosePopup-HTVnKVBl.js";import"./Lists-DSwT9YX9.js";import"./ApiCrud-SVFtkNw7.js";const L={__name:"DomisiliForm",props:{data:{type:Object,required:!0}},emits:["successDelete","successSubmit","successUpdate","successCreate"],setup(g,{emit:p}){const d=g,o=p,e=r({}),s=r(!1);V(async()=>{Object.assign(e.value,d.data)});const f=async()=>{const m={santri_id:e.value.santri_id,domisili:e.value.domisili,keterangan:e.value.keterangan};let a=null;const u=!e.value.id;u?a=await q({endPoint:"domisili",data:m,loading:s}):a=await N({endPoint:`domisili/${e.value.id}`,data:m,confirm:!0,notify:!0,loading:s}),a&&(document.getElementById("btn-close-form").click(),o("successSubmit",a?.domisili),o(u?"successCreate":"successUpdate",a?.domisili))},v=async()=>{const m=e.value.id;await H({endPoint:`domisili/${m}`,loading:s})&&(document.getElementById("btn-close-form").click(),o("successDelete",m))};return(m,a)=>{const u=y("FormHeader"),t=y("FormLoading"),l=y("FormActions");return _(),b(S,{class:"full-width",style:{"max-width":"425px"}},{default:c(()=>[n(j,{onSubmit:B(f,["prevent"])},{default:c(()=>[n(u,{title:"Input Domisili","is-new":!e.value.id},null,8,["is-new"]),s.value?(_(),b(t,{key:0})):C("",!0),n(F,null,{default:c(()=>[n(w,{class:"q-my-sm",dense:"",outlined:"",label:"Nama","model-value":e.value?.nama+" ("+e.value?.santri_id+")",disable:"",filled:""},null,8,["model-value"]),n(K,{class:"q-my-sm",modelValue:e.value.domisili,"onUpdate:modelValue":a[0]||(a[0]=i=>e.value.domisili=i),url:"domisili",label:"Domisili *",rules:[i=>!!i||"Harus diisi!"]},null,8,["modelValue","rules"]),n(w,{class:"q-my-sm",dense:"",outlined:"",label:"Keterangan",modelValue:e.value.keterangan,"onUpdate:modelValue":a[1]||(a[1]=i=>e.value.keterangan=i),autogrow:""},null,8,["modelValue"])]),_:1}),n(l,{"btn-delete":!!e.value.id,onOnDelete:v},null,8,["btn-delete"])]),_:1})]),_:1})}}},Be={__name:"SantriDomisili",setup(g){const p=r(!1),d=r(!1),o=r({}),e=r([]),s=r({}),{params:f}=I();async function v(){const t=await P({endPoint:`domisili/santri/${f.id}`,loading:p});t.domisili&&(e.value=t.domisili,s.value=t.santri)}const m=x(()=>e.value.map(t=>({Tanggal:k(t.created_at,"dd-MM-yyyy")+" | "+$(k(t.created_at,"yyyy-MM-dd")),Domisili:t.domisili,Keterangan:t.keterangan||"-",id:t.id})));V(async()=>{await v()});const a=()=>{o.value={santri_id:s.value.id,nama:s.value.nama},d.value=!0},u=({id:t})=>{o.value=O(e,t),o.value.santri_id=s.value.id,o.value.nama=s.value.nama,d.value=!0};return(t,l)=>(_(),M("div",null,[n(Q,{data:m.value,spinner:p.value,onAdd:a,onEdit:u},null,8,["data","spinner"]),n(U,{modelValue:d.value,"onUpdate:modelValue":l[3]||(l[3]=i=>d.value=i)},{default:c(()=>[n(L,{data:o.value,title:"Input Domisili",onSuccessDelete:l[0]||(l[0]=i=>D(E)(e.value,i)),onSuccessCreate:l[1]||(l[1]=i=>e.value.push(i)),onSuccessUpdate:l[2]||(l[2]=i=>D(A)(e.value,i.id,i))},null,8,["data"])]),_:1},8,["modelValue"])]))}};export{Be as default};
