import{E as D,c as g,o as p,w as e,g as a,Q as q,a as _,t as O,r as la,b as H,F as M,D as na,l as L,n as k,v as V,p as K,q as C,af as oa,a9 as h,aa as z,ad as G,e as c,J as W,ae as ia,A as E,s as sa,G as j}from"./index-DU_HTlLB.js";import{g as ra,f as J}from"./format-date-DBaFa2rd.js";import{Q as X}from"./QSpace-qysJYOyt.js";import{Q as ua}from"./QImg-DkL3_Rkg.js";import{_ as da}from"./ImageUploader-DNqZWpIz.js";import{s as Q}from"./santri-store-CoBrUaru.js";import{b as ma}from"./hijri-FEY2XuSe.js";import{Q as B}from"./QRouteTab-yccmxXDV.js";import{Q as S}from"./QItemLabel-L7dSSnSA.js";import{Q as I,a as s}from"./QItem-BbodOwCO.js";import{Q as Y}from"./QList-DmBsZOwe.js";import{Q as Z}from"./QBtnDropdown-Dc57Ck4Y.js";import{Q as pa}from"./QTabs-hSWqx3uf.js";import{C as y}from"./ClosePopup-rX8lBwqX.js";import{d as fa}from"./dialog-store-CtNDtZVZ.js";import{a as ca}from"./api-get-C_HGQ1i3.js";import{a as N}from"./api-download-JZfdvj7C.js";import{_ as ga}from"./ReportViewer-CX4b6yYe.js";import{Q as R}from"./QSelect-aBcEPTX0.js";import{Q as va}from"./QForm-DITd0Hw9.js";import{d as _a}from"./index-Bkc3wIyA.js";import{_ as ba}from"./InputSelectArray-DYbXt-XS.js";import{l as wa}from"./loading-store-l6bB7hf0.js";import{S as ka}from"./Santri-jJ7nPQ4X.js";import{C as Va}from"./CardListTabel-DFt3Suij.js";import{f as Sa}from"./format-text-DnCGEu2I.js";import"./id-BuNGTsqN.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./index-qAgkCKpN.js";import"./format-number-B34ySHL_.js";import"./QBtnGroup-C4NJIEbX.js";import"./QMenu-CI7rZ4oV.js";import"./selection-DVZ_h5Pg.js";import"./QResizeObserver-D-HUoSLs.js";import"./rtl-DFPa-2ov.js";import"./api-error-B8ANjOsk.js";import"./QField-D_RK9dyS.js";import"./QChip-D50d__-6.js";import"./format-CJebrXOQ.js";import"./lists-store-DOh1Pajr.js";import"./ArrayCrud-CkcA-ixF.js";import"./DropDownAfter-BhmZwgir.js";import"./Lists-BX2MfUpl.js";import"./ApiCrud-CEbaue1g.js";import"./Api-NxoWfBb3.js";import"./QMarkupTable-Bf_AFg38.js";const Ia={class:"flex items-center"},ya={class:"text-subtitle2"},Ca={class:"col-4 q-pr-sm relative-position"},qa={class:"col"},$a={class:"text-caption text-italic"},ha={class:"q-mb-sm"},Qa={__name:"CardIdentity",props:{title:String,data:Object,image:String,loading:Boolean,loadingImage:Boolean},setup(f){return(t,b)=>{const o=D("CardLoading");return p(),g(L,{flat:"",bordered:""},{default:e(()=>[a(q,{class:"bg-green-7 text-green-11 q-pa-sm"},{default:e(()=>[_("div",Ia,[_("div",ya,O(f.title),1),a(X)])]),_:1}),a(q,{class:"q-pa-sm row"},{default:e(()=>[_("div",Ca,[a(ua,{src:f.image,ratio:3/4,alt:"santri"},null,8,["src"]),la(t.$slots,"button"),a(o,{showing:f.loadingImage,message:""},null,8,["showing"])]),_("div",qa,[(p(!0),H(M,null,na(f.data,(l,u)=>(p(),H("div",{key:u},[_("div",$a,O(u),1),_("div",ha,O(l),1)]))),128))]),a(o,{showing:f.loading},null,8,["showing"])]),_:3})]),_:3})}}},Da={__name:"SantriRelations",props:{santriId:{default:null}},setup(f){const t=f;return(b,o)=>{const l=D("router-view");return p(),g(L,{bordered:"",flat:""},{default:e(()=>[a(q,{class:"bg-green-7 text-green-11 no-padding"},{default:e(()=>[a(pa,{"no-caps":"","outside-arrows":"","mobile-arrows":"",dense:"","indicator-color":"green-13",align:"left"},{default:e(()=>[a(B,{name:"wali",label:"Wali",to:"/santri/"+t.santriId+"/wali"},null,8,["to"]),a(B,{name:"ortu",label:"Ortu",to:"/santri/"+t.santriId+"/ortu"},null,8,["to"]),a(B,{name:"status",label:"Status",to:"/santri/"+t.santriId+"/status"},null,8,["to"]),a(B,{name:"kelas",label:"Kelas",to:"/santri/"+t.santriId+"/kelas"},null,8,["to"]),a(B,{name:"domisili",label:"Domisili",to:"/santri/"+t.santriId+"/domisili"},null,8,["to"]),a(X),a(Z,{flat:"",dense:"","dropdown-icon":"more_vert",class:"q-pl-md",color:"green-11"},{default:e(()=>[a(Y,null,{default:e(()=>[k((p(),g(I,{to:"/iuran/santri/"+t.santriId},{default:e(()=>[a(s,null,{default:e(()=>[a(S,null,{default:e(()=>[...o[0]||(o[0]=[V("Iuran",-1)])]),_:1})]),_:1}),a(s,{avatar:""},{default:e(()=>[a(K,{name:"payments",flat:""})]),_:1})]),_:1},8,["to"])),[[y]]),k((p(),g(I,{to:"/keamanan/izin-pesantren/santri/"+t.santriId},{default:e(()=>[a(s,null,{default:e(()=>[a(S,null,{default:e(()=>[...o[1]||(o[1]=[V("Izin Pesantren",-1)])]),_:1})]),_:1}),a(s,{avatar:""},{default:e(()=>[a(K,{name:"transfer_within_a_station",flat:""})]),_:1})]),_:1},8,["to"])),[[y]]),k((p(),g(I,{to:"/keamanan/indisipliner/santri/"+t.santriId},{default:e(()=>[a(s,null,{default:e(()=>[a(S,null,{default:e(()=>[...o[2]||(o[2]=[V("Indisipliner",-1)])]),_:1})]),_:1}),a(s,{avatar:""},{default:e(()=>[a(K,{name:"directions_run",flat:""})]),_:1})]),_:1},8,["to"])),[[y]])]),_:1})]),_:1})]),_:1})]),_:1}),a(q,{class:"q-pa-sm"},{default:e(()=>[a(l)]),_:1})]),_:1})}}},Ua={__name:"SantriPermohonanBerhentiForm",props:{data:{type:Object,required:!0}},emits:["successSubmit"],setup(f,{emit:t}){const b=t,o=f,l=C({jenis_permohonan:"Berhenti",tunggakan:"Lunas"}),u=C({...o.data});async function v(){const d=JSON.parse(JSON.stringify(l.value));if(!d.tunggakan||!d.jenis_permohonan||!d.alasan||!d.wali_nama||!d.wali_status||!d.wali_hubungan)return _a("Isian tidak lengkap");d.id=u.value.id,b("successSubmit",d),document.getElementById("btn-close-form")?.click()}return(d,n)=>{const U=D("FormHeader"),x=D("FormActions");return p(),g(L,{class:"full-width",style:{"max-width":"425px"}},{default:e(()=>[a(va,{onSubmit:oa(v,["prevent"])},{default:e(()=>[a(U,{title:"Permohonan Berhenti","is-new":!0}),a(q,{class:"q-pa-sm"},{default:e(()=>[a(h,{dense:"",class:"q-my-sm",outlined:"",label:"Santri ID",modelValue:u.value.id,"onUpdate:modelValue":n[0]||(n[0]=i=>u.value.id=i),filled:"",disable:""},null,8,["modelValue"]),a(h,{dense:"",class:"q-my-sm",outlined:"",label:"Nama",modelValue:u.value.nama,"onUpdate:modelValue":n[1]||(n[1]=i=>u.value.nama=i),filled:"",disable:""},null,8,["modelValue"]),a(R,{dense:"",class:"q-my-sm",outlined:"",label:"Tunggakan*",modelValue:l.value.tunggakan,"onUpdate:modelValue":n[2]||(n[2]=i=>l.value.tunggakan=i),options:["Lunas","Belum Lunas"],clearable:"","use-input":"","new-value-mode":"add",behavior:"menu"},null,8,["modelValue"]),a(R,{dense:"",class:"q-my-sm",outlined:"",label:"Jenis Permohonan*",modelValue:l.value.jenis_permohonan,"onUpdate:modelValue":n[3]||(n[3]=i=>l.value.jenis_permohonan=i),options:["Berhenti","Cuti/Istirahat"],clearable:"","use-input":"","new-value-mode":"add",behavior:"menu"},null,8,["modelValue"]),a(h,{dense:"",class:"q-my-sm",outlined:"",label:"Alasan*",modelValue:l.value.alasan,"onUpdate:modelValue":n[4]||(n[4]=i=>l.value.alasan=i),autogrow:""},null,8,["modelValue"]),a(L,{class:"",flat:"",bordered:""},{default:e(()=>[a(q,{class:"q-py-none q-px-sm"},{default:e(()=>[n[11]||(n[11]=_("div",{class:"text-subtitle2 q-my-sm"},"Identitas Pemohon (Wali)",-1)),a(h,{dense:"",class:"",outlined:"",label:"Nama*",modelValue:l.value.wali_nama,"onUpdate:modelValue":n[5]||(n[5]=i=>l.value.wali_nama=i)},null,8,["modelValue"]),a(h,{dense:"",class:"q-my-sm",outlined:"",label:"Nomor Telepon",modelValue:l.value.wali_no_telepon,"onUpdate:modelValue":n[6]||(n[6]=i=>l.value.wali_no_telepon=i)},null,8,["modelValue"]),a(R,{dense:"",class:"q-my-sm",outlined:"",label:"Bukti Diri",modelValue:l.value.wali_bukti_diri,"onUpdate:modelValue":n[7]||(n[7]=i=>l.value.wali_bukti_diri=i),options:["KTP","SIM"],clearable:"","use-input":"","new-value-mode":"add",behavior:"menu"},null,8,["modelValue"]),a(h,{dense:"",class:"q-my-sm",outlined:"",label:"Nomor / ID Bukti Diri",modelValue:l.value.wali_bukti_diri_id,"onUpdate:modelValue":n[8]||(n[8]=i=>l.value.wali_bukti_diri_id=i)},null,8,["modelValue"]),a(R,{dense:"",class:"q-my-sm",outlined:"",label:"Status*",modelValue:l.value.wali_status,"onUpdate:modelValue":n[9]||(n[9]=i=>l.value.wali_status=i),options:["Wali","Wakil Wali"],clearable:"","use-input":"","new-value-mode":"add",behavior:"menu"},null,8,["modelValue"]),a(ba,{modelValue:l.value.wali_hubungan,"onUpdate:modelValue":n[10]||(n[10]=i=>l.value.wali_hubungan=i),url:"hubungan-wali",label:"Hubungan*",class:"q-my-sm","use-input":"","new-value-mode":"add"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),a(x,{"btn-delete":!1,labelSubmit:"Cetak",iconSubmit:"print"})]),_:1})]),_:1})}}},xa={__name:"DropDownPrint",props:{santri:{type:Object,required:!0}},setup(f){const t=f,{loadingMain:b}=z(wa()),o=G(),l=C(!1),u=C(""),v=C(!1);async function d(){await N({endPoint:`reports/santri/registrasi/download?id=${o.params.id}`,loading:b,fileName:"registrasi-"+o.params.id,confirm:!0,message:"Download data registrasi?"})}async function n(){await N({endPoint:`reports/santri/standbook/download?id=${o.params.id}`,loading:b,fileName:"standbook-"+o.params.id,confirm:!0,message:"Download standbook?"})}async function U(){await N({endPoint:`reports/santri/keterangan-berhenti/download?id=${o.params.id}`,loading:b,fileName:"keterangan-berhenti-"+o.params.id,confirm:!0,message:"Download Keterangan Berhenti"})}async function x(){await N({endPoint:`reports/santri/id-card/download?id=${o.params.id}`,loading:b,fileName:"card-"+o.params.id+" ~ "+t.santri.nama,confirm:!0,message:"Download ID Card"})}function i(){u.value=`reports/santri/registrasi/view?id=${o.params.id}`,v.value=!0}function F(){u.value=`reports/santri/standbook/view?id=${o.params.id}`,v.value=!0}function T(w){l.value=!1;const r=new URLSearchParams(w).toString();u.value=`reports/santri/permohonan-berhenti/view?${r}`,v.value=!0}function A(){u.value=`reports/santri/keterangan-berhenti/view?id=${o.params.id}`,v.value=!0}return(w,r)=>(p(),H(M,null,[a(Z,{color:"green-10",label:w.$q.screen.lt.sm?"":"Cetak",icon:"print","no-caps":"",dense:"",outline:"",class:"q-px-sm text-green-11"},{default:e(()=>[a(Y,null,{default:e(()=>[k((p(),g(I,null,{default:e(()=>[a(s,null,{default:e(()=>[a(S,null,{default:e(()=>[...r[3]||(r[3]=[V("Registrasi",-1)])]),_:1})]),_:1}),a(s,{avatar:""},{default:e(()=>[a(c,{icon:"download",flat:"",onClick:d})]),_:1}),a(s,{avatar:""},{default:e(()=>[a(c,{icon:"print",flat:"",onClick:i})]),_:1})]),_:1})),[[y]]),k((p(),g(I,null,{default:e(()=>[a(s,null,{default:e(()=>[a(S,null,{default:e(()=>[...r[4]||(r[4]=[V("Standbook",-1)])]),_:1})]),_:1}),a(s,{avatar:""},{default:e(()=>[a(c,{icon:"download",flat:"",onClick:n})]),_:1}),a(s,{avatar:""},{default:e(()=>[a(c,{icon:"print",flat:"",onClick:F})]),_:1})]),_:1})),[[y]]),k((p(),g(I,null,{default:e(()=>[a(s,null,{default:e(()=>[a(S,null,{default:e(()=>[...r[5]||(r[5]=[V("Permohonan Berhenti",-1)])]),_:1})]),_:1}),a(s,{avatar:""},{default:e(()=>[a(c,{icon:"download",flat:"",disable:""})]),_:1}),a(s,{avatar:""},{default:e(()=>[a(c,{icon:"print",flat:"",onClick:r[0]||(r[0]=$=>l.value=!0)})]),_:1})]),_:1})),[[y]]),k((p(),g(I,null,{default:e(()=>[a(s,null,{default:e(()=>[a(S,null,{default:e(()=>[...r[6]||(r[6]=[V("Keterangan Berhenti",-1)])]),_:1})]),_:1}),a(s,{avatar:""},{default:e(()=>[a(c,{icon:"download",flat:"",onClick:U})]),_:1}),a(s,{avatar:""},{default:e(()=>[a(c,{icon:"print",flat:"",onClick:A})]),_:1})]),_:1})),[[y]]),k((p(),g(I,null,{default:e(()=>[a(s,null,{default:e(()=>[a(S,null,{default:e(()=>[...r[7]||(r[7]=[V("ID Card",-1)])]),_:1})]),_:1}),a(s,{avatar:""},{default:e(()=>[a(c,{icon:"download",flat:"",onClick:x})]),_:1}),a(s,{avatar:""},{default:e(()=>[a(c,{icon:"print",flat:"",disable:""})]),_:1})]),_:1})),[[y]])]),_:1})]),_:1},8,["label"]),a(W,{modelValue:l.value,"onUpdate:modelValue":r[1]||(r[1]=$=>l.value=$)},{default:e(()=>[a(Ua,{onSuccessSubmit:T,data:t.santri},null,8,["data"])]),_:1},8,["modelValue"]),a(W,{modelValue:v.value,"onUpdate:modelValue":r[2]||(r[2]=$=>v.value=$)},{default:e(()=>[a(ga,{url:u.value},null,8,["url"])]),_:1},8,["modelValue"])],64))}},Ba={class:"row"},Pa={class:"col-12 col-sm-6 col-md-4 q-pa-sm"},ja={class:"col-12 col-sm-6 col-md-5 q-pa-sm"},he={__name:"SantriDetail",setup(f){const{santri:t}=ia(Q()),o=G().params.id,l=fa(),{searchSantri:u,crudSantri:v}=z(l),d=C(!1),n=C(!1);async function U(){const m=await ca({endPoint:`images/santri/${o}`,loading:n});t.image_url=m.image_url}const x=E(()=>{if(t.value?.tgl_lahir){const m=ra(t.value.tgl_lahir);return m.tahun+" tahun, "+m.bulan+" bulan, "+m.hari+" hari"}else return"-"});async function i(){Q().$reset();try{d.value=!0;const m=await ka.getById({id:o});m&&(Q().setSantri(m.santri),Q().setOrtu(m.ortu),Q().setWali(m.wali))}catch{}finally{d.value=!1}}const F=E(()=>[{label:"ID",value:t.value.id},{label:"Tanggal Daftar",value:J(t.value.tgl_daftar_m)+" | "+ma(t.value.tgl_daftar_h)},{label:"Tahun Ajaran",value:`${t.value.th_ajaran_h||"-"} | ${t.value.th_ajaran_m||"-"}`}]),T=E(()=>({Nama:`${t.value.nama?t.value.nama?.toUpperCase():""} (${t.value.sex?.toUpperCase()})`,Alamat:Sa(t.value.jl,t.value.rt,t.value.rw,t.value.desa,t.value.kecamatan,t.value.kabupaten,t.value.provinsi,t.value.kode_pos),Kelahiran:`${t.value.tmp_lahir||"-"}, ${J(t.value.tgl_lahir)}`,Umur:x.value,"Data Akhir":t.value.data_akhir||"-"}));sa(async()=>{await i()});function A(){Q().setEdit(),v.value=!0}const w=C(!1),r=m=>w.value=m;async function $(){w.value=!1,await U()}return(m,P)=>{const aa=D("CardHeader"),ea=D("CardPage");return p(),g(ea,null,{default:e(()=>[a(aa,{title:"Data Santri",onOnReload:i,"show-edit":!0,onOnEdit:A},{buttons:e(()=>[a(c,{label:m.$q.screen.lt.sm?"":"Cari",onClick:P[0]||(P[0]=ta=>u.value=!0),color:"green-2","no-caps":"",dense:"",class:"q-px-sm text-green-10",icon:"search"},null,8,["label"]),a(xa,{santri:j(t)},null,8,["santri"])]),_:1}),a(q,{class:"no-padding"},{default:e(()=>[_("div",Ba,[_("div",Pa,[a(Va,{class:"q-mb-sm",data:F.value,loading:d.value,title:"Registrasi"},null,8,["data","loading"]),a(Qa,{class:"q-mb-sm",title:"Identitas",data:T.value,loading:d.value,loadingImage:n.value,image:j(t)?.image_url||"/user-default.png"},{button:e(()=>[a(c,{class:"q-mt-sm full-width",icon:"upload","no-caps":"",label:"Foto",dense:"",size:"sm",outline:"",color:"green-10",onClick:P[1]||(P[1]=ta=>w.value=!0)})]),_:1},8,["data","loading","loadingImage","image"])]),_("div",ja,[a(Da,{"santri-id":j(o)},null,8,["santri-id"])])])]),_:1}),a(da,{"img-format":"jpg","show-uploader":w.value,url:`/images/santri/${j(o)}`,onUpdateUploader:r,onSuccessUpload:$},null,8,["show-uploader","url"])]),_:1})}}};export{he as default};
