import{ai as U,q as n,ad as A,s as D,E as k,c as M,o as B,w as s,g as t,Q as m,a as l,ap as f,l as H,v as I,t as h,G as N,a9 as $,m as E,e as w}from"./index-BeuhZ-ol.js";import{Q as F}from"./QTable-DhN6aArA.js";import{Q as G}from"./QSpace-D9jlXOGO.js";import{Q as J}from"./QSpinnerFacebook-CsZBegeQ.js";import{Q as R}from"./QInnerLoading-DTo_Hmaz.js";import{a as z}from"./api-get-ItlXgaJz.js";import{a as K}from"./api-post-BoCtEaTJ.js";import{_ as L}from"./FilterKelas-CNOdRMHR.js";import{_ as O}from"./InputSelectIuranPaket-DaKjWmIn.js";import{d as x}from"./index-BXhUsTyQ.js";import{f as W,a as X}from"./id-BuNGTsqN.js";import"./QList-SMP-2XJV.js";import"./QMarkupTable-D4fBkLtu.js";import"./QSelect-CSuiH4Z6.js";import"./QField-4_Uk7UCx.js";import"./QChip-CWLqqxtS.js";import"./QItem-qAKJqzX7.js";import"./QItemLabel-CMAJZVV_.js";import"./QMenu-8-e25rsX.js";import"./selection-DHH_NrKf.js";import"./rtl-DFPa-2ov.js";import"./format-CJebrXOQ.js";import"./use-fullscreen-DHuhaxT_.js";import"./index-Cg0spb8C.js";import"./api-error-FN4ckS3j.js";import"./QToolbar-Cw6vXvLw.js";import"./api-get-lists-G1pjdwyA.js";import"./QSlideTransition-Beo3GlRK.js";import"./ClosePopup-3JOTOK1J.js";const Y={class:"no-padding full-width row no-wrap justify-between items-start content-start scroll"},Z={class:"q-mt-sm",style:{"min-width":"500px",width:"100%"}},aa={class:"q-mt-sm",style:{"min-width":"400px",width:"70%"}},ea={class:"vertical-top"},ta={class:"vertical-top"},la={class:"vertical-top"},sa={class:""},Ma={__name:"PageTagihan",setup(oa){const y=U(),{email:V}=y.user,_=n(!1),Q=n(""),b=n(!1),{params:i}=A(),d=n([]),r=n([]),p=n([]),v=n(!1),c=n({th_ajaran_h:i.th_ajaran_h||""}),q=W(new Date,"yyyy-MM-dd HH:mm:ss",{locale:X})+" ~ "+V||"",u=n("");async function j(){const o=await z({endPoint:"kelas",params:{th_ajaran_h:i.th_ajaran_h,tingkat_id:i.tingkat_id,kelas:i.kelas},loading:b});o&&(d.value=o.murid)}D(async()=>{i.th_ajaran_h&&i.tingkat_id&&i.kelas?await j():d.value=[]});async function P(){if(!r.value.length)return x("Pilih murid terlebih dahulu");if(!p.value.length)return x("Pilih paket terlebih dahulu");const o={th_ajaran_h:c.value.th_ajaran_h,va_group:u.value,santri_id:r.value.map(a=>a.santri_id),paket:p.value.map(a=>({item:a.item,nominal:a.nominal}))};await K({endPoint:"iuran/paket-massal",loading:v,data:o,message:`PERHATIAN<br/>
			Jika item iuran sudah terdapat dalam daftar maka akan diabaikan.
			<hr/>
			<span style="color:red">Kesalahan akibat aksi ini sulit ditelusuri dan harus diperbaiki satu per satu.</span>`})}const C=[{name:"santri_id",label:"ID Santri",align:"left",field:"santri_id",sortable:!0},{name:"nama",label:"Nama",align:"left",field:"nama",sortable:!0},{name:"domisili",label:"Domisili",align:"left",field:"domisili",sortable:!0},{name:"status",label:"Status",align:"left",field:"status",sortable:!0},{name:"wali",label:"Wali",align:"left",field:o=>`${o.wali_nama} (${o.wali_sex}; ${o.wali_status})`,sortable:!0}];return(o,a)=>{const S=k("CardHeader"),T=k("CardPage");return B(),M(T,null,{default:s(()=>[t(S,{"show-reload":!1,title:"Modul Tagihan"}),t(m,{class:"q-pa-sm"},{default:s(()=>[t(L,{bordered:"",flat:"","show-ujian-ke":!1,"start-url":"/iuran/tagihan",onDataFilter:a[0]||(a[0]=e=>Q.value=e)}),l("div",Y,[l("div",Z,[t(F,{flat:"",bordered:"","table-header-class":"bg-green-2 text-green-10 text-subtitle1",class:"dt",rows:d.value,columns:C,loading:b.value,"row-key":"id",selection:"multiple",selected:r.value,"onUpdate:selected":a[1]||(a[1]=e=>r.value=e),"rows-per-page-options":[0],"hide-bottom":"",style:{height:"635px"},"virtual-scroll":""},{"header-selection":s(e=>[t(f,{modelValue:e.selected,"onUpdate:modelValue":g=>e.selected=g,color:"green-7","checked-icon":"check","unchecked-icon":"clear"},null,8,["modelValue","onUpdate:modelValue"])]),"body-selection":s(e=>[t(f,{modelValue:e.selected,"onUpdate:modelValue":g=>e.selected=g,color:"green-5","checked-icon":"check","unchecked-icon":"clear"},null,8,["modelValue","onUpdate:modelValue"])]),_:1},8,["rows","loading","selected"])]),l("div",aa,[t(H,{bordered:"",flat:"",class:"q-ml-sm scroll",style:{height:"635px"}},{default:s(()=>[t(m,{class:"q-px-sm q-py-md bg-green-2 text-green-10 text-subtitle2"},{default:s(()=>[...a[6]||(a[6]=[I(" Buat Tagihan Massal ",-1)])]),_:1}),t(m,{class:"q-pa-sm"},{default:s(()=>[l("table",null,[l("tbody",null,[l("tr",ea,[a[7]||(a[7]=l("td",{class:"text-no-wrap text-italic q-pr-md"},"Jumlah Murid",-1)),l("td",null,h(d.value.length),1)]),l("tr",ta,[a[8]||(a[8]=l("td",{class:"text-no-wrap text-italic q-pr-md"},"Terpilih",-1)),l("td",null,h(r.value.length)+" santri "+h(r.value.map(e=>e.santri_id)),1)]),l("tr",la,[a[9]||(a[9]=l("td",{class:"text-no-wrap text-italic q-pr-md"},"VA Group",-1)),l("td",sa,[t(f,{dense:"",modelValue:_.value,"onUpdate:modelValue":[a[2]||(a[2]=e=>_.value=e),a[3]||(a[3]=e=>e?u.value=N(q):u.value="")],color:"green",label:u.value},null,8,["modelValue","label"])])])])])]),_:1}),t(m,{class:"q-pa-sm"},{default:s(()=>[t($,{label:"Tahun Ajaran",outlined:"",dense:"",modelValue:c.value.th_ajaran_h,"onUpdate:modelValue":a[4]||(a[4]=e=>c.value.th_ajaran_h=e),disable:""},null,8,["modelValue"]),t(O,{class:"q-mt-sm",onOnInput:a[5]||(a[5]=e=>p.value=e)})]),_:1}),t(E,{class:"q-pa-sm bg-green-6 absolute-bottom"},{default:s(()=>[t(w,{label:"Unduh Data",glossy:"",color:"green-9",class:"text-green-11","no-caps":"",icon:"download",to:"/iuran/download"}),t(G),t(w,{label:"Simpan",glossy:"",outline:"",color:"green-10",class:"bg-green-11 right-0","no-caps":"",icon:"save",onClick:P})]),_:1}),t(R,{showing:v.value},{default:s(()=>[t(J,{color:"green-6",size:"6em"})]),_:1},8,["showing"])]),_:1})])])]),_:1})]),_:1})}}};export{Ma as default};
