import{ac as T,v as i,a7 as U,R as A,f as D,o as M,w as s,i as e,q as k,Q as m,k as l,aa as g,j as $,t as _,z as B,a3 as C,m as I,p as w}from"./index-BOc7y3E3.js";import{Q as N}from"./QTable-CATdYY-T.js";import{Q as F}from"./QSpace-CoisEuyS.js";import{Q as H}from"./QSpinnerFacebook-CumbsqR-.js";import{Q as R}from"./QInnerLoading-GSbaVWQs.js";import{Q as z}from"./QPage-BVhxSLxX.js";import{a as E}from"./api-get-DUTCLQ7F.js";import{a as G}from"./api-post-CPwNAYjq.js";import{_ as J}from"./CardHeader-B086-4Fs.js";import{_ as K}from"./FilterKelas-BNcny4WJ.js";import{_ as L}from"./InputSelectIuranPaket-Ch-7yPEX.js";import{d as x}from"./index-CdkvXyXH.js";import{f as O,a as W}from"./id-BuNGTsqN.js";import"./QList-DGdmu--E.js";import"./QMarkupTable-Dp9ldZmi.js";import"./QSelect-Br9kkI5Z.js";import"./QChip-DferuxmN.js";import"./QItemSection-U4VUPMG0.js";import"./QItemLabel-CrvmL7Ku.js";import"./QMenu-iXJrGXAP.js";import"./selection-CUoFkLvB.js";import"./rtl-DFPa-2ov.js";import"./format-CJebrXOQ.js";import"./use-fullscreen-DZQzNGwS.js";import"./index-CHOBZr16.js";import"./api-error-CtGrtfSx.js";import"./QToolbarTitle-DS7gKC4A.js";import"./QToolbar-DD9_B9vM.js";import"./lists-madrasah-store-LMKzhE5A.js";import"./api-get-lists-CRvCG-zL.js";import"./QSlideTransition-62SSNh1n.js";import"./ClosePopup-CcGROVC7.js";const X={class:"row"},Y={class:"col-7 q-mt-sm"},Z={class:"col-5 q-mt-sm"},aa={class:"vertical-top"},ea={class:"vertical-top"},ta={class:"vertical-top"},la={class:""},Ca={__name:"PageTagihan",setup(sa){const y=T(),{email:V}=y.getUser,h=i(!1),Q=i(""),b=i(!1),{params:n}=U(),d=i([]),r=i([]),p=i([]),v=i(!1),c=i({th_ajaran_h:n.th_ajaran_h||""}),q=O(new Date,"yyyy-MM-dd HH:mm:ss",{locale:W})+" ~ "+V||"",u=i("");async function j(){const o=await E({endPoint:"kelas",params:{th_ajaran_h:n.th_ajaran_h,tingkat_id:n.tingkat_id,kelas:n.kelas},loading:b});o&&(d.value=o.murid)}A(async()=>{n.th_ajaran_h&&n.tingkat_id&&n.kelas?await j():d.value=[]});async function P(){if(!r.value.length)return x("Pilih murid terlebih dahulu");if(!p.value.length)return x("Pilih paket terlebih dahulu");const o={th_ajaran_h:c.value.th_ajaran_h,va_group:u.value,santri_id:r.value.map(a=>a.santri_id),paket:p.value.map(a=>({item:a.item,nominal:a.nominal}))};await G({endPoint:"iuran/paket-massal",loading:v,data:o,message:`PERHATIAN<br/>
			Jika item iuran sudah terdapat dalam daftar maka akan diabaikan.
			<hr/>
			<span style="color:red">Kesalahan akibat aksi ini sulit ditelusuri dan harus diperbaiki satu per satu.</span>`})}const S=[{name:"santri_id",label:"ID Santri",align:"left",field:"santri_id",sortable:!0},{name:"nama",label:"Nama",align:"left",field:"nama",sortable:!0},{name:"domisili",label:"Domisili",align:"left",field:"domisili",sortable:!0},{name:"status",label:"Status",align:"left",field:"status",sortable:!0},{name:"wali",label:"Wali",align:"left",field:o=>`${o.wali_nama} (${o.wali_sex}; ${o.wali_status})`,sortable:!0}];return(o,a)=>(M(),D(z,{class:"q-pa-sm",style:{"min-width":"1024px"}},{default:s(()=>[e(k,null,{default:s(()=>[e(J,{"show-reload":!1,title:"Modul Tagihan"}),e(m,{class:"q-pa-sm"},{default:s(()=>[e(K,{bordered:"",flat:"","show-ujian-ke":!1,"start-url":"/iuran/tagihan",onDataFilter:a[0]||(a[0]=t=>Q.value=t)}),l("div",X,[l("div",Y,[e(N,{flat:"",bordered:"","table-header-class":"bg-green-2 text-green-10 text-subtitle1",class:"dt",rows:d.value,columns:S,loading:b.value,"row-key":"id",selection:"multiple",selected:r.value,"onUpdate:selected":a[1]||(a[1]=t=>r.value=t),"rows-per-page-options":[0],"hide-bottom":"",style:{height:"635px"},"virtual-scroll":""},{"header-selection":s(t=>[e(g,{modelValue:t.selected,"onUpdate:modelValue":f=>t.selected=f,color:"green-7","checked-icon":"check","unchecked-icon":"clear"},null,8,["modelValue","onUpdate:modelValue"])]),"body-selection":s(t=>[e(g,{modelValue:t.selected,"onUpdate:modelValue":f=>t.selected=f,color:"green-5","checked-icon":"check","unchecked-icon":"clear"},null,8,["modelValue","onUpdate:modelValue"])]),_:1},8,["rows","loading","selected"])]),l("div",Z,[e(k,{bordered:"",flat:"",class:"q-ml-sm scroll",style:{height:"635px"}},{default:s(()=>[e(m,{class:"q-px-sm q-py-md bg-green-2 text-green-10 text-subtitle2"},{default:s(()=>[...a[6]||(a[6]=[$(" Buat Tagihan Massal ",-1)])]),_:1}),e(m,{class:"q-pa-sm"},{default:s(()=>[l("table",null,[l("tbody",null,[l("tr",aa,[a[7]||(a[7]=l("td",{class:"text-no-wrap text-italic q-pr-md"}," Jumlah Murid ",-1)),l("td",null,_(d.value.length),1)]),l("tr",ea,[a[8]||(a[8]=l("td",{class:"text-no-wrap text-italic q-pr-md"}," Terpilih ",-1)),l("td",null,_(r.value.length)+" santri "+_(r.value.map(t=>t.santri_id)),1)]),l("tr",ta,[a[9]||(a[9]=l("td",{class:"text-no-wrap text-italic q-pr-md"}," VA Group ",-1)),l("td",la,[e(g,{dense:"",modelValue:h.value,"onUpdate:modelValue":[a[2]||(a[2]=t=>h.value=t),a[3]||(a[3]=t=>t?u.value=B(q):u.value="")],color:"green",label:u.value},null,8,["modelValue","label"])])])])])]),_:1}),e(m,{class:"q-pa-sm"},{default:s(()=>[e(C,{label:"Tahun Ajaran",outlined:"",dense:"",modelValue:c.value.th_ajaran_h,"onUpdate:modelValue":a[4]||(a[4]=t=>c.value.th_ajaran_h=t),disable:""},null,8,["modelValue"]),e(L,{class:"q-mt-sm",onOnInput:a[5]||(a[5]=t=>p.value=t)})]),_:1}),e(I,{class:"q-pa-sm bg-green-6 absolute-bottom"},{default:s(()=>[e(w,{label:"Unduh Data",glossy:"",color:"green-9",class:"text-green-11","no-caps":"",icon:"download",to:"/iuran/download"}),e(F),e(w,{label:"Simpan",glossy:"",outline:"",color:"green-10",class:"bg-green-11 right-0","no-caps":"",icon:"save",onClick:P})]),_:1}),e(R,{showing:v.value},{default:s(()=>[e(H,{color:"green-6",size:"6em"})]),_:1},8,["showing"])]),_:1})])])]),_:1})]),_:1})]),_:1}))}};export{Ca as default};
