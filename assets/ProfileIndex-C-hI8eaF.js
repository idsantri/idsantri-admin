import{A as d,B as v,c as Q,o as m,w as l,b as e,ab as L,e as P,Q as F,a5 as k,x as I,U as N,a,f as q,g as h,t as V,z as _,F as E,y as H,ad as T,C as j,E as G}from"./index-DwrbA0R8.js";import{Q as M}from"./QImg--g9yT0uK.js";import{Q as g}from"./QItemLabel-Dzdetwv2.js";import{Q as S,a as A}from"./QItemSection-CeSY4hvW.js";import{Q as O}from"./QList-Cc6jCv1k.js";import{Q as R}from"./QPage-BU8r9xHl.js";import{a as z}from"./api-get-D4W4lze7.js";import{t as J}from"./format-text-DnCGEu2I.js";import{b as K}from"./index-BlZcD66n.js";import{_ as W}from"./ImageUploader-DWxxELTC.js";import{Q as X}from"./QForm-DCEv1Ikv.js";import{A as Y}from"./Api-DWdZFNbG.js";import"./index-B6LiMDVO.js";import"./api-error-DGWaEiw1.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";class Z extends Y{constructor(){super("user")}async get(){return(await this._apiGet({endPoint:this._path})).data}async update(s,i=!1){if(i&&!await this._notifyConfirm("Update profil Anda?"))return!1;const c=await this._apiUpdate({endPoint:`${this._path}`,data:s});return this._showSuccess(c.message),c.data}}const D=new Z,ee={__name:"UserForm",props:{data:{type:Object,required:!0}},emits:["successDelete","successSubmit","successUpdate","successCreate"],setup(w,{emit:s}){const i=s,o=d({...w.data}),u=d(!1);async function x(){const y={username:o.value.username,name:o.value.name,phone:o.value.phone};try{u.value=!0;const r=await D.update(y,!0);r&&(document.getElementById("btn-close-form")?.click(),i("successSubmit",r.user),i("successUpdate",r.user))}catch{}finally{u.value=!1}}return(y,r)=>{const b=v("FormHeader"),p=v("FormLoading"),U=v("FormActions");return m(),Q(I,{class:"full-width",style:{"max-width":"425px"}},{default:l(()=>[e(X,{onSubmit:L(x,["prevent"])},{default:l(()=>[e(b,{title:"Update Profil","is-new":!1}),u.value?(m(),Q(p,{key:0})):P("",!0),e(F,null,{default:l(()=>[e(k,{class:"q-my-sm",dense:"",outlined:"",label:"Nama",modelValue:o.value.name,"onUpdate:modelValue":r[0]||(r[0]=n=>o.value.name=n),hint:""},null,8,["modelValue"]),e(k,{class:"q-my-sm",dense:"",outlined:"",label:"Username",modelValue:o.value.username,"onUpdate:modelValue":r[1]||(r[1]=n=>o.value.username=n),hint:"Anda bisa login dengan username atau email"},null,8,["modelValue"]),e(k,{class:"q-my-sm",dense:"",outlined:"",label:"Nomor Telepon",modelValue:o.value.phone,"onUpdate:modelValue":r[2]||(r[2]=n=>o.value.phone=n),hint:"08123456789"},null,8,["modelValue"])]),_:1}),e(U,{"btn-delete":!1})]),_:1})]),_:1})}}},ae={class:"absolute-top-right q-ma-sm"},te={style:{"max-width":"150px"},class:"q-mx-auto"},se={key:0},le={class:"float-right"},oe={class:"fit row wrap justify-start items-start content-start"},xe={__name:"ProfileIndex",setup(w){const s=d({}),i=d(!1),c=d(!1),o=d(!1),u=d(!1),x=n=>u.value=n;async function y(){u.value=!1,await b()}async function r(){try{i.value=!0;const n=await D.get();s.value=n.user}catch(n){console.log("ðŸš€ ~ loadData ~ error:",n)}finally{i.value=!1}}async function b(){const n=await z({endPoint:`images/users/${s.value.id}`,loading:c});s.value.image=n.image_url||"/user-default.png"}async function p(){await r(),await b()}N(async()=>{await p()});const U=async()=>{await K("Untuk mengganti password, silakan <strong>logout (keluar)</strong>. Pada halaman login, klik <strong>lupa password</strong>.<br/>Ikuti petunjuk yang diberikan.",0)};return(n,t)=>{const $=v("CardHeader"),B=v("CardLoading");return m(),Q(R,{class:"q-pa-sm"},{default:l(()=>[e(I,{class:"",style:{"max-width":"600px"}},{default:l(()=>[e($,{title:"Profil Pengguna",onOnReload:p}),e(F,{class:"q-pa-sm"},{default:l(()=>[a("div",ae,[e(h,{icon:"camera",round:"","no-caps":"",dense:"",glossy:"",class:"q-ma-xs q-px-sm",onClick:t[0]||(t[0]=f=>u.value=!0)})]),a("div",te,[e(M,{src:s.value.image,ratio:1,alt:"user","img-style":{borderRadius:"50%",border:"3px",borderColor:"green",borderStyle:"solid"}},null,8,["src"])]),s.value.confirmed_at?P("",!0):(m(),q("div",se,[...t[3]||(t[3]=[a("div",{class:"text-center q-my-lg"},[a("div",{class:"q-pa-md text-negative bg-red-1",style:{"border-radius":"10px"}},[a("div",null,"Akun Anda belum terkonfirmasi."),a("div",null,"Silakan hubungi Admin!")])],-1)])])),e(O,{bordered:"",separator:"",class:"q-mt-sm"},{default:l(()=>[e(S,{class:"q-pa-sm"},{default:l(()=>[e(A,null,{default:l(()=>[e(g,{overline:""},{default:l(()=>[...t[4]||(t[4]=[V("User",-1)])]),_:1}),e(g,null,{default:l(()=>[a("table",null,[a("tbody",null,[a("tr",null,[t[5]||(t[5]=a("td",{class:"text-italic text-caption"},"Nama",-1)),a("td",null,_(s.value.name),1)]),a("tr",null,[t[6]||(t[6]=a("td",{class:"text-italic text-caption"},"Email",-1)),a("td",null,_(s.value.email),1)]),a("tr",null,[t[7]||(t[7]=a("td",{class:"text-italic text-caption"},"Username",-1)),a("td",null,_(s.value.username),1)]),a("tr",null,[t[8]||(t[8]=a("td",{class:"text-italic text-caption"},"Telepon",-1)),a("td",null,_(s.value.phone||"-"),1)])])])]),_:1}),e(g,{class:"bg-green-1"},{default:l(()=>[a("div",le,[e(h,{label:"User",icon:"edit","no-caps":"",dense:"",class:"q-my-xs q-mx-sm q-px-sm",onClick:t[1]||(t[1]=f=>o.value=!0)}),e(h,{label:"Password",icon:"edit","no-caps":"",dense:"",class:"q-my-xs q-mx-sm q-px-sm",onClick:U})])]),_:1})]),_:1})]),_:1}),e(S,{class:"q-pa-sm"},{default:l(()=>[e(A,null,{default:l(()=>[e(g,{overline:""},{default:l(()=>[...t[9]||(t[9]=[V("User Group",-1)])]),_:1}),e(g,null,{default:l(()=>[a("div",oe,[(m(!0),q(E,null,H(s.value.roles,(f,C)=>(m(),q("div",{key:C,class:"col-6"},[e(T,{"model-value":f,color:"green",label:j(J)(C),disable:""},null,8,["model-value","label"])]))),128))])]),_:1})]),_:1})]),_:1})]),_:1}),e(B,{showing:i.value},null,8,["showing"])]),_:1})]),_:1}),e(G,{modelValue:o.value,"onUpdate:modelValue":t[2]||(t[2]=f=>o.value=f)},{default:l(()=>[e(ee,{data:s.value,onSuccessSubmit:p},null,8,["data"])]),_:1},8,["modelValue"]),e(W,{"show-uploader":u.value,url:`/images/users/${s.value.id}`,width:300,height:300,"img-format":"webp",onUpdateUploader:x,onSuccessUpload:y},null,8,["show-uploader","url"])]),_:1})}}};export{xe as default};
