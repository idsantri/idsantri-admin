import{q as v,ap as T,s as U,Y as I,E as k,c as F,o as c,w as m,g as o,af as N,f as j,G as A,Q as C,a9 as y,l as H,N as B,m as E,a as l,b as V,v as h,F as O,D as $,t as g,aq as K,e as L,J as R}from"./index-DutRA_CO.js";import{Q as G}from"./QSkeleton-DR1gHoWS.js";import{Q as J}from"./QMarkupTable-soH4YcMw.js";import{Q as Y}from"./QSelect-LIcm9uTB.js";import{Q as z}from"./QForm-DRzvYkEB.js";import{_ as Q}from"./InputSelectTingkatPendidikan-BEo5P2Hh.js";import{u as W}from"./useCrudForm-L8fi9UCL.js";import{M as D}from"./Mapel-Dl6ayglx.js";import{_ as X}from"./InputToggle-CyM3yNJW.js";import"./QField-BhEqSw-i.js";import"./QChip-D_SQIzNi.js";import"./QItem-qGBVeF8-.js";import"./QItemLabel-WimR8O_E.js";import"./QMenu-JGhTZEq-.js";import"./selection-BSDJEjKX.js";import"./rtl-DFPa-2ov.js";import"./format-CJebrXOQ.js";import"./lists-store-NC8-X11g.js";import"./ArrayCrud-CByp4EUn.js";import"./DropDownAfter-8SRzBjks.js";import"./QBtnDropdown-DEivjYd9.js";import"./QBtnGroup-_ujcPxic.js";import"./ClosePopup-RQcL-rG0.js";import"./Lists-CyIViPOd.js";import"./ApiCrud-CZFmsy5d.js";import"./Api-AjNxW92f.js";import"./index-BAyNzCk6.js";import"./index-Cpf3S9fo.js";import"./apiPost-BTbDNFlR.js";const Z={__name:"MapelForm",props:{data:{type:Object,required:!0}},emits:["successDelete","successSubmit","successUpdate","successCreate"],setup(q,{emit:p}){const u=q,f=p,e=v({category:"Fan Dasar",show:1,...u.data}),d=!u.data?.id,i=T("firstInput");U(async()=>{await I(),i.value&&i.value.focus()});const{handleDelete:w,handleCreate:_,handleUpdate:r,loading:a}=W(D,{emit:f,responseKey:"mapel"}),b=async()=>{const t={sequence:e.value.sequence,id:e.value.id.toLowerCase(),tingkat_id:e.value.tingkat_id,name:e.value.name,alias:e.value.alias,category:e.value.category,show:e.value.show};return d?await _(t,!0):await r(u.data.id,t,!0)},x=async()=>await w(u.data.id);return(t,n)=>{const M=k("FormHeader"),P=k("FormLoading"),S=k("FormActions");return c(),F(H,{class:"full-width",style:{"max-width":"425px"}},{default:m(()=>[o(z,{onSubmit:N(b,["prevent"])},{default:m(()=>[o(M,{title:"Input Mata Pelajaran","is-new":d}),A(a)?(c(),F(P,{key:0})):j("",!0),o(C,null,{default:m(()=>[o(y,{dense:"",outlined:"",label:"Urut",modelValue:e.value.sequence,"onUpdate:modelValue":n[0]||(n[0]=s=>e.value.sequence=s),hint:"Nomor urut tampil",class:"q-my-sm",ref_key:"firstInput",ref:i},null,8,["modelValue"]),o(Q,{modelValue:e.value.tingkat_id,"onUpdate:modelValue":n[1]||(n[1]=s=>e.value.tingkat_id=s),class:"q-my-sm",rules:[s=>!!s||"Harus diisi!"]},null,8,["modelValue","rules"]),o(y,{class:"q-my-sm",dense:"",outlined:"",label:"Kode/ID Mapel",modelValue:e.value.id,"onUpdate:modelValue":n[2]||(n[2]=s=>e.value.id=s),hint:"Format: tingkat_id—kode_mapel (ibt-qur; ts-taj; aly-tau)"},null,8,["modelValue"]),o(y,{dense:"",class:"q-my-sm",outlined:"",label:"Mata Pelajaran",modelValue:e.value.name,"onUpdate:modelValue":n[3]||(n[3]=s=>e.value.name=s),hint:"Hanya huruf dan spasi"},null,8,["modelValue"]),o(y,{dense:"",class:"q-my-sm",outlined:"",label:"Mata Pelajaran (Alias)",modelValue:e.value.alias,"onUpdate:modelValue":n[4]||(n[4]=s=>e.value.alias=s)},null,8,["modelValue"]),o(Y,{dense:"",class:"q-my-sm",outlined:"",label:"Kategori Fan","emit-value":"","map-options":"",modelValue:e.value.category,"onUpdate:modelValue":n[5]||(n[5]=s=>e.value.category=s),options:["Fan Pokok","Fan Dasar","Fan Tambahan"],behavior:"menu"},null,8,["modelValue"]),o(X,{modelValue:e.value.show,"onUpdate:modelValue":n[6]||(n[6]=s=>e.value.show=s),label:"Tampilkan"},null,8,["modelValue"])]),_:1}),o(S,{"btn-delete":!d,onOnDelete:x},null,8,["btn-delete"])]),_:1})]),_:1})}}},ee={key:0},ae={colspan:"7"},te={key:1},le={class:"text-center"},Te={__name:"MapelIndex",setup(q){const p=v([]),u=v(""),f=v(!1),e=v({}),d=v(!1);async function i(r){try{f.value=!0,p.value=[];const a=await D.getAll({params:{tingkat_id:r}});p.value=a.mapel}catch(a){console.error("Error loading data:",a)}finally{f.value=!1}}B(u,async r=>{r?await i(r):p.value=[]});function w(r){e.value=r,d.value=!0}function _(){e.value={tingkat_id:u.value},d.value=!0}return(r,a)=>{const b=k("CardHeader"),x=k("CardPage");return c(),F(x,null,{default:m(()=>[o(b,{title:"Daftar Mata Pelajaran",onOnReload:a[0]||(a[0]=t=>i(u.value)),"show-reload":!!u.value,"show-add":!0,onOnAdd:_},null,8,["show-reload"]),o(E,{align:"right",class:"bg-green-1"},{default:m(()=>[a[5]||(a[5]=l("div",{class:"text-caption q-mr-sm text-italic"},"Pilih Tingkat Pendidikan:",-1)),o(Q,{style:{width:"300px"},modelValue:u.value,"onUpdate:modelValue":a[1]||(a[1]=t=>u.value=t),label:"Tingkat Pendidikan",bottomSlots:!1},null,8,["modelValue"])]),_:1}),o(C,{class:"q-pa-sm"},{default:m(()=>[o(J,{flat:""},{default:m(()=>[a[7]||(a[7]=l("thead",null,[l("tr",{class:"text-left"},[l("th",null,"No"),l("th",null,"Kode/ID"),l("th",null,"Mata Pelajaran"),l("th",null,"Alias"),l("th",null,"Status Fan"),l("th",null,"Tampil"),l("th",{class:"text-center"},"Edit")])],-1)),l("tbody",null,[f.value?(c(),V("tr",ee,[l("td",ae,[o(G,{height:"50px"})])])):p.value.length==0?(c(),V("tr",te,[...a[6]||(a[6]=[l("td",{colspan:"7",class:"text-center text-green-10 text-italic"},[h(" — Tidak ada data untuk ditampilkan — "),l("br"),h(" — Pilih Tingkat Pendidikan — ")],-1)])])):(c(!0),V(O,{key:2},$(p.value,t=>(c(),V("tr",{key:t.id},[l("td",null,g(t.sequence),1),l("td",null,g(t.id),1),l("td",null,g(t.name),1),l("td",null,g(t.alias),1),l("td",null,g(t.category),1),l("td",null,[o(K,{"model-value":!!t.show,color:"green",disable:""},null,8,["model-value"])]),l("td",le,[o(L,{icon:"edit",flat:"",color:"green",onClick:n=>w(t)},null,8,["onClick"])])]))),128))])]),_:1})]),_:1}),o(R,{modelValue:d.value,"onUpdate:modelValue":a[4]||(a[4]=t=>d.value=t)},{default:m(()=>[o(Z,{data:e.value,onSuccessSubmit:a[2]||(a[2]=t=>i(t.tingkat_id)),onSuccessDelete:a[3]||(a[3]=t=>i(t.tingkat_id))},null,8,["data"])]),_:1},8,["modelValue"])]),_:1})}}};export{Te as default};
