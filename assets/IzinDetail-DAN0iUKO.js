import{q as f,ad as z,s as K,au as E,E as q,c as x,o as _,w as n,g as e,a,Q as y,e as S,v as T,b as M,F as A,D as O,aj as G,G as u,t as r,J as I,l as $,ap as J,Y,N as W,af as X,f as L,a9 as Z,C as h}from"./index-CEqRNMKa.js";import{Q as P,a as R}from"./QToolbar-wE0hZ0P4.js";import{Q as N}from"./QSpace-rI7O3oMi.js";import{a as aa,b as ta,i as ea,f as V}from"./format-date-DBaFa2rd.js";import{f as la,m as Q,b as F}from"./hijri-CTUg_lXm.js";import{_ as sa}from"./ReportViewer-DzJb1QzI.js";import{Q as na,a as H}from"./QItem-CE7Gw7UR.js";import{Q as oa}from"./QList-BwIiBKrg.js";import{_ as U}from"./IzinPesantrenForm-CExlTEbD.js";import{I as j}from"./IzinPesantren-DWoDps4q.js";import{_ as ia}from"./CardSantriSimple-C1G2qtFD.js";import{Q as ra}from"./QForm-BLkSNr4R.js";import{_ as ua}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./id-BuNGTsqN.js";import"./format-number-B34ySHL_.js";import"./index-DUDauND2.js";import"./index-DMQSfvx3.js";import"./QSelect-Cq7a2gGZ.js";import"./QField-D4menuIJ.js";import"./QChip-CJrHXeq1.js";import"./QItemLabel-DHWqC7wC.js";import"./QMenu-CIUGaSD_.js";import"./selection-Dn82c7hT.js";import"./rtl-DFPa-2ov.js";import"./format-CJebrXOQ.js";import"./InputSelectSantriId-CbyPcKXF.js";import"./Santri-DFvv300L.js";import"./ApiCrud-DQp7e7nl.js";import"./Api-BLJ5CcMO.js";import"./apiPost-D18tN-j-.js";import"./InputSelectArray-BdV20Le8.js";import"./lists-store-DgR8HQaa.js";import"./ArrayCrud-CByp4EUn.js";import"./DropDownAfter-9gl95ku2.js";import"./QBtnDropdown-xGuuc5eh.js";import"./QBtnGroup-BeWlmbWW.js";import"./ClosePopup-CfU5FfYf.js";import"./Lists-Bb6B22On.js";import"./useCrudForm-B6DzUwVC.js";import"./QSkeleton-0P7MF2sQ.js";import"./QImg-QOdUUYq6.js";import"./santri-store-CUagSAoY.js";const da={class:"relative-position"},ma={class:"flex"},pa={__name:"IzinRiwayat",props:{santri_id:{required:!0}},setup(w){const g=w,d=f([]),v=f(!1),l=f(!1),{params:m}=z();K(async()=>{g.santri_id?await p(g.santri_id):d.value=[]}),E(async()=>{g.santri_id?await p(g.santri_id):d.value=[]});async function p(b){try{v.value=!0;const s=await j.getAll({params:{santri_id:b}});d.value=s.izin_pesantren}catch(s){console.log("ðŸš€ ~ getRiwayat ~ error:",s)}finally{v.value=!1}}return(b,s)=>{const i=q("CardLoading");return _(),x($,{flat:"",bordered:"",class:""},{default:n(()=>[e(y,{class:"bg-green-7 no-padding"},{default:n(()=>[e(P,{class:"no-padding no-margin"},{default:n(()=>[e(S,{icon:"sync","no-caps":"",onClick:s[0]||(s[0]=o=>p(w.santri_id)),flat:"",dense:"",class:"q-pl-sm",color:"green-11",title:"Muat ulang"}),e(R,{class:"text-subtitle1 text-green-11 q-px-none"},{default:n(()=>[...s[4]||(s[4]=[T(" Riwayat Perizinan ",-1)])]),_:1}),e(S,{color:"green-11",outline:"",dense:"","no-caps":"",icon:"add",label:"Tambah",class:"q-mr-sm q-px-md",onClick:s[1]||(s[1]=o=>l.value=!0)})]),_:1})]),_:1}),a("div",da,[d.value?.length?(_(),x(y,{key:1,class:"q-pa-sm"},{default:n(()=>[e(oa,{separator:"",bordered:""},{default:n(()=>[(_(!0),M(A,null,O(d.value,(o,c)=>(_(),x(na,{key:c,class:G([o.id==u(m).id?"bg-green-1":"","q-pa-sm"])},{default:n(()=>[e(H,null,{default:n(()=>[a("table",null,[a("tbody",null,[a("tr",null,[s[6]||(s[6]=a("td",{class:"label"},"Tanggal:",-1)),a("td",ma,[T(r(u(aa)(o.dari_tgl)+" | "+u(la)(u(Q)(o.dari_tgl)))+" ",1),e(N),T(" "+r(o.th_ajaran_h),1)])]),a("tr",null,[s[7]||(s[7]=a("td",{class:"label"},"Izin",-1)),a("td",null,r(o.sifat)+" | "+r(o.durasi)+" hari | "+r(o.pengajuan),1)]),a("tr",null,[s[8]||(s[8]=a("td",{class:"label"},"Keperluan",-1)),a("td",null,r(o.keperluan)+" "+r(o.keterangan?" ("+o.keterangan+")":""),1)]),a("tr",null,[s[9]||(s[9]=a("td",{class:"label"},"Status",-1)),a("td",null,r(o.status),1)])])])]),_:2},1024),e(H,{side:"",class:"no-padding"},{default:n(()=>[e(S,{disable:o.id==u(m).id,icon:"info",glossy:"",dense:"",round:"",outline:"",color:"green",to:`/keamanan/izin-pesantren/${o.id}`},null,8,["disable","to"])]),_:2},1024)]),_:2},1032,["class"]))),128))]),_:1})]),_:1})):(_(),x(y,{key:0,class:"text-italic text-center q-pa-lg"},{default:n(()=>[...s[5]||(s[5]=[T(" Tidak ada untuk ditampilkan ",-1)])]),_:1})),e(i,{showing:v.value},null,8,["showing"])]),e(I,{modelValue:l.value,"onUpdate:modelValue":s[3]||(s[3]=o=>l.value=o)},{default:n(()=>[e(U,{data:{santri_id:w.santri_id,nama:d.value[0]?.nama,data_akhir:d.value[0]?.data_akhir},onSuccessDelete:o=>null,onSuccessSubmit:s[2]||(s[2]=o=>b.$router.push(`/keamanan/izin-pesantren/${o.id}`))},null,8,["data"])]),_:1},8,["modelValue"])]),_:1})}}},ca={__name:"IzinPesantrenKembaliForm",props:{data:Object},emits:["successSubmit"],setup(w,{emit:g}){const d=w,v=g,l=f({...d.data}),m=f(!1),p=J("firstInput");K(async()=>{await Y(),p.value&&p.value.focus()});async function b(){try{m.value=!0;const i=await j.setKembali({id:d.data.id,data:{kembali_tgl:l.value.kembali_tgl},message:"Tetapkan sudah kembali ke pesantren pada tanggal ini?"});i&&(document.getElementById("btn-close-form").click(),v("successSubmit",i?.izin_pesantren))}catch(i){console.error("err set not back",i)}finally{m.value=!1}}async function s(){try{m.value=!0;const i=await j.setKembali({id:d.data.id,data:{kembali_tgl:null},message:"Tetapkan belum kembali ke pesantren?"});i&&(document.getElementById("btn-close-form").click(),v("successSubmit",i?.izin_pesantren))}catch(i){console.error("err set not back",i)}finally{m.value=!1}}return W(()=>l.value.kembali_tgl,i=>{l.value.kembali_tgl=ta(i)}),(i,o)=>{const c=q("FormHeader"),t=q("FormLoading"),D=q("FormActions");return _(),x($,{class:"full-width",style:{"max-width":"425px"}},{default:n(()=>[e(ra,{onSubmit:X(b,["prevent"])},{default:n(()=>[e(c,{title:"Tetapkan Tanggal Kembali","is-new":!1}),m.value?(_(),x(t,{key:0})):L("",!0),e(y,null,{default:n(()=>[e(Z,{dense:"",hint:u(ea)(l.value.kembali_tgl)?u(V)(l.value.kembali_tgl):"",class:"q-my-sm",outlined:"",label:"Tanggal (M)*",modelValue:l.value.kembali_tgl,"onUpdate:modelValue":o[0]||(o[0]=C=>l.value.kembali_tgl=C),type:"datetime-local",rules:[C=>!!C||"Harus diisi!"],"error-color":"negative",ref_key:"firstInput",ref:p},null,8,["hint","modelValue","rules"])]),_:1}),e(D,{"btn-delete":!!w.data.kembali_tgl,onOnDelete:s,"label-delete":"Belum Kembali"},null,8,["btn-delete"])]),_:1})]),_:1})}}},fa={class:"row",style:{"max-width":"1200px"}},ga={class:"col-xs-12 col-sm-6"},va={class:"q-ma-sm"},ba={class:"full-width"},_a={colspan:"2"},ka={class:"col-xs-12 col-sm-6"},xa={class:"q-ma-sm"},ya={__name:"IzinDetail",setup(w){const g=f(!1),d=f(""),v=z(),l=f({}),m=f(!1),p=f(!1),b=f(!1);function s(){d.value=`reports/izin-pesantren/view?id=${l.value.id}`,g.value=!0}async function i(){try{m.value=!0;const c=await j.getById({id:v.params.id});l.value=c.izin_pesantren}catch(c){console.log("ðŸš€ ~ loadData ~ error:",c)}finally{m.value=!1}}K(async()=>{v.params.id&&await i()});function o(c){const t=/\(\+(\d+)\)/g;return c.replace(t,(C,B)=>`(terlambat ${B} hari)`)}return(c,t)=>{const D=q("CardHeader"),C=q("CardLoading"),B=q("CardPage");return _(),x(B,null,{default:n(()=>[e(D,{title:"Detail Izin Pesantren","show-reload":!1}),a("div",fa,[a("div",ga,[a("div",va,[e($,{class:"",flat:"",bordered:""},{default:n(()=>[e(y,{class:"bg-green-7 no-padding"},{default:n(()=>[e(P,{class:"no-padding no-margin"},{default:n(()=>[e(S,{icon:"sync","no-caps":"",onClick:i,flat:"",dense:"",class:"q-pl-sm",color:"green-11",title:"Muat ulang"}),e(R,{class:"text-subtitle1 text-green-11 q-px-none"},{default:n(()=>[...t[6]||(t[6]=[T(" Data Perizinan ",-1)])]),_:1}),e(S,{dense:"",class:"q-px-md q-mr-sm text-green-10",label:"Cetak","no-caps":"",icon:"print",color:"green-11",onClick:s}),e(S,{dense:"",class:"q-px-md q-mr-sm text-green-10",label:"Edit","no-caps":"",icon:"edit",color:"green-11",onClick:t[0]||(t[0]=k=>p.value=!0)})]),_:1})]),_:1}),l.value?(_(),x(y,{key:0,class:"q-pa-sm"},{default:n(()=>[e(ia,{id:l.value.santri_id},null,8,["id"]),e($,{bordered:"",flat:"",class:"q-mt-sm"},{default:n(()=>[e(y,{class:"q-pa-sm text-subtitle1 bg-green-11 flex"},{default:n(()=>[t[7]||(t[7]=T(" Data Izin ",-1)),e(N),e(S,{dense:"",label:"Kembali",icon:"manage_history","no-caps":"",class:"q-px-sm bg-green-10 text-green-12",onClick:t[1]||(t[1]=k=>b.value=!0)})]),_:1}),e(y,{class:"q-pa-sm"},{default:n(()=>[a("table",ba,[a("tbody",null,[a("tr",null,[t[8]||(t[8]=a("td",{class:"text-italic"},"Sifat:",-1)),a("td",null,r(l.value.sifat),1)]),a("tr",null,[t[9]||(t[9]=a("td",{class:"text-italic"},"Pengajuan:",-1)),a("td",null,r(l.value.pengajuan),1)]),a("tr",null,[t[10]||(t[10]=a("td",{class:"text-italic"},"Durasi:",-1)),a("td",null,r(l.value.durasi+" hari"),1)]),a("tr",null,[t[11]||(t[11]=a("td",{class:"text-italic"},"Dari Tanggal:",-1)),a("td",null,r(u(V)(l.value.dari_tgl)+" | "+u(F)(u(Q)(l.value.dari_tgl))),1)]),a("tr",null,[t[12]||(t[12]=a("td",{class:"text-italic"},"Sampai Tanggal:",-1)),a("td",null,r(u(V)(l.value.sampai_tgl)+" | "+u(F)(u(Q)(l.value.sampai_tgl))),1)]),a("tr",null,[t[13]||(t[13]=a("td",{class:"text-italic"},"Keperluan:",-1)),a("td",null,r(l.value.keperluan),1)]),a("tr",null,[t[14]||(t[14]=a("td",{class:"text-italic"},"Keterangan:",-1)),a("td",null,r(l.value.keterangan??"-"),1)]),a("tr",null,[t[15]||(t[15]=a("td",{class:"text-italic"},"Tujuan:",-1)),a("td",null,r(l.value.tujuan),1)]),a("tr",null,[t[16]||(t[16]=a("td",{class:"text-italic"},"Catatan:",-1)),a("td",null,r(l.value.catatan||"-"),1)]),a("tr",null,[a("td",_a,[e(h,{color:"green-8"})])]),a("tr",null,[t[17]||(t[17]=a("td",{class:"text-italic"},"Kembali:",-1)),a("td",null,r(u(V)(l.value.kembali_tgl)+" | "+u(F)(u(Q)(l.value.kembali_tgl))),1)]),a("tr",null,[t[18]||(t[18]=a("td",{class:"text-italic"},"Status:",-1)),a("td",null,r(l.value.status?o(l.value.status):""),1)])])]),e(C,{showing:m.value},null,8,["showing"])]),_:1})]),_:1})]),_:1})):L("",!0)]),_:1})])]),a("div",ka,[a("div",xa,[e(pa,{class:"",santri_id:l.value.santri_id},null,8,["santri_id"])])])]),e(I,{modelValue:p.value,"onUpdate:modelValue":t[3]||(t[3]=k=>p.value=k)},{default:n(()=>[e(U,{data:l.value,onSuccessDelete:t[2]||(t[2]=k=>c.$router.go(-1)),onSuccessSubmit:i},null,8,["data"])]),_:1},8,["modelValue"]),e(I,{modelValue:b.value,"onUpdate:modelValue":t[4]||(t[4]=k=>b.value=k)},{default:n(()=>[e(ca,{data:{id:l.value.id,kembali_tgl:l.value.kembali_tgl},onSuccessSubmit:i},null,8,["data"])]),_:1},8,["modelValue"]),e(I,{modelValue:g.value,"onUpdate:modelValue":t[5]||(t[5]=k=>g.value=k)},{default:n(()=>[e(sa,{url:d.value},null,8,["url"])]),_:1},8,["modelValue"])]),_:1})}}},dt=ua(ya,[["__scopeId","data-v-76a5876c"]]);export{dt as default};
