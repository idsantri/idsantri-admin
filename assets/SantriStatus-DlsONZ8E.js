import{x as r,R as V,y,c as b,o as _,w as p,b as u,a9 as B,a as C,n as D,a3 as w,s as F,a7 as x,k as I,g as M,z as S,B as U}from"./index-Bf-p91mW.js";import{_ as Q}from"./TemplateArray-DT58ZlLN.js";import{c as k}from"./format-date-DlwYCgkJ.js";import{a as $}from"./hijri-BBdEhqDI.js";import{r as A,d as E,g as O}from"./array-object-BytDdNh7.js";import{a as P}from"./api-get-CiRdORW1.js";import{Q as j}from"./QForm-OmDQHoiq.js";import{a as q}from"./api-post-CHcQycZS.js";import{a as N}from"./api-update-BYe6B3v5.js";import{a as H}from"./api-delete-BVHfd1pG.js";import{_ as K}from"./InputSelectArray-Jz4ksDX6.js";import"./QSpinnerCube-CRIto8Mg.js";import"./QItemSection-Bl4rOme3.js";import"./QItemLabel-sjS6zLD0.js";import"./QList-51Eu5HNp.js";import"./id-BuNGTsqN.js";import"./format-number-B34ySHL_.js";import"./index-D7WC_quC.js";import"./index-BtaF3-6r.js";import"./api-error-C0HjZ2a3.js";import"./QSelect-Co09SqkM.js";import"./QChip-DeZPZCXp.js";import"./QMenu-BvL1IfNl.js";import"./selection-CE9S_xiH.js";import"./rtl-DFPa-2ov.js";import"./format-CJebrXOQ.js";import"./lists-store-F5P_xNBX.js";import"./lists-data-mcTvx2m2.js";import"./DropDownAfter-wYSCUu7Z.js";import"./QBtnDropdown-Br6y2eVM.js";import"./QBtnGroup-BDP931ZD.js";import"./ClosePopup-HTVnKVBl.js";import"./Lists-DSwT9YX9.js";import"./ApiCrud-SVFtkNw7.js";const L={__name:"StatusForm",props:{data:{type:Object,required:!0}},emits:["successDelete","successSubmit","successUpdate","successCreate"],setup(g,{emit:c}){const d=g,o=c,a=r({}),n=r(!1);V(async()=>{Object.assign(a.value,d.data)});const f=async()=>{const i={santri_id:a.value.santri_id,status:a.value.status,keterangan:a.value.keterangan};let t=null;const m=!a.value.id;m?t=await q({endPoint:"status",data:i,loading:n}):t=await N({endPoint:`status/${a.value.id}`,data:i,confirm:!0,notify:!0,loading:n}),t&&(document.getElementById("btn-close-form").click(),o("successSubmit",t?.status),o(m?"successCreate":"successUpdate",t?.status))},v=async()=>{const i=a.value.id;await H({endPoint:`status/${i}`,loading:n})&&(document.getElementById("btn-close-form").click(),o("successDelete",i))};return(i,t)=>{const m=y("FormHeader"),e=y("FormLoading"),l=y("FormActions");return _(),b(F,{class:"full-width",style:{"max-width":"425px"}},{default:p(()=>[u(j,{onSubmit:B(f,["prevent"])},{default:p(()=>[u(m,{title:"Input Status","is-new":!a.value.id},null,8,["is-new"]),n.value?(_(),b(e,{key:0})):C("",!0),u(D,null,{default:p(()=>[u(w,{dense:"",outlined:"",label:"Nama","model-value":a.value?.nama+" ("+a.value?.santri_id+")",disable:"",filled:"",class:"q-my-sm"},null,8,["model-value"]),u(K,{modelValue:a.value.status,"onUpdate:modelValue":t[0]||(t[0]=s=>a.value.status=s),url:"status",label:"Status *",class:"q-my-sm",rules:[s=>!!s||"Harus diisi!"]},null,8,["modelValue","rules"]),u(w,{dense:"",class:"q-my-sm",outlined:"",label:"Keterangan",modelValue:a.value.keterangan,"onUpdate:modelValue":t[1]||(t[1]=s=>a.value.keterangan=s),autogrow:""},null,8,["modelValue"])]),_:1}),u(l,{"btn-delete":!!a.value.id,onOnDelete:v},null,8,["btn-delete"])]),_:1})]),_:1})}}},Ba={__name:"SantriStatus",setup(g){const c=r(!1),d=r(!1),o=r({}),a=r([]),n=r({}),{params:f}=x();async function v(){const e=await P({endPoint:`status/santri/${f.id}`,loading:c});e.status&&(a.value=e.status,n.value=e.santri)}const i=I(()=>a.value.map(e=>({Tanggal:k(e.created_at,"dd-MM-yyyy")+" | "+$(k(e.created_at,"yyyy-MM-dd")),Status:e.status,Keterangan:e.keterangan||"-",id:e.id})));V(async()=>{await v()});const t=()=>{o.value={santri_id:n.value.id,nama:n.value.nama},d.value=!0},m=({id:e})=>{o.value=O(a,e),o.value.santri_id=n.value.id,o.value.nama=n.value.nama,d.value=!0};return(e,l)=>(_(),M("div",null,[u(Q,{data:i.value,spinner:c.value,onAdd:t,onEdit:m},null,8,["data","spinner"]),u(U,{modelValue:d.value,"onUpdate:modelValue":l[3]||(l[3]=s=>d.value=s)},{default:p(()=>[u(L,{data:o.value,onSuccessDelete:l[0]||(l[0]=s=>S(E)(a.value,s)),onSuccessCreate:l[1]||(l[1]=s=>a.value.push(s)),onSuccessUpdate:l[2]||(l[2]=s=>S(A)(a.value,s.id,s))},null,8,["data"])]),_:1},8,["modelValue"])]))}};export{Ba as default};
