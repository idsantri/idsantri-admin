import{K as D,at as S,ap as j,ac as B,q as i,ai as C,N as E,s as I,au as N,b as U,o as z,a as y,n as K,g as a,a9 as h,w as f,p as O,e as p,Q as P,l as T,af as $,a4 as M,H as w}from"./index-4p260kvZ.js";import{Q as R}from"./QSpinnerCube-XWZyRXhe.js";import{a as k}from"./index-Dt0LXLau.js";import{t as q}from"./array-object-BytDdNh7.js";import{b as F,d as H}from"./index-Kc9iSi_0.js";function G(){return D(S)}const J={class:""},W={class:"q-gutter-y-md column"},ae={__name:"LoginPage",props:{credential:{type:Object}},emits:["title","errors"],setup(x,{emit:V}){const s=V;s("title","Login"),s("errors",[]);const m=x,g=j("inputLogin"),b=B(),u=i(""),c=i(""),n=i(!1),l=i(!0),A=C(),L=async t=>{const e=new FormData(t.target),o=Object.fromEntries(e.entries());s("errors",[]);try{n.value=!0;const d=(await k.post("login",o)).data,v=d.data;A.setUser(v),H(d.message);const{user:_}=v;return _.confirmed_at?b.push("/"):b.push("/profile")}catch(r){s("errors",q(r.response?.data?.message||"Terjadi sebuah kesalahan")),g.value.focus()}finally{n.value=!1}};function Q(){G().notify({message:"Klik tombol info (kanan-atas) untuk info login.",icon:"info",color:"green-7",textColor:"green-11",timeout:1e4,actions:[{color:"green-11",icon:"close",round:!0}]})}return E([()=>m.credential.username,()=>m.credential.password],([t,e])=>{w.DEV&&(t&&(u.value=t),e&&(c.value=e))}),I(()=>{w.DEV&&Q(),g.value.focus()}),N(()=>{const t=document.getElementById("resend-email");t&&t.addEventListener("click",async e=>{s("errors",[]),e.preventDefault();const o=t.href.replace("%2540","@");try{n.value=!0;const r=await k.get(o);await F(r.data.message,0)}catch(r){s("errors",q(r.response?.data?.message||"Terjadi sebuah kesalahan"))}finally{n.value=!1}})}),(t,e)=>(z(),U("div",J,[y("form",{onSubmit:$(L,["prevent"])},[y("div",W,[a(h,{"bg-color":"green-1",outlined:"",label:"Login",name:"login",modelValue:u.value,"onUpdate:modelValue":e[0]||(e[0]=o=>u.value=o),required:"",hint:"Username atau email/surel Anda!",autocomplete:"off",autocapitalize:"none",readonly:"",onfocus:"this.removeAttribute('readonly');",onblur:"this.setAttribute('readonly','true');",autocorrect:"off",ref:"inputLogin"},null,8,["modelValue"]),a(h,{id:"password",type:l.value?"password":"text","bg-color":"green-1",outlined:"",label:"Password",name:"password",modelValue:c.value,"onUpdate:modelValue":e[2]||(e[2]=o=>c.value=o),required:"",autocomplete:"off",autocapitalize:"none",readonly:"",onfocus:"this.removeAttribute('readonly');",onblur:"this.setAttribute('readonly','true');",hint:"Password atau kata sandi"},{append:f(()=>[a(O,{name:l.value?"visibility_off":"visibility",class:"cursor-pointer",onClick:e[1]||(e[1]=o=>l.value=!l.value)},null,8,["name"])]),_:1},8,["type","modelValue"]),a(p,{type:"submit",class:"full-width q-pa-sm text-green-10",color:"green-3",label:"Login"}),a(T,{class:"my-card",flat:""},{default:f(()=>[a(P,{class:"text-green-10 text-center bg-green-2 q-pa-sm"},{default:f(()=>[a(p,{outline:"",color:"green-10",class:"full-width text-weight-regular","no-caps":"",to:"/register",label:"Belum punya akun? Daftar!"}),a(p,{outline:"",color:"green-10",class:"full-width text-weight-regular q-mt-sm","no-caps":"",to:"/forgot-password",label:"Lupa password? Atur ulang!"})]),_:1})]),_:1})])],32),K(a(R,{color:"green-12",size:"14em",class:"absolute-center"},null,512),[[M,n.value]])]))}};export{ae as default};
