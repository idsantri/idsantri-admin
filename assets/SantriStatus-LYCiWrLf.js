import{v as r,R as V,x as y,f as x,o as _,w as p,i as l,a8 as B,Q as D,r as k,y as Q,B as C,a4 as b,q as U,a7 as F,b as I,z as w}from"./index-1h6WQa8x.js";import{_ as M}from"./TemplateArray-BJpoSohg.js";import{c as S}from"./format-date-DlwYCgkJ.js";import{a as q}from"./hijri-BBdEhqDI.js";import{r as $,d as A,g as E}from"./array-object-BytDdNh7.js";import{a as O}from"./api-get-BY6mtHh6.js";import{Q as P}from"./QSpinnerCube-CdFtSnRz.js";import{Q as j}from"./QForm-Dcqp4yj8.js";import{a as N}from"./api-post-C74Y7wCj.js";import{a as H}from"./api-update-Damf_6Ly.js";import{a as z}from"./api-delete-BHdy2F2f.js";import{_ as K}from"./InputSelectArray-f2GqfPam.js";import"./QItemSection-CDMonx4a.js";import"./QItemLabel-BCrbjFPh.js";import"./QList-DG4NG05A.js";import"./id-BuNGTsqN.js";import"./format-number-B34ySHL_.js";import"./index-CpzetzrR.js";import"./index-_Ec9HkD1.js";import"./api-error-B2Y93K9w.js";import"./QSelect-DyXiAk3o.js";import"./QChip-DJ1cSnO8.js";import"./QMenu-C8eKSCkY.js";import"./selection-Bkxc-DqK.js";import"./rtl-DFPa-2ov.js";import"./format-CJebrXOQ.js";import"./api-get-lists-BZgeu587.js";import"./lists-store-DUO5Gnb9.js";import"./lists-data-L-iOlbK0.js";import"./DropDownAfter-vvhC7sAZ.js";import"./QBtnDropdown-BuGH-2yX.js";import"./QBtnGroup-GiM85D-N.js";import"./ClosePopup-DlITPM1C.js";const R={key:0},G={__name:"StatusForm",props:{data:{type:Object,required:!0}},emits:["successDelete","successSubmit","successUpdate","successCreate"],setup(g,{emit:c}){const d=g,n=c,e=r({}),o=r(!1);V(async()=>{Object.assign(e.value,d.data)});const f=async()=>{const u={santri_id:e.value.santri_id,status:e.value.status,keterangan:e.value.keterangan};let t=null;const m=!e.value.id;m?t=await N({endPoint:"status",data:u,loading:o}):t=await H({endPoint:`status/${e.value.id}`,data:u,confirm:!0,notify:!0,loading:o}),t&&(document.getElementById("btn-close-form").click(),n("successSubmit",t?.status),n(m?"successCreate":"successUpdate",t?.status))},v=async()=>{const u=e.value.id;await z({endPoint:`status/${u}`,loading:o})&&(document.getElementById("btn-close-form").click(),n("successDelete",u))};return(u,t)=>{const m=y("FormHeader"),s=y("FormActions");return _(),x(U,{class:"full-width",style:{"max-width":"425px"}},{default:p(()=>[l(j,{onSubmit:B(f,["prevent"])},{default:p(()=>[l(m,{title:"Input Status","is-new":!e.value.id},null,8,["is-new"]),l(D,null,{default:p(()=>[o.value?(_(),k("div",R,[l(C,{modelValue:o.value,"onUpdate:modelValue":t[0]||(t[0]=a=>o.value=a),persistent:""},{default:p(()=>[l(P,{color:"green-12",size:"8em",class:"flex q-ma-lg q-mx-auto"})]),_:1},8,["modelValue"])])):Q("",!0),l(b,{dense:"",outlined:"",label:"Nama","model-value":e.value?.nama+" ("+e.value?.santri_id+")",disable:"",filled:""},null,8,["model-value"]),l(K,{modelValue:e.value.status,"onUpdate:modelValue":t[1]||(t[1]=a=>e.value.status=a),url:"status",label:"Status *",class:"q-mt-sm",rules:[a=>!!a||"Harus diisi!"]},null,8,["modelValue","rules"]),l(b,{dense:"",class:"q-mt-sm",outlined:"",label:"Keterangan",modelValue:e.value.keterangan,"onUpdate:modelValue":t[2]||(t[2]=a=>e.value.keterangan=a),autogrow:""},null,8,["modelValue"])]),_:1}),l(s,{"btn-delete":!!e.value.id,onOnDelete:v},null,8,["btn-delete"])]),_:1})]),_:1})}}},xe={__name:"SantriStatus",setup(g){const c=r(!1),d=r(!1),n=r({}),e=r([]),o=r({}),{params:f}=F();async function v(){const s=await O({endPoint:`status/santri/${f.id}`,loading:c});s.status&&(e.value=s.status,o.value=s.santri)}const u=I(()=>e.value.map(s=>({Tanggal:S(s.created_at,"dd-MM-yyyy")+" | "+q(S(s.created_at,"yyyy-MM-dd")),Status:s.status,Keterangan:s.keterangan||"-",id:s.id})));V(async()=>{await v()});const t=()=>{n.value={santri_id:o.value.id,nama:o.value.nama},d.value=!0},m=({id:s})=>{n.value=E(e,s),n.value.santri_id=o.value.id,n.value.nama=o.value.nama,d.value=!0};return(s,a)=>(_(),k("div",null,[l(M,{data:u.value,spinner:c.value,onAdd:t,onEdit:m},null,8,["data","spinner"]),l(C,{modelValue:d.value,"onUpdate:modelValue":a[3]||(a[3]=i=>d.value=i)},{default:p(()=>[l(G,{data:n.value,onSuccessDelete:a[0]||(a[0]=i=>w(A)(e.value,i)),onSuccessCreate:a[1]||(a[1]=i=>e.value.push(i)),onSuccessUpdate:a[2]||(a[2]=i=>w($)(e.value,i.id,i))},null,8,["data"])]),_:1},8,["modelValue"])]))}};export{xe as default};
