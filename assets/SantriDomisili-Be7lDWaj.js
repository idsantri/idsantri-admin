import{v as m,R as V,x as y,f as S,o as _,w as p,i as l,a8 as x,Q as B,r as k,y as Q,B as C,a4 as b,q as I,a7 as U,b as F,z as w}from"./index-1h6WQa8x.js";import{_ as M}from"./TemplateArray-BJpoSohg.js";import{c as D}from"./format-date-DlwYCgkJ.js";import{a as q}from"./hijri-BBdEhqDI.js";import{r as $,d as A,g as E}from"./array-object-BytDdNh7.js";import{a as O}from"./api-get-BY6mtHh6.js";import{Q as P}from"./QSpinnerCube-CdFtSnRz.js";import{Q as j}from"./QForm-Dcqp4yj8.js";import{a as N}from"./api-post-C74Y7wCj.js";import{a as H}from"./api-update-Damf_6Ly.js";import{a as z}from"./api-delete-BHdy2F2f.js";import{_ as K}from"./InputSelectArray-f2GqfPam.js";import"./QItemSection-CDMonx4a.js";import"./QItemLabel-BCrbjFPh.js";import"./QList-DG4NG05A.js";import"./id-BuNGTsqN.js";import"./format-number-B34ySHL_.js";import"./index-CpzetzrR.js";import"./index-_Ec9HkD1.js";import"./api-error-B2Y93K9w.js";import"./QSelect-DyXiAk3o.js";import"./QChip-DJ1cSnO8.js";import"./QMenu-C8eKSCkY.js";import"./selection-Bkxc-DqK.js";import"./rtl-DFPa-2ov.js";import"./format-CJebrXOQ.js";import"./api-get-lists-BZgeu587.js";import"./lists-store-DUO5Gnb9.js";import"./lists-data-L-iOlbK0.js";import"./DropDownAfter-vvhC7sAZ.js";import"./QBtnDropdown-BuGH-2yX.js";import"./QBtnGroup-GiM85D-N.js";import"./ClosePopup-DlITPM1C.js";const R={key:0},G={__name:"DomisiliForm",props:{data:{type:Object,required:!0}},emits:["successDelete","successSubmit","successUpdate","successCreate"],setup(g,{emit:c}){const d=g,s=c,e=m({}),o=m(!1);V(async()=>{Object.assign(e.value,d.data)});const f=async()=>{const n={santri_id:e.value.santri_id,domisili:e.value.domisili,keterangan:e.value.keterangan};let a=null;const u=!e.value.id;u?a=await N({endPoint:"domisili",data:n,loading:o}):a=await H({endPoint:`domisili/${e.value.id}`,data:n,confirm:!0,notify:!0,loading:o}),a&&(document.getElementById("btn-close-form").click(),s("successSubmit",a?.domisili),s(u?"successCreate":"successUpdate",a?.domisili))},v=async()=>{const n=e.value.id;await z({endPoint:`domisili/${n}`,loading:o})&&(document.getElementById("btn-close-form").click(),s("successDelete",n))};return(n,a)=>{const u=y("FormHeader"),i=y("FormActions");return _(),S(I,{class:"full-width",style:{"max-width":"425px"}},{default:p(()=>[l(j,{onSubmit:x(f,["prevent"])},{default:p(()=>[l(u,{title:"Input Domisili","is-new":!e.value.id},null,8,["is-new"]),l(B,null,{default:p(()=>[o.value?(_(),k("div",R,[l(C,{modelValue:o.value,"onUpdate:modelValue":a[0]||(a[0]=t=>o.value=t),persistent:""},{default:p(()=>[l(P,{color:"green-12",size:"8em",class:"flex q-ma-lg q-mx-auto"})]),_:1},8,["modelValue"])])):Q("",!0),l(b,{dense:"",outlined:"",label:"Nama","model-value":e.value?.nama+" ("+e.value?.santri_id+")",disable:"",filled:""},null,8,["model-value"]),l(K,{modelValue:e.value.domisili,"onUpdate:modelValue":a[1]||(a[1]=t=>e.value.domisili=t),url:"domisili",label:"Domisili *",class:"q-mt-sm",rules:[t=>!!t||"Harus diisi!"]},null,8,["modelValue","rules"]),l(b,{dense:"",class:"q-mt-sm",outlined:"",label:"Keterangan",modelValue:e.value.keterangan,"onUpdate:modelValue":a[2]||(a[2]=t=>e.value.keterangan=t),autogrow:""},null,8,["modelValue"])]),_:1}),l(i,{"btn-delete":!!e.value.id,onOnDelete:v},null,8,["btn-delete"])]),_:1})]),_:1})}}},Se={__name:"SantriDomisili",setup(g){const c=m(!1),d=m(!1),s=m({}),e=m([]),o=m({}),{params:f}=U();async function v(){const i=await O({endPoint:`domisili/santri/${f.id}`,loading:c});i.domisili&&(e.value=i.domisili,o.value=i.santri)}const n=F(()=>e.value.map(i=>({Tanggal:D(i.created_at,"dd-MM-yyyy")+" | "+q(D(i.created_at,"yyyy-MM-dd")),Domisili:i.domisili,Keterangan:i.keterangan||"-",id:i.id})));V(async()=>{await v()});const a=()=>{s.value={santri_id:o.value.id,nama:o.value.nama},d.value=!0},u=({id:i})=>{s.value=E(e,i),s.value.santri_id=o.value.id,s.value.nama=o.value.nama,d.value=!0};return(i,t)=>(_(),k("div",null,[l(M,{data:n.value,spinner:c.value,onAdd:a,onEdit:u},null,8,["data","spinner"]),l(C,{modelValue:d.value,"onUpdate:modelValue":t[3]||(t[3]=r=>d.value=r)},{default:p(()=>[l(G,{data:s.value,title:"Input Domisili",onSuccessDelete:t[0]||(t[0]=r=>w(A)(e.value,r)),onSuccessCreate:t[1]||(t[1]=r=>e.value.push(r)),onSuccessUpdate:t[2]||(t[2]=r=>w($)(e.value,r.id,r))},null,8,["data"])]),_:1},8,["modelValue"])]))}};export{Se as default};
