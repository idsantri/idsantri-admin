import{Q as P}from"./QToolbarTitle-DriFd-N5.js";import{a2 as M,v as r,R as U,G as O,f as N,o as G,w as t,i as e,a8 as J,Q as q,a4 as v,q as D,k as B,m as R,n as $,p as _,Z as A,j as m,t as g,z as T,_ as E,B as K}from"./index-Cju_WcQt.js";import{Q as z}from"./QToolbar-DOvpToKQ.js";import{Q as p}from"./QTd-BuU3HM4J.js";import{Q as F}from"./QTr-CEnAfSYk.js";import{Q as H}from"./QTable-CGef7esh.js";import{Q as L}from"./QPage-B1tTC_E4.js";import{a as j}from"./api-get-C-ZFMqL_.js";import{d as x}from"./format-number-B34ySHL_.js";import{Q as Z}from"./QSelect-D99lhOsm.js";import{Q as W}from"./QSpace-e5nOhYJp.js";import{Q as X}from"./QForm-B-IeWzDf.js";import{C as Y}from"./ClosePopup-POBKOZoS.js";import{l as h}from"./loading-store-By6xlJ3p.js";import{a as ee}from"./api-post-P8g4q4LG.js";import{a as ae}from"./api-update-Dm-9pXju.js";import{a as le}from"./api-delete-BEmNpbPy.js";import{_ as te}from"./FormHeader-BlagXmst.js";import{_ as ne}from"./InputCurrency-XyKkbiGT.js";import{_ as se}from"./ReportViewer-DDhmJ-uk.js";import"./QList-DJ6I4Xhf.js";import"./QMarkupTable-CVJrzePZ.js";import"./use-fullscreen-BVouRRhr.js";import"./index-DgCvXGx8.js";import"./index-pFkrbuLE.js";import"./api-error-BS7WyEhR.js";import"./QChip-DJA81wTZ.js";import"./QItemSection-CL0X_XCy.js";import"./QItemLabel-97msGuv9.js";import"./QMenu-BUIDrqEf.js";import"./selection-noklRUze.js";import"./rtl-DFPa-2ov.js";import"./format-CJebrXOQ.js";const oe={__name:"KasCrud",props:{data:Object,isNew:Boolean},emits:["successSubmit","successDelete"],setup(C,{emit:Q}){const{loadingMain:b}=M(h()),c=C,f=Q,n=r({keperluan:"Biaya Administrasi GT",keterangan:"Lunas",flag:"+"}),k=r(!1),u=r({});async function w(o){return await j({endPoint:`ugt/gt/${o}`,loading:k})}U(async()=>{if(Object.assign(n.value,c.data),n.value.gt_id){const o=await w(n.value.gt_id);o?u.value=o.gt:(u.value.nama="Data tidak ditemukan",u.value.pjgt_nama="Data tidak ditemukan")}});async function S(){const o=JSON.parse(JSON.stringify(n.value));delete o.id;let l=null;c.isNew?l=await ee({endPoint:"ugt/kas",data:o,loading:b}):l=await ae({endPoint:`ugt/kas/${n.value.id}`,data:o,confirm:!0,notify:!0,loading:b}),l&&(document.getElementById("btn-close-crud").click(),f("successSubmit",l?.gt))}const V=async()=>{await le({endPoint:`ugt/kas/${n.value.id}`,loading:b})&&(document.getElementById("btn-close-crud").click(),f("successDelete"))};return O(()=>n.value.gt_id,async(o,l)=>{if(u.value.nama="",u.value.pjgt_nama="",o!=l&&typeof l<"u"){const s=await w(o);s?u.value=s.gt:(u.value.nama="Data tidak ditemukan",u.value.pjgt_nama="Data tidak ditemukan")}}),(o,l)=>(G(),N(D,{class:"full-width",style:{"max-width":"425px"}},{default:t(()=>[e(X,{onSubmit:J(S,["prevent"])},{default:t(()=>[e(te,{title:"Input Kas UGT","is-new":c.isNew},null,8,["is-new"]),e(q,{class:"q-pa-sm"},{default:t(()=>[e(v,{dense:"",hint:"Diisi oleh sistem",class:"",outlined:"",label:"ID",modelValue:n.value.id,"onUpdate:modelValue":l[0]||(l[0]=s=>n.value.id=s),disable:"",filled:""},null,8,["modelValue"]),e(D,{class:"q-mt-sm",flat:"",bordered:""},{default:t(()=>[e(q,{class:"q-pa-sm"},{default:t(()=>[l[8]||(l[8]=B("div",{class:"text-caption"}," Jika terkait dengan administrasi GT ",-1)),e(v,{dense:"",class:"q-mt-sm",outlined:"",label:"GT ID",modelValue:n.value.gt_id,"onUpdate:modelValue":l[1]||(l[1]=s=>n.value.gt_id=s)},null,8,["modelValue"]),e(v,{dense:"",class:"q-mt-sm",outlined:"",label:"Nama GT",modelValue:u.value.nama,"onUpdate:modelValue":l[2]||(l[2]=s=>u.value.nama=s),disable:"",filled:"",loading:k.value},null,8,["modelValue","loading"]),e(v,{dense:"",class:"q-mt-sm",outlined:"",label:"Nama PJGT",modelValue:u.value.pjgt_nama,"onUpdate:modelValue":l[3]||(l[3]=s=>u.value.pjgt_nama=s),disable:"",filled:"",loading:k.value},null,8,["modelValue","loading"])]),_:1})]),_:1}),e(v,{dense:"",class:"q-mt-sm",outlined:"",label:"Keperluan",modelValue:n.value.keperluan,"onUpdate:modelValue":l[4]||(l[4]=s=>n.value.keperluan=s)},null,8,["modelValue"]),e(Z,{dense:"",class:"q-mt-sm",outlined:"",label:"Kas Masuk/Keluar",modelValue:n.value.flag,"onUpdate:modelValue":l[5]||(l[5]=s=>n.value.flag=s),options:[{value:"+",label:"Masuk"},{value:"-",label:"Keluar"}],"emit-value":"","map-options":"","error-color":"negative",behavior:"menu"},null,8,["modelValue"]),e(ne,{dense:"",class:"q-mt-sm",outlined:"",modelValue:n.value.nominal,"onUpdate:modelValue":l[6]||(l[6]=s=>n.value.nominal=s),required:"",label:"Nominal"},null,8,["modelValue"]),e(v,{dense:"",class:"q-mt-sm",outlined:"",label:"Keterangan",modelValue:n.value.keterangan,"onUpdate:modelValue":l[7]||(l[7]=s=>n.value.keterangan=s),autogrow:""},null,8,["modelValue"])]),_:1}),e(R,{class:"flex bg-green-6"},{default:t(()=>[$(e(_,{label:"Hapus",class:"bg-red text-red-1","no-caps":"",onClick:V},null,512),[[A,!o.$props.isNew]]),e(W),$(e(_,{label:"Tutup",class:"bg-green-11","no-caps":"",id:"btn-close-crud"},null,512),[[Y]]),e(_,{type:"submit",label:"Simpan",class:"bg-green-10 text-green-11","no-caps":""})]),_:1})]),_:1})]),_:1}))}},ie={class:"q-gutter-sm"},Je={__name:"KasIndex",setup(C){const Q=r([]),b=r(!1),c=r(""),f=r(!1),n=r(!1),k=r({}),u=r("");async function w(){f.value=!1;const d=await j({endPoint:"ugt/kas",loading:b});d&&(Q.value=d.kas)}function S(){k.value={},n.value=!0,f.value=!0}const V=r(!1);async function o(d){u.value=`reports/ugt/kuitansi/view?id=${d.id}`,V.value=!0}function l(d){const i=d.masuk?"+":"-",a=d.masuk||d.keluar,y={id:d.id,gt_id:d.gt_id,keperluan:d.keperluan,keterangan:d.keterangan,flag:i,nominal:a};k.value=y,n.value=!1,f.value=!0}U(async()=>{await w()});const s=[{name:"id",label:"ID",align:"left",field:"id",sortable:!0},{name:"tgl_m",label:"Tanggal",align:"left",field:"tgl_m",sortable:!0},{name:"keperluan",label:"Keperluan",align:"left",field:"keperluan",sortable:!0},{name:"keterangan",label:"Keterangan",align:"left",field:"keterangan",sortable:!0},{name:"masuk",label:"Masuk",align:"right",field:"masuk",sortable:!0},{name:"keluar",label:"Keluar",align:"right",field:"keluar",sortable:!0},{name:"saldo",label:"Saldo",align:"right",field:"saldo",sortable:!0},{name:"cr_by",label:"By",align:"left",field:"cr_by",sortable:!0},{name:"edit",label:"!",align:"center",field:"",sortable:!1}];return(d,i)=>(G(),N(L,{class:"q-pa-sm"},{default:t(()=>[e(D,{class:""},{default:t(()=>[e(q,{class:"bg-green-8 no-padding"},{default:t(()=>[e(z,{class:"no-padding no-margin"},{default:t(()=>[e(P,{class:"text-subtitle1 q-ml-sm text-green-11"},{default:t(()=>[...i[6]||(i[6]=[m(" Kas UGT ",-1)])]),_:1}),e(_,{dense:"",class:"q-px-md q-mr-sm text-green-10",label:"Tambah","no-caps":"",icon:"add",color:"green-2",onClick:S})]),_:1})]),_:1}),e(q,{class:"no-padding"},{default:t(()=>[e(H,{rows:Q.value,loading:b.value,"rows-per-page-options":[10,25,50,100,0],pagination:{page:999},class:"dt q-px-sm",columns:s,filter:c.value,"no-data-label":"Tidak ada data untuk ditampilkan!","no-results-label":"Tidak ditemukan kata kunci yang sesuai dengan pencarian Anda!","row-key":"name",onRowClick:i[1]||(i[1]=(a,y,I)=>l(a,y,I))},{"top-right":t(()=>[e(v,{outlined:"",dense:"",debounce:"300",modelValue:c.value,"onUpdate:modelValue":i[0]||(i[0]=a=>c.value=a),placeholder:"Cari"},{append:t(()=>[e(E,{name:"search"})]),_:1},8,["modelValue"])]),body:t(a=>[e(F,{props:a},{default:t(()=>[e(p,{key:"id",props:a},{default:t(()=>[m(g(a.row.id),1)]),_:2},1032,["props"]),e(p,{key:"tgl_m",props:a},{default:t(()=>[m(g(a.row.tgl_m),1)]),_:2},1032,["props"]),e(p,{key:"keperluan",props:a},{default:t(()=>[m(g(a.row.gt_id?`${a.row.keperluan} (${a.row.gt_id})`:a.row.keperluan),1)]),_:2},1032,["props"]),e(p,{key:"keterangan",props:a},{default:t(()=>[m(g(a.row.keterangan),1)]),_:2},1032,["props"]),e(p,{key:"masuk",props:a},{default:t(()=>[m(g(T(x)(a.row.masuk)),1)]),_:2},1032,["props"]),e(p,{key:"keluar",props:a},{default:t(()=>[m(g(T(x)(a.row.keluar)),1)]),_:2},1032,["props"]),e(p,{key:"saldo",props:a},{default:t(()=>[m(g(T(x)(a.row.saldo)),1)]),_:2},1032,["props"]),e(p,{key:"cr_by",props:a},{default:t(()=>[m(g(a.row.cr_by),1)]),_:2},1032,["props"]),e(p,{key:"edit",props:a},{default:t(()=>[B("div",ie,[e(_,{icon:"edit","no-caps":"",color:"green-10",outline:"",dense:"",class:"q-px-md",onClick:y=>l(a.row)},null,8,["onClick"]),e(_,{icon:"print","no-caps":"",color:"green-10",outline:"",dense:"",class:"q-px-md",onClick:y=>o(a.row),disable:!a.row.gt_id},null,8,["onClick","disable"])])]),_:2},1032,["props"])]),_:2},1032,["props"])]),_:1},8,["rows","loading","filter"])]),_:1})]),_:1}),e(K,{persistent:"",modelValue:f.value,"onUpdate:modelValue":i[4]||(i[4]=a=>f.value=a)},{default:t(()=>[e(oe,{"is-new":n.value,data:k.value,onSuccessSubmit:i[2]||(i[2]=a=>w()),onSuccessDelete:i[3]||(i[3]=a=>w())},null,8,["is-new","data"])]),_:1},8,["modelValue"]),e(K,{modelValue:V.value,"onUpdate:modelValue":i[5]||(i[5]=a=>V.value=a)},{default:t(()=>[e(se,{url:u.value},null,8,["url"])]),_:1},8,["modelValue"])]),_:1}))}};export{Je as default};
