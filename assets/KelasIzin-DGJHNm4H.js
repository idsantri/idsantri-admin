import{A as o,U as S,B as w,c as D,o as z,w as v,b as l,ab as j,e as U,C as y,Q as $,a5 as c,x as q,a9 as x,f as I,E as C,F as M}from"./index-DwrbA0R8.js";import{i as A,f as H,b as Q}from"./format-date-DlwYCgkJ.js";import{f as K,m as N}from"./hijri-BBdEhqDI.js";import{g as B}from"./array-object-BytDdNh7.js";import{a as O}from"./api-get-D4W4lze7.js";import{_ as E}from"./TemplateArray-hLUfA21F.js";import{Q as P}from"./QForm-DCEv1Ikv.js";import{_ as F}from"./InputSelectArray-DFe88pva.js";import{u as G}from"./useCrudForm-DF0rM6hG.js";import{A as L}from"./ApiCrud-KwrbSuI8.js";import{_ as R}from"./ReportViewer-25QRZbnp.js";import"./id-BuNGTsqN.js";import"./format-number-B34ySHL_.js";import"./index-B6LiMDVO.js";import"./index-BlZcD66n.js";import"./api-error-DGWaEiw1.js";import"./QSpinnerCube-CuByR_Bu.js";import"./QItemSection-CeSY4hvW.js";import"./QItemLabel-Dzdetwv2.js";import"./QList-Cc6jCv1k.js";import"./QSelect-CrgZ1FsI.js";import"./QChip-DvUCR8tL.js";import"./QMenu-BEnErdhw.js";import"./selection-DRCgFU0J.js";import"./rtl-DFPa-2ov.js";import"./format-CJebrXOQ.js";import"./lists-store-Cp7AZ7Mr.js";import"./DropDownAfter-D2Wgui76.js";import"./QBtnDropdown-DqbNLFX1.js";import"./QBtnGroup-CPjXoyXA.js";import"./ClosePopup-kZj4_oIv.js";import"./Lists-g9uME9Wy.js";import"./Api-DWdZFNbG.js";class T extends L{constructor(){super("izin-madrasah")}async riwayat(_){const u=await this._apiGet({endPoint:`${this._path}/kelas/${_}`});return this._showSuccess(u.message),u.data}}const J=new T,W={__name:"IzinMadrasahForm",props:{data:{type:Object,required:!0}},emits:["successDelete","successSubmit","successUpdate","successCreate"],setup(h,{emit:_}){const u=h,f=_,a=o({keperluan:"Sakit",durasi:1}),t=!u.data?.id,{handleDelete:g,handleCreate:d,handleUpdate:s,loading:k}=G(J,{emit:f,responseKey:"izin_madrasah"});S(async()=>{Object.assign(a.value,u.data)});const m=async()=>{const p={kelas_id:a.value.kelas_id,dari_tgl:a.value.dari_tgl,durasi:a.value.durasi,keperluan:a.value.keperluan,keterangan:a.value.keterangan,catatan:a.value.catatan};return t?await d(p,!0):await s(u.data.id,p,!0)},V=async()=>await g(u.data.id);return(p,r)=>{const b=w("FormHeader"),i=w("FormLoading"),n=w("FormActions");return z(),D(q,{class:"full-width",style:{"max-width":"425px"}},{default:v(()=>[l(P,{onSubmit:j(m,["prevent"])},{default:v(()=>[l(b,{title:"Input Izin Madrasah","is-new":t}),y(k)?(z(),D(i,{key:0})):U("",!0),l($,null,{default:v(()=>[l(c,{dense:"",class:"q-my-sm",outlined:"",label:"Nama","model-value":a.value?.nama+" ("+a.value?.santri_id+")",disable:"",filled:""},null,8,["model-value"]),l(c,{dense:"",class:"q-my-sm",outlined:"",label:"Data Kelas","model-value":a.value?.th_ajaran_h+" | "+a.value?.tingkat_id+" | "+a.value?.kelas,disable:"",filled:""},null,8,["model-value"]),l(c,{dense:"",hint:y(A)(a.value.dari_tgl)?y(H)(a.value.dari_tgl):"",class:"q-my-sm",outlined:"",label:"Tanggal (M)*",modelValue:a.value.dari_tgl,"onUpdate:modelValue":r[0]||(r[0]=e=>a.value.dari_tgl=e),type:"date",rules:[e=>!!e||"Harus diisi!"],"error-color":"negative"},null,8,["hint","modelValue","rules"]),l(c,{dense:"",class:"q-my-sm",outlined:"",label:"Durasi (hari)*",modelValue:a.value.durasi,"onUpdate:modelValue":r[1]||(r[1]=e=>a.value.durasi=e),rules:[e=>!!e||"Harus diisi!",e=>!e||!isNaN(e)||"Hanya angka"],"error-color":"negative"},null,8,["modelValue","rules"]),l(F,{modelValue:a.value.keperluan,"onUpdate:modelValue":r[2]||(r[2]=e=>a.value.keperluan=e),url:"keperluan-izin",label:"Keperluan *",class:"q-my-sm",rules:[e=>!!e||"Harus diisi!"]},null,8,["modelValue","rules"]),l(F,{modelValue:a.value.keterangan,"onUpdate:modelValue":r[3]||(r[3]=e=>a.value.keterangan=e),url:"keterangan-izin",label:"Keterangan",class:"q-my-sm"},null,8,["modelValue"]),l(c,{dense:"",class:"q-my-sm",outlined:"",label:"Catatan",modelValue:a.value.catatan,"onUpdate:modelValue":r[4]||(r[4]=e=>a.value.catatan=e),autogrow:""},null,8,["modelValue"])]),_:1}),l(n,{"btn-delete":!t,onOnDelete:V},null,8,["btn-delete"])]),_:1})]),_:1})}}},Ua={__name:"KelasIzin",setup(h){const u=x().params,f=o([]),a=o([]),t=o({}),g=o(!1),d=o(!1),s=o({}),k=o("");async function m(){const i=await O({endPoint:`izin-madrasah/kelas/${u.id}`,loading:g});i.izin_madrasah&&(f.value=i.izin_madrasah,s.value=i.kelas,a.value=i.izin_madrasah.map(n=>({Tanggal:Q(n.dari_tgl)+" | "+K(N(n.dari_tgl)),Durasi:n.durasi+" hari",Keperluan:n.keperluan+`${n.keterangan?.length>0?" ("+n.keterangan+")":""}`,Catatan:n.catatan,id:n.id})))}S(async()=>{await m()});const V=()=>{t.value={},t.value.santri_id=s.value.santri_id,t.value.nama=s.value.nama,t.value.th_ajaran_h=s.value.th_ajaran_h,t.value.tingkat_id=s.value.tingkat_id,t.value.kelas=s.value.kelas,t.value.kelas_id=s.value.id,d.value=!0},p=({id:i})=>{t.value={},t.value=B(f,i),t.value.santri_id=s.value.santri_id,t.value.nama=s.value.nama,t.value.th_ajaran_h=s.value.th_ajaran_h,t.value.tingkat_id=s.value.tingkat_id,t.value.kelas=s.value.kelas,d.value=!0},r=o(!1);function b(i){k.value=`reports/izin-madrasah/view?id=${i.id}}`,r.value=!0}return(i,n)=>(z(),I(M,null,[l(E,{data:a.value,spinner:g.value,"btn-print":!0,onAdd:V,onEdit:p,onPrint:b},null,8,["data","spinner"]),l(C,{modelValue:d.value,"onUpdate:modelValue":n[0]||(n[0]=e=>d.value=e)},{default:v(()=>[l(W,{data:t.value,onSuccessSubmit:m,onSuccessDelete:m},null,8,["data"])]),_:1},8,["modelValue"]),l(C,{modelValue:r.value,"onUpdate:modelValue":n[1]||(n[1]=e=>r.value=e)},{default:v(()=>[l(R,{url:k.value},null,8,["url"])]),_:1},8,["modelValue"])],64))}};export{Ua as default};
