import{Q as z}from"./QSpace-DJeipgZa.js";import{c,o as u,w as e,b as a,n as Q,q as g,v as F,g as y,a0 as ea,F as H,t as ta,s as B,x as V,y as la,e as w,p as $,_ as O,af as na,a5 as oa,R as G,a9 as sa,a as ia,B as A,a3 as U,z as I,Q as ra,f as p,a4 as X,a7 as Y,a8 as ua,k as M}from"./index-Bf-p91mW.js";import{Q as da}from"./QPage-DbeGPrD5.js";import{f as J}from"./format-date-DlwYCgkJ.js";import{_ as ma}from"./CardColumn-CnWjUfn4.js";import{Q as j}from"./QSpinnerCube-CRIto8Mg.js";import{Q as pa}from"./QImg-DJapb2Ub.js";import{_ as fa}from"./ImageUploader-CsjUpCz_.js";import{s as x}from"./santri-store-Bj24Fsef.js";import{b as ca}from"./hijri-BBdEhqDI.js";import{Q as h}from"./QRouteTab-CpyWYYTo.js";import{Q as S}from"./QItemLabel-sjS6zLD0.js";import{Q as q,a as r}from"./QItemSection-Bl4rOme3.js";import{Q as Z}from"./QList-51Eu5HNp.js";import{Q as aa}from"./QBtnDropdown-Br6y2eVM.js";import{Q as ga}from"./QTabs-vx_STaPS.js";import{C as k}from"./ClosePopup-HTVnKVBl.js";import{d as va}from"./dialog-store-Bszvjqv7.js";import{a as _a}from"./api-get-CiRdORW1.js";import{a as N}from"./api-download-Bx82Ti5H.js";import{_ as ba}from"./ReportViewer-BPWo2oEb.js";import{Q as R}from"./QSelect-Co09SqkM.js";import{Q as wa}from"./QForm-OmDQHoiq.js";import{_ as ka}from"./FormHeader-5vDnmT1F.js";import{d as Va}from"./index-BtaF3-6r.js";import{_ as $a}from"./InputSelectArray-Jz4ksDX6.js";import{l as Sa}from"./loading-store-BlK5tqaZ.js";import{S as qa}from"./Santri-BlBn6n9Q.js";import"./id-BuNGTsqN.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./index-D7WC_quC.js";import"./format-number-B34ySHL_.js";import"./QBtnGroup-BDP931ZD.js";import"./QMenu-BvL1IfNl.js";import"./selection-CE9S_xiH.js";import"./QResizeObserver-CbBcyoPU.js";import"./rtl-DFPa-2ov.js";import"./api-error-C0HjZ2a3.js";import"./QChip-DeZPZCXp.js";import"./format-CJebrXOQ.js";import"./QToolbarTitle-Bi6rSosy.js";import"./QToolbar-CUFZpZSE.js";import"./lists-store-F5P_xNBX.js";import"./lists-data-mcTvx2m2.js";import"./DropDownAfter-wYSCUu7Z.js";import"./Lists-DSwT9YX9.js";import"./ApiCrud-SVFtkNw7.js";const Ia={class:"flex items-center"},xa={class:"text-subtitle2"},ya={key:0},Qa={key:1,class:"row"},Ca={class:"col-4 q-pr-sm"},Da={key:0},Ua={class:"col"},ha={class:"text-caption text-italic"},Ba={class:"q-mb-sm"},Pa={__name:"CardImage",props:{title:String,data:Object,image:String,loading:Boolean,loadingImage:Boolean},setup(v){return(t,n)=>(u(),c(B,null,{default:e(()=>[a(Q,{class:"bg-green-7 text-green-11 q-pa-sm"},{default:e(()=>[g("div",Ia,[g("div",xa,F(v.title),1),a(z)])]),_:1}),a(Q,{class:"q-pa-sm"},{default:e(()=>[v.loading?(u(),y("div",ya,[a(j,{color:"green-12",size:"8em",class:"flex q-ma-lg q-mx-auto"})])):(u(),y("div",Qa,[g("div",Ca,[v.loadingImage?(u(),y("div",Da,[a(j,{color:"green-12",size:"4em",class:"flex q-ma-sm q-mx-auto"})])):(u(),c(pa,{key:1,src:v.image,ratio:3/4,alt:"santri"},null,8,["src"])),ea(t.$slots,"button")]),g("div",Ua,[(u(!0),y(H,null,ta(v.data,(s,i)=>(u(),y("div",{key:i},[g("div",ha,F(i),1),g("div",Ba,F(s),1)]))),128))])]))]),_:3})]),_:3}))}},Na={__name:"SantriRelations",props:{santriId:{default:null}},setup(v){const t=v,n=V(0);return(s,i)=>{const _=la("router-view");return u(),c(B,{key:n.value},{default:e(()=>[g("button",{onClick:i[0]||(i[0]=b=>n.value++),id:"btn-rerender-santri-relations",style:{display:"none"}}," rerender "),a(ga,{"no-caps":"","outside-arrows":"","mobile-arrows":"",class:"bg-green-7 text-green-11 shadow-2",dense:"","indicator-color":"green-13",align:"left"},{default:e(()=>[a(h,{name:"wali",label:"Wali",to:"/santri/"+t.santriId+"/wali"},null,8,["to"]),a(h,{name:"ortu",label:"Ortu",to:"/santri/"+t.santriId+"/ortu"},null,8,["to"]),a(h,{name:"status",label:"Status",to:"/santri/"+t.santriId+"/status"},null,8,["to"]),a(h,{name:"kelas",label:"Kelas",to:"/santri/"+t.santriId+"/kelas"},null,8,["to"]),a(h,{name:"domisili",label:"Domisili",to:"/santri/"+t.santriId+"/domisili"},null,8,["to"]),a(z),a(aa,{flat:"",dense:"","dropdown-icon":"more_vert",class:"q-pl-md",color:"green-11"},{default:e(()=>[a(Z,null,{default:e(()=>[w((u(),c(q,{to:"/iuran/santri/"+t.santriId},{default:e(()=>[a(r,null,{default:e(()=>[a(S,null,{default:e(()=>[...i[1]||(i[1]=[$("Iuran",-1)])]),_:1})]),_:1}),a(r,{avatar:""},{default:e(()=>[a(O,{name:"payments",flat:""})]),_:1})]),_:1},8,["to"])),[[k]]),w((u(),c(q,{to:"/keamanan/izin-pesantren/santri/"+t.santriId},{default:e(()=>[a(r,null,{default:e(()=>[a(S,null,{default:e(()=>[...i[2]||(i[2]=[$("Izin Pesantren",-1)])]),_:1})]),_:1}),a(r,{avatar:""},{default:e(()=>[a(O,{name:"transfer_within_a_station",flat:""})]),_:1})]),_:1},8,["to"])),[[k]]),w((u(),c(q,{to:"/keamanan/indisipliner/santri/"+t.santriId},{default:e(()=>[a(r,null,{default:e(()=>[a(S,null,{default:e(()=>[...i[3]||(i[3]=[$("Indisipliner",-1)])]),_:1})]),_:1}),a(r,{avatar:""},{default:e(()=>[a(O,{name:"directions_run",flat:""})]),_:1})]),_:1},8,["to"])),[[k]])]),_:1})]),_:1})]),_:1}),a(Q,{class:"q-pa-sm"},{default:e(()=>[(u(),c(na,null,{default:e(()=>[a(_)]),fallback:e(()=>[a(j,{color:"green-12",size:"8em",class:"flex q-mx-auto"})]),_:1}))]),_:1})]),_:1})}}},Ra={key:0},ja={__name:"PermohonanBerhenti",emits:["submitted"],setup(v,{emit:t}){const n=V({jenis_permohonan:"Berhenti",tunggakan:"Lunas"}),{santri:s}=oa(x()),i=V(!1),_=t;G(async()=>{});async function b(){const m=JSON.parse(JSON.stringify(n.value));if(!m.tunggakan||!m.jenis_permohonan||!m.alasan||!m.wali_nama||!m.wali_status||!m.wali_hubungan)return Va("Isian tidak lengkap");m.id=s.id,_("submitted",m),document.getElementById("btn-close").click()}return(m,l)=>(u(),c(B,{class:"full-width",style:{"max-width":"425px"}},{default:e(()=>[a(wa,{onSubmit:sa(b,["prevent"])},{default:e(()=>[a(ka,{title:"Permohonan Berhenti","is-new":!0}),a(Q,{class:"q-pa-sm"},{default:e(()=>[i.value?(u(),y("div",Ra,[a(A,{modelValue:i.value,"onUpdate:modelValue":l[0]||(l[0]=o=>i.value=o),persistent:""},{default:e(()=>[a(j,{color:"green-12",size:"8em",class:"flex q-ma-lg q-mx-auto"})]),_:1},8,["modelValue"])])):ia("",!0),a(U,{dense:"",class:"",outlined:"",label:"Santri ID",modelValue:I(s).id,"onUpdate:modelValue":l[1]||(l[1]=o=>I(s).id=o),filled:"",disable:""},null,8,["modelValue"]),a(U,{dense:"",class:"q-mt-sm",outlined:"",label:"Nama",modelValue:I(s).nama,"onUpdate:modelValue":l[2]||(l[2]=o=>I(s).nama=o),filled:"",disable:""},null,8,["modelValue"]),a(R,{dense:"",class:"q-mt-sm",outlined:"",label:"Tunggakan*",modelValue:n.value.tunggakan,"onUpdate:modelValue":l[3]||(l[3]=o=>n.value.tunggakan=o),options:["Lunas","Belum Lunas"],clearable:"","use-input":"","new-value-mode":"add",behavior:"menu"},null,8,["modelValue"]),a(R,{dense:"",class:"q-mt-sm",outlined:"",label:"Jenis Permohonan*",modelValue:n.value.jenis_permohonan,"onUpdate:modelValue":l[4]||(l[4]=o=>n.value.jenis_permohonan=o),options:["Berhenti","Cuti/Istirahat"],clearable:"","use-input":"","new-value-mode":"add",behavior:"menu"},null,8,["modelValue"]),a(U,{dense:"",class:"q-mt-sm",outlined:"",label:"Alasan*",modelValue:n.value.alasan,"onUpdate:modelValue":l[5]||(l[5]=o=>n.value.alasan=o),autogrow:""},null,8,["modelValue"]),a(B,{class:"q-mt-sm",flat:"",bordered:""},{default:e(()=>[a(Q,{class:"q-pa-sm"},{default:e(()=>[l[12]||(l[12]=g("div",{class:"text-subtitle2"}," Identitas Pemohon (Wali) ",-1)),a(U,{dense:"",class:"",outlined:"",label:"Nama*",modelValue:n.value.wali_nama,"onUpdate:modelValue":l[6]||(l[6]=o=>n.value.wali_nama=o)},null,8,["modelValue"]),a(U,{dense:"",class:"q-mt-sm",outlined:"",label:"Nomor Telepon",modelValue:n.value.wali_no_telepon,"onUpdate:modelValue":l[7]||(l[7]=o=>n.value.wali_no_telepon=o)},null,8,["modelValue"]),a(R,{dense:"",class:"q-mt-sm",outlined:"",label:"Bukti Diri",modelValue:n.value.wali_bukti_diri,"onUpdate:modelValue":l[8]||(l[8]=o=>n.value.wali_bukti_diri=o),options:["KTP","SIM"],clearable:"","use-input":"","new-value-mode":"add",behavior:"menu"},null,8,["modelValue"]),a(U,{dense:"",class:"q-mt-sm",outlined:"",label:"Nomor / ID Bukti Diri",modelValue:n.value.wali_bukti_diri_id,"onUpdate:modelValue":l[9]||(l[9]=o=>n.value.wali_bukti_diri_id=o)},null,8,["modelValue"]),a(R,{dense:"",class:"q-mt-sm",outlined:"",label:"Status*",modelValue:n.value.wali_status,"onUpdate:modelValue":l[10]||(l[10]=o=>n.value.wali_status=o),options:["Wali","Wakil Wali"],clearable:"","use-input":"","new-value-mode":"add",behavior:"menu"},null,8,["modelValue"]),a($a,{modelValue:n.value.wali_hubungan,"onUpdate:modelValue":l[11]||(l[11]=o=>n.value.wali_hubungan=o),url:"hubungan-wali",label:"Hubungan*",class:"q-mt-sm","use-input":"","new-value-mode":"add"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),a(ra,{class:"flex bg-green-6"},{default:e(()=>[a(z),w(a(p,{label:"Tutup",class:"bg-green-11","no-caps":"",id:"btn-close"},null,512),[[k]]),a(p,{type:"submit",label:"Print",class:"bg-green-10 text-green-11","no-caps":"",icon:"print"})]),_:1})]),_:1})]),_:1}))}},za={__name:"DropDownPrint",props:{santri:{type:Object,required:!0}},setup(v){const t=v,{loadingMain:n}=X(Sa()),s=Y(),i=V(!1),_=V(""),b=V(!1);async function m(){await N({endPoint:`reports/santri/registrasi/download?id=${s.params.id}`,loading:n,fileName:"registrasi-"+s.params.id,confirm:!0,message:"Download data registrasi?"})}async function l(){await N({endPoint:`reports/santri/standbook/download?id=${s.params.id}`,loading:n,fileName:"standbook-"+s.params.id,confirm:!0,message:"Download standbook?"})}async function o(){await N({endPoint:`reports/santri/keterangan-berhenti/download?id=${s.params.id}`,loading:n,fileName:"keterangan-berhenti-"+s.params.id,confirm:!0,message:"Download Keterangan Berhenti"})}async function T(){await N({endPoint:`reports/santri/id-card/download?id=${s.params.id}`,loading:n,fileName:"card-"+s.params.id+" ~ "+t.santri.nama,confirm:!0,message:"Download ID Card"})}function K(){_.value=`reports/santri/registrasi/view?id=${s.params.id}`,b.value=!0}function L(){_.value=`reports/santri/standbook/view?id=${s.params.id}`,b.value=!0}function W(P){i.value=!1;const d=new URLSearchParams(P).toString();_.value=`reports/santri/permohonan-berhenti/view?${d}`,b.value=!0}function C(){_.value=`reports/santri/keterangan-berhenti/view?id=${s.params.id}`,b.value=!0}return(P,d)=>(u(),y(H,null,[a(aa,{color:"green-10",label:"Cetak",icon:"print","no-caps":"",class:"text-green-11 q-px-md",size:"sm"},{default:e(()=>[a(Z,null,{default:e(()=>[w((u(),c(q,null,{default:e(()=>[a(r,null,{default:e(()=>[a(S,null,{default:e(()=>[...d[3]||(d[3]=[$("Registrasi",-1)])]),_:1})]),_:1}),a(r,{avatar:""},{default:e(()=>[a(p,{icon:"download",flat:"",onClick:m})]),_:1}),a(r,{avatar:""},{default:e(()=>[a(p,{icon:"print",flat:"",onClick:K})]),_:1})]),_:1})),[[k]]),w((u(),c(q,null,{default:e(()=>[a(r,null,{default:e(()=>[a(S,null,{default:e(()=>[...d[4]||(d[4]=[$("Standbook",-1)])]),_:1})]),_:1}),a(r,{avatar:""},{default:e(()=>[a(p,{icon:"download",flat:"",onClick:l})]),_:1}),a(r,{avatar:""},{default:e(()=>[a(p,{icon:"print",flat:"",onClick:L})]),_:1})]),_:1})),[[k]]),w((u(),c(q,null,{default:e(()=>[a(r,null,{default:e(()=>[a(S,null,{default:e(()=>[...d[5]||(d[5]=[$("Permohonan Berhenti",-1)])]),_:1})]),_:1}),a(r,{avatar:""},{default:e(()=>[a(p,{icon:"download",flat:"",disable:""})]),_:1}),a(r,{avatar:""},{default:e(()=>[a(p,{icon:"print",flat:"",onClick:d[0]||(d[0]=f=>i.value=!0)})]),_:1})]),_:1})),[[k]]),w((u(),c(q,null,{default:e(()=>[a(r,null,{default:e(()=>[a(S,null,{default:e(()=>[...d[6]||(d[6]=[$("Keterangan Berhenti",-1)])]),_:1})]),_:1}),a(r,{avatar:""},{default:e(()=>[a(p,{icon:"download",flat:"",onClick:o})]),_:1}),a(r,{avatar:""},{default:e(()=>[a(p,{icon:"print",flat:"",onClick:C})]),_:1})]),_:1})),[[k]]),w((u(),c(q,null,{default:e(()=>[a(r,null,{default:e(()=>[a(S,null,{default:e(()=>[...d[7]||(d[7]=[$("ID Card",-1)])]),_:1})]),_:1}),a(r,{avatar:""},{default:e(()=>[a(p,{icon:"download",flat:"",onClick:T})]),_:1}),a(r,{avatar:""},{default:e(()=>[a(p,{icon:"print",flat:"",disable:""})]),_:1})]),_:1})),[[k]])]),_:1})]),_:1}),a(A,{modelValue:i.value,"onUpdate:modelValue":d[1]||(d[1]=f=>i.value=f)},{default:e(()=>[a(ja,{onSubmitted:W})]),_:1},8,["modelValue"]),a(A,{modelValue:b.value,"onUpdate:modelValue":d[2]||(d[2]=f=>b.value=f)},{default:e(()=>[a(ba,{url:_.value},null,8,["url"])]),_:1},8,["modelValue"])],64))}},Ta={class:"flex items-center"},Ka={class:"row"},La={class:"col-12 col-sm-6 col-md-4 q-pa-sm"},Wa={class:"col-12 col-sm-6 col-md-5 q-pa-sm"},Re={__name:"SantriDetail",setup(v){const{santri:t}=ua(x()),s=Y().params.id,i=va(),{searchSantri:_,crudSantri:b}=X(i),m=V(!1),l=V(!1);async function o(){const f=await _a({endPoint:`images/santri/${s}`,loading:l});t.image_url=f.image_url}async function T(){x().$reset();try{m.value=!0;const f=await qa.getById({id:s});f&&(x().setSantri(f.santri),x().setOrtu(f.ortu),x().setWali(f.wali))}catch{}finally{m.value=!1}}const K=M(()=>({ID:t.value.id,"Tanggal Daftar":J(t.value.tgl_daftar_m)+" | "+ca(t.value.tgl_daftar_h),"Tahun Ajaran":`${t.value.th_ajaran_h||"-"} | ${t.value.th_ajaran_m||"-"}`})),L=M(()=>({Nama:`${t.value.nama?.toUpperCase()} (${t.value.sex?.toUpperCase()})`,Alamat:`${t.value.jl||" "} RT ${String(t.value.rt||0).padStart(3,0)} RW ${String(t.value.rw||0).padStart(3,"0")} ${t.value.desa||" "} ${t.value.kecamatan||" "} ${t.value.kabupaten||" "} ${t.value.provinsi||" "} ${t.value.kode_pos||" "}`.replace(/\s\s+/g," "),Kelahiran:`${t.value.tmp_lahir||"-"}, ${J(t.value.tgl_lahir)}`,"Data Akhir":t.value.data_akhir||"-"}));G(async()=>{await T()});function W(){x().setEdit(),b.value=!0}const C=V(!1),P=f=>C.value=f;async function d(){C.value=!1,await o()}return(f,D)=>(u(),c(da,{class:"q-pa-sm"},{default:e(()=>[a(B,{class:""},{default:e(()=>[a(Q,{class:"bg-green-8 text-green-11 q-pa-sm"},{default:e(()=>[g("div",Ta,[D[2]||(D[2]=g("div",{class:"text-subtitle1"},"Data Santri",-1)),a(z),a(p,{onClick:E=>null,size:"sm",color:"green-2",class:"text-green-10 q-mr-sm",icon:"sync",disable:""}),a(p,{label:"Cari",onClick:D[0]||(D[0]=E=>_.value=!0),size:"sm",color:"green-2",class:"text-green-10 q-mr-sm",icon:"search"}),a(p,{"no-caps":"",size:"sm",color:"green-2",class:"text-green-10 q-mr-sm",icon:"edit",label:"Edit",onClick:W}),a(za,{santri:I(t)},null,8,["santri"])])]),_:1}),a(Q,{class:"no-padding"},{default:e(()=>[g("div",Ka,[g("div",La,[a(ma,{class:"q-mb-sm",data:K.value,loading:m.value,title:"Registrasi"},null,8,["data","loading"]),a(Pa,{class:"q-mb-sm",title:"Identitas",data:L.value,loading:m.value,loadingImage:l.value,image:I(t)?.image_url||"/user-default.png"},{button:e(()=>[a(p,{class:"q-mt-sm full-width",icon:"upload","no-caps":"",label:"Foto",dense:"",size:"sm",outline:"",color:"green-10",onClick:D[1]||(D[1]=E=>C.value=!0)})]),_:1},8,["data","loading","loadingImage","image"])]),g("div",Wa,[a(Na,{"santri-id":I(s)},null,8,["santri-id"])])])]),_:1})]),_:1}),a(fa,{"img-format":"jpg","show-uploader":C.value,url:`/images/santri/${I(s)}`,onUpdateUploader:P,onSuccessUpload:d},null,8,["show-uploader","url"])]),_:1}))}};export{Re as default};
