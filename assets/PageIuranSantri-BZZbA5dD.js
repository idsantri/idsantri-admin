import{x as v,R as A,y as T,c as q,o as f,w as e,b as a,a9 as E,a as B,n as Q,e as L,Z as pa,a3 as N,s as O,a4 as ca,g as $,p as x,f as D,B as R,F as M,a7 as G,C as fa,G as va,P as _a,q as c,v as C,z as P,t as na,ab as ea,r as ga,_ as ta,a6 as sa,a0 as ba,bI as ka,bJ as ya,ag as xa}from"./index-Bf-p91mW.js";import{Q as wa}from"./QSpace-DJeipgZa.js";import{Q as oa}from"./QSpinnerCube-CRIto8Mg.js";import{Q as Va}from"./QRouteTab-CpyWYYTo.js";import{Q as ha}from"./QTabs-vx_STaPS.js";import{a as z}from"./api-get-CiRdORW1.js";import{Q as F,a as h}from"./QItemSection-Bl4rOme3.js";import{Q as j}from"./QItemLabel-sjS6zLD0.js";import{Q as X}from"./QList-51Eu5HNp.js";import{a as J}from"./api-update-BYe6B3v5.js";import{c as $a}from"./format-date-DlwYCgkJ.js";import{Q as aa}from"./QForm-OmDQHoiq.js";import{l as W}from"./lists-store-F5P_xNBX.js";import{a as qa}from"./api-delete-BVHfd1pG.js";import{a as ua}from"./api-post-CHcQycZS.js";import{_ as ia}from"./InputCurrency-DnJI6KCw.js";import{_ as ra}from"./InputSelectSantriId-Dr_LO5a7.js";import{_ as H}from"./InputSelectArray-Jz4ksDX6.js";import{r as la,d as Sa}from"./array-object-BytDdNh7.js";import{s as ja,a as Ia,b as Ca,c as Pa}from"./utils-CiaEZYac.js";import{Q as da}from"./QBtnDropdown-Br6y2eVM.js";import{C as K}from"./ClosePopup-HTVnKVBl.js";import{a as Z}from"./api-download-Bx82Ti5H.js";import{l as Fa}from"./loading-store-BlK5tqaZ.js";import{_ as Ua}from"./ReportViewer-BPWo2oEb.js";import{_ as Qa}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{Q as Ta}from"./QToolbarTitle-Bi6rSosy.js";import{Q as Da}from"./QToolbar-CUFZpZSE.js";import{Q as Aa}from"./QSelect-Co09SqkM.js";import{_ as La}from"./CardSantriSimple-JMo4QFGj.js";import{_ as Ba}from"./InputSelectIuranPaket-R353gxqw.js";import"./QResizeObserver-CbBcyoPU.js";import"./rtl-DFPa-2ov.js";import"./index-D7WC_quC.js";import"./index-BtaF3-6r.js";import"./api-error-C0HjZ2a3.js";import"./id-BuNGTsqN.js";import"./lists-data-mcTvx2m2.js";import"./Santri-BlBn6n9Q.js";import"./ApiCrud-SVFtkNw7.js";import"./DropDownAfter-wYSCUu7Z.js";import"./Lists-DSwT9YX9.js";import"./QBtnGroup-BDP931ZD.js";import"./QMenu-BvL1IfNl.js";import"./selection-CE9S_xiH.js";import"./QChip-DeZPZCXp.js";import"./format-CJebrXOQ.js";import"./QSkeleton-DEYFlc1v.js";import"./QImg-DJapb2Ub.js";import"./santri-store-Bj24Fsef.js";import"./QSlideTransition-CK8PkPuu.js";const ma={__name:"IuranForm",props:{data:{type:Object,required:!1,default:()=>{}},disableSantriId:{type:Boolean,default:!1},disableThAjaran:{type:Boolean,default:!1}},emits:["successDelete","successSubmit","successUpdate","successCreate"],setup(S,{emit:d}){const g=S,_=d,t=v({}),s=v(!1),w=v([]),r=v([]);A(async()=>{Object.assign(t.value,g.data),w.value=W().getStateByKey("tahun-ajaran"),r.value=W().getStateByKey("iuran")});const i=b=>{const n=r.value.find(m=>m.val0===b);n&&(t.value.nominal=n.val1)},V=async()=>{const b={santri_id:t.value.santri_id,th_ajaran_h:t.value.th_ajaran_h,item:t.value.item,nominal:t.value.nominal,via:t.value.via,keterangan:t.value.keterangan};let n=null;const m=!t.value.id;m?n=await ua({endPoint:"iuran",data:b,loading:s}):n=await J({endPoint:`iuran/${t.value.id}`,data:b,confirm:!0,notify:!0,loading:s}),n&&(document.getElementById("btn-close-form").click(),_("successSubmit",n?.iuran),_(m?"successCreate":"successUpdate",n?.iuran))},y=async()=>{const b=t.value.id;await qa({endPoint:`iuran/${b}`,loading:s})&&(document.getElementById("btn-close-form").click(),_("successDelete",b))};return(b,n)=>{const m=T("FormHeader"),o=T("FormLoading"),k=T("FormActions");return f(),q(O,{class:"full-width",style:{"max-width":"425px"}},{default:e(()=>[a(aa,{onSubmit:E(V,["prevent"])},{default:e(()=>[a(m,{title:"Input Iuran","is-new":!t.value.id},null,8,["is-new"]),s.value?(f(),q(o,{key:0})):B("",!0),a(Q,null,{default:e(()=>[a(ra,{"active-only":!0,onEmitInput:n[0]||(n[0]=p=>Object.assign(t.value,p)),data:g.data,class:"q-my-sm"},null,8,["data"]),a(H,{modelValue:t.value.th_ajaran_h,"onUpdate:modelValue":n[1]||(n[1]=p=>t.value.th_ajaran_h=p),url:"tahun-ajaran",label:"Tahun Ajaran",sort:"desc",class:"q-my-sm",rules:[p=>!!p||"Harus diisi!"],selected:t.value.th_ajaran_h,disable:g.disableThAjaran},null,8,["modelValue","rules","selected","disable"]),a(H,{modelValue:t.value.item,"onUpdate:modelValue":[n[2]||(n[2]=p=>t.value.item=p),i],url:"iuran",label:"Nama Iuran",class:"q-my-sm"},null,8,["modelValue"]),a(ia,{dense:"",class:"q-my-sm",outlined:"",modelValue:t.value.nominal,"onUpdate:modelValue":n[3]||(n[3]=p=>t.value.nominal=p),required:"",label:"Nominal",rules:[p=>!!p||"Harus diisi!"]},null,8,["modelValue","rules"]),L(a(H,{modelValue:t.value.via,"onUpdate:modelValue":n[4]||(n[4]=p=>t.value.via=p),url:"metode-pembayaran",label:"Via",class:"q-my-sm"},null,8,["modelValue"]),[[pa,t.value.id&&t.value.lunas]]),a(N,{label:"Keterangan",modelValue:t.value.keterangan,"onUpdate:modelValue":n[5]||(n[5]=p=>t.value.keterangan=p),dense:"",outlined:"",class:"q-my-sm",autogrow:""},null,8,["modelValue"])]),_:1}),a(k,{"btn-delete":!!t.value.id,onOnDelete:y},null,8,["btn-delete"])]),_:1})]),_:1})}}},Oa={__name:"DropDownPrint",props:{data:{}},setup(S){const{loadingMain:d}=ca(Fa()),g=v(""),_=v(!1),t=S,s=v("");A(()=>{s.value=new URLSearchParams(t.data).toString()});async function w(){await Z({endPoint:`reports/iuran-card/download?${s.value}`,loading:d,fileName:"iuran-card",confirm:!0,message:"Download kartu iuran?"})}async function r(){await Z({endPoint:`reports/iuran-cover/download?${s.value}`,loading:d,fileName:"iuran-cover",confirm:!0,message:"Download cover kartu iuran?"})}async function i(){await Z({endPoint:`reports/iuran-kuitansi/download?${s.value}`,loading:d,fileName:"iuran-kuitansi",confirm:!0,message:"Download kuitansi iuran?"})}function V(){g.value=`reports/iuran-card/view?${s.value}`,_.value=!0}function y(){g.value=`reports/iuran-cover/view?${s.value}`,_.value=!0}function b(){g.value=`reports/iuran-kuitansi/view?${s.value}`,_.value=!0}return(n,m)=>(f(),$(M,null,[a(da,{color:"green-11",label:"Cetak",icon:"print","no-caps":"",class:"text-green-10 q-px-md",dense:""},{default:e(()=>[a(X,null,{default:e(()=>[L((f(),q(F,null,{default:e(()=>[a(h,null,{default:e(()=>[a(j,null,{default:e(()=>[...m[1]||(m[1]=[x("Kartu",-1)])]),_:1})]),_:1}),a(h,{avatar:""},{default:e(()=>[a(D,{icon:"download",flat:"",onClick:w})]),_:1}),a(h,{avatar:""},{default:e(()=>[a(D,{icon:"print",flat:"",onClick:V})]),_:1})]),_:1})),[[K]]),L((f(),q(F,null,{default:e(()=>[a(h,null,{default:e(()=>[a(j,null,{default:e(()=>[...m[2]||(m[2]=[x("Cover",-1)])]),_:1})]),_:1}),a(h,{avatar:""},{default:e(()=>[a(D,{icon:"download",flat:"",onClick:r})]),_:1}),a(h,{avatar:""},{default:e(()=>[a(D,{icon:"print",flat:"",onClick:y})]),_:1})]),_:1})),[[K]]),L((f(),q(F,null,{default:e(()=>[a(h,null,{default:e(()=>[a(j,null,{default:e(()=>[...m[3]||(m[3]=[x("Kuitansi",-1)])]),_:1})]),_:1}),a(h,{avatar:""},{default:e(()=>[a(D,{icon:"download",flat:"",onClick:i})]),_:1}),a(h,{avatar:""},{default:e(()=>[a(D,{icon:"print",flat:"",onClick:b})]),_:1})]),_:1})),[[K]])]),_:1})]),_:1}),a(R,{modelValue:_.value,"onUpdate:modelValue":m[0]||(m[0]=o=>_.value=o)},{default:e(()=>[a(Ua,{url:g.value},null,8,["url"])]),_:1},8,["modelValue"])],64))}},Na={__name:"IuranLunasForm",props:{data:{type:Object,required:!0}},emits:["successDelete","successSubmit","successUpdate","successCreate"],setup(S,{emit:d}){const g=S,_=d,t=v({}),s=v(!1);A(async()=>{Object.assign(t.value,g.data)});const w=async()=>{const r={via:t.value.via},i=await J({endPoint:`iuran/${t.value.id}/lunas`,data:r,message:"Iuran/tagihan lunas?",notify:!0,loading:s});i&&(document.getElementById("btn-close-form").click(),_("successSubmit",i?.iuran),_("successUpdate",i?.iuran))};return(r,i)=>{const V=T("FormHeader"),y=T("FormLoading"),b=T("FormActions");return f(),q(O,{class:"full-width",style:{"max-width":"425px"}},{default:e(()=>[a(aa,{onSubmit:E(w,["prevent"])},{default:e(()=>[a(V,{title:"Set Iuran Lunas","is-new":!1}),s.value?(f(),q(y,{key:0})):B("",!0),a(Q,null,{default:e(()=>[a(N,{disable:"",label:"Nama",modelValue:t.value.nama,"onUpdate:modelValue":i[0]||(i[0]=n=>t.value.nama=n),dense:"",outlined:"",class:"q-my-sm"},null,8,["modelValue"]),a(N,{disable:"",label:"Tahun Ajaran",modelValue:t.value.th_ajaran_h,"onUpdate:modelValue":i[1]||(i[1]=n=>t.value.th_ajaran_h=n),dense:"",outlined:"",class:"q-my-sm"},null,8,["modelValue"]),a(N,{disable:"",label:"Nama Iuran",modelValue:t.value.item,"onUpdate:modelValue":i[2]||(i[2]=n=>t.value.item=n),dense:"",outlined:"",class:"q-my-sm"},null,8,["modelValue"]),a(ia,{disable:"",dense:"",class:"q-my-sm",outlined:"",modelValue:t.value.nominal,"onUpdate:modelValue":i[3]||(i[3]=n=>t.value.nominal=n),required:"",label:"Nominal"},null,8,["modelValue"]),a(H,{modelValue:t.value.via,"onUpdate:modelValue":i[4]||(i[4]=n=>t.value.via=n),url:"metode-pembayaran",label:"Via",class:"q-my-sm",rules:[n=>!!n||"Harus diisi!"]},null,8,["modelValue","rules"])]),_:1}),a(b,{"btn-delete":!1})]),_:1})]),_:1})}}},Ha={key:0},Ka={key:1},Ea={key:0},Ra={class:"",style:{"min-width":"250px","max-width":"300px"}},Ma={class:"text-right"},za={class:"text-right"},Ja={class:"text-right text-weight-bold"},Ga={class:"flex items-center q-gutter-x-sm"},Ya={class:"q-card--bordered rounded-borders q-px-sm"},Za={class:"q-card--bordered rounded-borders q-px-sm"},Wa={class:"text-subtitle1 text-weight-bold"},Xa={class:"flex flex-center"},ae={key:1,class:"q-ma-lg"},ee={__name:"IuranSantriByTh",setup(S){const{params:d}=G(),g=v(d.thAjaranH),_=v(d.id),t=v(!1),s=v([]),w=v(!1),r=v({}),i=fa("santri"),V=v(!1);function y(p){r.value=p,r.value.nama=i.value.nama,r.value.data_akhir=i.value.data_akhir,w.value=!0}async function b(){if(g.value&&_.value){const p=await z({endPoint:`iuran/santri/${_.value}`,params:{th_ajaran_h:g.value},loading:t});p&&(s.value=k(p.iuran))}}A(async()=>await b());async function n(p,l,u,U){await J({endPoint:`iuran/${u.id}/cetak`,confirm:!1,notify:!1})||(s.value[U].cetak=p==1?0:1)}async function m(p,l,u,U){if(p)return o(u,U);const I=await J({endPoint:`iuran/${u.id}/not-lunas`,message:"Iuran/tagihan TIDAK lunas?",loading:t});I?s.value[U]=I.iuran:s.value[U].isLunas=p!=!0}async function o(p,l){r.value=p,r.value.nama=i.value.nama,r.value.data_akhir=i.value.data_akhir,V.value=!0,s.value[l].isLunas=!1}va(s,async(p,l)=>{await _a();const u=k([...p]);JSON.stringify(u)!==JSON.stringify(l)&&(s.value=u)},{deep:!0});function k(p){return p.sort((l,u)=>l.lunas===null&&u.lunas===null?0:l.lunas===null?1:u.lunas===null?-1:new Date(l.lunas)-new Date(u.lunas)).map(l=>({...l,isLunas:!!l.lunas,show:Object.prototype.hasOwnProperty.call(l,"show")?l.show:!1}))}return(p,l)=>(f(),$(M,null,[t.value?(f(),$("div",Ha,[a(oa,{color:"green-12",size:"8em",class:"flex q-ma-lg q-mx-auto"})])):(f(),$("div",Ka,[s.value.length>0?(f(),$("div",Ea,[a(X,null,{default:e(()=>[a(F,{class:"q-pa-sm bg-green-11"},{default:e(()=>[a(h,{class:"flex"},{default:e(()=>[c("table",Ra,[c("tbody",null,[c("tr",null,[l[6]||(l[6]=c("td",{class:"text-caption text-italic q-pr-md"}," Total Tagihan ",-1)),c("td",Ma,C(P(ja)(s.value).toRupiah()),1)]),c("tr",null,[l[7]||(l[7]=c("td",{class:"text-caption text-italic q-pr-md"}," Total Pembayaran ",-1)),c("td",za,C(P(Ia)(s.value).toRupiah()),1)]),c("tr",null,[l[8]||(l[8]=c("td",{class:"text-caption text-italic q-pr-md"}," Sisa Tagihan ",-1)),c("td",Ja,C(P(Ca)(s.value).toRupiah()),1)])])])]),_:1})]),_:1}),(f(!0),$(M,null,na(s.value,(u,U)=>(f(),$("div",{key:U},[a(F,{class:"q-px-sm",clickable:"",onClick:E(I=>u.show=!u.show,["stop"])},{default:e(()=>[a(h,null,{default:e(()=>[a(j,{overline:""},{default:e(()=>[x(C(u.item),1)]),_:2},1024),a(j,null,{default:e(()=>[x(C(u.nominal.toRupiah()),1)]),_:2},1024)]),_:2},1024),a(h,{side:""},{default:e(()=>[c("div",Ga,[c("div",Ya,[a(ea,{label:"Lunas",color:"green",class:"text-green-10",modelValue:u.isLunas,"onUpdate:modelValue":[I=>u.isLunas=I,(I,Y)=>m(I,Y,u,U)],"checked-icon":"check","unchecked-icon":"clear","true-value":!0,"false-value":!1},null,8,["modelValue","onUpdate:modelValue"])]),c("div",Za,[a(ea,{disable:!u.lunas,label:"Cetak",color:"green",class:"text-green-10",modelValue:u.cetak,"onUpdate:modelValue":[I=>u.cetak=I,(I,Y)=>n(I,Y,u,U)],"checked-icon":"check","unchecked-icon":"clear","true-value":1,"false-value":0},null,8,["disable","modelValue","onUpdate:modelValue"])]),a(D,{icon:"edit",glossy:"",outline:"",dense:"",round:"",color:"green-8",unelevated:"",onClick:E(I=>y(u),["stop"])},null,8,["onClick"])])]),_:2},1024)]),_:2},1032,["onClick"]),u.show?(f(),q(F,{key:0,class:"q-px-sm q-pb-sm q-pt-none"},{default:e(()=>[a(h,null,{default:e(()=>[a(j,null,{default:e(()=>[l[9]||(l[9]=c("em",null,"Lunas:",-1)),x("  "+C(u.lunas?P($a)(u.lunas,"'hari' EEEE, 'tanggal' dd MMMM yyyy, 'pukul' HH:mm"):"-"),1)]),_:2},1024),a(j,{caption:""},{default:e(()=>[l[10]||(l[10]=c("em",null,"Kasir:",-1)),l[11]||(l[11]=x(" ",-1)),c("strong",null,C(u.kasir||"-"),1),l[12]||(l[12]=x("; ",-1)),l[13]||(l[13]=c("em",null,"Via:",-1)),l[14]||(l[14]=x(" ",-1)),c("strong",null,C(u.via||"-"),1),l[15]||(l[15]=x("; ",-1)),l[16]||(l[16]=c("em",null,"Ket.:",-1)),l[17]||(l[17]=x(" ",-1)),c("strong",null,C(u.keterangan||"-"),1)]),_:2},1024)]),_:2},1024)]),_:2},1024)):B("",!0),a(ga)]))),128)),a(F,{class:"q-pa-sm bg-green-8"},{default:e(()=>[a(h,{class:"text-green-11"},{default:e(()=>[a(j,{overline:"",class:"text-green-1"},{default:e(()=>[l[18]||(l[18]=x(" TOTAL CETAK ",-1)),c("span",Wa,C(P(Pa)(s.value).toRupiah()),1)]),_:1})]),_:1}),a(h,{side:"",class:""},{default:e(()=>[c("div",Xa,[a(Oa,{data:{santri_id:_.value,th_ajaran_h:g.value}},null,8,["data"])])]),_:1})]),_:1})]),_:1})])):(f(),$("div",ae,[...l[19]||(l[19]=[c("div",{class:"text-body2 text-italic text-center"}," Tidak ada data untuk ditampilkan! ",-1),c("hr",null,null,-1),c("div",{class:"text-weight-thin text-italic text-center"}," Klik angka tahun disamping, atau tambahkan data! ",-1)])]))])),a(R,{modelValue:w.value,"onUpdate:modelValue":l[3]||(l[3]=u=>w.value=u)},{default:e(()=>[a(ma,{data:r.value,onSuccessDelete:l[0]||(l[0]=u=>P(Sa)(s.value,u)),onSuccessCreate:l[1]||(l[1]=u=>s.value.push(u)),onSuccessUpdate:l[2]||(l[2]=u=>P(la)(s.value,u.id,u)),"disable-santri-id":!0,"disable-th-ajaran":!0},null,8,["data"])]),_:1},8,["modelValue"]),a(R,{modelValue:V.value,"onUpdate:modelValue":l[5]||(l[5]=u=>V.value=u)},{default:e(()=>[a(Na,{data:r.value,onSuccessUpdate:l[4]||(l[4]=u=>P(la)(s.value,u.id,u))},null,8,["data"])]),_:1},8,["modelValue"])],64))}},te={key:0},le={key:1,class:"row"},ne={class:"col bg-green-1",style:{"max-width":"90px"}},se={class:"col"},oe={key:0,class:"q-ma-lg"},ue={key:1},ie={key:2,class:"q-ma-lg"},re={__name:"TabThAjaran",setup(S){const d=v([]),g=v(!1),{params:_}=G(),t=v([]);async function s(){const w=await z({endPoint:"iuran/santri/"+_.id,loading:g});w&&(d.value=w.iuran??[],t.value=d.value.map(r=>r.th_ajaran_h))}return A(async()=>{_.id&&await s()}),(w,r)=>g.value?(f(),$("div",te,[a(oa,{color:"green-12",size:"8em",class:"flex q-ma-lg q-mx-auto"})])):d.value?.length>0?(f(),$("div",le,[c("div",ne,[a(ha,{vertical:"",dense:"",align:"left","no-caps":"","active-bg-color":"green-11"},{default:e(()=>[(f(!0),$(M,null,na(t.value,(i,V)=>(f(),$("div",{key:V},[a(Va,{name:i,label:i,to:`/iuran/santri/${P(_).id}/${i}`},null,8,["name","label","to"])]))),128))]),_:1})]),c("div",se,[P(_).thAjaranH?(f(),$("div",ue,[a(ee)])):(f(),$("div",oe,[...r[0]||(r[0]=[c("div",{class:"text-italic text-center"}," Klik angka tahun disamping, atau tambahkan data! ",-1)])]))])])):(f(),$("div",ie,[...r[1]||(r[1]=[c("div",{class:"text-body2 text-italic text-center"}," Tidak ada data untuk ditampilkan! ",-1),c("hr",null,null,-1),c("div",{class:"text-weight-thin text-italic text-center"},[x(" Yang bersangkutan belum pernah melakuan pembayaran. "),c("br"),x(" Silakan klik tombol tambah! ")],-1)])]))}},de={};function me(S,d){return f(),q(da,{split:"",dense:"",label:"Tambah","no-caps":"",icon:"add",color:"green-10",padding:"xs sm","text-color":"green-11",onClick:d[1]||(d[1]=g=>S.$emit("onAdd"))},{default:e(()=>[a(X,null,{default:e(()=>[L((f(),q(F,{clickable:"",onClick:d[0]||(d[0]=g=>S.$emit("showPaket"))},{default:e(()=>[a(h,{avatar:""},{default:e(()=>[a(ta,{name:"local_atm",color:"green"})]),_:1}),a(h,null,{default:e(()=>[a(j,null,{default:e(()=>[...d[2]||(d[2]=[x("Paket",-1)])]),_:1}),a(j,{caption:""},{default:e(()=>[...d[3]||(d[3]=[x("Pembayaran/Tagihan",-1)])]),_:1})]),_:1})]),_:1})),[[K]]),L((f(),q(F,{clickable:"",to:"/iuran/paket"},{default:e(()=>[a(h,{avatar:""},{default:e(()=>[a(ta,{name:"settings",color:"green"})]),_:1}),a(h,null,{default:e(()=>[a(j,null,{default:e(()=>[...d[4]||(d[4]=[x("Setting",-1)])]),_:1}),a(j,{caption:""},{default:e(()=>[...d[5]||(d[5]=[x("Atur Paket",-1)])]),_:1})]),_:1})]),_:1})),[[K]])]),_:1})]),_:1})}const pe=Qa(de,[["render",me]]),ce={class:"flex content-start items-center",style:{"max-width":"1000px",width:"100%"}},fe={key:0,class:"q-pa-sm"},ve={key:1,class:"q-pa-sm text-negative"},_e={__name:"FilterSantri",props:{startUrl:String,activeOnly:{type:Boolean}},emits:["dataFilter"],setup(S,{emit:d}){const g=S,_=d,t=G(),s=sa(),w={id:t.params.id},r=v(w.id),i=v(!1),V=v([]),y=v(!1);A(async()=>{if(_("dataFilter",{display:'<div class="text-green-13 text-italic">Tentukan filter!</div>'}),r.value){const m=await z({endPoint:`santri/${r.value}`}),o={display:`
			➡️ ${r.value}
			| <strong>${m.santri.nama}</strong>
			| ${m.santri.data_akhir}
			`};_("dataFilter",o)}});function b(m){m?s.push(`${g.startUrl}/${m}`):s.push(`${g.startUrl}`)}async function n(m,o){if(!m){o(()=>{V.value=[]});return}const k=await z({endPoint:"santri/ids",loading:i,params:{active_only:!!g.activeOnly,q:m}});y.value=!k.lists.length,o(()=>V.value=k.lists,p=>{m!==""&&p.options.length&&(p.setOptionIndex(-1),p.moveOptionSelection(1,!0))})}return(m,o)=>(f(),q(O,null,{default:e(()=>[a(Q,{class:"q-px-sm q-py-sm bg-green-11"},{default:e(()=>[a(Da,{class:"no-padding",style:{"min-height":"0"}},{default:e(()=>[a(Ta,{class:"text-subtitle1"},{default:e(()=>[...o[1]||(o[1]=[c("div",{class:"text-subtitle2 text-weight-bold"}," Filter ID Santri ",-1)])]),_:1}),ba(m.$slots,"default")]),_:3})]),_:3}),a(Q,{class:"no-padding"},{default:e(()=>[c("div",ce,[a(Aa,{class:"q-pa-sm",dense:"",outlined:"",label:"ID Santri",modelValue:r.value,"onUpdate:modelValue":[o[0]||(o[0]=k=>r.value=k),b],options:V.value,"emit-value":"","map-options":"","option-value":"id","option-label":"id","error-color":"negative",loading:i.value,"use-input":"",clearable:"",onFilter:n,behavior:"menu"},{option:e(k=>[a(F,ka(ya(k.itemProps)),{default:e(()=>[a(h,null,{default:e(()=>[a(j,null,{default:e(()=>[x(C(k.opt.id)+" — "+C(k.opt.nama),1)]),_:2},1024),a(j,{caption:""},{default:e(()=>[x(C(k.opt.data_akhir),1)]),_:2},1024)]),_:2},1024)]),_:2},1040)]),_:1},8,["modelValue","options","loading"]),r.value?B("",!0):(f(),$("div",fe,"Ketikkan ID Santri")),y.value?(f(),$("div",ve," Data Tidak ditemukan ")):B("",!0)])]),_:1})]),_:3}))}},ge={__name:"IuranPaketSantriForm",props:{data:{type:Object,required:!1,default:()=>{}},title:{type:String,default:()=>"Input"}},emits:["successDelete","successSubmit","successUpdate","successCreate"],setup(S,{emit:d}){const g=S,_=d,t=v({}),s=v(!1),w=v([]),r=v([]);A(async()=>{Object.assign(t.value,g.data),w.value=W().getStateByKey("tahun-ajaran")});const i=async()=>{const V=r.value.map(n=>({item:n.item,nominal:n.nominal})),y={santri_id:t.value.santri_id,th_ajaran_h:t.value.th_ajaran_h,keterangan:t.value.keterangan||"",paket:V},b=await ua({endPoint:"iuran/paket",data:y,loading:s,message:"PERHATIAN<br/>Jika item iuran sudah terdapat dalam daftar maka akan diabaikan."});b&&(document.getElementById("btn-close-form").click(),_("successSubmit",b?.iuran),_("successCreate",b?.iuran))};return(V,y)=>{const b=T("FormHeader"),n=T("FormLoading"),m=T("FormActions");return f(),q(O,{class:"full-width",style:{"max-width":"425px"}},{default:e(()=>[a(aa,{onSubmit:E(i,["prevent"])},{default:e(()=>[a(b,{title:"Modul Paket","is-new":!0}),s.value?(f(),q(n,{key:0})):B("",!0),a(Q,null,{default:e(()=>[a(ra,{"active-only":!0,onEmitInput:y[0]||(y[0]=o=>Object.assign(t.value,o)),data:g.data,class:"q-my-sm"},null,8,["data"]),a(H,{modelValue:t.value.th_ajaran_h,"onUpdate:modelValue":y[1]||(y[1]=o=>t.value.th_ajaran_h=o),url:"tahun-ajaran",label:"Tahun Ajaran",sort:"desc",class:"q-my-sm",rules:[o=>!!o||"Harus diisi!"],selected:t.value.th_ajaran_h,disable:g.disableThAjaran},null,8,["modelValue","rules","selected","disable"]),a(Ba,{class:"q-my-sm",onOnInput:y[2]||(y[2]=o=>r.value=o)}),a(N,{label:"Keterangan",modelValue:t.value.keterangan,"onUpdate:modelValue":y[3]||(y[3]=o=>t.value.keterangan=o),dense:"",outlined:"",class:"q-my-sm"},null,8,["modelValue"])]),_:1}),a(m,{"btn-delete":!1})]),_:1})]),_:1})}}},be={class:"q-mt-sm"},_t={__name:"PageIuranSantri",setup(S){const{params:d}=G(),g=sa(),_=v({}),t=v(0),s=v({}),w=v(!1),r=v(!1),i=v({});xa("santri",i);function V(){s.value={santri_id:i.value.id,nama:i.value.nama,data_akhir:i.value.data_akhir,th_ajaran_h:d.thAjaranH||""}}function y(){V(),w.value=!0}function b(){V(),r.value=!0}const n=m=>{m.th_ajaran_h==d.thAjaranH&&t.value++,g.push(`/iuran/santri/${m.santri_id}/${m.th_ajaran_h}`)};return(m,o)=>(f(),$(M,null,[a(_e,{"start-url":"/iuran/santri",onDataFilter:o[0]||(o[0]=k=>_.value=k),"active-only":!1,bordered:"",flat:"",class:""}),c("div",be,[P(d).id?(f(),q(La,{key:0,id:P(d).id,onLoaded:o[1]||(o[1]=k=>i.value=k)},null,8,["id"])):(f(),q(O,{key:1,bordered:"",flat:""},{default:e(()=>[a(Q,{class:"q-pa-sm bg-green-11 text-subtitle2"},{default:e(()=>[...o[6]||(o[6]=[x(" No data ",-1)])]),_:1}),a(Q,{class:"q-pa-lg text-body1 text-center"},{default:e(()=>[...o[7]||(o[7]=[x(" Pilih Santri ",-1)])]),_:1})]),_:1}))]),a(O,{flat:"",bordered:"",class:"q-mt-sm"},{default:e(()=>[a(Q,{class:"q-pa-sm text-subtitle1 bg-green-6 text-green-11 flex items-center"},{default:e(()=>[o[8]||(o[8]=x(" Data Iuran ",-1)),a(wa),a(D,{icon:"sync",outline:"",dense:"",onClick:o[2]||(o[2]=k=>t.value++),class:"q-px-sm q-mr-sm"}),a(pe,{onOnAdd:y,onShowPaket:b})]),_:1}),a(Q,{class:"no-padding"},{default:e(()=>[(f(),q(re,{key:t.value}))]),_:1})]),_:1}),a(R,{modelValue:w.value,"onUpdate:modelValue":o[3]||(o[3]=k=>w.value=k)},{default:e(()=>[a(ma,{data:s.value,onSuccessCreate:n,"disable-santri-id":!0},null,8,["data"])]),_:1},8,["modelValue"]),a(R,{modelValue:r.value,"onUpdate:modelValue":o[5]||(o[5]=k=>r.value=k)},{default:e(()=>[a(ge,{data:s.value,onSuccessSubmit:o[4]||(o[4]=k=>t.value++)},null,8,["data"])]),_:1},8,["modelValue"])],64))}};export{_t as default};
