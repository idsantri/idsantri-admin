import{A as u,B as y,c as w,o as g,w as m,b as o,ad as M,e as Q,C as S,Q as x,a7 as V,y as A,ab as U,q,W as I,f as N,G as O}from"./index-Bjf6jOrL.js";import{_ as h}from"./TemplateArray-NzDrgwGn.js";import{c as C}from"./format-date-DlwYCgkJ.js";import{a as j}from"./hijri--5qD4USW.js";import{r as E,d as H,g as K}from"./array-object-BytDdNh7.js";import{Q as $}from"./QForm-CQ61mLzh.js";import{_ as L}from"./InputSelectArray-DTVIQacW.js";import{S as F}from"./Status-KwGOxe2X.js";import{u as G}from"./useCrudForm-D9Qtfi7L.js";import"./QItemSection-D4HO8eJd.js";import"./QItemLabel-Clz1Xits.js";import"./QList-DrJ2aexG.js";import"./id-BuNGTsqN.js";import"./format-number-B34ySHL_.js";import"./QSelect-BCDk0qVl.js";import"./QChip-CKBUwVMq.js";import"./QMenu-DO2tkYnP.js";import"./selection-C-yT_gHt.js";import"./rtl-DFPa-2ov.js";import"./format-CJebrXOQ.js";import"./lists-store-Ddm_j1AX.js";import"./DropDownAfter-BWotgQpI.js";import"./QBtnDropdown-CATaFFO-.js";import"./QBtnGroup-BZf-O_co.js";import"./ClosePopup-Ced6Y-Os.js";import"./Lists-DcfSSLIw.js";import"./ApiCrud-Cz799mD5.js";import"./Api-v4AqqFFf.js";import"./index-BRCx2Z00.js";import"./index-DV84x6RN.js";import"./api-error-C_UMNjEa.js";const R={__name:"StatusForm",props:{data:{type:Object,required:!0}},emits:["successDelete","successSubmit","successUpdate","successCreate"],setup(b,{emit:i}){const n=b,l=i,a=u({...n.data}),r=!n.data?.id,{handleDelete:p,handleCreate:c,handleUpdate:v,loading:f}=G(F,{emit:l,responseKey:"status"}),_=async()=>{const s={santri_id:a.value.santri_id,status:a.value.status,keterangan:a.value.keterangan};return r?await c(s,!0):await v(n.data.id,s,!0)},e=async()=>await p(n.data.id);return(s,t)=>{const k=y("FormHeader"),D=y("FormLoading"),B=y("FormActions");return g(),w(A,{class:"full-width",style:{"max-width":"425px"}},{default:m(()=>[o($,{onSubmit:M(_,["prevent"])},{default:m(()=>[o(k,{title:"Input Status","is-new":r}),S(f)?(g(),w(D,{key:0})):Q("",!0),o(x,null,{default:m(()=>[o(V,{dense:"",outlined:"",label:"Nama","model-value":a.value?.nama+" ("+a.value?.santri_id+")",disable:"",filled:"",class:"q-my-sm"},null,8,["model-value"]),o(L,{modelValue:a.value.status,"onUpdate:modelValue":t[0]||(t[0]=d=>a.value.status=d),url:"status",label:"Status *",class:"q-my-sm",rules:[d=>!!d||"Harus diisi!"]},null,8,["modelValue","rules"]),o(V,{dense:"",class:"q-my-sm",outlined:"",label:"Keterangan",modelValue:a.value.keterangan,"onUpdate:modelValue":t[1]||(t[1]=d=>a.value.keterangan=d),autogrow:""},null,8,["modelValue"])]),_:1}),o(B,{"btn-delete":!r,onOnDelete:e},null,8,["btn-delete"])]),_:1})]),_:1})}}},Ca={__name:"SantriStatus",setup(b){const i=u(!1),n=u(!1),l=u({}),a=u([]),r=u({}),{params:p}=U();async function c(){try{i.value=!0;const e=await F.santri(p.id);a.value=e.status,r.value=e.santri}catch{console.log("error get status")}finally{i.value=!1}}const v=q(()=>a.value.map(e=>({Tanggal:C(e.created_at,"dd-MM-yyyy")+" | "+j(C(e.created_at,"yyyy-MM-dd")),Status:e.status,Keterangan:e.keterangan||"-",id:e.id})));I(async()=>{await c()});const f=()=>{l.value={santri_id:r.value.id,nama:r.value.nama},n.value=!0},_=({id:e})=>{l.value=K(a,e),l.value.santri_id=r.value.id,l.value.nama=r.value.nama,n.value=!0};return(e,s)=>(g(),N("div",null,[o(h,{data:v.value,spinner:i.value,onAdd:f,onEdit:_},null,8,["data","spinner"]),o(O,{modelValue:n.value,"onUpdate:modelValue":s[3]||(s[3]=t=>n.value=t)},{default:m(()=>[o(R,{data:l.value,onSuccessDelete:s[0]||(s[0]=t=>S(H)(a.value,t)),onSuccessCreate:s[1]||(s[1]=t=>a.value.push(t)),onSuccessUpdate:s[2]||(s[2]=t=>S(E)(a.value,t.id,t))},null,8,["data"])]),_:1},8,["modelValue"])]))}};export{Ca as default};
