import{q as g,E as D,c as $,o as f,w as e,g as a,ae as E,f as N,G as F,Q as L,n as Q,a4 as ma,a8 as O,l as H,a9 as pa,s as J,b as q,v as w,e as A,J as R,F as W,ac as G,K as ca,N as fa,Y as va,a as m,t as U,D as sa,ag as ea,C as _a,p as ta,ab as oa,r as ga,bI as ka,bJ as ba,ak as ya}from"./index-BD0rPuwI.js";import{Q as wa}from"./QSpace-5xN-RTD3.js";import{Q as xa}from"./QRouteTab-1ww9ytiz.js";import{Q as ha}from"./QTabs-EUIxuNg1.js";import{a as M}from"./api-get-BCXhCHlZ.js";import{Q as P,a as V}from"./QItemSection-IwpTB_GG.js";import{Q as I}from"./QItemLabel-D6C2_kLw.js";import{Q as X}from"./QList-BEPgv0aR.js";import{a as na}from"./api-update-DJyiURe1.js";import{c as Va}from"./format-date-DlwYCgkJ.js";import{Q as Z}from"./QForm-Bxs8j-wD.js";import{_ as ua}from"./InputCurrency-D6luOTBk.js";import{_ as ia}from"./InputSelectSantriId-DbY6aM65.js";import{_ as K}from"./InputSelectArray-C3_iyAte.js";import{u as $a}from"./useCrudForm-DmdwiqlE.js";import{A as Sa}from"./ApiCrud-C6ys5aHm.js";import{l as qa}from"./lists-store-h_cLlXO2.js";import{r as la,d as Ca}from"./array-object-BytDdNh7.js";import{s as Ia,a as ja,b as Ua,c as Fa}from"./utils-CiaEZYac.js";import{Q as ra}from"./QBtnDropdown-C1QKmXiE.js";import{C as B}from"./ClosePopup-CCVUmZVV.js";import{a as z}from"./api-download-BzRNYGXe.js";import{l as Da}from"./loading-store-BS9X0Auv.js";import{_ as Pa}from"./ReportViewer-DSS0eYFs.js";import{_ as Ta}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{Q as La,a as Aa}from"./QToolbar-DtZkS60q.js";import{Q as Qa}from"./QSelect-CYTXzFFA.js";import{_ as Na}from"./CardSantriSimple-Bk2bXcn2.js";import{_ as Ha}from"./InputSelectIuranPaket-BPwLVqqU.js";import"./QResizeObserver-DxSbAeTr.js";import"./rtl-DFPa-2ov.js";import"./index-n6Dqaau9.js";import"./index-Bt3cYzg4.js";import"./api-error-DI2-xNds.js";import"./id-BuNGTsqN.js";import"./Santri-D4LM7LTo.js";import"./DropDownAfter-DARN8D_I.js";import"./Lists-Brk1_KEv.js";import"./Api-CkWZCpKy.js";import"./ArrayCrud-CkcA-ixF.js";import"./QBtnGroup-PW693_0R.js";import"./QMenu-Bb-0PlhQ.js";import"./selection-D1mjVW1G.js";import"./QChip-CZ2DfYuE.js";import"./format-CJebrXOQ.js";import"./QSkeleton-XNUgrYtX.js";import"./QImg-Bw4PCoSV.js";import"./santri-store-BNSQ2yZ2.js";import"./QSlideTransition-zzbd9oUc.js";class Oa extends Sa{constructor(){super("iuran")}async setLunas({id:o,data:r,message:_}){if(!await this._notifyConfirm(_||"Update data ini?"))return!1;const t=await this._apiUpdate({endPoint:`${this._path}/${o}/lunas`,data:r});return this._showSuccess(t.message),t.data||!0}async storePaketSantri({data:o,message:r}){if(!await this._notifyConfirm(r||"Simpan data ini?"))return!1;const l=await this._apiPost({endPoint:`${this._path}/paket`,data:o});return this._showSuccess(l.message),l.data||!0}}const aa=new Oa,da={__name:"IuranForm",props:{data:{type:Object,required:!1,default:()=>{}},disableSantriId:{type:Boolean,default:!1},disableThAjaran:{type:Boolean,default:!1}},emits:["successDelete","successSubmit","successUpdate","successCreate"],setup(S,{emit:o}){const r=S,_=o,l=qa().getStateByKey("iuran"),t=g({...r.data}),x=g([...l]),s=!r.data?.id,{handleDelete:c,handleCreate:v,handleUpdate:b,loading:j}=$a(aa,{emit:_,responseKey:"iuran"}),h=k=>{const d=x.value.find(n=>n.val0===k);d&&(t.value.nominal=d.val1)},i=async()=>{const k={santri_id:t.value.santri_id,th_ajaran_h:t.value.th_ajaran_h,item:t.value.item,nominal:t.value.nominal,via:t.value.via,keterangan:t.value.keterangan};return s?await v(k,!0):await b(r.data.id,k,!0)},p=async()=>await c(r.data.id);return(k,d)=>{const n=D("FormHeader"),C=D("FormLoading"),u=D("FormActions");return f(),$(H,{class:"full-width",style:{"max-width":"425px"}},{default:e(()=>[a(Z,{onSubmit:E(i,["prevent"])},{default:e(()=>[a(n,{title:"Input Iuran","is-new":s}),F(j)?(f(),$(C,{key:0})):N("",!0),a(L,null,{default:e(()=>[a(ia,{"active-only":!0,onEmitInput:d[0]||(d[0]=y=>Object.assign(t.value,y)),data:r.data,class:"q-my-sm"},null,8,["data"]),a(K,{modelValue:t.value.th_ajaran_h,"onUpdate:modelValue":d[1]||(d[1]=y=>t.value.th_ajaran_h=y),url:"tahun-ajaran",label:"Tahun Ajaran",sort:"desc",class:"q-my-sm",rules:[y=>!!y||"Harus diisi!"],selected:t.value.th_ajaran_h,disable:r.disableThAjaran},null,8,["modelValue","rules","selected","disable"]),a(K,{modelValue:t.value.item,"onUpdate:modelValue":[d[2]||(d[2]=y=>t.value.item=y),h],url:"iuran",label:"Nama Iuran",class:"q-my-sm"},null,8,["modelValue"]),a(ua,{dense:"",class:"q-my-sm",outlined:"",modelValue:t.value.nominal,"onUpdate:modelValue":d[3]||(d[3]=y=>t.value.nominal=y),required:"",label:"Nominal",rules:[y=>!!y||"Harus diisi!"]},null,8,["modelValue","rules"]),Q(a(K,{modelValue:t.value.via,"onUpdate:modelValue":d[4]||(d[4]=y=>t.value.via=y),url:"metode-pembayaran",label:"Via",class:"q-my-sm"},null,8,["modelValue"]),[[ma,t.value.id&&t.value.lunas]]),a(O,{label:"Keterangan",modelValue:t.value.keterangan,"onUpdate:modelValue":d[5]||(d[5]=y=>t.value.keterangan=y),dense:"",outlined:"",class:"q-my-sm",autogrow:""},null,8,["modelValue"])]),_:1}),a(u,{"btn-delete":!s,onOnDelete:p},null,8,["btn-delete"])]),_:1})]),_:1})}}},Ka={__name:"DropDownPrint",props:{data:{}},setup(S){const{loadingMain:o}=pa(Da()),r=g(""),_=g(!1),l=S,t=g("");J(()=>{t.value=new URLSearchParams(l.data).toString()});async function x(){await z({endPoint:`reports/iuran-card/download?${t.value}`,loading:o,fileName:"iuran-card",confirm:!0,message:"Download kartu iuran?"})}async function s(){await z({endPoint:`reports/iuran-cover/download?${t.value}`,loading:o,fileName:"iuran-cover",confirm:!0,message:"Download cover kartu iuran?"})}async function c(){await z({endPoint:`reports/iuran-kuitansi/download?${t.value}`,loading:o,fileName:"iuran-kuitansi",confirm:!0,message:"Download kuitansi iuran?"})}function v(){r.value=`reports/iuran-card/view?${t.value}`,_.value=!0}function b(){r.value=`reports/iuran-cover/view?${t.value}`,_.value=!0}function j(){r.value=`reports/iuran-kuitansi/view?${t.value}`,_.value=!0}return(h,i)=>(f(),q(W,null,[a(ra,{color:"green-11",label:"Cetak",icon:"print","no-caps":"",class:"text-green-10 q-px-md",dense:""},{default:e(()=>[a(X,null,{default:e(()=>[Q((f(),$(P,null,{default:e(()=>[a(V,null,{default:e(()=>[a(I,null,{default:e(()=>[...i[1]||(i[1]=[w("Kartu",-1)])]),_:1})]),_:1}),a(V,{avatar:""},{default:e(()=>[a(A,{icon:"download",flat:"",onClick:x})]),_:1}),a(V,{avatar:""},{default:e(()=>[a(A,{icon:"print",flat:"",onClick:v})]),_:1})]),_:1})),[[B]]),Q((f(),$(P,null,{default:e(()=>[a(V,null,{default:e(()=>[a(I,null,{default:e(()=>[...i[2]||(i[2]=[w("Cover",-1)])]),_:1})]),_:1}),a(V,{avatar:""},{default:e(()=>[a(A,{icon:"download",flat:"",onClick:s})]),_:1}),a(V,{avatar:""},{default:e(()=>[a(A,{icon:"print",flat:"",onClick:b})]),_:1})]),_:1})),[[B]]),Q((f(),$(P,null,{default:e(()=>[a(V,null,{default:e(()=>[a(I,null,{default:e(()=>[...i[3]||(i[3]=[w("Kuitansi",-1)])]),_:1})]),_:1}),a(V,{avatar:""},{default:e(()=>[a(A,{icon:"download",flat:"",onClick:c})]),_:1}),a(V,{avatar:""},{default:e(()=>[a(A,{icon:"print",flat:"",onClick:j})]),_:1})]),_:1})),[[B]])]),_:1})]),_:1}),a(R,{modelValue:_.value,"onUpdate:modelValue":i[0]||(i[0]=p=>_.value=p)},{default:e(()=>[a(Pa,{url:r.value},null,8,["url"])]),_:1},8,["modelValue"])],64))}},Ba={__name:"IuranLunasForm",props:{data:{type:Object,required:!0}},emits:["successDelete","successSubmit","successUpdate","successCreate"],setup(S,{emit:o}){const r=S,_=o,l=g({...r.data}),t=g(!1),x=async()=>{try{t.value=!0;const s=await aa.setLunas({id:r.data.id,data:{via:l.value.via},message:"Iuran/tagihan lunas?"});s&&(document.getElementById("btn-close-form").click(),_("successSubmit",s?.iuran),_("successUpdate",s?.iuran))}catch(s){console.error("err set lunas ",s)}finally{t.value=!1}};return(s,c)=>{const v=D("FormHeader"),b=D("FormLoading"),j=D("FormActions");return f(),$(H,{class:"full-width",style:{"max-width":"425px"}},{default:e(()=>[a(Z,{onSubmit:E(x,["prevent"])},{default:e(()=>[a(v,{title:"Set Iuran Lunas","is-new":!1}),t.value?(f(),$(b,{key:0})):N("",!0),a(L,null,{default:e(()=>[a(O,{disable:"",label:"Nama",modelValue:l.value.nama,"onUpdate:modelValue":c[0]||(c[0]=h=>l.value.nama=h),dense:"",outlined:"",class:"q-my-sm"},null,8,["modelValue"]),a(O,{disable:"",label:"Tahun Ajaran",modelValue:l.value.th_ajaran_h,"onUpdate:modelValue":c[1]||(c[1]=h=>l.value.th_ajaran_h=h),dense:"",outlined:"",class:"q-my-sm"},null,8,["modelValue"]),a(O,{disable:"",label:"Nama Iuran",modelValue:l.value.item,"onUpdate:modelValue":c[2]||(c[2]=h=>l.value.item=h),dense:"",outlined:"",class:"q-my-sm"},null,8,["modelValue"]),a(ua,{disable:"",dense:"",class:"q-my-sm",outlined:"",modelValue:l.value.nominal,"onUpdate:modelValue":c[3]||(c[3]=h=>l.value.nominal=h),required:"",label:"Nominal"},null,8,["modelValue"]),a(K,{modelValue:l.value.via,"onUpdate:modelValue":c[4]||(c[4]=h=>l.value.via=h),url:"metode-pembayaran",label:"Via",class:"q-my-sm",rules:[h=>!!h||"Harus diisi!"]},null,8,["modelValue","rules"])]),_:1}),a(j,{"btn-delete":!1})]),_:1})]),_:1})}}},Ea={class:"relative-position"},Ra={key:0},Ma={class:"",style:{"min-width":"250px","max-width":"300px"}},Ja={class:"text-right"},Ga={class:"text-right"},Ya={class:"text-right text-weight-bold"},za={class:"flex items-center q-gutter-x-sm"},Wa={class:"q-card--bordered rounded-borders q-px-sm"},Xa={class:"q-card--bordered rounded-borders q-px-sm"},Za={class:"text-subtitle1 text-weight-bold"},ae={class:"flex flex-center"},ee={key:1,class:"q-ma-lg"},te={__name:"IuranSantriByTh",setup(S){const{params:o}=G(),r=g(o.thAjaranH),_=g(o.id),l=g(!1),t=g([]),x=g(!1),s=g({}),c=ca("santri"),v=g(!1);function b(d){s.value=d,s.value.nama=c.value.nama,s.value.data_akhir=c.value.data_akhir,x.value=!0}async function j(){if(r.value&&_.value){const d=await M({endPoint:`iuran/santri/${_.value}`,params:{th_ajaran_h:r.value},loading:l});d&&(t.value=k(d.iuran))}}J(async()=>await j());async function h(d,n,C,u){await na({endPoint:`iuran/${C.id}/cetak`,confirm:!1,notify:!1})||(t.value[u].cetak=d==1?0:1)}async function i(d,n,C,u){if(d)return p(C,u);const y=await na({endPoint:`iuran/${C.id}/not-lunas`,message:"Iuran/tagihan TIDAK lunas?",loading:l});y?t.value[u]=y.iuran:t.value[u].isLunas=d!=!0}async function p(d,n){s.value=d,s.value.nama=c.value.nama,s.value.data_akhir=c.value.data_akhir,v.value=!0,t.value[n].isLunas=!1}fa(t,async(d,n)=>{await va();const C=k([...d]);JSON.stringify(C)!==JSON.stringify(n)&&(t.value=C)},{deep:!0});function k(d){return d.sort((n,C)=>n.lunas===null&&C.lunas===null?0:n.lunas===null?1:C.lunas===null?-1:new Date(n.lunas)-new Date(C.lunas)).map(n=>({...n,isLunas:!!n.lunas,show:Object.prototype.hasOwnProperty.call(n,"show")?n.show:!1}))}return(d,n)=>{const C=D("CardLoading");return f(),q("div",Ea,[t.value.length>0?(f(),q("div",Ra,[a(X,null,{default:e(()=>[a(P,{class:"q-pa-sm bg-green-11"},{default:e(()=>[a(V,{class:"flex"},{default:e(()=>[m("table",Ma,[m("tbody",null,[m("tr",null,[n[6]||(n[6]=m("td",{class:"text-caption text-italic q-pr-md"},"Total Tagihan",-1)),m("td",Ja,U(F(Ia)(t.value).toRupiah()),1)]),m("tr",null,[n[7]||(n[7]=m("td",{class:"text-caption text-italic q-pr-md"},"Total Pembayaran",-1)),m("td",Ga,U(F(ja)(t.value).toRupiah()),1)]),m("tr",null,[n[8]||(n[8]=m("td",{class:"text-caption text-italic q-pr-md"},"Sisa Tagihan",-1)),m("td",Ya,U(F(Ua)(t.value).toRupiah()),1)])])])]),_:1})]),_:1}),(f(!0),q(W,null,sa(t.value,(u,y)=>(f(),q("div",{key:y},[a(P,{class:"q-px-sm",clickable:"",onClick:E(T=>u.show=!u.show,["stop"])},{default:e(()=>[a(V,null,{default:e(()=>[a(I,{overline:""},{default:e(()=>[w(U(u.item),1)]),_:2},1024),a(I,null,{default:e(()=>[w(U(u.nominal.toRupiah()),1)]),_:2},1024)]),_:2},1024),a(V,{side:""},{default:e(()=>[m("div",za,[m("div",Wa,[a(ea,{label:"Lunas",color:"green",class:"text-green-10",modelValue:u.isLunas,"onUpdate:modelValue":[T=>u.isLunas=T,(T,Y)=>i(T,Y,u,y)],"checked-icon":"check","unchecked-icon":"clear","true-value":!0,"false-value":!1},null,8,["modelValue","onUpdate:modelValue"])]),m("div",Xa,[a(ea,{disable:!u.lunas,label:"Cetak",color:"green",class:"text-green-10",modelValue:u.cetak,"onUpdate:modelValue":[T=>u.cetak=T,(T,Y)=>h(T,Y,u,y)],"checked-icon":"check","unchecked-icon":"clear","true-value":1,"false-value":0},null,8,["disable","modelValue","onUpdate:modelValue"])]),a(A,{icon:"edit",glossy:"",outline:"",dense:"",round:"",color:"green-8",unelevated:"",onClick:E(T=>b(u),["stop"])},null,8,["onClick"])])]),_:2},1024)]),_:2},1032,["onClick"]),u.show?(f(),$(P,{key:0,class:"q-px-sm q-pb-sm q-pt-none"},{default:e(()=>[a(V,null,{default:e(()=>[a(I,null,{default:e(()=>[n[9]||(n[9]=m("em",null,"Lunas:",-1)),w("  "+U(u.lunas?F(Va)(u.lunas,"'hari' EEEE, 'tanggal' dd MMMM yyyy, 'pukul' HH:mm"):"-"),1)]),_:2},1024),a(I,{caption:""},{default:e(()=>[n[10]||(n[10]=m("em",null,"Kasir:",-1)),n[11]||(n[11]=w(" ",-1)),m("strong",null,U(u.kasir||"-"),1),n[12]||(n[12]=w("; ",-1)),n[13]||(n[13]=m("em",null,"Via:",-1)),n[14]||(n[14]=w(" ",-1)),m("strong",null,U(u.via||"-"),1),n[15]||(n[15]=w("; ",-1)),n[16]||(n[16]=m("em",null,"Ket.:",-1)),n[17]||(n[17]=w(" ",-1)),m("strong",null,U(u.keterangan||"-"),1)]),_:2},1024)]),_:2},1024)]),_:2},1024)):N("",!0),a(_a)]))),128)),a(P,{class:"q-pa-sm bg-green-8"},{default:e(()=>[a(V,{class:"text-green-11"},{default:e(()=>[a(I,{overline:"",class:"text-green-1"},{default:e(()=>[n[18]||(n[18]=w(" TOTAL CETAK ",-1)),m("span",Za,U(F(Fa)(t.value).toRupiah()),1)]),_:1})]),_:1}),a(V,{side:"",class:""},{default:e(()=>[m("div",ae,[a(Ka,{data:{santri_id:_.value,th_ajaran_h:r.value}},null,8,["data"])])]),_:1})]),_:1})]),_:1})])):(f(),q("div",ee,[...n[19]||(n[19]=[m("div",{class:"text-body2 text-italic text-center"},"Tidak ada data untuk ditampilkan!",-1),m("hr",null,null,-1),m("div",{class:"text-weight-thin text-italic text-center"},"Klik angka tahun disamping, atau tambahkan data!",-1)])])),a(C,{showing:l.value},null,8,["showing"]),a(R,{modelValue:x.value,"onUpdate:modelValue":n[3]||(n[3]=u=>x.value=u)},{default:e(()=>[a(da,{data:s.value,onSuccessDelete:n[0]||(n[0]=u=>F(Ca)(t.value,u)),onSuccessCreate:n[1]||(n[1]=u=>t.value.push(u)),onSuccessUpdate:n[2]||(n[2]=u=>F(la)(t.value,u.id,u)),"disable-santri-id":!0,"disable-th-ajaran":!0},null,8,["data"])]),_:1},8,["modelValue"]),a(R,{modelValue:v.value,"onUpdate:modelValue":n[5]||(n[5]=u=>v.value=u)},{default:e(()=>[a(Ba,{data:s.value,onSuccessUpdate:n[4]||(n[4]=u=>F(la)(t.value,u.id,u))},null,8,["data"])]),_:1},8,["modelValue"])])}}},ne={class:"relative-position"},le={key:0,class:"row"},se={class:"col bg-green-1",style:{"max-width":"90px"}},oe={class:"col"},ue={key:0,class:"q-ma-lg"},ie={key:1},re={key:1,class:"q-ma-lg"},de={__name:"TabThAjaran",setup(S){const o=g([]),r=g(!1),{params:_}=G(),l=g([]);async function t(){const x=await M({endPoint:"iuran/santri/"+_.id,loading:r});x&&(o.value=x.iuran??[],l.value=o.value.map(s=>s.th_ajaran_h))}return J(async()=>{_.id&&await t()}),(x,s)=>{const c=D("CardLoading");return f(),q("div",ne,[o.value?.length>0?(f(),q("div",le,[m("div",se,[a(ha,{vertical:"",dense:"",align:"left","no-caps":"","active-bg-color":"green-11"},{default:e(()=>[(f(!0),q(W,null,sa(l.value,(v,b)=>(f(),q("div",{key:b},[a(xa,{name:v,label:v,to:`/iuran/santri/${F(_).id}/${v}`},null,8,["name","label","to"])]))),128))]),_:1})]),m("div",oe,[F(_).thAjaranH?(f(),q("div",ie,[a(te)])):(f(),q("div",ue,[...s[0]||(s[0]=[m("div",{class:"text-italic text-center"},"Klik angka tahun disamping, atau tambahkan data!",-1)])]))])])):(f(),q("div",re,[...s[1]||(s[1]=[m("div",{class:"text-body2 text-italic text-center"},"Tidak ada data untuk ditampilkan!",-1),m("hr",null,null,-1),m("div",{class:"text-weight-thin text-italic text-center"},[w(" Yang bersangkutan belum pernah melakuan pembayaran. "),m("br"),w(" Silakan klik tombol tambah! ")],-1)])])),a(c,{showing:r.value},null,8,["showing"])])}}},me={};function pe(S,o){return f(),$(ra,{split:"",dense:"",label:"Tambah","no-caps":"",icon:"add",color:"green-10",padding:"xs sm","text-color":"green-11",onClick:o[1]||(o[1]=r=>S.$emit("onAdd"))},{default:e(()=>[a(X,null,{default:e(()=>[Q((f(),$(P,{clickable:"",onClick:o[0]||(o[0]=r=>S.$emit("showPaket"))},{default:e(()=>[a(V,{avatar:""},{default:e(()=>[a(ta,{name:"local_atm",color:"green"})]),_:1}),a(V,null,{default:e(()=>[a(I,null,{default:e(()=>[...o[2]||(o[2]=[w("Paket",-1)])]),_:1}),a(I,{caption:""},{default:e(()=>[...o[3]||(o[3]=[w("Pembayaran/Tagihan",-1)])]),_:1})]),_:1})]),_:1})),[[B]]),Q((f(),$(P,{clickable:"",to:"/iuran/paket"},{default:e(()=>[a(V,{avatar:""},{default:e(()=>[a(ta,{name:"settings",color:"green"})]),_:1}),a(V,null,{default:e(()=>[a(I,null,{default:e(()=>[...o[4]||(o[4]=[w("Setting",-1)])]),_:1}),a(I,{caption:""},{default:e(()=>[...o[5]||(o[5]=[w("Atur Paket",-1)])]),_:1})]),_:1})]),_:1})),[[B]])]),_:1})]),_:1})}const ce=Ta(me,[["render",pe]]),fe={class:"flex content-start items-center",style:{"max-width":"1000px",width:"100%"}},ve={key:0,class:"q-pa-sm"},_e={key:1,class:"q-pa-sm text-negative"},ge={__name:"FilterSantri",props:{startUrl:String,activeOnly:{type:Boolean}},emits:["dataFilter"],setup(S,{emit:o}){const r=S,_=o,l=G(),t=oa(),x={id:l.params.id},s=g(x.id),c=g(!1),v=g([]),b=g(!1);J(async()=>{if(_("dataFilter",{display:'<div class="text-green-13 text-italic">Tentukan filter!</div>'}),s.value){const i=await M({endPoint:`santri/${s.value}`}),p={display:`
			➡️ ${s.value}
			| <strong>${i.santri.nama}</strong>
			| ${i.santri.data_akhir}
			`};_("dataFilter",p)}});function j(i){i?t.push(`${r.startUrl}/${i}`):t.push(`${r.startUrl}`)}async function h(i,p){if(!i){p(()=>{v.value=[]});return}const k=await M({endPoint:"santri/ids",loading:c,params:{active_only:!!r.activeOnly,q:i}});b.value=!k.lists.length,p(()=>v.value=k.lists,d=>{i!==""&&d.options.length&&(d.setOptionIndex(-1),d.moveOptionSelection(1,!0))})}return(i,p)=>(f(),$(H,null,{default:e(()=>[a(L,{class:"q-px-sm q-py-sm bg-green-11"},{default:e(()=>[a(La,{class:"no-padding",style:{"min-height":"0"}},{default:e(()=>[a(Aa,{class:"text-subtitle1"},{default:e(()=>[...p[1]||(p[1]=[m("div",{class:"text-subtitle2 text-weight-bold"}," Filter ID Santri ",-1)])]),_:1}),ga(i.$slots,"default")]),_:3})]),_:3}),a(L,{class:"no-padding"},{default:e(()=>[m("div",fe,[a(Qa,{class:"q-pa-sm",dense:"",outlined:"",label:"ID Santri",modelValue:s.value,"onUpdate:modelValue":[p[0]||(p[0]=k=>s.value=k),j],options:v.value,"emit-value":"","map-options":"","option-value":"id","option-label":"id","error-color":"negative",loading:c.value,"use-input":"",clearable:"",onFilter:h,behavior:"menu"},{option:e(k=>[a(P,ka(ba(k.itemProps)),{default:e(()=>[a(V,null,{default:e(()=>[a(I,null,{default:e(()=>[w(U(k.opt.id)+" — "+U(k.opt.nama),1)]),_:2},1024),a(I,{caption:""},{default:e(()=>[w(U(k.opt.data_akhir),1)]),_:2},1024)]),_:2},1024)]),_:2},1040)]),_:1},8,["modelValue","options","loading"]),s.value?N("",!0):(f(),q("div",ve,"Ketikkan ID Santri")),b.value?(f(),q("div",_e," Data Tidak ditemukan ")):N("",!0)])]),_:1})]),_:3}))}},ke={__name:"IuranPaketSantriForm",props:{data:{type:Object,required:!1,default:()=>{}},title:{type:String,default:()=>"Input"}},emits:["successDelete","successSubmit","successUpdate","successCreate"],setup(S,{emit:o}){const r=S,_=o,l=g({...r.data}),t=g(!1),x=g([]),s=async()=>{const c=x.value.map(b=>({item:b.item,nominal:b.nominal})),v={santri_id:l.value.santri_id,th_ajaran_h:l.value.th_ajaran_h,keterangan:l.value.keterangan||"",paket:c};try{t.value=!0;const b=await aa.storePaketSantri({data:v,message:"PERHATIAN<br/>Jika item iuran sudah terdapat dalam daftar maka akan diabaikan."});b&&(document.getElementById("btn-close-form").click(),_("successSubmit",b?.iuran),_("successCreate",b?.iuran))}catch(b){console.error("err set paket iuran",b)}finally{t.value=!1}};return(c,v)=>{const b=D("FormHeader"),j=D("FormLoading"),h=D("FormActions");return f(),$(H,{class:"full-width",style:{"max-width":"425px"}},{default:e(()=>[a(Z,{onSubmit:E(s,["prevent"])},{default:e(()=>[a(b,{title:"Modul Paket","is-new":!0}),t.value?(f(),$(j,{key:0})):N("",!0),a(L,null,{default:e(()=>[a(ia,{"active-only":!0,onEmitInput:v[0]||(v[0]=i=>Object.assign(l.value,i)),data:r.data,class:"q-my-sm"},null,8,["data"]),a(K,{modelValue:l.value.th_ajaran_h,"onUpdate:modelValue":v[1]||(v[1]=i=>l.value.th_ajaran_h=i),url:"tahun-ajaran",label:"Tahun Ajaran",sort:"desc",class:"q-my-sm",rules:[i=>!!i||"Harus diisi!"],selected:l.value.th_ajaran_h,disable:r.disableThAjaran},null,8,["modelValue","rules","selected","disable"]),a(Ha,{class:"q-my-sm",onOnInput:v[2]||(v[2]=i=>x.value=i)}),a(O,{label:"Keterangan",modelValue:l.value.keterangan,"onUpdate:modelValue":v[3]||(v[3]=i=>l.value.keterangan=i),dense:"",outlined:"",class:"q-my-sm"},null,8,["modelValue"])]),_:1}),a(h,{"btn-delete":!1})]),_:1})]),_:1})}}},be={class:"q-mt-sm"},vt={__name:"PageIuranSantri",setup(S){const{params:o}=G(),r=oa(),_=g({}),l=g(0),t=g({}),x=g(!1),s=g(!1),c=g({});ya("santri",c);function v(){t.value={santri_id:c.value.id,nama:c.value.nama,data_akhir:c.value.data_akhir,th_ajaran_h:o.thAjaranH||""}}function b(){v(),x.value=!0}function j(){v(),s.value=!0}const h=i=>{i.th_ajaran_h==o.thAjaranH&&l.value++,r.push(`/iuran/santri/${i.santri_id}/${i.th_ajaran_h}`)};return(i,p)=>(f(),q("div",null,[a(ge,{"start-url":"/iuran/santri",onDataFilter:p[0]||(p[0]=k=>_.value=k),"active-only":!1,bordered:"",flat:"",class:""}),m("div",be,[F(o).id?(f(),$(Na,{key:0,id:F(o).id,onLoaded:p[1]||(p[1]=k=>c.value=k)},null,8,["id"])):(f(),$(H,{key:1,bordered:"",flat:""},{default:e(()=>[a(L,{class:"q-pa-sm bg-green-11 text-subtitle2"},{default:e(()=>[...p[6]||(p[6]=[w(" No data ",-1)])]),_:1}),a(L,{class:"q-pa-lg text-body1 text-center"},{default:e(()=>[...p[7]||(p[7]=[w(" Pilih Santri ",-1)])]),_:1})]),_:1}))]),a(H,{flat:"",bordered:"",class:"q-mt-sm"},{default:e(()=>[a(L,{class:"q-pa-sm text-subtitle1 bg-green-6 text-green-11 flex items-center"},{default:e(()=>[p[8]||(p[8]=w(" Data Iuran ",-1)),a(wa),a(A,{icon:"sync",outline:"",dense:"",onClick:p[2]||(p[2]=k=>l.value++),class:"q-px-sm q-mr-sm"}),a(ce,{onOnAdd:b,onShowPaket:j})]),_:1}),a(L,{class:"no-padding"},{default:e(()=>[(f(),$(de,{key:l.value}))]),_:1})]),_:1}),a(R,{modelValue:x.value,"onUpdate:modelValue":p[3]||(p[3]=k=>x.value=k)},{default:e(()=>[a(da,{data:t.value,onSuccessCreate:h,"disable-santri-id":!0},null,8,["data"])]),_:1},8,["modelValue"]),a(R,{modelValue:s.value,"onUpdate:modelValue":p[5]||(p[5]=k=>s.value=k)},{default:e(()=>[a(ke,{data:t.value,onSuccessSubmit:p[4]||(p[4]=k=>l.value++)},null,8,["data"])]),_:1},8,["modelValue"])]))}};export{vt as default};
