import{Q as w}from"./QSelect-Co09SqkM.js";import{x as c,R as z,y as r,c as v,o as f,w as d,b as n,a9 as q,a as U,n as C,q as F,a3 as o,z as g,s as P}from"./index-Bf-p91mW.js";import{Q as S}from"./QForm-OmDQHoiq.js";import{a as D}from"./api-post-CHcQycZS.js";import{a as B}from"./api-update-BYe6B3v5.js";import{a as H}from"./api-delete-BVHfd1pG.js";import{i as I,f as Q}from"./format-date-DlwYCgkJ.js";import{_ as x}from"./InputSelectSantriId-Dr_LO5a7.js";import{_ as m}from"./InputSelectArray-Jz4ksDX6.js";const R={__name:"IzinPesantrenForm",props:{data:Object},emits:["successDelete","successSubmit","successUpdate","successCreate"],setup(V,{emit:b}){const p=V,s=b,e=c({pengajuan:"Baru",tujuan:"Sesuai alamat rumah"}),u=c(!1);async function y(){const t={santri_id:e.value.santri_id,sifat:e.value.sifat,pengajuan:e.value.pengajuan,dari_tgl:e.value.dari_tgl,durasi:e.value.durasi,keperluan:e.value.keperluan,keterangan:e.value.keterangan,tujuan:e.value.tujuan,catatan:e.value.catatan};let l=null;const i=!e.value.id;i?l=await D({endPoint:"izin-pesantren",data:t,loading:u}):l=await B({endPoint:`izin-pesantren/${e.value.id}`,data:t,confirm:!0,notify:!0,loading:u}),l&&(document.getElementById("btn-close-form").click(),s("successSubmit",l?.izin_pesantren),s(i?"successCreate":"successUpdate",l?.izin_pesantren))}const k=async()=>{const t=e.value.id;await H({endPoint:`izin-pesantren/${t}`,loading:u})&&(document.getElementById("btn-close-form").click(),s("successDelete",t))};return z(async()=>{Object.assign(e.value,p.data)}),(t,l)=>{const i=r("FormHeader"),j=r("FormLoading"),_=r("FormActions");return f(),v(P,{class:"full-width",style:{"max-width":"425px"}},{default:d(()=>[n(S,{onSubmit:q(y,["prevent"])},{default:d(()=>[n(i,{title:"Input Izin Santri","is-new":!e.value.id},null,8,["is-new"]),u.value?(f(),v(j,{key:0})):U("",!0),n(C,{class:"q-pa-sm"},{default:d(()=>[F("div",null,[n(x,{"active-only":!0,onEmitInput:l[0]||(l[0]=a=>Object.assign(e.value,a)),data:p.data,class:"q-my-sm"},null,8,["data"]),n(m,{modelValue:e.value.sifat,"onUpdate:modelValue":l[1]||(l[1]=a=>e.value.sifat=a),url:"sifat-izin",label:"Sifat",class:"q-my-sm",rules:[a=>!!a||"Harus diisi!"]},null,8,["modelValue","rules"]),n(w,{label:"Pengajuan",modelValue:e.value.pengajuan,"onUpdate:modelValue":l[2]||(l[2]=a=>e.value.pengajuan=a),dense:"",outlined:"",class:"q-my-sm",options:["Baru","Perpanjangan ke-1","Perpanjangan ke-2"],disable:e.value.sifat!="Pulang"},null,8,["modelValue","disable"]),n(o,{dense:"",hint:g(I)(e.value.dari_tgl)?g(Q)(e.value.dari_tgl):"",class:"q-my-sm",outlined:"",label:"Tanggal (M)*",modelValue:e.value.dari_tgl,"onUpdate:modelValue":l[3]||(l[3]=a=>e.value.dari_tgl=a),type:"date",rules:[a=>!!a||"Harus diisi!"],"error-color":"negative"},null,8,["hint","modelValue","rules"]),n(o,{dense:"",hint:"",class:"q-my-sm",outlined:"",label:"Durasi (hari)*",modelValue:e.value.durasi,"onUpdate:modelValue":l[4]||(l[4]=a=>e.value.durasi=a),rules:[a=>!!a||"Harus diisi!",a=>!a||!isNaN(a)||"Hanya angka"],"error-color":"negative"},null,8,["modelValue","rules"]),n(m,{modelValue:e.value.keperluan,"onUpdate:modelValue":l[5]||(l[5]=a=>e.value.keperluan=a),url:"keperluan-izin",label:"Keperluan *",class:"q-my-sm",rules:[a=>!!a||"Harus diisi!"]},null,8,["modelValue","rules"]),n(m,{modelValue:e.value.keterangan,"onUpdate:modelValue":l[6]||(l[6]=a=>e.value.keterangan=a),url:"keterangan-izin",label:"Keterangan",class:"q-my-sm"},null,8,["modelValue"]),n(o,{dense:"",class:"q-my-sm",outlined:"",label:"Tujuan",modelValue:e.value.tujuan,"onUpdate:modelValue":l[7]||(l[7]=a=>e.value.tujuan=a),autogrow:""},null,8,["modelValue"]),n(o,{dense:"",class:"q-my-sm",outlined:"",label:"Catatan",modelValue:e.value.catatan,"onUpdate:modelValue":l[8]||(l[8]=a=>e.value.catatan=a),autogrow:""},null,8,["modelValue"])])]),_:1}),n(_,{"btn-delete":!!e.value.id,onOnDelete:k},null,8,["btn-delete"])]),_:1})]),_:1})}}};export{R as _};
