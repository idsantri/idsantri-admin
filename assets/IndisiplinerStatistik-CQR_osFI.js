import{Q as q}from"./QSelect-udWnZaoN.js";import{A as h,c as w,o as f,w as g,a as t,g as l,G as B,l as y,b as x,F as A,D as S,t as m,q as v,s as L,N as D,E as b,Q as C,C as V}from"./index-B_fOp8I2.js";import{C as j,p as E,a as F,b as N,B as U,c as H,L as M,d as R,S as G}from"./index-BvsTfFw2.js";import{A as J}from"./ArrayCrud-CByp4EUn.js";import{_ as O}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{Q as $}from"./QMarkupTable-O1N7MMlJ.js";import{I as Z}from"./Indisipliner-BPN3HASI.js";import"./QChip-5TM6hDLU.js";import"./QItem-BIr2qAQs.js";import"./QItemLabel-Dzv1rcUf.js";import"./QMenu-BsVEoqbp.js";import"./selection-CtPAXORa.js";import"./rtl-DFPa-2ov.js";import"./format-CJebrXOQ.js";import"./Api-BNo_L0HG.js";import"./index-Bv8s4jzG.js";import"./index-BF457XYG.js";import"./apiPost-TFI76I_W.js";import"./ApiCrud-DVH4XNNQ.js";const z={class:"chart-container",style:{position:"relative","min-height":"400px"}},W={__name:"StatistikChartAsrama",props:{asrama:Array},emits:["slice-click"],setup(_,{emit:p}){j.register(E,F,N,U,H,M);const e=_,c=p,u=h(()=>({labels:e.asrama.map(a=>`Asrama ${a.asrama}`),datasets:[{label:"Total Kasus",data:e.asrama.map(a=>parseInt(a.total_kasus)),backgroundColor:"lightcoral"},{label:"Total Point",data:e.asrama.map(a=>parseInt(a.total_point)),backgroundColor:"#00FA9A"}]})),d=h(()=>"Data Santri Indisipliner per Asrama"+(e.asrama?.length>0?` (${e.asrama[0]?.th_ajaran_h} H)`:"")),r=h(()=>({responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"top"},title:{display:!0,text:d.value}},scales:{y:{beginAtZero:!0,title:{display:!0,text:"Jumlah"}}},onClick:(s,a)=>{if(a.length>0){const o=a[0].index;c("slice-click",e.asrama[o])}else c("slice-click",null)}}));return(s,a)=>(f(),w(y,{flat:"",bordered:"",class:"container"},{default:g(()=>[t("div",z,[l(B(R),{data:u.value,options:r.value},null,8,["data","options"])])]),_:1}))}},X=O(W,[["__scopeId","data-v-c2ccd287"]]),Y=["onClick"],tt={class:"text-center"},at={class:"text-right"},st={class:"text-right"},et={class:"bg-green-1"},rt={class:"text-right text-bold"},lt={class:"text-right text-bold"},ot={__name:"StatistikTabelAsrama",props:{asrama:Array},emits:["rowClick"],setup(_,{emit:p}){const e=_,c=p,u=h(()=>{const r=e.asrama.reduce((a,o)=>a+parseInt(o.total_kasus),0),s=e.asrama.reduce((a,o)=>a+parseInt(o.total_point),0);return{totalKasus:r,totalPoint:s}}),d=r=>{c("rowClick",r)};return(r,s)=>(f(),x("div",null,[s[2]||(s[2]=t("div",{class:"bg-green-1 text-green-10 text-overline text-center"},"Tabel Asrama (Total)",-1)),l($,{flat:"",bordered:"",class:"q-my-sm"},{default:g(()=>[s[1]||(s[1]=t("thead",{class:"bg-green-2"},[t("tr",null,[t("th",null,"Asrama"),t("th",{class:"text-right"},"Kasus"),t("th",{class:"text-right"},"Point")])],-1)),t("tbody",null,[(f(!0),x(A,null,S(_.asrama,a=>(f(),x("tr",{key:a.asrama,onClick:o=>d(a)},[t("td",tt,m(a.asrama),1),t("td",at,m(a.total_kasus),1),t("td",st,m(a.total_point),1)],8,Y))),128))]),t("tfoot",et,[t("tr",null,[s[0]||(s[0]=t("td",{class:"text-center text-bold"},"Total",-1)),t("td",rt,m(u.value.totalKasus),1),t("td",lt,m(u.value.totalPoint),1)])])]),_:1}),s[3]||(s[3]=t("div",{class:"q-pa-sm bg-green-2 text-center text-green-10"},"Klik baris untuk filter kamar",-1))]))}},nt=["onClick"],it={class:"text-center"},ct={class:"text-right"},ut={class:"text-right"},dt={class:"bg-green-1"},mt={class:"text-right text-bold"},pt={class:"text-right text-bold"},_t={__name:"StatistikTabelKamar",props:{kamar:Array},emits:["rowClick"],setup(_,{emit:p}){const e=_,c=p,u=h(()=>{const r=e.kamar.reduce((a,o)=>a+parseInt(o.total_kasus),0),s=e.kamar.reduce((a,o)=>a+parseInt(o.total_point),0);return{totalKasus:r,totalPoint:s}}),d=r=>{c("rowClick",r)};return(r,s)=>(f(),x("div",null,[s[2]||(s[2]=t("div",{class:"bg-green-1 text-green-10 text-overline text-center"},"Tabel Kamar (Total)",-1)),l($,{flat:"",bordered:"",class:"q-my-sm"},{default:g(()=>[s[1]||(s[1]=t("thead",{class:"bg-green-2"},[t("tr",null,[t("th",{class:"text-left"},"Kamar"),t("th",{class:"text-right"},"Kasus"),t("th",{class:"text-right"},"Point")])],-1)),t("tbody",null,[(f(!0),x(A,null,S(_.kamar,a=>(f(),x("tr",{key:a.kamar,onClick:o=>d(a)},[t("td",it,m(a.kamar),1),t("td",ct,m(a.total_kasus),1),t("td",ut,m(a.total_point),1)],8,nt))),128))]),t("tfoot",dt,[t("tr",null,[s[0]||(s[0]=t("td",{class:"text-center text-bold"},"Total",-1)),t("td",mt,m(u.value.totalKasus),1),t("td",pt,m(u.value.totalPoint),1)])])]),_:1})]))}},gt={class:"tw:flex tw:flex-col tw:gap-2 tw:w-full"},ft={class:"tw:grid tw:grid-cols-1 tw:sm:grid-cols-2 tw:gap-2"},Dt={__name:"IndisiplinerStatistik",setup(_){const p=v(null),e=v(!1),c=v(!1),u=v([]),d=v([]),r=v([]),s=v("");function a(){r.value=[],d.value=[],s.value=""}async function o(){try{e.value=!0;const n=await Z.listThAjaran();u.value=J.sortPrimitiveArray(n.th_ajaran_h,"desc")}catch(n){console.error("ðŸš€ ~ getList ~ error:",n)}finally{e.value=!1}}L(async()=>{await o()});async function I(n){if(n)try{c.value=!0;const i=await G.indisipliner(n);d.value=i.kamar,r.value=i.asrama}catch(i){console.error("ðŸš€ ~ get statistik ~ error:",i)}finally{c.value=!1}}D(p,async n=>{a(),n&&await I(n)});const K=h(()=>s.value?d.value.filter(n=>n.asrama.toUpperCase()===s.value.toUpperCase()):d.value);return(n,i)=>{const T=b("CardHeader"),P=b("CardLoading"),Q=b("CardPage");return f(),w(Q,null,{default:g(()=>[l(T,{title:"Statistik Santri Indisipliner","show-reload":!1}),l(C,{class:"q-pa-sm"},{default:g(()=>[l(y,{bordered:"",flat:""},{default:g(()=>[l(C,{class:"q-pa-sm"},{default:g(()=>[l(q,{dense:"",modelValue:p.value,"onUpdate:modelValue":i[0]||(i[0]=k=>p.value=k),label:"Pilih Tahun Ajaran",class:"text-green-10",outlined:"",style:{"max-width":"300px"},behavior:"menu",options:u.value,loading:e.value,clearable:""},null,8,["modelValue","options","loading"])]),_:1}),l(V),l(C,{class:"q-pa-sm relative-position"},{default:g(()=>[l(P,{showing:c.value},null,8,["showing"]),t("div",gt,[l(X,{asrama:r.value,onSliceClick:i[1]||(i[1]=k=>s.value=k?.asrama?k.asrama:"")},null,8,["asrama"]),t("div",ft,[l(ot,{class:"tw:col-span-1",asrama:r.value,onRowClick:i[2]||(i[2]=k=>s.value=k.asrama)},null,8,["asrama"]),l(_t,{class:"tw:col-span-1",kamar:K.value},null,8,["kamar"])])])]),_:1})]),_:1})]),_:1})]),_:1})}}};export{Dt as default};
