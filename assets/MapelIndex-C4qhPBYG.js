import{Q as T}from"./QToolbarTitle-Bi6rSosy.js";import{x as d,R as M,c as q,o as r,w as o,b as l,a9 as U,n as x,g as v,a as h,B as S,a3 as b,s as Q,p as k,ab as P,Q as C,e as _,f as p,Z as B,G as F,q as s,F as j,t as I,v as g}from"./index-Bf-p91mW.js";import{Q as N}from"./QToolbar-CUFZpZSE.js";import{Q as $}from"./QSkeleton-DEYFlc1v.js";import{Q as E}from"./QMarkupTable-BU6ysEzR.js";import{Q as K}from"./QPage-DbeGPrD5.js";import{a as A}from"./api-get-CiRdORW1.js";import{Q as H}from"./QSpinnerCube-CRIto8Mg.js";import{Q as O}from"./QSelect-Co09SqkM.js";import{Q as G}from"./QSpace-DJeipgZa.js";import{Q as L}from"./QForm-OmDQHoiq.js";import{C as z}from"./ClosePopup-HTVnKVBl.js";import{l as R}from"./lists-store-F5P_xNBX.js";import{a as Z}from"./api-post-CHcQycZS.js";import{a as J}from"./api-update-BYe6B3v5.js";import{a as W}from"./api-delete-BVHfd1pG.js";import{_ as X}from"./FormHeader-5vDnmT1F.js";import{_ as D}from"./InputSelectTingkatPendidikan-C_EqL8ok.js";import"./index-D7WC_quC.js";import"./index-BtaF3-6r.js";import"./api-error-C0HjZ2a3.js";import"./QChip-DeZPZCXp.js";import"./QItemSection-Bl4rOme3.js";import"./QItemLabel-sjS6zLD0.js";import"./QMenu-BvL1IfNl.js";import"./selection-CE9S_xiH.js";import"./rtl-DFPa-2ov.js";import"./format-CJebrXOQ.js";import"./lists-data-mcTvx2m2.js";import"./DropDownAfter-wYSCUu7Z.js";import"./QBtnDropdown-Br6y2eVM.js";import"./QBtnGroup-BDP931ZD.js";import"./Lists-DSwT9YX9.js";import"./ApiCrud-SVFtkNw7.js";const Y={key:0},ee={__name:"MapelCrud",props:{data:{type:Object,required:!0},title:{type:String,default:()=>"Input"}},emits:["successSubmit","successDelete"],setup(w,{emit:m}){const u=w,c=m,t=d({category:"Fan Dasar",show:1}),i=d(!1),f=d([]);M(async()=>{Object.assign(t.value,u.data),f.value=R().getStateByKey("tingkat_pendidikan")});const V=async()=>{const n={sequence:t.value.sequence,id:t.value.id.toLowerCase(),tingkat_id:t.value.tingkat_id,name:t.value.name,alias:t.value.alias,category:t.value.category,show:t.value.show};let e=null;u.data.id?e=await J({endPoint:`mapel/${u.data.id}`,data:n,confirm:!0,notify:!0,loading:i}):e=await Z({endPoint:"mapel",data:n,loading:i}),e&&(document.getElementById("btn-close-crud").click(),c("successSubmit",e.mapel))},y=async()=>{await W({endPoint:`mapel/${u.data.id}`,loading:i})&&(document.getElementById("btn-close-crud").click(),c("successDelete",u.data))};return(n,e)=>(r(),q(Q,{class:"full-width",style:{"max-width":"425px"}},{default:o(()=>[l(L,{onSubmit:U(V,["prevent"])},{default:o(()=>[l(X,{title:u.title,"is-new":!t.value.id},null,8,["title","is-new"]),l(x,null,{default:o(()=>[i.value?(r(),v("div",Y,[l(S,{modelValue:i.value,"onUpdate:modelValue":e[0]||(e[0]=a=>i.value=a),persistent:""},{default:o(()=>[l(H,{color:"green-12",size:"8em",class:"flex q-ma-lg q-mx-auto"})]),_:1},8,["modelValue"])])):h("",!0),l(b,{dense:"",outlined:"",label:"Urut",modelValue:t.value.sequence,"onUpdate:modelValue":e[1]||(e[1]=a=>t.value.sequence=a),hint:"Nomor urut tampil"},null,8,["modelValue"]),l(D,{modelValue:t.value.tingkat_id,"onUpdate:modelValue":e[2]||(e[2]=a=>t.value.tingkat_id=a),class:"q-mt-sm",rules:[a=>!!a||"Harus diisi!"],selected:t.value.tingkat_id},null,8,["modelValue","rules","selected"]),l(b,{class:"q-mt-sm",dense:"",outlined:"",label:"Kode/ID Mapel",modelValue:t.value.id,"onUpdate:modelValue":e[3]||(e[3]=a=>t.value.id=a),hint:"Format: tingkat_id—kode_mapel (ibt-qur; ts-taj; aly-tau)"},null,8,["modelValue"]),l(b,{dense:"",class:"q-mt-sm",outlined:"",label:"Mata Pelajaran",modelValue:t.value.name,"onUpdate:modelValue":e[4]||(e[4]=a=>t.value.name=a),hint:"Hanya huruf dan spasi"},null,8,["modelValue"]),l(b,{dense:"",class:"q-mt-sm",outlined:"",label:"Mata Pelajaran (Alias)",modelValue:t.value.alias,"onUpdate:modelValue":e[5]||(e[5]=a=>t.value.alias=a)},null,8,["modelValue"]),l(O,{dense:"",class:"q-mt-sm",outlined:"",label:"Kategori Fan","emit-value":"","map-options":"",modelValue:t.value.category,"onUpdate:modelValue":e[6]||(e[6]=a=>t.value.category=a),options:["Fan Pokok","Fan Dasar","Fan Tambahan"],behavior:"menu"},null,8,["modelValue"]),l(Q,{bordered:"",flat:"",class:"q-px-sm q-mt-sm"},{default:o(()=>[e[8]||(e[8]=k(" Tampilkan: ",-1)),l(P,{modelValue:t.value.show,"onUpdate:modelValue":e[7]||(e[7]=a=>t.value.show=a),color:"green","true-value":1,"false-value":0},null,8,["modelValue"])]),_:1})]),_:1}),l(C,{class:"flex bg-green-6"},{default:o(()=>[_(l(p,{label:"Hapus",class:"bg-red text-red-1","no-caps":"",onClick:y},null,512),[[B,t.value.id]]),l(G),_(l(p,{label:"Tutup",class:"bg-green-11","no-caps":"",id:"btn-close-crud"},null,512),[[z]]),l(p,{type:"submit",label:"Simpan",class:"bg-green-10 text-green-11","no-caps":""})]),_:1})]),_:1})]),_:1}))}},ae={key:0},le={colspan:"7"},te={key:1},se={class:"text-center"},Ee={__name:"MapelIndex",setup(w){const m=d([]),u=d(""),c=d(!1),t=d({}),i=d(!1);async function f(n){const e=await A({endPoint:"mapel",loading:c,params:{tingkat_id:n}});m.value=e.mapel}F(u,async n=>{n?await f(n):m.value=[]});function V(n){t.value=n,i.value=!0}function y(){t.value={},i.value=!0}return(n,e)=>(r(),q(K,{class:"q-pa-sm"},{default:o(()=>[l(Q,null,{default:o(()=>[l(x,{class:"bg-green-8 text-green-11 q-px-sm q-py-none"},{default:o(()=>[l(N,{class:"no-padding no-margin"},{default:o(()=>[l(T,{class:"text-subtitle1"},{default:o(()=>[...e[4]||(e[4]=[k(" Daftar Mata Pelajaran ",-1)])]),_:1}),l(p,{label:"Nilai Mapel",to:"/madrasah/nilai-mapel",dense:"",outline:"","no-caps":"",icon:"arrow_back",class:"q-px-sm q-mr-md"}),l(p,{class:"text-green-10",label:"Baru",icon:"add","no-caps":"",color:"green-11",onClick:y})]),_:1})]),_:1}),l(C,{align:"right",class:"bg-green-1"},{default:o(()=>[l(D,{style:{width:"300px"},modelValue:u.value,"onUpdate:modelValue":e[0]||(e[0]=a=>u.value=a),label:"Tingkat Pendidikan",selected:u.value,class:""},null,8,["modelValue","selected"])]),_:1}),l(x,{class:"q-pa-sm"},{default:o(()=>[l(E,{flat:""},{default:o(()=>[e[6]||(e[6]=s("thead",null,[s("tr",{class:"text-left"},[s("th",null,"No"),s("th",null,"Kode/ID"),s("th",null,"Mata Pelajaran"),s("th",null,"Alias"),s("th",null,"Status Fan"),s("th",null,"Tampil"),s("th",{class:"text-center"},"Edit")])],-1)),s("tbody",null,[c.value?(r(),v("tr",ae,[s("td",le,[l($,{height:"50px"})])])):m.value.length==0?(r(),v("tr",te,[...e[5]||(e[5]=[s("td",{colspan:"7",class:"text-center text-green-10 text-italic"},[k(" — Tidak ada data untuk ditampilkan — "),s("br"),k(" — Pilih Tingkat Pendidikan — ")],-1)])])):(r(!0),v(j,{key:2},I(m.value,a=>(r(),v("tr",{key:a.id},[s("td",null,g(a.sequence),1),s("td",null,g(a.id),1),s("td",null,g(a.name),1),s("td",null,g(a.alias),1),s("td",null,g(a.category),1),s("td",null,[l(P,{"model-value":!!a.show,color:"green",disable:""},null,8,["model-value"])]),s("td",se,[l(p,{icon:"edit",flat:"",color:"green",onClick:oe=>V(a)},null,8,["onClick"])])]))),128))])]),_:1})]),_:1})]),_:1}),l(S,{modelValue:i.value,"onUpdate:modelValue":e[3]||(e[3]=a=>i.value=a)},{default:o(()=>[l(ee,{data:t.value,title:"Input Mata Pelajaran",onSuccessSubmit:e[1]||(e[1]=a=>f(a.tingkat_id)),onSuccessDelete:e[2]||(e[2]=a=>f(a.tingkat_id))},null,8,["data"])]),_:1},8,["modelValue"])]),_:1}))}};export{Ee as default};
