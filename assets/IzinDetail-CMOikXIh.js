import{q as p,ad as z,s as L,au as E,E as S,c as x,o as _,w as n,g as e,a,Q as y,e as q,v as D,b as M,F as A,D as O,ak as G,G as r,t as i,J as V,l as $,N as J,af as W,f as P,a9 as X,C as Y}from"./index-DH4X2iu7.js";import{Q as H,a as N}from"./QToolbar-Zd6jg8rY.js";import{Q as R}from"./QSpace-CfeB1z7Z.js";import{a as Z,b as h,i as aa,f as Q}from"./format-date-OVhbBx9F.js";import{a as ta,b as F,m as B}from"./hijri-Bs48DFvR.js";import{_ as ea}from"./ReportViewer-C8hUfPmT.js";import{Q as la,a as j}from"./QItem-BaBUoxOV.js";import{Q as sa}from"./QList-CdgReGH-.js";import{_ as U}from"./IzinPesantrenForm-M0OLeaz_.js";import{I as T}from"./IzinPesantren-BMu5jRvW.js";import{_ as na}from"./CardSantriSimple-DUa-8HQ1.js";import{Q as oa}from"./QForm-CPqPOTPm.js";import{_ as ia}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./id-BuNGTsqN.js";import"./format-number-B34ySHL_.js";import"./index-DGlHjC_U.js";import"./index--5Igz8-8.js";import"./QSelect-C96dAaMt.js";import"./QChip-VkTGbIiX.js";import"./QItemLabel-BOqCow3x.js";import"./QMenu-B5Em3nAR.js";import"./selection-CG3bmO4s.js";import"./rtl-DFPa-2ov.js";import"./format-CJebrXOQ.js";import"./InputSelectSantriId-7J1NoPRp.js";import"./Santri-CylbBrXw.js";import"./ApiCrud-C3EW7Fag.js";import"./Api-xA2tC3zB.js";import"./api-error-BkQkVNSH.js";import"./InputSelectArray-BrxKK8FU.js";import"./lists-store-C1KNRbvf.js";import"./ArrayCrud-CkcA-ixF.js";import"./DropDownAfter-D-coFwQY.js";import"./QBtnDropdown-d8YRy-iw.js";import"./QBtnGroup-BFtmyMD7.js";import"./ClosePopup-DsNUyLMH.js";import"./Lists-D_rw5opJ.js";import"./useCrudForm-BW4U5tHv.js";import"./QSkeleton-mGWqUj8h.js";import"./QImg-Dtk7nbJd.js";import"./api-get-CaBEA7nP.js";import"./santri-store-RuESwwcd.js";const ra={class:"relative-position"},ua={class:"flex"},da={__name:"IzinRiwayat",props:{santri_id:{required:!0}},setup(w){const c=w,u=p([]),g=p(!1),s=p(!1),{params:d}=z();L(async()=>{c.santri_id?await f(c.santri_id):u.value=[]}),E(async()=>{c.santri_id?await f(c.santri_id):u.value=[]});async function f(v){try{g.value=!0;const l=await T.getAll({params:{santri_id:v}});u.value=l.izin_pesantren}catch(l){console.log("ðŸš€ ~ getRiwayat ~ error:",l)}finally{g.value=!1}}return(v,l)=>{const b=S("CardLoading");return _(),x($,{flat:"",bordered:"",class:""},{default:n(()=>[e(y,{class:"bg-green-7 no-padding"},{default:n(()=>[e(H,{class:"no-padding no-margin"},{default:n(()=>[e(q,{icon:"sync","no-caps":"",onClick:l[0]||(l[0]=o=>f(w.santri_id)),flat:"",dense:"",class:"q-pl-sm",color:"green-11",title:"Muat ulang"}),e(N,{class:"text-subtitle1 text-green-11 q-px-none"},{default:n(()=>[...l[4]||(l[4]=[D(" Riwayat Perizinan ",-1)])]),_:1}),e(q,{color:"green-11",outline:"",dense:"","no-caps":"",icon:"add",label:"Tambah",class:"q-mr-sm q-px-md",onClick:l[1]||(l[1]=o=>s.value=!0)})]),_:1})]),_:1}),a("div",ra,[u.value?.length?(_(),x(y,{key:1,class:"q-pa-sm"},{default:n(()=>[e(sa,{separator:"",bordered:""},{default:n(()=>[(_(!0),M(A,null,O(u.value,(o,m)=>(_(),x(la,{key:m,class:G([o.id==r(d).id?"bg-green-1":"","q-pa-sm"])},{default:n(()=>[e(j,null,{default:n(()=>[a("table",null,[a("tbody",null,[a("tr",null,[l[6]||(l[6]=a("td",{class:"label"},"Tanggal:",-1)),a("td",ua,[D(i(r(Z)(o.dari_tgl)+" | "+r(ta)(o.dari_tgl))+" ",1),e(R),D(" "+i(o.th_ajaran_h),1)])]),a("tr",null,[l[7]||(l[7]=a("td",{class:"label"},"Izin",-1)),a("td",null,i(o.sifat)+" | "+i(o.durasi)+" hari | "+i(o.pengajuan),1)]),a("tr",null,[l[8]||(l[8]=a("td",{class:"label"},"Keperluan",-1)),a("td",null,i(o.keperluan)+" "+i(o.keterangan?" ("+o.keterangan+")":""),1)]),a("tr",null,[l[9]||(l[9]=a("td",{class:"label"},"Status",-1)),a("td",null,i(o.status),1)])])])]),_:2},1024),e(j,{side:"",class:"no-padding"},{default:n(()=>[e(q,{disable:o.id==r(d).id,icon:"info",glossy:"",dense:"",round:"",outline:"",color:"green",to:`/keamanan/izin-pesantren/${o.id}`},null,8,["disable","to"])]),_:2},1024)]),_:2},1032,["class"]))),128))]),_:1})]),_:1})):(_(),x(y,{key:0,class:"text-italic text-center q-pa-lg"},{default:n(()=>[...l[5]||(l[5]=[D(" Tidak ada untuk ditampilkan ",-1)])]),_:1})),e(b,{showing:g.value},null,8,["showing"])]),e(V,{modelValue:s.value,"onUpdate:modelValue":l[3]||(l[3]=o=>s.value=o)},{default:n(()=>[e(U,{data:{santri_id:w.santri_id,nama:u.value[0]?.nama,data_akhir:u.value[0]?.data_akhir},onSuccessDelete:o=>null,onSuccessSubmit:l[2]||(l[2]=o=>v.$router.push(`/keamanan/izin-pesantren/${o.id}`))},null,8,["data"])]),_:1},8,["modelValue"])]),_:1})}}},ma={__name:"IzinPesantrenKembaliForm",props:{data:Object},emits:["successSubmit"],setup(w,{emit:c}){const u=w,g=c,s=p({...u.data}),d=p(!1);async function f(){try{d.value=!0;const l=await T.setKembali({id:u.data.id,data:{kembali_tgl:s.value.kembali_tgl},message:"Tetapkan sudah kembali ke pesantren pada tanggal ini?"});l&&(document.getElementById("btn-close-form").click(),g("successSubmit",l?.izin_pesantren))}catch(l){console.error("err set not back",l)}finally{d.value=!1}}async function v(){try{d.value=!0;const l=await T.setKembali({id:u.data.id,data:{kembali_tgl:null},message:"Tetapkan belum kembali ke pesantren?"});l&&(document.getElementById("btn-close-form").click(),g("successSubmit",l?.izin_pesantren))}catch(l){console.error("err set not back",l)}finally{d.value=!1}}return J(()=>s.value.kembali_tgl,l=>{s.value.kembali_tgl=h(l)}),(l,b)=>{const o=S("FormHeader"),m=S("FormLoading"),t=S("FormActions");return _(),x($,{class:"full-width",style:{"max-width":"425px"}},{default:n(()=>[e(oa,{onSubmit:W(f,["prevent"])},{default:n(()=>[e(o,{title:"Tetapkan Tanggal Kembali","is-new":!1}),d.value?(_(),x(m,{key:0})):P("",!0),e(y,{class:"q-pa-sm"},{default:n(()=>[e(X,{dense:"",hint:r(aa)(s.value.kembali_tgl)?r(Q)(s.value.kembali_tgl):"",class:"q-my-sm",outlined:"",label:"Tanggal (M)*",modelValue:s.value.kembali_tgl,"onUpdate:modelValue":b[0]||(b[0]=C=>s.value.kembali_tgl=C),type:"datetime-local",rules:[C=>!!C||"Harus diisi!"],"error-color":"negative"},null,8,["hint","modelValue","rules"])]),_:1}),e(t,{"btn-delete":!!w.data.kembali_tgl,onOnDelete:v,"label-delete":"Belum Kembali"},null,8,["btn-delete"])]),_:1})]),_:1})}}},pa={class:"row",style:{"max-width":"1200px"}},ca={class:"col-xs-12 col-sm-6"},ga={class:"q-ma-sm"},fa={class:"full-width"},va={colspan:"2"},ba={class:"col-xs-12 col-sm-6"},_a={class:"q-ma-sm"},ka={__name:"IzinDetail",setup(w){const c=p(!1),u=p(""),g=z(),s=p({}),d=p(!1),f=p(!1),v=p(!1);function l(){u.value=`reports/izin-pesantren/view?id=${s.value.id}`,c.value=!0}async function b(){try{d.value=!0;const m=await T.getById({id:g.params.id});s.value=m.izin_pesantren}catch(m){console.log("ðŸš€ ~ loadData ~ error:",m)}finally{d.value=!1}}L(async()=>{g.params.id&&await b()});function o(m){const t=/\(\+(\d+)\)/g;return m.replace(t,(K,I)=>`(terlambat ${I} hari)`)}return(m,t)=>{const C=S("CardHeader"),K=S("CardLoading"),I=S("CardPage");return _(),x(I,null,{default:n(()=>[e(C,{title:"Detail Izin Pesantren","show-reload":!1}),a("div",pa,[a("div",ca,[a("div",ga,[e($,{class:"",flat:"",bordered:""},{default:n(()=>[e(y,{class:"bg-green-7 no-padding"},{default:n(()=>[e(H,{class:"no-padding no-margin"},{default:n(()=>[e(q,{icon:"sync","no-caps":"",onClick:b,flat:"",dense:"",class:"q-pl-sm",color:"green-11",title:"Muat ulang"}),e(N,{class:"text-subtitle1 text-green-11 q-px-none"},{default:n(()=>[...t[6]||(t[6]=[D(" Data Perizinan ",-1)])]),_:1}),e(q,{dense:"",class:"q-px-md q-mr-sm text-green-10",label:"Cetak","no-caps":"",icon:"print",color:"green-11",onClick:l}),e(q,{dense:"",class:"q-px-md q-mr-sm text-green-10",label:"Edit","no-caps":"",icon:"edit",color:"green-11",onClick:t[0]||(t[0]=k=>f.value=!0)})]),_:1})]),_:1}),s.value?(_(),x(y,{key:0,class:"q-pa-sm"},{default:n(()=>[e(na,{id:s.value.santri_id},null,8,["id"]),e($,{bordered:"",flat:"",class:"q-mt-sm"},{default:n(()=>[e(y,{class:"q-pa-sm text-subtitle1 bg-green-11 flex"},{default:n(()=>[t[7]||(t[7]=D(" Data Izin ",-1)),e(R),e(q,{dense:"",label:"Kembali",icon:"manage_history","no-caps":"",class:"q-px-sm bg-green-10 text-green-12",onClick:t[1]||(t[1]=k=>v.value=!0)})]),_:1}),e(y,{class:"q-pa-sm"},{default:n(()=>[a("table",fa,[a("tbody",null,[a("tr",null,[t[8]||(t[8]=a("td",{class:"text-italic"},"Sifat:",-1)),a("td",null,i(s.value.sifat),1)]),a("tr",null,[t[9]||(t[9]=a("td",{class:"text-italic"},"Pengajuan:",-1)),a("td",null,i(s.value.pengajuan),1)]),a("tr",null,[t[10]||(t[10]=a("td",{class:"text-italic"},"Durasi:",-1)),a("td",null,i(s.value.durasi+" hari"),1)]),a("tr",null,[t[11]||(t[11]=a("td",{class:"text-italic"},"Dari Tanggal:",-1)),a("td",null,i(r(Q)(s.value.dari_tgl)+" | "+r(F)(r(B)(s.value.dari_tgl))),1)]),a("tr",null,[t[12]||(t[12]=a("td",{class:"text-italic"},"Sampai Tanggal:",-1)),a("td",null,i(r(Q)(s.value.sampai_tgl)+" | "+r(F)(r(B)(s.value.sampai_tgl))),1)]),a("tr",null,[t[13]||(t[13]=a("td",{class:"text-italic"},"Keperluan:",-1)),a("td",null,i(s.value.keperluan),1)]),a("tr",null,[t[14]||(t[14]=a("td",{class:"text-italic"},"Keterangan:",-1)),a("td",null,i(s.value.keterangan??"-"),1)]),a("tr",null,[t[15]||(t[15]=a("td",{class:"text-italic"},"Tujuan:",-1)),a("td",null,i(s.value.tujuan),1)]),a("tr",null,[t[16]||(t[16]=a("td",{class:"text-italic"},"Catatan:",-1)),a("td",null,i(s.value.catatan||"-"),1)]),a("tr",null,[a("td",va,[e(Y,{color:"green-8"})])]),a("tr",null,[t[17]||(t[17]=a("td",{class:"text-italic"},"Kembali:",-1)),a("td",null,i(r(Q)(s.value.kembali_tgl)+" | "+r(F)(r(B)(s.value.kembali_tgl))),1)]),a("tr",null,[t[18]||(t[18]=a("td",{class:"text-italic"},"Status:",-1)),a("td",null,i(s.value.status?o(s.value.status):""),1)])])]),e(K,{showing:d.value},null,8,["showing"])]),_:1})]),_:1})]),_:1})):P("",!0)]),_:1})])]),a("div",ba,[a("div",_a,[e(da,{class:"",santri_id:s.value.santri_id},null,8,["santri_id"])])])]),e(V,{modelValue:f.value,"onUpdate:modelValue":t[3]||(t[3]=k=>f.value=k)},{default:n(()=>[e(U,{data:s.value,onSuccessDelete:t[2]||(t[2]=k=>m.$router.go(-1)),onSuccessSubmit:b},null,8,["data"])]),_:1},8,["modelValue"]),e(V,{modelValue:v.value,"onUpdate:modelValue":t[4]||(t[4]=k=>v.value=k)},{default:n(()=>[e(ma,{data:{id:s.value.id,kembali_tgl:s.value.kembali_tgl},onSuccessSubmit:b},null,8,["data"])]),_:1},8,["modelValue"]),e(V,{modelValue:c.value,"onUpdate:modelValue":t[5]||(t[5]=k=>c.value=k)},{default:n(()=>[e(ea,{url:u.value},null,8,["url"])]),_:1},8,["modelValue"])]),_:1})}}},rt=ia(ka,[["__scopeId","data-v-dbbc9579"]]);export{rt as default};
