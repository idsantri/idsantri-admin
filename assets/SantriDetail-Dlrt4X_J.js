import{E as D,c as v,o as u,w as e,g as a,Q as $,a as w,t as W,r as na,b as F,F as M,D as oa,l as A,n as I,v as S,p as T,q as y,ap as ra,s as G,Y as sa,af as ia,a9 as U,ad as Y,A as E,e as g,f as ua,bE as da,J,ae as ma,aa as pa,G as R}from"./index-4p260kvZ.js";import{g as fa,f as z}from"./format-date-DBaFa2rd.js";import{Q as X}from"./QSpace-Cd2TOquo.js";import{Q as ca}from"./QImg-DsrDvg9D.js";import{_ as va}from"./ImageUploader-DAwqTnjx.js";import{s as q}from"./santri-store-C9I6KwTb.js";import{b as _a}from"./hijri-CTUg_lXm.js";import{Q as j}from"./QRouteTab-DhsBSL06.js";import{Q as V}from"./QItemLabel-CCnLRK8P.js";import{Q as h,a as r}from"./QItem-Bm8-c2Wn.js";import{Q as Z}from"./QList-Dxw8L8lH.js";import{Q as aa}from"./QBtnDropdown-DIY7qK8j.js";import{Q as ga}from"./QTabs-BraVJU2f.js";import{C}from"./ClosePopup-5R4sMsq5.js";import{d as ba}from"./dialog-store-rQmAIUIh.js";import{_ as wa}from"./ReportViewer-DX-CHrao.js";import{Q as L}from"./QSelect-3_6HAjAN.js";import{Q as ka}from"./QForm-CeEVrqdX.js";import{e as ya}from"./index-Kc9iSi_0.js";import{_ as Ia}from"./InputSelectArray-aH-VPit7.js";import{D as N}from"./DownloadFile-BJZr_q9V.js";import{S as Sa}from"./Santri-C3Lb9Zud.js";import{C as Va}from"./CardListTabel-BeL8W47r.js";import{f as ha}from"./format-text-DnCGEu2I.js";import{I as Ca}from"./Image-DuChdQRr.js";import"./id-BuNGTsqN.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./index-Dt0LXLau.js";import"./format-number-B34ySHL_.js";import"./QBtnGroup-DFA0bZUD.js";import"./QMenu-Cv4HdOt9.js";import"./selection-DmD-8NOJ.js";import"./QResizeObserver-XtTUB-Lt.js";import"./rtl-DFPa-2ov.js";import"./QField-ZUfgWHJg.js";import"./QChip-CYxuK0Bb.js";import"./format-CJebrXOQ.js";import"./lists-store-Bf7okdTk.js";import"./ArrayCrud-CByp4EUn.js";import"./DropDownAfter-BDZJMqrN.js";import"./Lists-B85W045j.js";import"./ApiCrud-p1I8ArCK.js";import"./Api-CfpY0NLz.js";import"./apiPost-CXI5RCo3.js";import"./QMarkupTable-CLFpw3DC.js";const qa={class:"flex items-center"},$a={class:"text-subtitle2"},Qa={class:"col-4 q-pr-sm relative-position"},Ua={class:"col"},Da={class:"text-caption text-italic"},xa={class:"q-mb-sm"},Ba={__name:"CardIdentity",props:{title:String,data:Object,image:String,loading:Boolean,loadingImage:Boolean},setup(_){return(l,k)=>{const d=D("CardLoading");return u(),v(A,{flat:"",bordered:""},{default:e(()=>[a($,{class:"bg-green-7 text-green-11 q-pa-sm"},{default:e(()=>[w("div",qa,[w("div",$a,W(_.title),1),a(X)])]),_:1}),a($,{class:"q-pa-sm row"},{default:e(()=>[w("div",Qa,[a(ca,{src:_.image,ratio:3/4,alt:"santri"},null,8,["src"]),na(l.$slots,"button"),a(d,{showing:_.loadingImage,message:""},null,8,["showing"])]),w("div",Ua,[(u(!0),F(M,null,oa(_.data,(t,m)=>(u(),F("div",{key:m},[w("div",Da,W(m),1),w("div",xa,W(t),1)]))),128))]),a(d,{showing:_.loading},null,8,["showing"])]),_:3})]),_:3})}}},ja={__name:"SantriRelations",props:{santriId:{default:null}},setup(_){const l=_;return(k,d)=>{const t=D("router-view");return u(),v(A,{bordered:"",flat:""},{default:e(()=>[a($,{class:"bg-green-7 text-green-11 no-padding"},{default:e(()=>[a(ga,{"no-caps":"","outside-arrows":"","mobile-arrows":"",dense:"","indicator-color":"green-13",align:"left"},{default:e(()=>[a(j,{name:"wali",label:"Wali",to:"/santri/"+l.santriId+"/wali",replace:""},null,8,["to"]),a(j,{name:"ortu",label:"Ortu",to:"/santri/"+l.santriId+"/ortu",replace:""},null,8,["to"]),a(j,{name:"status",label:"Status",to:"/santri/"+l.santriId+"/status",replace:""},null,8,["to"]),a(j,{name:"kelas",label:"Kelas",to:"/santri/"+l.santriId+"/kelas",replace:""},null,8,["to"]),a(j,{name:"domisili",label:"Domisili",to:"/santri/"+l.santriId+"/domisili",replace:""},null,8,["to"]),a(X),a(aa,{flat:"",dense:"","dropdown-icon":"more_vert",class:"q-pl-md",color:"green-11"},{default:e(()=>[a(Z,null,{default:e(()=>[I((u(),v(h,{to:"/iuran/santri/"+l.santriId},{default:e(()=>[a(r,null,{default:e(()=>[a(V,null,{default:e(()=>[...d[0]||(d[0]=[S("Iuran",-1)])]),_:1})]),_:1}),a(r,{avatar:""},{default:e(()=>[a(T,{name:"payments",flat:""})]),_:1})]),_:1},8,["to"])),[[C]]),I((u(),v(h,{to:"/keamanan/izin-pesantren/santri/"+l.santriId},{default:e(()=>[a(r,null,{default:e(()=>[a(V,null,{default:e(()=>[...d[1]||(d[1]=[S("Izin Pesantren",-1)])]),_:1})]),_:1}),a(r,{avatar:""},{default:e(()=>[a(T,{name:"transfer_within_a_station",flat:""})]),_:1})]),_:1},8,["to"])),[[C]]),I((u(),v(h,{to:"/keamanan/indisipliner/santri/"+l.santriId},{default:e(()=>[a(r,null,{default:e(()=>[a(V,null,{default:e(()=>[...d[2]||(d[2]=[S("Indisipliner",-1)])]),_:1})]),_:1}),a(r,{avatar:""},{default:e(()=>[a(T,{name:"directions_run",flat:""})]),_:1})]),_:1},8,["to"])),[[C]])]),_:1})]),_:1})]),_:1})]),_:1}),a($,{class:"q-pa-sm"},{default:e(()=>[a(t)]),_:1})]),_:1})}}},Pa={__name:"SantriPermohonanBerhentiForm",props:{data:{type:Object,required:!0}},emits:["successSubmit"],setup(_,{emit:l}){const k=_,d=l,t=y({jenis_permohonan:"Berhenti",tunggakan:"Lunas"}),m=y({...k.data}),b=ra("firstInput");G(async()=>{await sa(),b.value&&b.value.focus()});async function c(){const f=JSON.parse(JSON.stringify(t.value));if(!f.tunggakan||!f.jenis_permohonan||!f.alasan||!f.wali_nama||!f.wali_status||!f.wali_hubungan)return ya("Isian tidak lengkap");f.id=m.value.id,d("successSubmit",f),document.getElementById("btn-close-form")?.click()}return(f,n)=>{const x=D("FormHeader"),B=D("FormActions");return u(),v(A,{class:"full-width",style:{"max-width":"425px"}},{default:e(()=>[a(ka,{onSubmit:ia(c,["prevent"])},{default:e(()=>[a(x,{title:"Permohonan Berhenti","is-new":!0}),a($,null,{default:e(()=>[a(U,{dense:"",class:"q-my-sm",outlined:"",label:"Santri ID",modelValue:m.value.id,"onUpdate:modelValue":n[0]||(n[0]=o=>m.value.id=o),filled:"",disable:""},null,8,["modelValue"]),a(U,{dense:"",class:"q-my-sm",outlined:"",label:"Nama",modelValue:m.value.nama,"onUpdate:modelValue":n[1]||(n[1]=o=>m.value.nama=o),filled:"",disable:""},null,8,["modelValue"]),a(L,{dense:"",class:"q-my-sm",outlined:"",label:"Tunggakan*",modelValue:t.value.tunggakan,"onUpdate:modelValue":n[2]||(n[2]=o=>t.value.tunggakan=o),options:["Lunas","Belum Lunas"],clearable:"","use-input":"","new-value-mode":"add",behavior:"menu",ref_key:"firstInput",ref:b},null,8,["modelValue"]),a(L,{dense:"",class:"q-my-sm",outlined:"",label:"Jenis Permohonan*",modelValue:t.value.jenis_permohonan,"onUpdate:modelValue":n[3]||(n[3]=o=>t.value.jenis_permohonan=o),options:["Berhenti","Cuti/Istirahat"],clearable:"","use-input":"","new-value-mode":"add",behavior:"menu"},null,8,["modelValue"]),a(U,{dense:"",class:"q-my-sm",outlined:"",label:"Alasan*",modelValue:t.value.alasan,"onUpdate:modelValue":n[4]||(n[4]=o=>t.value.alasan=o),autogrow:""},null,8,["modelValue"]),a(A,{class:"",flat:"",bordered:""},{default:e(()=>[a($,{class:"q-py-none q-px-sm"},{default:e(()=>[n[11]||(n[11]=w("div",{class:"text-subtitle2 q-my-sm"},"Identitas Pemohon (Wali)",-1)),a(U,{dense:"",class:"",outlined:"",label:"Nama*",modelValue:t.value.wali_nama,"onUpdate:modelValue":n[5]||(n[5]=o=>t.value.wali_nama=o)},null,8,["modelValue"]),a(U,{dense:"",class:"q-my-sm",outlined:"",label:"Nomor Telepon",modelValue:t.value.wali_no_telepon,"onUpdate:modelValue":n[6]||(n[6]=o=>t.value.wali_no_telepon=o)},null,8,["modelValue"]),a(L,{dense:"",class:"q-my-sm",outlined:"",label:"Bukti Diri",modelValue:t.value.wali_bukti_diri,"onUpdate:modelValue":n[7]||(n[7]=o=>t.value.wali_bukti_diri=o),options:["KTP","SIM"],clearable:"","use-input":"","new-value-mode":"add",behavior:"menu"},null,8,["modelValue"]),a(U,{dense:"",class:"q-my-sm",outlined:"",label:"Nomor / ID Bukti Diri",modelValue:t.value.wali_bukti_diri_id,"onUpdate:modelValue":n[8]||(n[8]=o=>t.value.wali_bukti_diri_id=o)},null,8,["modelValue"]),a(L,{dense:"",class:"q-my-sm",outlined:"",label:"Status*",modelValue:t.value.wali_status,"onUpdate:modelValue":n[9]||(n[9]=o=>t.value.wali_status=o),options:["Wali","Wakil Wali"],clearable:"","use-input":"","new-value-mode":"add",behavior:"menu"},null,8,["modelValue"]),a(Ia,{modelValue:t.value.wali_hubungan,"onUpdate:modelValue":n[10]||(n[10]=o=>t.value.wali_hubungan=o),url:"hubungan-wali",label:"Hubungan*",class:"q-my-sm","use-input":"","new-value-mode":"add"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),a(B,{"btn-delete":!1,labelSubmit:"Cetak",iconSubmit:"print"})]),_:1})]),_:1})}}},Ra={key:2},La={__name:"DropDownPrint",props:{santri:{type:Object,required:!0}},setup(_){const l=_,k=Y(),d=y(!1),t=y(""),m=y(!1),b=E(()=>{const i=l.santri.nama.replace(/\s+/g,"_").toLowerCase();return`${l.santri.id}-${i}.pdf`}),c=y(!1);async function f(){try{c.value=!0,await N.santriRegistrasi(l.santri.id,"registrasi-"+b.value)}catch(i){console.error("Error downloading registrasi:",i)}finally{c.value=!1}}async function n(){try{c.value=!0,await N.santriStandbook(l.santri.id,"standbook-"+b.value)}catch(i){console.error("Error downloading standbook:",i)}finally{c.value=!1}}async function x(){try{c.value=!0,await N.santriKeteranganBerhenti(l.santri.id,"keterangan-berhenti-"+b.value)}catch(i){console.error("Error downloading keterangan berhenti:",i)}finally{c.value=!1}}async function B(){try{c.value=!0,await N.santriIdCard(l.santri.id,"id-card-"+b.value)}catch(i){console.error("Error downloading id card:",i)}finally{c.value=!1}}function o(){t.value=`reports/santri/registrasi/view?id=${k.params.id}`,m.value=!0}function O(){t.value=`reports/santri/standbook/view?id=${k.params.id}`,m.value=!0}function K(i){d.value=!1;const s=new URLSearchParams(i).toString();t.value=`reports/santri/permohonan-berhenti/view?${s}`,m.value=!0}function H(){t.value=`reports/santri/keterangan-berhenti/view?id=${k.params.id}`,m.value=!0}return(i,s)=>(u(),F(M,null,[a(aa,{color:"green-10","no-caps":"",dense:"",outline:"",class:"q-px-sm text-green-11",disable:c.value},{label:e(()=>[c.value?(u(),v(da,{key:0,class:"q-mr-sm"})):(u(),v(T,{key:1,name:"print",class:"q-mr-sm"})),i.$q.screen.lt.sm?ua("",!0):(u(),F("span",Ra," Cetak / Unduh "))]),default:e(()=>[a(Z,null,{default:e(()=>[I((u(),v(h,null,{default:e(()=>[a(r,null,{default:e(()=>[a(V,null,{default:e(()=>[...s[3]||(s[3]=[S("Registrasi",-1)])]),_:1})]),_:1}),a(r,{avatar:""},{default:e(()=>[a(g,{icon:"download",flat:"",onClick:f})]),_:1}),a(r,{avatar:""},{default:e(()=>[a(g,{icon:"print",flat:"",onClick:o})]),_:1})]),_:1})),[[C]]),I((u(),v(h,null,{default:e(()=>[a(r,null,{default:e(()=>[a(V,null,{default:e(()=>[...s[4]||(s[4]=[S("Standbook",-1)])]),_:1})]),_:1}),a(r,{avatar:""},{default:e(()=>[a(g,{icon:"download",flat:"",onClick:n})]),_:1}),a(r,{avatar:""},{default:e(()=>[a(g,{icon:"print",flat:"",onClick:O})]),_:1})]),_:1})),[[C]]),I((u(),v(h,null,{default:e(()=>[a(r,null,{default:e(()=>[a(V,null,{default:e(()=>[...s[5]||(s[5]=[S("Permohonan Berhenti",-1)])]),_:1})]),_:1}),a(r,{avatar:""},{default:e(()=>[a(g,{icon:"download",flat:"",disable:""})]),_:1}),a(r,{avatar:""},{default:e(()=>[a(g,{icon:"print",flat:"",onClick:s[0]||(s[0]=Q=>d.value=!0)})]),_:1})]),_:1})),[[C]]),I((u(),v(h,null,{default:e(()=>[a(r,null,{default:e(()=>[a(V,null,{default:e(()=>[...s[6]||(s[6]=[S("Keterangan Berhenti",-1)])]),_:1})]),_:1}),a(r,{avatar:""},{default:e(()=>[a(g,{icon:"download",flat:"",onClick:x})]),_:1}),a(r,{avatar:""},{default:e(()=>[a(g,{icon:"print",flat:"",onClick:H})]),_:1})]),_:1})),[[C]]),I((u(),v(h,null,{default:e(()=>[a(r,null,{default:e(()=>[a(V,null,{default:e(()=>[...s[7]||(s[7]=[S("ID Card",-1)])]),_:1})]),_:1}),a(r,{avatar:""},{default:e(()=>[a(g,{icon:"download",flat:"",onClick:B})]),_:1}),a(r,{avatar:""},{default:e(()=>[a(g,{icon:"print",flat:"",disable:""})]),_:1})]),_:1})),[[C]])]),_:1})]),_:1},8,["disable"]),a(J,{modelValue:d.value,"onUpdate:modelValue":s[1]||(s[1]=Q=>d.value=Q)},{default:e(()=>[a(Pa,{onSuccessSubmit:K,data:l.santri},null,8,["data"])]),_:1},8,["modelValue"]),a(J,{modelValue:m.value,"onUpdate:modelValue":s[2]||(s[2]=Q=>m.value=Q)},{default:e(()=>[a(wa,{url:t.value},null,8,["url"])]),_:1},8,["modelValue"])],64))}},Na={class:"row"},Ta={class:"col-12 col-sm-6 col-md-4 q-pa-sm"},Ea={class:"col-12 col-sm-6 col-md-5 q-pa-sm"},xe={__name:"SantriDetail",setup(_){const{santri:l}=ma(q()),k=q(),t=Y().params.id,m=ba(),{searchSantri:b,crudSantri:c}=pa(m),f=y(!1),n=y(!1);async function x(){try{n.value=!0;const p=await Ca.santri(t);k.setImage(p?.image_url||null)}catch(p){console.error("ðŸš€ ~ loadImage ~ _err:",p)}finally{n.value=!1}}const B=E(()=>{if(l.value?.tgl_lahir){const p=fa(l.value.tgl_lahir);return p.tahun+" tahun, "+p.bulan+" bulan, "+p.hari+" hari"}else return"-"});async function o(){q().$reset();try{f.value=!0;const p=await Sa.getById({id:t});p&&(q().setSantri(p.santri),q().setOrtu(p.ortu),q().setWali(p.wali))}catch{}finally{f.value=!1}}const O=E(()=>[{label:"ID",value:l.value.id},{label:"Tanggal Daftar",value:z(l.value.tgl_daftar_m)+" | "+_a(l.value.tgl_daftar_h)},{label:"Tahun Ajaran",value:`${l.value.th_ajaran_h||"-"} | ${l.value.th_ajaran_m||"-"}`}]),K=E(()=>({Nama:`${l.value.nama?l.value.nama?.toUpperCase():""} (${l.value.sex?.toUpperCase()})`,Alamat:ha(l.value.jl,l.value.rt,l.value.rw,l.value.desa,l.value.kecamatan,l.value.kabupaten,l.value.provinsi,l.value.kode_pos),Kelahiran:`${l.value.tmp_lahir||"-"}, ${z(l.value.tgl_lahir)}`,Umur:B.value,"Data Akhir":l.value.data_akhir||"-"}));G(async()=>{await o()});function H(){q().setEdit(),c.value=!0}const i=y(!1),s=p=>i.value=p;async function Q(){i.value=!1,await x()}return(p,P)=>{const ea=D("CardHeader"),la=D("CardPage");return u(),v(la,null,{default:e(()=>[a(ea,{title:"Data Santri",onOnReload:o,"show-edit":!0,onOnEdit:H},{buttons:e(()=>[a(g,{label:p.$q.screen.lt.sm?"":"Cari",onClick:P[0]||(P[0]=ta=>b.value=!0),color:"green-2","no-caps":"",dense:"",class:"q-px-sm text-green-10",icon:"search"},null,8,["label"]),a(La,{santri:R(l)},null,8,["santri"])]),_:1}),a($,{class:"no-padding"},{default:e(()=>[w("div",Na,[w("div",Ta,[a(Va,{class:"q-mb-sm",data:O.value,loading:f.value,title:"Registrasi"},null,8,["data","loading"]),a(Ba,{class:"q-mb-sm",title:"Identitas",data:K.value,loading:f.value,loadingImage:n.value,image:R(l)?.image_url||"/user-default.png"},{button:e(()=>[a(g,{class:"q-mt-sm full-width",icon:"upload","no-caps":"",label:"Foto",dense:"",size:"sm",outline:"",color:"green-10",onClick:P[1]||(P[1]=ta=>i.value=!0)})]),_:1},8,["data","loading","loadingImage","image"])]),w("div",Ea,[a(ja,{"santri-id":R(t)},null,8,["santri-id"])])])]),_:1}),a(va,{"img-format":"jpg","show-uploader":i.value,url:`/images/santri/${R(t)}`,onUpdateUploader:s,onSuccessUpload:Q},null,8,["show-uploader","url"])]),_:1})}}};export{xe as default};
