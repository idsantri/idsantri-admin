import{Q as j}from"./QSpinnerCube-BbU3LkI7.js";import{v as i,R as q,x as m,f as C,o as c,w as r,i as t,a8 as Q,Q as U,r as h,y as x,B,a4 as d,q as S}from"./index-Cju_WcQt.js";import{Q as N}from"./QForm-B-IeWzDf.js";import{l as p}from"./lists-store-Bv-Q7-f0.js";import{a as D}from"./api-post-P8g4q4LG.js";import{a as F}from"./api-update-Dm-9pXju.js";import{a as A}from"./api-delete-BEmNpbPy.js";import{_ as v}from"./InputSelectArray-G7sFmwYz.js";import{_ as H}from"./InputSelectTingkatPendidikan-BK-38Fxm.js";const I={key:0},G={__name:"KelasForm",props:{data:{type:Object,required:!0}},emits:["successDelete","successSubmit","successUpdate","successCreate"],setup(f,{emit:_}){const k=f,o=_,e=i({}),s=i(!1),g=i([]),b=i([]);q(async()=>{Object.assign(e.value,k.data),g.value=p().getByStateName("tahun-ajaran"),b.value=p().getByStateName("tingkat-pendidikan")});const V=async()=>{const n={santri_id:e.value.santri_id,th_ajaran_h:e.value.th_ajaran_h,tingkat_id:e.value.tingkat_id,kelas:e.value.kelas,no_absen:e.value.no_absen,keterangan:e.value.keterangan};let a=null;const u=!e.value.id;u?a=await D({endPoint:"kelas",data:n,loading:s}):a=await F({endPoint:`kelas/${e.value.id}`,data:n,confirm:!0,notify:!0,loading:s}),a&&(document.getElementById("btn-close-form").click(),o("successSubmit",a?.kelas),o(u?"successCreate":"successUpdate",a?.kelas))},y=async()=>{const n=e.value.id;await A({endPoint:`kelas/${n}`,loading:s})&&(document.getElementById("btn-close-form").click(),o("successDelete",n))};return(n,a)=>{const u=m("FormHeader"),w=m("FormActions");return c(),C(S,{class:"full-width",style:{"max-width":"425px"}},{default:r(()=>[t(N,{onSubmit:Q(V,["prevent"])},{default:r(()=>[t(u,{title:"Input Kelas","is-new":!e.value.id},null,8,["is-new"]),t(U,null,{default:r(()=>[s.value?(c(),h("div",I,[t(B,{modelValue:s.value,"onUpdate:modelValue":a[0]||(a[0]=l=>s.value=l),persistent:""},{default:r(()=>[t(j,{color:"green-12",size:"8em",class:"flex q-ma-lg q-mx-auto"})]),_:1},8,["modelValue"])])):x("",!0),t(d,{dense:"",outlined:"",label:"Nama","model-value":e.value?.nama+" ("+e.value?.santri_id+")",disable:"",filled:""},null,8,["model-value"]),t(v,{modelValue:e.value.th_ajaran_h,"onUpdate:modelValue":a[1]||(a[1]=l=>e.value.th_ajaran_h=l),url:"tahun-ajaran",label:"Tahun Ajaran *",sort:"desc",class:"q-mt-sm",rules:[l=>!!l||"Harus diisi!"],selected:e.value.th_ajaran_h},null,8,["modelValue","rules","selected"]),t(H,{modelValue:e.value.tingkat_id,"onUpdate:modelValue":a[2]||(a[2]=l=>e.value.tingkat_id=l),class:"q-mt-sm",rules:[l=>!!l||"Harus diisi!"],selected:e.value.tingkat_id},null,8,["modelValue","rules","selected"]),t(v,{modelValue:e.value.kelas,"onUpdate:modelValue":a[3]||(a[3]=l=>e.value.kelas=l),url:"kelas",label:"Kelas *",class:"q-mt-sm",rules:[l=>!!l||"Harus diisi!"]},null,8,["modelValue","rules"]),t(d,{dense:"",class:"q-mt-sm",outlined:"",label:"Nomor Absen",modelValue:e.value.no_absen,"onUpdate:modelValue":a[4]||(a[4]=l=>e.value.no_absen=l),type:"number"},null,8,["modelValue"]),t(d,{dense:"",class:"q-mt-sm",outlined:"",label:"Keterangan",modelValue:e.value.keterangan,"onUpdate:modelValue":a[5]||(a[5]=l=>e.value.keterangan=l),autogrow:""},null,8,["modelValue"])]),_:1}),t(w,{"btn-delete":!!e.value.id,onOnDelete:y},null,8,["btn-delete"])]),_:1})]),_:1})}}};export{G as _};
