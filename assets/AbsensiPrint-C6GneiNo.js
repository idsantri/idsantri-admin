import{Q as A}from"./QSpinnerCube-CuByR_Bu.js";import{A as d,U as T,J as y,f as C,o as N,b as n,e as x,w as o,ab as c,Q as i,a as u,E as I,x as f,t as V,ad as $,a5 as r,k as h,g as q,F as P}from"./index-DwrbA0R8.js";import{Q as b}from"./QSelect-CrgZ1FsI.js";import{Q as B}from"./QSpace-DIvX2TzF.js";import{Q as D}from"./QForm-DCEv1Ikv.js";import{g as w}from"./api-get-lists-8M14e61j.js";import{l as L}from"./hijri-BBdEhqDI.js";import{a as F}from"./api-download-B3pFS58W.js";import"./html2pdf-DqudkZrc.js";import"./index-B6LiMDVO.js";import{_ as J}from"./ReportViewer-25QRZbnp.js";import"./QChip-DvUCR8tL.js";import"./QItemSection-CeSY4hvW.js";import"./QItemLabel-Dzdetwv2.js";import"./QMenu-BEnErdhw.js";import"./selection-DRCgFU0J.js";import"./rtl-DFPa-2ov.js";import"./format-CJebrXOQ.js";import"./api-error-DGWaEiw1.js";import"./index-BlZcD66n.js";import"./format-number-B34ySHL_.js";import"./format-date-DlwYCgkJ.js";import"./id-BuNGTsqN.js";import"./_commonjsHelpers-CE1G-McA.js";const K={class:"row"},M={key:0},R={class:"col-12 col-md-3 q-pa-sm"},E={class:"col-12 col-md-3 q-pa-sm"},O={class:"col-12 col-md-6 q-pa-sm"},z={class:"row"},H={class:"row"},G={class:"row"},Ua={__name:"AbsensiPrint",setup(W){const p=d([]),m=d([]),a=d({absensi:"Sekolah"}),U=d([]),Q=d(L.map(s=>s.name)),t=d(!1),g=d(!1),_=d("");d([]);async function S(){const s=JSON.parse(JSON.stringify(a.value)),e="absensi-"+(s.absensi?.toLowerCase()||"")+"~"+(s.th_ajaran_h||"")+"~"+(s.tingkat_id||"")+"~"+(s.kelas||"")+"~"+(s.tahun||"")+"~"+(s.bulan?.toLowerCase()||"")+(s.pekan?"~p"+s.pekan:"");let l="";t.value?l="/reports/absensi/pekanan/download":l="/reports/absensi/bulanan/download",await F({endPoint:l,loading:g,params:s,fileName:e})}const k=d(!1);function j(){const s=new URLSearchParams(a.value).toString();let e="";t.value?e="reports/absensi/pekanan/view":e="reports/absensi/bulanan/view",_.value=`${e}?${s}`,k.value=!0}function v(s){s==1&&(isNaN(a.value.d1)||(a.value.d2=parseInt(a.value.d1)+1||"",a.value.d3=parseInt(a.value.d1)+2||"",a.value.d4=parseInt(a.value.d1)+3||"",a.value.d5=parseInt(a.value.d1)+4||"",a.value.d6=parseInt(a.value.d1)+5||"")),s==2&&(isNaN(a.value.d2)||(a.value.d3=parseInt(a.value.d2)+1||"",a.value.d4=parseInt(a.value.d2)+2||"",a.value.d5=parseInt(a.value.d2)+3||"",a.value.d6=parseInt(a.value.d2)+4||"")),s==3&&(isNaN(a.value.d3)||(a.value.d4=parseInt(a.value.d3)+1||"",a.value.d5=parseInt(a.value.d3)+2||"",a.value.d6=parseInt(a.value.d3)+3||"")),s==4&&(isNaN(a.value.d4)||(a.value.d5=parseInt(a.value.d4)+1||"",a.value.d6=parseInt(a.value.d4)+2||"")),s==5&&(isNaN(a.value.d5)||(a.value.d6=parseInt(a.value.d5)+1||""))}return T(async()=>{const s=await w({url:"murid/lists-kelas",key:"th_ajaran",loadingArray:p});m.value.th_ajaran=s}),y(()=>a.value.th_ajaran_h,async(s,e)=>{if(s!=e){a.value.tingkat_id="",a.value.kelas="",a.value.tahun="";const l=await w({url:`murid/lists-kelas/${s}`,key:"tingkat",loadingArray:p});m.value.tingkat=l,U.value=[s.substring(0,4),s.substring(5)]}}),y(()=>a.value.tingkat_id,async(s,e)=>{if(s!=e&&(a.value.kelas="",s&&a.value.th_ajaran_h)){const l=await w({url:`murid/lists-kelas/${a.value.th_ajaran_h}/${s}`,key:"kelas",loadingArray:p});m.value.kelas=l}}),(s,e)=>(N(),C(P,null,[n(f,{flat:"",bordered:"",style:{"max-width":"1000px"}},{default:o(()=>[n(D,{onSubmit:c(S,["prevent"])},{default:o(()=>[n(i,{class:"no-padding"},{default:o(()=>[u("div",K,[g.value?(N(),C("div",M,[n(I,{modelValue:g.value,"onUpdate:modelValue":e[0]||(e[0]=l=>g.value=l),persistent:""},{default:o(()=>[n(A,{color:"green-12",size:"8em",class:"flex q-ma-lg q-mx-auto"})]),_:1},8,["modelValue"])])):x("",!0),u("div",R,[n(f,{bordered:"",flat:""},{default:o(()=>[n(i,{class:"bg-green-11 q-pa-sm"},{default:o(()=>[...e[22]||(e[22]=[V(" Pilih Kelas ",-1)])]),_:1}),n(i,{class:"no-padding"},{default:o(()=>[n(b,{class:"q-pa-sm",dense:"",outlined:"",label:"Tahun Ajaran",modelValue:a.value.th_ajaran_h,"onUpdate:modelValue":e[1]||(e[1]=l=>a.value.th_ajaran_h=l),options:m.value.th_ajaran,"option-value":"th_ajaran_h","option-label":"th_ajaran_h","emit-value":"","map-options":"",loading:p.value.th_ajaran,behavior:"menu"},null,8,["modelValue","options","loading"]),n(b,{class:"q-pa-sm",dense:"",outlined:"",label:"Tingkat Pendidikan",modelValue:a.value.tingkat_id,"onUpdate:modelValue":e[2]||(e[2]=l=>a.value.tingkat_id=l),options:m.value.tingkat,"option-value":"tingkat_id","option-label":"tingkat","emit-value":"","map-options":"",loading:p.value.tingkat,clearable:"",behavior:"menu"},null,8,["modelValue","options","loading"]),n(b,{class:"q-pa-sm",dense:"",outlined:"",label:"Kelas",modelValue:a.value.kelas,"onUpdate:modelValue":e[3]||(e[3]=l=>a.value.kelas=l),options:m.value.kelas,"option-value":"kelas","option-label":"kelas","emit-value":"","map-options":"",loading:p.value.kelas,clearable:"",behavior:"menu"},null,8,["modelValue","options","loading"])]),_:1})]),_:1})]),u("div",E,[n(f,{bordered:"",flat:""},{default:o(()=>[n(i,{class:"bg-green-11 q-pa-sm"},{default:o(()=>[...e[23]||(e[23]=[V(" Atur Absensi ",-1)])]),_:1}),n(i,{class:"no-padding"},{default:o(()=>[n(b,{class:"q-pa-sm",dense:"",outlined:"",label:"Absensi",modelValue:a.value.absensi,"onUpdate:modelValue":e[4]||(e[4]=l=>a.value.absensi=l),options:["Sekolah","Musyawarah"],behavior:"menu"},null,8,["modelValue"]),n(b,{class:"q-pa-sm",dense:"",outlined:"",label:"Tahun",modelValue:a.value.tahun,"onUpdate:modelValue":e[5]||(e[5]=l=>a.value.tahun=l),options:U.value,behavior:"menu"},null,8,["modelValue","options"]),n(b,{class:"q-pa-sm",dense:"",outlined:"",label:"Bulan",modelValue:a.value.bulan,"onUpdate:modelValue":e[6]||(e[6]=l=>a.value.bulan=l),options:Q.value,clearable:"",behavior:"menu"},null,8,["modelValue","options"])]),_:1})]),_:1})]),u("div",O,[n(f,{bordered:"",flat:""},{default:o(()=>[n(i,{class:"bg-green-11 q-pa-sm"},{default:o(()=>[...e[24]||(e[24]=[V(" Atur Pekan dan Tanggal ",-1),u("small",null,[u("em",null,"(untuk absensi perpekan)")],-1)])]),_:1}),n(i,{class:"no-padding"},{default:o(()=>[u("div",z,[n($,{class:"q-pa-sm col-4",label:"Perpekan",modelValue:t.value,"onUpdate:modelValue":e[7]||(e[7]=l=>t.value=l)},null,8,["modelValue"]),n(r,{class:"q-pa-sm col-4",dense:"",outlined:"",label:"Pekan ke-?",modelValue:a.value.pekan,"onUpdate:modelValue":e[8]||(e[8]=l=>a.value.pekan=l),disable:!t.value},null,8,["modelValue","disable"])]),u("div",H,[n(r,{class:"q-pa-sm col-4",dense:"",outlined:"",label:"Sabtu Tanggal",modelValue:a.value.d1,"onUpdate:modelValue":e[9]||(e[9]=l=>a.value.d1=l),onChange:e[10]||(e[10]=l=>v(1)),disable:!t.value},null,8,["modelValue","disable"]),n(r,{class:"q-pa-sm col-4",dense:"",outlined:"",label:"Ahad Tanggal",modelValue:a.value.d2,"onUpdate:modelValue":e[11]||(e[11]=l=>a.value.d2=l),onChange:e[12]||(e[12]=l=>v(2)),disable:!t.value},null,8,["modelValue","disable"]),n(r,{class:"q-pa-sm col-4",dense:"",outlined:"",label:"Senin Tanggal",modelValue:a.value.d3,"onUpdate:modelValue":e[13]||(e[13]=l=>a.value.d3=l),onChange:e[14]||(e[14]=l=>v(3)),disable:!t.value},null,8,["modelValue","disable"])]),u("div",G,[n(r,{class:"q-pa-sm col-4",dense:"",outlined:"",label:"Selasa Tanggal",modelValue:a.value.d4,"onUpdate:modelValue":e[15]||(e[15]=l=>a.value.d4=l),onChange:e[16]||(e[16]=l=>v(4)),disable:!t.value},null,8,["modelValue","disable"]),n(r,{class:"q-pa-sm col-4",dense:"",outlined:"",label:"Rabu Tanggal",modelValue:a.value.d5,"onUpdate:modelValue":e[17]||(e[17]=l=>a.value.d5=l),onChange:e[18]||(e[18]=l=>v(5)),disable:!t.value},null,8,["modelValue","disable"]),n(r,{class:"q-pa-sm col-4",dense:"",outlined:"",label:"Kamis Tanggal",modelValue:a.value.d6,"onUpdate:modelValue":e[19]||(e[19]=l=>a.value.d6=l),onChange:e[20]||(e[20]=l=>v(6)),disable:!t.value},null,8,["modelValue","disable"])])]),_:1})]),_:1})])])]),_:1}),n(h,{class:"bg-green-7 flex"},{default:o(()=>[n(q,{label:"Cetak dengan Access",icon:"print",color:"green-10",class:"q-px-md text-green-11",dense:"","no-caps":"",to:"/info/download"}),n(B),n(q,{label:"Print",icon:"print",color:"green-11",class:"q-px-md text-green-10",dense:"","no-caps":"",onClick:j}),n(q,{type:"submit",label:"Unduh",icon:"download",color:"green-11",class:"q-px-md text-green-10",dense:"","no-caps":""})]),_:1})]),_:1})]),_:1}),n(I,{modelValue:k.value,"onUpdate:modelValue":e[21]||(e[21]=l=>k.value=l)},{default:o(()=>[n(J,{url:_.value},null,8,["url"])]),_:1},8,["modelValue"]),x("",!0)],64))}};export{Ua as default};
