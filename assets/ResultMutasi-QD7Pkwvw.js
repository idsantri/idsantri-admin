import{x as p,a4 as A,R as I,c as f,o as c,w as t,b as a,s as M,f as k,e as w,p as i,_ as b,n as U,v as _,Q as V,q as N,B as R}from"./index-Bf-p91mW.js";import{Q as y}from"./QItemLabel-sjS6zLD0.js";import{Q,a as s}from"./QItemSection-Bl4rOme3.js";import{Q as $}from"./QList-51Eu5HNp.js";import{Q as L}from"./QBtnDropdown-Br6y2eVM.js";import{Q as O,a as n}from"./QTable-De_bPsbt.js";import{Q as D}from"./QTr-D3m5hNPw.js";import{Q as r}from"./QTd-tD3oYfA5.js";import{Q as E}from"./QPage-DbeGPrD5.js";import{C as v}from"./ClosePopup-HTVnKVBl.js";import{a as H}from"./api-delete-BVHfd1pG.js";import{a as C}from"./api-get-CiRdORW1.js";import{_ as G}from"./EditMutasi-CWOUXgpV.js";import{a as K}from"./api-post-CHcQycZS.js";import{l as W}from"./loading-store-BlK5tqaZ.js";import{n as j}from"./index-BtaF3-6r.js";import{_ as z}from"./CardHeader-AnL1K4iE.js";import"./QBtnGroup-BDP931ZD.js";import"./QMenu-BvL1IfNl.js";import"./selection-CE9S_xiH.js";import"./QMarkupTable-BU6ysEzR.js";import"./QSelect-Co09SqkM.js";import"./QChip-DeZPZCXp.js";import"./rtl-DFPa-2ov.js";import"./format-CJebrXOQ.js";import"./use-fullscreen-CrpeCgX1.js";import"./index-D7WC_quC.js";import"./api-error-C0HjZ2a3.js";import"./QToolbarTitle-Bi6rSosy.js";import"./QToolbar-CUFZpZSE.js";import"./QSpace-DJeipgZa.js";import"./QInnerLoading-D-UeUIT6.js";import"./QForm-OmDQHoiq.js";import"./InputSelectArray-Jz4ksDX6.js";import"./lists-store-F5P_xNBX.js";import"./lists-data-mcTvx2m2.js";import"./DropDownAfter-wYSCUu7Z.js";import"./Lists-DSwT9YX9.js";import"./ApiCrud-SVFtkNw7.js";import"./api-update-BYe6B3v5.js";const Na={__name:"ResultMutasi",setup(F){const d=p([]),u=p(!1),g=p(!1),x=p({}),{loadingMain:q}=A(W());async function m(){const l=await C({endPoint:"mutasi",loading:u});l&&(d.value=l.mutasi.map(e=>({...e,tk:e.tingkat_id+" "+e.kelas})))}I(async()=>{await m()});async function P(l){x.value=l,g.value=!0}async function S(){await K({endPoint:"mutasi/execute",data:null,loading:u,confirm:!0,message:`<hr><span style="color:blue">Update Domisili?</span><hr>
		<em>
			<strong>Peringatan:</strong>
			<ul style="margin:0">
				<li>Pastikan semua keperluan Administrasi (terkait domisili asal) telah selesai!</li>
				<li>Sebaiknya data di-download/ diunduh terlebih dahulu sebagai backup!</li>
				<li>Setelah update selesai, semua data mutasi akan <strong>dihapus</strong>!</li>
			</ul>
		</em>`})&&await m()}async function B(){await H({endPoint:"mutasi/clean",loading:u,message:"Hapus semua data mutasi?"})&&(d.value=[])}async function T(){const l=await C({endPoint:"export/mutasi",loading:q,notify:!0});if(!l)return;if(!l.url)return j("Url tidak ditemukan");const e=document.createElement("a");e.href=l.url,e.click(),e.remove()}return(l,e)=>(c(),f(E,{class:"q-pa-sm"},{default:t(()=>[a(M,{class:""},{default:t(()=>[a(z,{title:"Data Mutasi Domisili",onOnReload:m},{right:t(()=>[a(k,{icon:"tune",label:"Atur Mutasi",dense:"",outline:"","no-caps":"",class:"q-ml-sm q-px-sm",to:"/mutasi/start"}),a(L,{flat:"",dense:"","dropdown-icon":"more_vert",class:"q-ml-sm",color:"green-11"},{default:t(()=>[a($,null,{default:t(()=>[w((c(),f(Q,{to:"/info/download"},{default:t(()=>[a(s,null,{default:t(()=>[a(y,null,{default:t(()=>[...e[1]||(e[1]=[i("Cetak",-1)])]),_:1})]),_:1}),a(s,{avatar:""},{default:t(()=>[a(b,{name:"print",flat:""})]),_:1})]),_:1})),[[v]]),w((c(),f(Q,{onClick:T,clickable:""},{default:t(()=>[a(s,null,{default:t(()=>[a(y,null,{default:t(()=>[...e[2]||(e[2]=[i("Unduh/Download",-1)])]),_:1})]),_:1}),a(s,{avatar:""},{default:t(()=>[a(b,{name:"download",flat:""})]),_:1})]),_:1})),[[v]]),w((c(),f(Q,{onClick:B,clickable:""},{default:t(()=>[a(s,null,{default:t(()=>[a(y,null,{default:t(()=>[...e[3]||(e[3]=[i("Hapus Semua",-1)])]),_:1})]),_:1}),a(s,{avatar:""},{default:t(()=>[a(b,{name:"delete_forever",flat:""})]),_:1})]),_:1})),[[v]])]),_:1})]),_:1})]),_:1}),a(U,{class:"q-pa-sm"},{default:t(()=>[a(O,{class:"q-pa-sm",rows:d.value,loading:u.value,"rows-per-page-options":[10,25,50,75,100,0],flat:"",bordered:""},{header:t(o=>[a(D,{props:o},{default:t(()=>[a(n,{key:"santri_id",props:o,class:"text-left"},{default:t(()=>[...e[4]||(e[4]=[i(" ID Santri ",-1)])]),_:1},8,["props"]),a(n,{key:"nama",props:o},{default:t(()=>[...e[5]||(e[5]=[i(" Nama ",-1)])]),_:1},8,["props"]),a(n,{key:"tk",props:o},{default:t(()=>[...e[6]||(e[6]=[i(" Tingkat â€” Kelas ",-1)])]),_:1},8,["props"]),a(n,{key:"domisili",props:o},{default:t(()=>[...e[7]||(e[7]=[i(" Domisili (Asal) ",-1)])]),_:1},8,["props"]),a(n,{key:"new_domisili",props:o},{default:t(()=>[...e[8]||(e[8]=[i(" Domisili (Baru) ",-1)])]),_:1},8,["props"]),a(n,{class:"text-center"})]),_:2},1032,["props"])]),body:t(o=>[a(D,{props:o},{default:t(()=>[a(r,{key:"santri_id",props:o,class:"text-left"},{default:t(()=>[a(k,{label:o.row.santri_id,outline:"",color:"green-10",class:"text-caption q-px-sm",dense:"",to:`/santri/${o.row.santri_id}`},null,8,["label","to"])]),_:2},1032,["props"]),a(r,{key:"nama",props:o},{default:t(()=>[i(_(o.row.nama),1)]),_:2},1032,["props"]),a(r,{key:"tk",props:o},{default:t(()=>[i(_(o.row.tk),1)]),_:2},1032,["props"]),a(r,{key:"domisili",props:o},{default:t(()=>[i(_(o.row.domisili),1)]),_:2},1032,["props"]),a(r,{key:"new_domisili",props:o},{default:t(()=>[i(_(o.row.new_domisili),1)]),_:2},1032,["props"]),a(r,{key:"id",props:o,class:"text-center"},{default:t(()=>[a(k,{icon:"edit",flat:"",color:"green-10",onClick:J=>P(o.row)},null,8,["onClick"])]),_:2},1032,["props"])]),_:2},1032,["props"])]),_:1},8,["rows","loading"])]),_:1}),a(V,{class:"q-pa-sm bg-green-7 text-green-11 row"},{default:t(()=>[e[9]||(e[9]=N("div",{class:"col text-italic"}," 1) Teliti kembali sebelum Anda menekan tombol Update; 2) Lakukan backup data dengan menekan tombol download!; ",-1)),a(k,{style:{"max-width":"150px"},class:"col bg-green-8 q-ml-md",label:"Update Domisili",glossy:"","no-caps":"",dense:"",outline:"",icon:"settings_applications",disable:!d.value.length>0,onClick:S},null,8,["disable"])]),_:1})]),_:1}),a(R,{modelValue:g.value,"onUpdate:modelValue":e[0]||(e[0]=o=>g.value=o)},{default:t(()=>[a(G,{data:x.value,api:!0,onOnDelete:m,onOnSubmit:m},null,8,["data"])]),_:1},8,["modelValue"])]),_:1}))}};export{Na as default};
