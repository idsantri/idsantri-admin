import{Q as C}from"./QSpinnerCube-Dxm5aSBA.js";import{A as d,a8 as la,ag as na,f as j,o as q,a as u,b as n,F as sa,z as ta,t as oa,w as t,y as b,Q as i,G as P,W as I,K as x,c as Q,e as S,ad as A,v as c,af as T,a7 as r,k as B,g as V}from"./index-0PBDf7I0.js";import{Q as f}from"./QSelect-Cpr8vW2V.js";import{Q as D}from"./QSpace-BYMtWShY.js";import{Q as M}from"./QForm-ieTYlGnS.js";import{g as _}from"./api-get-lists-BbchY3y_.js";import{l as E}from"./hijri-BBdEhqDI.js";import{a as F}from"./api-download-naAPvZMj.js";import{h as fa}from"./html2pdf-Cxj3C399.js";import{d as ba}from"./index-BDNa_dSq.js";import{l as ca}from"./loading-store-DRDFBxcW.js";import{a as L}from"./api-get-CJU_3mwN.js";import{_ as R}from"./ReportViewer-DaVvWWjD.js";import"./QChip-DG5_EyRB.js";import"./QItemSection-DpSW8XO7.js";import"./QItemLabel-DR97WW3U.js";import"./QMenu-3oalsLjd.js";import"./selection-DeDWR_N3.js";import"./rtl-DFPa-2ov.js";import"./format-CJebrXOQ.js";import"./index-BXLuJznK.js";import"./api-error-C1WPqECD.js";import"./format-number-B34ySHL_.js";import"./format-date-DlwYCgkJ.js";import"./id-BuNGTsqN.js";import"./_commonjsHelpers-CE1G-McA.js";const K={class:"row"},z={key:0},G={class:"col-12 col-md-3 q-pa-sm"},J={class:"col-12 col-md-3 q-pa-sm"},O={class:"col-12 col-md-6 q-pa-sm"},H={class:"row"},W={class:"row"},X={class:"row"};const Qa={__name:"AbsensiPrint",setup(Y){const m=d([]),p=d([]),a=d({absensi:"Sekolah"}),h=d([]),$=d(E.map(s=>s.name)),o=d(!1),g=d(!1),y=d(""),w=d([]);async function Z(){w.value=[];const s=await L({loading:g,endPoint:`murid/${a.value.th_ajaran_h}/${a.value.tingkat_id}${a.value.kelas?"/"+a.value.kelas:""}`});w.value=s.murid}async function N(){const s=JSON.parse(JSON.stringify(a.value)),e="absensi-"+(s.absensi?.toLowerCase()||"")+"~"+(s.th_ajaran_h||"")+"~"+(s.tingkat_id||"")+"~"+(s.kelas||"")+"~"+(s.tahun||"")+"~"+(s.bulan?.toLowerCase()||"")+(s.pekan?"~p"+s.pekan:"");let l="";o.value?l="/reports/absensi/pekanan/download":l="/reports/absensi/bulanan/download",await F({endPoint:l,loading:g,params:s,fileName:e})}const k=d(!1);function U(){const s=new URLSearchParams(a.value).toString();let e="";o.value?e="reports/absensi/pekanan/view":e="reports/absensi/bulanan/view",y.value=`${e}?${s}`,k.value=!0}function v(s){s==1&&(isNaN(a.value.d1)||(a.value.d2=parseInt(a.value.d1)+1||"",a.value.d3=parseInt(a.value.d1)+2||"",a.value.d4=parseInt(a.value.d1)+3||"",a.value.d5=parseInt(a.value.d1)+4||"",a.value.d6=parseInt(a.value.d1)+5||"")),s==2&&(isNaN(a.value.d2)||(a.value.d3=parseInt(a.value.d2)+1||"",a.value.d4=parseInt(a.value.d2)+2||"",a.value.d5=parseInt(a.value.d2)+3||"",a.value.d6=parseInt(a.value.d2)+4||"")),s==3&&(isNaN(a.value.d3)||(a.value.d4=parseInt(a.value.d3)+1||"",a.value.d5=parseInt(a.value.d3)+2||"",a.value.d6=parseInt(a.value.d3)+3||"")),s==4&&(isNaN(a.value.d4)||(a.value.d5=parseInt(a.value.d4)+1||"",a.value.d6=parseInt(a.value.d4)+2||"")),s==5&&(isNaN(a.value.d5)||(a.value.d6=parseInt(a.value.d5)+1||""))}return I(async()=>{const s=await _({url:"murid/lists-kelas",key:"th_ajaran",loadingArray:m});p.value.th_ajaran=s}),x(()=>a.value.th_ajaran_h,async(s,e)=>{if(s!=e){a.value.tingkat_id="",a.value.kelas="",a.value.tahun="";const l=await _({url:`murid/lists-kelas/${s}`,key:"tingkat",loadingArray:m});p.value.tingkat=l,h.value=[s.substring(0,4),s.substring(5)]}}),x(()=>a.value.tingkat_id,async(s,e)=>{if(s!=e&&(a.value.kelas="",s&&a.value.th_ajaran_h)){const l=await _({url:`murid/lists-kelas/${a.value.th_ajaran_h}/${s}`,key:"kelas",loadingArray:m});p.value.kelas=l}}),(s,e)=>(q(),Q(b,{flat:"",bordered:"",style:{"max-width":"1000px"}},{default:t(()=>[n(M,{onSubmit:A(N,["prevent"])},{default:t(()=>[n(i,{class:"no-padding"},{default:t(()=>[u("div",K,[g.value?(q(),j("div",z,[n(P,{modelValue:g.value,"onUpdate:modelValue":e[0]||(e[0]=l=>g.value=l),persistent:""},{default:t(()=>[n(C,{color:"green-12",size:"8em",class:"flex q-ma-lg q-mx-auto"})]),_:1},8,["modelValue"])])):S("",!0),u("div",G,[n(b,{bordered:"",flat:""},{default:t(()=>[n(i,{class:"bg-green-11 q-pa-sm"},{default:t(()=>[...e[22]||(e[22]=[c(" Pilih Kelas ",-1)])]),_:1}),n(i,{class:"no-padding"},{default:t(()=>[n(f,{class:"q-pa-sm",dense:"",outlined:"",label:"Tahun Ajaran",modelValue:a.value.th_ajaran_h,"onUpdate:modelValue":e[1]||(e[1]=l=>a.value.th_ajaran_h=l),options:p.value.th_ajaran,"option-value":"th_ajaran_h","option-label":"th_ajaran_h","emit-value":"","map-options":"",loading:m.value.th_ajaran,behavior:"menu"},null,8,["modelValue","options","loading"]),n(f,{class:"q-pa-sm",dense:"",outlined:"",label:"Tingkat Pendidikan",modelValue:a.value.tingkat_id,"onUpdate:modelValue":e[2]||(e[2]=l=>a.value.tingkat_id=l),options:p.value.tingkat,"option-value":"tingkat_id","option-label":"tingkat","emit-value":"","map-options":"",loading:m.value.tingkat,clearable:"",behavior:"menu"},null,8,["modelValue","options","loading"]),n(f,{class:"q-pa-sm",dense:"",outlined:"",label:"Kelas",modelValue:a.value.kelas,"onUpdate:modelValue":e[3]||(e[3]=l=>a.value.kelas=l),options:p.value.kelas,"option-value":"kelas","option-label":"kelas","emit-value":"","map-options":"",loading:m.value.kelas,clearable:"",behavior:"menu"},null,8,["modelValue","options","loading"])]),_:1})]),_:1})]),u("div",J,[n(b,{bordered:"",flat:""},{default:t(()=>[n(i,{class:"bg-green-11 q-pa-sm"},{default:t(()=>[...e[23]||(e[23]=[c(" Atur Absensi ",-1)])]),_:1}),n(i,{class:"no-padding"},{default:t(()=>[n(f,{class:"q-pa-sm",dense:"",outlined:"",label:"Absensi",modelValue:a.value.absensi,"onUpdate:modelValue":e[4]||(e[4]=l=>a.value.absensi=l),options:["Sekolah","Musyawarah"],behavior:"menu"},null,8,["modelValue"]),n(f,{class:"q-pa-sm",dense:"",outlined:"",label:"Tahun",modelValue:a.value.tahun,"onUpdate:modelValue":e[5]||(e[5]=l=>a.value.tahun=l),options:h.value,behavior:"menu"},null,8,["modelValue","options"]),n(f,{class:"q-pa-sm",dense:"",outlined:"",label:"Bulan",modelValue:a.value.bulan,"onUpdate:modelValue":e[6]||(e[6]=l=>a.value.bulan=l),options:$.value,clearable:"",behavior:"menu"},null,8,["modelValue","options"])]),_:1})]),_:1})]),u("div",O,[n(b,{bordered:"",flat:""},{default:t(()=>[n(i,{class:"bg-green-11 q-pa-sm"},{default:t(()=>[...e[24]||(e[24]=[c(" Atur Pekan dan Tanggal ",-1),u("small",null,[u("em",null,"(untuk absensi perpekan)")],-1)])]),_:1}),n(i,{class:"no-padding"},{default:t(()=>[u("div",H,[n(T,{class:"q-pa-sm col-4",label:"Perpekan",modelValue:o.value,"onUpdate:modelValue":e[7]||(e[7]=l=>o.value=l)},null,8,["modelValue"]),n(r,{class:"q-pa-sm col-4",dense:"",outlined:"",label:"Pekan ke-?",modelValue:a.value.pekan,"onUpdate:modelValue":e[8]||(e[8]=l=>a.value.pekan=l),disable:!o.value},null,8,["modelValue","disable"])]),u("div",W,[n(r,{class:"q-pa-sm col-4",dense:"",outlined:"",label:"Sabtu Tanggal",modelValue:a.value.d1,"onUpdate:modelValue":e[9]||(e[9]=l=>a.value.d1=l),onChange:e[10]||(e[10]=l=>v(1)),disable:!o.value},null,8,["modelValue","disable"]),n(r,{class:"q-pa-sm col-4",dense:"",outlined:"",label:"Ahad Tanggal",modelValue:a.value.d2,"onUpdate:modelValue":e[11]||(e[11]=l=>a.value.d2=l),onChange:e[12]||(e[12]=l=>v(2)),disable:!o.value},null,8,["modelValue","disable"]),n(r,{class:"q-pa-sm col-4",dense:"",outlined:"",label:"Senin Tanggal",modelValue:a.value.d3,"onUpdate:modelValue":e[13]||(e[13]=l=>a.value.d3=l),onChange:e[14]||(e[14]=l=>v(3)),disable:!o.value},null,8,["modelValue","disable"])]),u("div",X,[n(r,{class:"q-pa-sm col-4",dense:"",outlined:"",label:"Selasa Tanggal",modelValue:a.value.d4,"onUpdate:modelValue":e[15]||(e[15]=l=>a.value.d4=l),onChange:e[16]||(e[16]=l=>v(4)),disable:!o.value},null,8,["modelValue","disable"]),n(r,{class:"q-pa-sm col-4",dense:"",outlined:"",label:"Rabu Tanggal",modelValue:a.value.d5,"onUpdate:modelValue":e[17]||(e[17]=l=>a.value.d5=l),onChange:e[18]||(e[18]=l=>v(5)),disable:!o.value},null,8,["modelValue","disable"]),n(r,{class:"q-pa-sm col-4",dense:"",outlined:"",label:"Kamis Tanggal",modelValue:a.value.d6,"onUpdate:modelValue":e[19]||(e[19]=l=>a.value.d6=l),onChange:e[20]||(e[20]=l=>v(6)),disable:!o.value},null,8,["modelValue","disable"])])]),_:1})]),_:1})])])]),_:1}),n(B,{class:"bg-green-7 flex"},{default:t(()=>[n(V,{label:"Cetak dengan Access",icon:"print",color:"green-10",class:"q-px-md text-green-11",dense:"","no-caps":"",to:"/info/download"}),n(D),n(V,{label:"Print",icon:"print",color:"green-11",class:"q-px-md text-green-10",dense:"","no-caps":"",onClick:U}),n(V,{type:"submit",label:"Unduh",icon:"download",color:"green-11",class:"q-px-md text-green-10",dense:"","no-caps":""})]),_:1})]),_:1}),n(P,{modelValue:k.value,"onUpdate:modelValue":e[21]||(e[21]=l=>k.value=l)},{default:t(()=>[n(R,{url:y.value},null,8,["url"])]),_:1},8,["modelValue"]),S("",!0)]),_:1}))}};export{Qa as default};
