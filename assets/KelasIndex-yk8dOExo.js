import{q as c,ah as O,c as u,o as i,w as a,g as t,Q as S,a as r,e as x,bO as A,v as I,b as Q,t as n,G as R,C as j,l as q,ad as M,s as z,E as $,aq as P,J as U}from"./index-DutRA_CO.js";import{Q as W}from"./QSpace-RyUqKbav.js";import{Q as h}from"./QMarkupTable-soH4YcMw.js";import{Q as V}from"./QRouteTab-C-5MWmPO.js";import{Q as H}from"./QTabs-Bk8DSaVR.js";import{Q as v}from"./QSkeleton-DR1gHoWS.js";import{Q as G}from"./QImg-D00gkuds.js";import{Q as D,a as p}from"./QItem-qGBVeF8-.js";import{Q as g}from"./QItemLabel-WimR8O_E.js";import{Q as J}from"./QList-Ht0U1kJ0.js";import{s as b}from"./santri-store-DZ0WB9jQ.js";import{S as Y}from"./Santri-DPVpRR6s.js";import{d as F}from"./format-date-DBaFa2rd.js";import{_ as X}from"./KelasForm-BDjb28WC.js";import{K}from"./Kelas-78SoOI7m.js";import"./QResizeObserver-B7htWBfh.js";import"./rtl-DFPa-2ov.js";import"./ApiCrud-CZFmsy5d.js";import"./Api-AjNxW92f.js";import"./index-BAyNzCk6.js";import"./index-Cpf3S9fo.js";import"./apiPost-BTbDNFlR.js";import"./id-BuNGTsqN.js";import"./QForm-DRzvYkEB.js";import"./InputSelectArray-5WdULfX-.js";import"./QSelect-LIcm9uTB.js";import"./QField-BhEqSw-i.js";import"./QChip-D_SQIzNi.js";import"./QMenu-JGhTZEq-.js";import"./selection-BSDJEjKX.js";import"./format-CJebrXOQ.js";import"./lists-store-NC8-X11g.js";import"./ArrayCrud-CByp4EUn.js";import"./DropDownAfter-8SRzBjks.js";import"./QBtnDropdown-DEivjYd9.js";import"./QBtnGroup-_ujcPxic.js";import"./ClosePopup-RQcL-rG0.js";import"./Lists-CyIViPOd.js";import"./InputSelectTingkatPendidikan-BEo5P2Hh.js";import"./useCrudForm-L8fi9UCL.js";import"./InputSelectTahunAjaran-X3PCVqmO.js";const Z={key:1},tt={key:1},at={key:1},et={key:1},lt={key:1},rt={__name:"CardSantri",props:{id:{type:[Number,String],validator(d){if(typeof d=="number")return!isNaN(d);if(typeof d=="string"){const k=Number(d);return!isNaN(k)}return!1}}},emits:["loaded"],setup(d,{emit:k}){const T=k,_=d,l=c(!1),o=c({}),y=c({}),w=c({}),C=async()=>{try{l.value=!0;const m=await Y.getById({id:_.id});o.value=m.santri,w.value=m.wali,y.value=m.ortu,b().setSantri(m.santri),b().setOrtu(m.ortu),b().setWali(m.wali)}catch(m){console.error("Error loading santri data:",m)}finally{l.value=!1}};return O(async()=>{if(_.id){const m=b().getSantri,s=b().getWali,e=b().getOrtu;m.id==_.id?(o.value=m,y.value=e,w.value=s):await C(),T("loaded",o.value)}}),(m,s)=>(i(),u(q,{flat:"",bordered:""},{default:a(()=>[t(S,{class:"q-pa-sm bg-green-1 flex items-center justify-between"},{default:a(()=>[s[0]||(s[0]=r("div",{class:"text-subtitle2"},"Identitas Santri",-1)),t(x,{icon:"sync",flat:"",dense:"",onClick:C})]),_:1}),t(S,{class:"q-py-sm q-px-none"},{default:a(()=>[t(J,{dense:""},{default:a(()=>[t(D,null,{default:a(()=>[t(p,{avatar:""},{default:a(()=>[l.value||!d.id?(i(),u(v,{key:0,type:"QAvatar"})):(i(),u(A,{key:1,class:"d-flex"},{default:a(()=>[t(G,{src:o.value?.image_url||"/user-default.png",ratio:1,cover:""},null,8,["src"])]),_:1}))]),_:1}),t(p,null,{default:a(()=>[t(g,{overline:""},{default:a(()=>[...s[1]||(s[1]=[I(" Santri ",-1)])]),_:1}),t(g,null,{default:a(()=>[l.value||!d.id?(i(),u(v,{key:0,type:"text"})):(i(),Q("div",Z,n(o.value.nama)+" ("+n(o.value.sex)+"; "+n(o.value.tgl_lahir?R(F)(o.value.tgl_lahir):"?")+" tahun) ",1))]),_:1}),t(g,{caption:"",lines:"1"},{default:a(()=>[l.value||!d.id?(i(),u(v,{key:0,type:"text"})):(i(),Q("div",tt,n(o.value?.alamat_pendek||"-"),1))]),_:1}),t(g,{caption:"",lines:"1",class:"text-italic"},{default:a(()=>[l.value||!d.id?(i(),u(v,{key:0,type:"text"})):(i(),Q("div",at,n(o.value?.data_akhir||"-"),1))]),_:1})]),_:1}),t(p,{avatar:""},{default:a(()=>[l.value||!d.id?(i(),u(v,{key:0,type:"QBtn",class:"full-width"})):(i(),u(x,{key:1,outline:"",color:"green",to:`/santri/${o.value?.id}`},{default:a(()=>[r("small",null,n(o.value?.id),1)]),_:1},8,["to"]))]),_:1})]),_:1}),t(j,{inset:"item"}),t(D,null,{default:a(()=>[t(p,{top:"",avatar:""},{default:a(()=>[t(A)]),_:1}),t(p,null,{default:a(()=>[t(g,{overline:""},{default:a(()=>[...s[2]||(s[2]=[I(" Wali ",-1)])]),_:1}),t(g,null,{default:a(()=>[l.value||!d.id?(i(),u(v,{key:0,type:"text"})):(i(),Q("div",et,n(w.value?.nama)+" ("+n(w.value?.sex)+"; "+n(o.value?.wali_status)+")",1))]),_:1})]),_:1}),t(p,{avatar:""},{default:a(()=>[l.value||!d.id?(i(),u(v,{key:0,type:"QBtn",class:"full-width"})):(i(),u(x,{key:1,outline:"",color:"green",to:`/wali/${o.value?.wali_id}`},{default:a(()=>[r("small",null,n(o.value?.wali_id),1)]),_:1},8,["to"]))]),_:1})]),_:1}),t(j,{inset:"item"}),t(D,null,{default:a(()=>[t(p,{top:"",avatar:""},{default:a(()=>[t(A)]),_:1}),t(p,null,{default:a(()=>[t(g,{overline:""},{default:a(()=>[...s[3]||(s[3]=[I(" Orang Tua ",-1)])]),_:1}),t(g,null,{default:a(()=>[l.value||!d.id?(i(),u(v,{key:0,type:"text"})):(i(),Q("div",lt,n(y.value?.ayah)+" | "+n(y.value?.ibu),1))]),_:1})]),_:1}),t(p,{avatar:""},{default:a(()=>[l.value||!d.id?(i(),u(v,{key:0,type:"QBtn",class:"full-width"})):(i(),u(x,{key:1,outline:"",color:"green",to:`/ortu/${o.value?.ortu_id}`},{default:a(()=>[r("small",null,n(o.value?.ortu_id),1)]),_:1},8,["to"]))]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}))}},it={class:"tw:w-full"},ot={class:"tw:w-full"},Gt={__name:"KelasIndex",setup(d){const k=c(0),_=M().params.id,l=c({}),o=c(!1),y=c(!1),w=c({});async function C(s){const e=s==1,N=s==1?0:1;try{await K.updateAktif(_,e)}catch(B){l.value.aktif=N,console.error("ðŸš€ ~ updateAktif ~ error:",B)}}async function m(){try{o.value=!0;const s=await K.getById({id:_});l.value=s.kelas}catch(s){console.error("ðŸš€ ~ loadData ~ error:",s)}finally{o.value=!1}}return z(async()=>{await m()}),(s,e)=>{const N=$("CardHeader"),B=$("CardLoading"),E=$("router-view"),L=$("CardPage");return i(),u(L,null,{default:a(()=>[t(N,{title:"Data Murid",onOnReload:m}),t(S,{class:"tw:grid tw:sm:flex tw:sm:justify-between tw:gap-2 q-pa-sm",style:{"max-width":"1400px"}},{default:a(()=>[r("div",it,[t(q,{bordered:"",flat:""},{default:a(()=>[t(rt,{id:l.value.santri_id,onLoaded:e[0]||(e[0]=f=>w.value=f)},null,8,["id"])]),_:1}),t(q,{class:"q-mt-sm",bordered:"",flat:""},{default:a(()=>[t(B,{showing:o.value},null,8,["showing"]),t(S,{class:"q-pa-sm bg-green-1 flex items-center justify-between"},{default:a(()=>[e[6]||(e[6]=r("div",{class:"text-subtitle2"},"Data Kelas",-1)),t(W),t(x,{class:"q-px-md",outline:"",dense:"","icon-right":"edit",onClick:e[1]||(e[1]=f=>y.value=!0),label:"Edit","no-caps":""})]),_:1}),t(h,{flat:"",class:"q-pa-sm"},{default:a(()=>[r("tbody",null,[r("tr",null,[e[7]||(e[7]=r("td",{class:"text-italic"},"Tahun Ajaran",-1)),r("td",null,n(l.value.th_ajaran_h+" | "+l.value.th_ajaran_m),1)]),r("tr",null,[e[8]||(e[8]=r("td",{class:"text-italic"},"Tingkat",-1)),r("td",null,n(l.value.tingkat),1)]),r("tr",null,[e[9]||(e[9]=r("td",{class:"text-italic"},"Kelas",-1)),r("td",null,n(l.value.kelas),1)]),r("tr",null,[e[10]||(e[10]=r("td",{class:"text-italic"},"Nomor Absen",-1)),r("td",null,n(l.value.no_absen),1)]),r("tr",null,[e[11]||(e[11]=r("td",{class:"text-italic"},"Aktif",-1)),r("td",null,[t(P,{modelValue:l.value.aktif,"onUpdate:modelValue":[e[2]||(e[2]=f=>l.value.aktif=f),C],color:"green","true-value":1,"false-value":0},null,8,["modelValue"])])]),r("tr",null,[e[12]||(e[12]=r("td",{class:"text-italic"},"Keterangan",-1)),r("td",null,n(l.value.keterangan),1)])])]),_:1})]),_:1})]),r("div",ot,[t(q,{bordered:"",flat:""},{default:a(()=>[t(H,{"no-caps":"","outside-arrows":"","mobile-arrows":"",class:"bg-green-7 text-green-3","indicator-color":"green-11","active-color":"green-11"},{default:a(()=>[t(V,{name:"riwayat",label:"Riwayat",to:`/madrasah/kelas/${l.value.id}/riwayat`,replace:""},null,8,["to"]),t(V,{name:"izin",label:"Izin",to:`/madrasah/kelas/${l.value.id}/izin`,replace:""},null,8,["to"]),t(V,{name:"nilai",label:"Nilai Mapel",to:`/madrasah/kelas/${l.value.id}/nilai-mapel`,replace:""},null,8,["to"])]),_:1}),(i(),u(S,{class:"q-pa-sm",key:k.value},{default:a(()=>[(i(),u(E,{key:s.$route.fullPath,santri_id:l.value.santri_id},null,8,["santri_id"]))]),_:1}))]),_:1})])]),_:1}),t(U,{modelValue:y.value,"onUpdate:modelValue":e[5]||(e[5]=f=>y.value=f)},{default:a(()=>[t(X,{data:l.value,onSuccessUpdate:e[3]||(e[3]=f=>{l.value=f,k.value++}),onSuccessDelete:e[4]||(e[4]=f=>s.$router.go(-1))},null,8,["data"])]),_:1},8,["modelValue"])]),_:1})}}};export{Gt as default};
