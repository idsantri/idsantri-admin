import{A as u,K as M,B as U,c as T,o as G,w as l,b as a,ad as j,e as O,C as _,Q as $,a7 as k,y as I,a as F,W as H,g as D,v as c,t as f,a3 as J,G as N}from"./index-Bjf6jOrL.js";import{Q as i}from"./QTd-DUNgUIwQ.js";import{Q as L}from"./QTr-Dc0P-ko4.js";import{Q as R}from"./QTable-CO9G8_fV.js";import{Q as P}from"./QPage-CdhCNm0R.js";import{d as S}from"./format-number-B34ySHL_.js";import{Q as W}from"./QSelect-BCDk0qVl.js";import{Q as z}from"./QForm-CQ61mLzh.js";import{_ as E}from"./InputCurrency-B2DtLOoj.js";import{u as X}from"./useCrudForm-D9Qtfi7L.js";import{A as Y}from"./ApiCrud-Cz799mD5.js";import{U as Z}from"./UgtGt-CjsAxFTY.js";import{_ as h}from"./ReportViewer-LM4oNrBP.js";import{c as ee}from"./format-date-DlwYCgkJ.js";import{_ as ae}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./QList-DrJ2aexG.js";import"./QMarkupTable-DhfjFCDy.js";import"./use-fullscreen-CRS_nenH.js";import"./QChip-CKBUwVMq.js";import"./QItemSection-D4HO8eJd.js";import"./QItemLabel-Clz1Xits.js";import"./QMenu-DO2tkYnP.js";import"./selection-C-yT_gHt.js";import"./rtl-DFPa-2ov.js";import"./format-CJebrXOQ.js";import"./Api-v4AqqFFf.js";import"./index-BRCx2Z00.js";import"./index-DV84x6RN.js";import"./api-error-C_UMNjEa.js";import"./id-BuNGTsqN.js";class le extends Y{constructor(){super("ugt/kas")}}const A=new le,te={__name:"UgtKasForm",props:{data:Object},emits:["successDelete","successSubmit","successUpdate","successCreate"],setup(C,{emit:V}){const m=C,v=V,t=u({keperluan:"Biaya Administrasi GT",keterangan:"Lunas",flag:"+",...m.data}),p=u(!1),d=u({}),g=!m.data?.id,{handleDelete:K,handleCreate:b,handleUpdate:Q,loading:w}=X(A,{emit:v,responseKey:"kas"}),q=async()=>{const r=JSON.parse(JSON.stringify(t.value));return delete r.id,g?await b(r,!0):await Q(m.data.id,r,!0)},o=async()=>await K(m.data.id);async function n(r){try{p.value=!0;const e=await Z.getById({id:r,notifySuccess:!1});d.value=e.gt}catch{d.value.nama="Data tidak ditemukan",d.value.pjgt_nama="Data tidak ditemukan"}finally{p.value=!1}}return M(()=>t.value.gt_id,async(r,e)=>{d.value.nama="",d.value.pjgt_nama="",r!=e&&await n(r)},{immediate:!0}),(r,e)=>{const y=U("FormHeader"),x=U("FormLoading"),B=U("FormActions");return G(),T(I,{class:"full-width",style:{"max-width":"425px"}},{default:l(()=>[a(z,{onSubmit:j(q,["prevent"])},{default:l(()=>[a(y,{title:"Input Kas UGT","is-new":g}),_(w)?(G(),T(x,{key:0})):O("",!0),a($,{class:"q-pa-sm"},{default:l(()=>[a(k,{dense:"",hint:"Diisi oleh sistem",class:"",outlined:"",label:"ID",modelValue:t.value.id,"onUpdate:modelValue":e[0]||(e[0]=s=>t.value.id=s),disable:"",filled:""},null,8,["modelValue"]),a(I,{class:"q-my-sm",flat:"",bordered:""},{default:l(()=>[a($,{class:"q-pa-sm"},{default:l(()=>[e[8]||(e[8]=F("div",{class:"text-caption"},"Jika terkait dengan administrasi GT",-1)),a(k,{dense:"",class:"q-my-sm",outlined:"",label:"GT ID",modelValue:t.value.gt_id,"onUpdate:modelValue":e[1]||(e[1]=s=>t.value.gt_id=s),clearable:"",debounce:"500"},null,8,["modelValue"]),a(k,{dense:"",class:"q-my-sm",outlined:"",label:"Nama GT",modelValue:d.value.nama,"onUpdate:modelValue":e[2]||(e[2]=s=>d.value.nama=s),disable:"",filled:"",loading:p.value},null,8,["modelValue","loading"]),a(k,{dense:"",class:"q-my-sm",outlined:"",label:"Nama PJGT",modelValue:d.value.pjgt_nama,"onUpdate:modelValue":e[3]||(e[3]=s=>d.value.pjgt_nama=s),disable:"",filled:"",loading:p.value},null,8,["modelValue","loading"])]),_:1})]),_:1}),a(k,{dense:"",class:"q-my-sm",outlined:"",label:"Keperluan",modelValue:t.value.keperluan,"onUpdate:modelValue":e[4]||(e[4]=s=>t.value.keperluan=s)},null,8,["modelValue"]),a(W,{dense:"",class:"q-my-sm",outlined:"",label:"Kas Masuk/Keluar",modelValue:t.value.flag,"onUpdate:modelValue":e[5]||(e[5]=s=>t.value.flag=s),options:[{value:"+",label:"Masuk"},{value:"-",label:"Keluar"}],"emit-value":"","map-options":"","error-color":"negative",behavior:"menu"},null,8,["modelValue"]),a(E,{dense:"",class:"q-my-sm",outlined:"",modelValue:t.value.nominal,"onUpdate:modelValue":e[6]||(e[6]=s=>t.value.nominal=s),required:"",label:"Nominal"},null,8,["modelValue"]),a(k,{dense:"",class:"q-my-sm",outlined:"",label:"Keterangan",modelValue:t.value.keterangan,"onUpdate:modelValue":e[7]||(e[7]=s=>t.value.keterangan=s),autogrow:""},null,8,["modelValue"])]),_:1}),a(B,{"btn-delete":!g,onOnDelete:o},null,8,["btn-delete"])]),_:1})]),_:1})}}},ne={class:"q-gutter-sm"},oe={__name:"KasIndex",setup(C){const V=u([]),m=u(!1),v=u(""),t=u(!1),p=u({}),d=u("");async function g(){try{m.value=!0;const o=await A.getAll();V.value=o.kas}catch{console.log("error get kas ugt")}finally{m.value=!1}}function K(){p.value={},t.value=!0}const b=u(!1);async function Q(o){d.value=`reports/ugt/kuitansi/view?id=${o.id}`,b.value=!0}function w(o){const n=o.masuk?"+":"-",r=o.masuk||o.keluar,e={id:o.id,gt_id:o.gt_id,keperluan:o.keperluan,keterangan:o.keterangan,flag:n,nominal:r};p.value=e,t.value=!0}H(async()=>{await g()});const q=[{name:"id",label:"ID",align:"left",field:"id",sortable:!0},{name:"tgl_m",label:"Tanggal",align:"left",field:"tgl_m",sortable:!0},{name:"keperluan",label:"Keperluan",align:"left",field:"keperluan",sortable:!0},{name:"keterangan",label:"Keterangan",align:"left",field:"keterangan",sortable:!0},{name:"masuk",label:"Masuk",align:"right",field:"masuk",sortable:!0},{name:"keluar",label:"Keluar",align:"right",field:"keluar",sortable:!0},{name:"saldo",label:"Saldo",align:"right",field:"saldo",sortable:!0},{name:"cr_by",label:"By",align:"left",field:"cr_by",sortable:!0},{name:"edit",label:"!",align:"center",field:"",sortable:!1}];return(o,n)=>{const r=U("CardHeader");return G(),T(P,{class:"q-pa-sm"},{default:l(()=>[a(I,{class:""},{default:l(()=>[a(r,{title:"Kas UGT",onOnReload:g},{right:l(()=>[a(D,{dense:"",class:"q-px-md q-ml-sm text-green-10",label:"Tambah","no-caps":"",icon:"add",color:"green-2",onClick:K})]),_:1}),a($,{class:"no-padding"},{default:l(()=>[a(R,{rows:V.value,loading:m.value,"rows-per-page-options":[10,25,50,100,0],pagination:{page:999},class:"dt q-px-sm",columns:q,filter:v.value,"no-data-label":"Tidak ada data untuk ditampilkan!","no-results-label":"Tidak ditemukan kata kunci yang sesuai dengan pencarian Anda!","row-key":"name",onRowClick:n[1]||(n[1]=(e,y,x)=>w(e,y,x))},{"top-right":l(()=>[a(k,{outlined:"",dense:"",debounce:"300",modelValue:v.value,"onUpdate:modelValue":n[0]||(n[0]=e=>v.value=e),placeholder:"Cari"},{append:l(()=>[a(J,{name:"search"})]),_:1},8,["modelValue"])]),body:l(e=>[a(L,{props:e},{default:l(()=>[a(i,{key:"id",props:e},{default:l(()=>[c(f(e.row.id),1)]),_:2},1032,["props"]),a(i,{key:"tgl_m",props:e,title:"format tanggal dd/mm/yyyy"},{default:l(()=>[c(f(_(ee)(e.row.tgl_m,"dd/MM/yyyy")),1)]),_:2},1032,["props"]),a(i,{key:"keperluan",props:e},{default:l(()=>[c(f(e.row.gt_id?`${e.row.keperluan} (${e.row.gt_id})`:e.row.keperluan),1)]),_:2},1032,["props"]),a(i,{key:"keterangan",props:e},{default:l(()=>[c(f(e.row.keterangan),1)]),_:2},1032,["props"]),a(i,{key:"masuk",props:e},{default:l(()=>[c(f(_(S)(e.row.masuk)),1)]),_:2},1032,["props"]),a(i,{key:"keluar",props:e},{default:l(()=>[c(f(_(S)(e.row.keluar)),1)]),_:2},1032,["props"]),a(i,{key:"saldo",props:e},{default:l(()=>[c(f(_(S)(e.row.saldo)),1)]),_:2},1032,["props"]),a(i,{key:"cr_by",props:e},{default:l(()=>[c(f(e.row.cr_by),1)]),_:2},1032,["props"]),a(i,{key:"edit",props:e},{default:l(()=>[F("div",ne,[a(D,{icon:"edit","no-caps":"",color:"green-10",outline:"",dense:"",class:"q-px-md",onClick:y=>w(e.row)},null,8,["onClick"]),a(D,{icon:"print","no-caps":"",color:"green-10",outline:"",dense:"",class:"q-px-md",onClick:y=>Q(e.row),disable:!e.row.gt_id},null,8,["onClick","disable"])])]),_:2},1032,["props"])]),_:2},1032,["props"])]),_:1},8,["rows","loading","filter"])]),_:1})]),_:1}),a(N,{persistent:"",modelValue:t.value,"onUpdate:modelValue":n[4]||(n[4]=e=>t.value=e)},{default:l(()=>[a(te,{data:p.value,onSuccessSubmit:n[2]||(n[2]=e=>g()),onSuccessDelete:n[3]||(n[3]=e=>g())},null,8,["data"])]),_:1},8,["modelValue"]),a(N,{modelValue:b.value,"onUpdate:modelValue":n[5]||(n[5]=e=>b.value=e)},{default:l(()=>[a(h,{url:d.value},null,8,["url"])]),_:1},8,["modelValue"])]),_:1})}}},Fe=ae(oe,[["__scopeId","data-v-03cd9c81"]]);export{Fe as default};
