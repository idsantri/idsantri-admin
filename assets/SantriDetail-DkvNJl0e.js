import{Q as j}from"./QSpace-BYMtWShY.js";import{c as g,o as d,w as e,b as a,Q,a as c,t as L,f as x,r as ea,F as G,z as ta,y as B,A as V,B as la,l as w,v as $,a3 as A,a9 as na,W as H,ad as oa,e as sa,G as F,a7 as U,C as q,k as ia,g as p,a8 as X,ab as Y,ac as ra,q as M}from"./index-0PBDf7I0.js";import{Q as ua}from"./QPage-B2JjDCGV.js";import{f as J}from"./format-date-DlwYCgkJ.js";import{_ as da}from"./CardColumn-CMOvZTMP.js";import{Q as O}from"./QSpinnerCube-Dxm5aSBA.js";import{Q as ma}from"./QImg-BtLhfr-G.js";import{_ as pa}from"./ImageUploader-DcjShdbY.js";import{s as y}from"./santri-store-BL0UX-pe.js";import{b as fa}from"./hijri-BBdEhqDI.js";import{Q as h}from"./QRouteTab-C5IFMv6O.js";import{Q as S}from"./QItemLabel-DR97WW3U.js";import{Q as I,a as r}from"./QItemSection-DpSW8XO7.js";import{Q as Z}from"./QList-BR1VLd4M.js";import{Q as aa}from"./QBtnDropdown-CEycuZRG.js";import{Q as ca}from"./QTabs-DQ3kVZ7f.js";import{C as k}from"./ClosePopup-5qpDiF0T.js";import{d as ga}from"./dialog-store-CMavKrro.js";import{a as va}from"./api-get-CJU_3mwN.js";import{a as N}from"./api-download-naAPvZMj.js";import{_ as _a}from"./ReportViewer-DaVvWWjD.js";import{Q as R}from"./QSelect-Cpr8vW2V.js";import{Q as ba}from"./QForm-ieTYlGnS.js";import{_ as wa}from"./FormHeader-CZLmrL6Q.js";import{d as ka}from"./index-BDNa_dSq.js";import{_ as Va}from"./InputSelectArray-BGoSDEHL.js";import{l as $a}from"./loading-store-DRDFBxcW.js";import{S as Sa}from"./Santri-DK5Da5-L.js";import"./id-BuNGTsqN.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./index-BXLuJznK.js";import"./format-number-B34ySHL_.js";import"./QBtnGroup-BBlBx6YD.js";import"./QMenu-3oalsLjd.js";import"./selection-DeDWR_N3.js";import"./QResizeObserver-DonTkqYd.js";import"./rtl-DFPa-2ov.js";import"./api-error-C1WPqECD.js";import"./QChip-DG5_EyRB.js";import"./format-CJebrXOQ.js";import"./QToolbarTitle-Bi7GnpK1.js";import"./QToolbar-CIornAnt.js";import"./lists-store-C4dqSiKA.js";import"./DropDownAfter-f-uzuh2w.js";import"./Lists-B91eApHM.js";import"./ApiCrud-CgUuq5zB.js";import"./Api--YdEMrhi.js";const Ia={class:"flex items-center"},qa={class:"text-subtitle2"},ya={key:0},xa={key:1,class:"row"},Qa={class:"col-4 q-pr-sm"},Ca={key:0},Da={class:"col"},Ua={class:"text-caption text-italic"},ha={class:"q-mb-sm"},Ba={__name:"CardImage",props:{title:String,data:Object,image:String,loading:Boolean,loadingImage:Boolean},setup(v){return(t,n)=>(d(),g(B,null,{default:e(()=>[a(Q,{class:"bg-green-7 text-green-11 q-pa-sm"},{default:e(()=>[c("div",Ia,[c("div",qa,L(v.title),1),a(j)])]),_:1}),a(Q,{class:"q-pa-sm"},{default:e(()=>[v.loading?(d(),x("div",ya,[a(O,{color:"green-12",size:"8em",class:"flex q-ma-lg q-mx-auto"})])):(d(),x("div",xa,[c("div",Qa,[v.loadingImage?(d(),x("div",Ca,[a(O,{color:"green-12",size:"4em",class:"flex q-ma-sm q-mx-auto"})])):(d(),g(ma,{key:1,src:v.image,ratio:3/4,alt:"santri"},null,8,["src"])),ea(t.$slots,"button")]),c("div",Da,[(d(!0),x(G,null,ta(v.data,(s,i)=>(d(),x("div",{key:i},[c("div",Ua,L(i),1),c("div",ha,L(s),1)]))),128))])]))]),_:3})]),_:3}))}},Pa={__name:"SantriRelations",props:{santriId:{default:null}},setup(v){const t=v,n=V(0);return(s,i)=>{const _=la("router-view");return d(),g(B,{key:n.value},{default:e(()=>[c("button",{onClick:i[0]||(i[0]=b=>n.value++),id:"btn-rerender-santri-relations",style:{display:"none"}},"rerender"),a(ca,{"no-caps":"","outside-arrows":"","mobile-arrows":"",class:"bg-green-7 text-green-11 shadow-2",dense:"","indicator-color":"green-13",align:"left"},{default:e(()=>[a(h,{name:"wali",label:"Wali",to:"/santri/"+t.santriId+"/wali"},null,8,["to"]),a(h,{name:"ortu",label:"Ortu",to:"/santri/"+t.santriId+"/ortu"},null,8,["to"]),a(h,{name:"status",label:"Status",to:"/santri/"+t.santriId+"/status"},null,8,["to"]),a(h,{name:"kelas",label:"Kelas",to:"/santri/"+t.santriId+"/kelas"},null,8,["to"]),a(h,{name:"domisili",label:"Domisili",to:"/santri/"+t.santriId+"/domisili"},null,8,["to"]),a(j),a(aa,{flat:"",dense:"","dropdown-icon":"more_vert",class:"q-pl-md",color:"green-11"},{default:e(()=>[a(Z,null,{default:e(()=>[w((d(),g(I,{to:"/iuran/santri/"+t.santriId},{default:e(()=>[a(r,null,{default:e(()=>[a(S,null,{default:e(()=>[...i[1]||(i[1]=[$("Iuran",-1)])]),_:1})]),_:1}),a(r,{avatar:""},{default:e(()=>[a(A,{name:"payments",flat:""})]),_:1})]),_:1},8,["to"])),[[k]]),w((d(),g(I,{to:"/keamanan/izin-pesantren/santri/"+t.santriId},{default:e(()=>[a(r,null,{default:e(()=>[a(S,null,{default:e(()=>[...i[2]||(i[2]=[$("Izin Pesantren",-1)])]),_:1})]),_:1}),a(r,{avatar:""},{default:e(()=>[a(A,{name:"transfer_within_a_station",flat:""})]),_:1})]),_:1},8,["to"])),[[k]]),w((d(),g(I,{to:"/keamanan/indisipliner/santri/"+t.santriId},{default:e(()=>[a(r,null,{default:e(()=>[a(S,null,{default:e(()=>[...i[3]||(i[3]=[$("Indisipliner",-1)])]),_:1})]),_:1}),a(r,{avatar:""},{default:e(()=>[a(A,{name:"directions_run",flat:""})]),_:1})]),_:1},8,["to"])),[[k]])]),_:1})]),_:1})]),_:1}),a(Q,{class:"q-pa-sm"},{default:e(()=>[a(_)]),_:1})]),_:1})}}},Na={key:0},Ra={__name:"PermohonanBerhenti",emits:["submitted"],setup(v,{emit:t}){const n=V({jenis_permohonan:"Berhenti",tunggakan:"Lunas"}),{santri:s}=na(y()),i=V(!1),_=t;H(async()=>{});async function b(){const m=JSON.parse(JSON.stringify(n.value));if(!m.tunggakan||!m.jenis_permohonan||!m.alasan||!m.wali_nama||!m.wali_status||!m.wali_hubungan)return ka("Isian tidak lengkap");m.id=s.id,_("submitted",m),document.getElementById("btn-close").click()}return(m,l)=>(d(),g(B,{class:"full-width",style:{"max-width":"425px"}},{default:e(()=>[a(ba,{onSubmit:oa(b,["prevent"])},{default:e(()=>[a(wa,{title:"Permohonan Berhenti","is-new":!0}),a(Q,{class:"q-pa-sm"},{default:e(()=>[i.value?(d(),x("div",Na,[a(F,{modelValue:i.value,"onUpdate:modelValue":l[0]||(l[0]=o=>i.value=o),persistent:""},{default:e(()=>[a(O,{color:"green-12",size:"8em",class:"flex q-ma-lg q-mx-auto"})]),_:1},8,["modelValue"])])):sa("",!0),a(U,{dense:"",class:"",outlined:"",label:"Santri ID",modelValue:q(s).id,"onUpdate:modelValue":l[1]||(l[1]=o=>q(s).id=o),filled:"",disable:""},null,8,["modelValue"]),a(U,{dense:"",class:"q-mt-sm",outlined:"",label:"Nama",modelValue:q(s).nama,"onUpdate:modelValue":l[2]||(l[2]=o=>q(s).nama=o),filled:"",disable:""},null,8,["modelValue"]),a(R,{dense:"",class:"q-mt-sm",outlined:"",label:"Tunggakan*",modelValue:n.value.tunggakan,"onUpdate:modelValue":l[3]||(l[3]=o=>n.value.tunggakan=o),options:["Lunas","Belum Lunas"],clearable:"","use-input":"","new-value-mode":"add",behavior:"menu"},null,8,["modelValue"]),a(R,{dense:"",class:"q-mt-sm",outlined:"",label:"Jenis Permohonan*",modelValue:n.value.jenis_permohonan,"onUpdate:modelValue":l[4]||(l[4]=o=>n.value.jenis_permohonan=o),options:["Berhenti","Cuti/Istirahat"],clearable:"","use-input":"","new-value-mode":"add",behavior:"menu"},null,8,["modelValue"]),a(U,{dense:"",class:"q-mt-sm",outlined:"",label:"Alasan*",modelValue:n.value.alasan,"onUpdate:modelValue":l[5]||(l[5]=o=>n.value.alasan=o),autogrow:""},null,8,["modelValue"]),a(B,{class:"q-mt-sm",flat:"",bordered:""},{default:e(()=>[a(Q,{class:"q-pa-sm"},{default:e(()=>[l[12]||(l[12]=c("div",{class:"text-subtitle2"}," Identitas Pemohon (Wali) ",-1)),a(U,{dense:"",class:"",outlined:"",label:"Nama*",modelValue:n.value.wali_nama,"onUpdate:modelValue":l[6]||(l[6]=o=>n.value.wali_nama=o)},null,8,["modelValue"]),a(U,{dense:"",class:"q-mt-sm",outlined:"",label:"Nomor Telepon",modelValue:n.value.wali_no_telepon,"onUpdate:modelValue":l[7]||(l[7]=o=>n.value.wali_no_telepon=o)},null,8,["modelValue"]),a(R,{dense:"",class:"q-mt-sm",outlined:"",label:"Bukti Diri",modelValue:n.value.wali_bukti_diri,"onUpdate:modelValue":l[8]||(l[8]=o=>n.value.wali_bukti_diri=o),options:["KTP","SIM"],clearable:"","use-input":"","new-value-mode":"add",behavior:"menu"},null,8,["modelValue"]),a(U,{dense:"",class:"q-mt-sm",outlined:"",label:"Nomor / ID Bukti Diri",modelValue:n.value.wali_bukti_diri_id,"onUpdate:modelValue":l[9]||(l[9]=o=>n.value.wali_bukti_diri_id=o)},null,8,["modelValue"]),a(R,{dense:"",class:"q-mt-sm",outlined:"",label:"Status*",modelValue:n.value.wali_status,"onUpdate:modelValue":l[10]||(l[10]=o=>n.value.wali_status=o),options:["Wali","Wakil Wali"],clearable:"","use-input":"","new-value-mode":"add",behavior:"menu"},null,8,["modelValue"]),a(Va,{modelValue:n.value.wali_hubungan,"onUpdate:modelValue":l[11]||(l[11]=o=>n.value.wali_hubungan=o),url:"hubungan-wali",label:"Hubungan*",class:"q-mt-sm","use-input":"","new-value-mode":"add"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),a(ia,{class:"flex bg-green-6"},{default:e(()=>[a(j),w(a(p,{label:"Tutup",class:"bg-green-11","no-caps":"",id:"btn-close"},null,512),[[k]]),a(p,{type:"submit",label:"Print",class:"bg-green-10 text-green-11","no-caps":"",icon:"print"})]),_:1})]),_:1})]),_:1}))}},ja={__name:"DropDownPrint",props:{santri:{type:Object,required:!0}},setup(v){const t=v,{loadingMain:n}=X($a()),s=Y(),i=V(!1),_=V(""),b=V(!1);async function m(){await N({endPoint:`reports/santri/registrasi/download?id=${s.params.id}`,loading:n,fileName:"registrasi-"+s.params.id,confirm:!0,message:"Download data registrasi?"})}async function l(){await N({endPoint:`reports/santri/standbook/download?id=${s.params.id}`,loading:n,fileName:"standbook-"+s.params.id,confirm:!0,message:"Download standbook?"})}async function o(){await N({endPoint:`reports/santri/keterangan-berhenti/download?id=${s.params.id}`,loading:n,fileName:"keterangan-berhenti-"+s.params.id,confirm:!0,message:"Download Keterangan Berhenti"})}async function z(){await N({endPoint:`reports/santri/id-card/download?id=${s.params.id}`,loading:n,fileName:"card-"+s.params.id+" ~ "+t.santri.nama,confirm:!0,message:"Download ID Card"})}function T(){_.value=`reports/santri/registrasi/view?id=${s.params.id}`,b.value=!0}function W(){_.value=`reports/santri/standbook/view?id=${s.params.id}`,b.value=!0}function K(P){i.value=!1;const u=new URLSearchParams(P).toString();_.value=`reports/santri/permohonan-berhenti/view?${u}`,b.value=!0}function C(){_.value=`reports/santri/keterangan-berhenti/view?id=${s.params.id}`,b.value=!0}return(P,u)=>(d(),x(G,null,[a(aa,{color:"green-10",label:"Cetak",icon:"print","no-caps":"",class:"text-green-11 q-px-md",size:"sm"},{default:e(()=>[a(Z,null,{default:e(()=>[w((d(),g(I,null,{default:e(()=>[a(r,null,{default:e(()=>[a(S,null,{default:e(()=>[...u[3]||(u[3]=[$("Registrasi",-1)])]),_:1})]),_:1}),a(r,{avatar:""},{default:e(()=>[a(p,{icon:"download",flat:"",onClick:m})]),_:1}),a(r,{avatar:""},{default:e(()=>[a(p,{icon:"print",flat:"",onClick:T})]),_:1})]),_:1})),[[k]]),w((d(),g(I,null,{default:e(()=>[a(r,null,{default:e(()=>[a(S,null,{default:e(()=>[...u[4]||(u[4]=[$("Standbook",-1)])]),_:1})]),_:1}),a(r,{avatar:""},{default:e(()=>[a(p,{icon:"download",flat:"",onClick:l})]),_:1}),a(r,{avatar:""},{default:e(()=>[a(p,{icon:"print",flat:"",onClick:W})]),_:1})]),_:1})),[[k]]),w((d(),g(I,null,{default:e(()=>[a(r,null,{default:e(()=>[a(S,null,{default:e(()=>[...u[5]||(u[5]=[$("Permohonan Berhenti",-1)])]),_:1})]),_:1}),a(r,{avatar:""},{default:e(()=>[a(p,{icon:"download",flat:"",disable:""})]),_:1}),a(r,{avatar:""},{default:e(()=>[a(p,{icon:"print",flat:"",onClick:u[0]||(u[0]=f=>i.value=!0)})]),_:1})]),_:1})),[[k]]),w((d(),g(I,null,{default:e(()=>[a(r,null,{default:e(()=>[a(S,null,{default:e(()=>[...u[6]||(u[6]=[$("Keterangan Berhenti",-1)])]),_:1})]),_:1}),a(r,{avatar:""},{default:e(()=>[a(p,{icon:"download",flat:"",onClick:o})]),_:1}),a(r,{avatar:""},{default:e(()=>[a(p,{icon:"print",flat:"",onClick:C})]),_:1})]),_:1})),[[k]]),w((d(),g(I,null,{default:e(()=>[a(r,null,{default:e(()=>[a(S,null,{default:e(()=>[...u[7]||(u[7]=[$("ID Card",-1)])]),_:1})]),_:1}),a(r,{avatar:""},{default:e(()=>[a(p,{icon:"download",flat:"",onClick:z})]),_:1}),a(r,{avatar:""},{default:e(()=>[a(p,{icon:"print",flat:"",disable:""})]),_:1})]),_:1})),[[k]])]),_:1})]),_:1}),a(F,{modelValue:i.value,"onUpdate:modelValue":u[1]||(u[1]=f=>i.value=f)},{default:e(()=>[a(Ra,{onSubmitted:K})]),_:1},8,["modelValue"]),a(F,{modelValue:b.value,"onUpdate:modelValue":u[2]||(u[2]=f=>b.value=f)},{default:e(()=>[a(_a,{url:_.value},null,8,["url"])]),_:1},8,["modelValue"])],64))}},za={class:"flex items-center"},Ta={class:"row"},Wa={class:"col-12 col-sm-6 col-md-4 q-pa-sm"},Ka={class:"col-12 col-sm-6 col-md-5 q-pa-sm"},Ne={__name:"SantriDetail",setup(v){const{santri:t}=ra(y()),s=Y().params.id,i=ga(),{searchSantri:_,crudSantri:b}=X(i),m=V(!1),l=V(!1);async function o(){const f=await va({endPoint:`images/santri/${s}`,loading:l});t.image_url=f.image_url}async function z(){y().$reset();try{m.value=!0;const f=await Sa.getById({id:s});f&&(y().setSantri(f.santri),y().setOrtu(f.ortu),y().setWali(f.wali))}catch{}finally{m.value=!1}}const T=M(()=>({ID:t.value.id,"Tanggal Daftar":J(t.value.tgl_daftar_m)+" | "+fa(t.value.tgl_daftar_h),"Tahun Ajaran":`${t.value.th_ajaran_h||"-"} | ${t.value.th_ajaran_m||"-"}`})),W=M(()=>({Nama:`${t.value.nama?.toUpperCase()} (${t.value.sex?.toUpperCase()})`,Alamat:`${t.value.jl||" "} RT ${String(t.value.rt||0).padStart(3,0)} RW ${String(t.value.rw||0).padStart(3,"0")} ${t.value.desa||" "} ${t.value.kecamatan||" "} ${t.value.kabupaten||" "} ${t.value.provinsi||" "} ${t.value.kode_pos||" "}`.replace(/\s\s+/g," "),Kelahiran:`${t.value.tmp_lahir||"-"}, ${J(t.value.tgl_lahir)}`,"Data Akhir":t.value.data_akhir||"-"}));H(async()=>{await z()});function K(){y().setEdit(),b.value=!0}const C=V(!1),P=f=>C.value=f;async function u(){C.value=!1,await o()}return(f,D)=>(d(),g(ua,{class:"q-pa-sm"},{default:e(()=>[a(B,{class:""},{default:e(()=>[a(Q,{class:"bg-green-8 text-green-11 q-pa-sm"},{default:e(()=>[c("div",za,[D[2]||(D[2]=c("div",{class:"text-subtitle1"},"Data Santri",-1)),a(j),a(p,{onClick:E=>null,size:"sm",color:"green-2",class:"text-green-10 q-mr-sm",icon:"sync",disable:""}),a(p,{label:"Cari",onClick:D[0]||(D[0]=E=>_.value=!0),size:"sm",color:"green-2",class:"text-green-10 q-mr-sm",icon:"search"}),a(p,{"no-caps":"",size:"sm",color:"green-2",class:"text-green-10 q-mr-sm",icon:"edit",label:"Edit",onClick:K}),a(ja,{santri:q(t)},null,8,["santri"])])]),_:1}),a(Q,{class:"no-padding"},{default:e(()=>[c("div",Ta,[c("div",Wa,[a(da,{class:"q-mb-sm",data:T.value,loading:m.value,title:"Registrasi"},null,8,["data","loading"]),a(Ba,{class:"q-mb-sm",title:"Identitas",data:W.value,loading:m.value,loadingImage:l.value,image:q(t)?.image_url||"/user-default.png"},{button:e(()=>[a(p,{class:"q-mt-sm full-width",icon:"upload","no-caps":"",label:"Foto",dense:"",size:"sm",outline:"",color:"green-10",onClick:D[1]||(D[1]=E=>C.value=!0)})]),_:1},8,["data","loading","loadingImage","image"])]),c("div",Ka,[a(Pa,{"santri-id":q(s)},null,8,["santri-id"])])])]),_:1})]),_:1}),a(pa,{"img-format":"jpg","show-uploader":C.value,url:`/images/santri/${q(s)}`,onUpdateUploader:P,onSuccessUpload:u},null,8,["show-uploader","url"])]),_:1}))}};export{Ne as default};
