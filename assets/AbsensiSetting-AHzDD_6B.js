import{Q as H}from"./QSelect-CrgZ1FsI.js";import{A as u,U as T,f as d,o as r,b as a,w as l,Q as g,x as w,t as _,z as $,F as I,y as F,ab as Q,a as y,a5 as m,g as v}from"./index-DwrbA0R8.js";import{Q as z}from"./QSpinnerCube-CuByR_Bu.js";import{Q as x,a as f}from"./QItemSection-CeSY4hvW.js";import{Q as U}from"./QBtnGroup-CPjXoyXA.js";import{Q as S}from"./QForm-DCEv1Ikv.js";import{a as A}from"./api-delete-Bg9l1TPr.js";import{a as q}from"./api-get-D4W4lze7.js";import{a as D}from"./api-post-D71-L22w.js";import{a as G}from"./api-update-BSsi6Fy5.js";import"./QChip-DvUCR8tL.js";import"./QItemLabel-Dzdetwv2.js";import"./QMenu-BEnErdhw.js";import"./selection-DRCgFU0J.js";import"./rtl-DFPa-2ov.js";import"./format-CJebrXOQ.js";import"./index-B6LiMDVO.js";import"./index-BlZcD66n.js";import"./api-error-DGWaEiw1.js";const K={class:"",style:{"max-width":"600px"}},M={key:0},E={key:0,class:"q-pa-md"},L={key:1},R={class:"row"},J={class:"row"},O={key:1,class:"q-my-md text-center"},fe={__name:"AbsensiSetting",setup(W){const o=u(""),V=u([]),b=u([{}]),j=u([{}]),k=u(!1),p=u(!1),i=u({});async function h(){if(i.value.tingkat_id=o.value.val0,await D({endPoint:"absensi/settings",data:i.value}))return i.value={},c(o.value.val0)}async function P(n){if(await A({endPoint:`absensi/settings/${n}`,loading:p}))return c(o.value.val0)}async function B(n){await G({endPoint:`absensi/settings/${n.id}`,data:{bulan:n.bulan,ujian:n.ujian,tingkat_id:n.tingkat_id},loading:p,confirm:!1}),await c(n.tingkat_id)}async function N(){const n=await q({endPoint:"lists/tingkat-pendidikan",loading:k});V.value=n.tingkat_pendidikan}async function C(){const n=await q({endPoint:"lists/bulan-hijri",loading:k});b.value=n.bulan_hijri}async function c(n){const s=await q({endPoint:`absensi/settings?tingkat_id=${n}`,loading:p});j.value=s.bulan_ujian}return T(async()=>{await N(),await C()}),(n,s)=>(r(),d("div",K,[a(w,null,{default:l(()=>[a(g,{class:"q-pa-sm"},{default:l(()=>[a(H,{dense:"",outlined:"",label:"Pilih Tingkat Pendidikan",modelValue:o.value,"onUpdate:modelValue":[s[0]||(s[0]=e=>o.value=e),s[1]||(s[1]=e=>c(e.val0))],options:V.value,"emit-value":"","map-options":"","option-label":"val1",loading:k.value,behavior:"menu"},null,8,["modelValue","options","loading"])]),_:1})]),_:1}),a(w,{class:"q-mt-sm"},{default:l(()=>[a(g,{class:"bg-green-8 text-green-1 text-subtitle1 q-pa-sm"},{default:l(()=>[_(" Tingkat Pendidikan: "+$(o.value.val1),1)]),_:1}),a(g,{class:"q-pa-sm"},{default:l(()=>[o.value?(r(),d("div",M,[p.value?(r(),d("div",E,[a(z,{color:"green-12",size:"8em",class:"flex q-mx-auto"})])):(r(),d("div",L,[(r(!0),d(I,null,F(j.value,e=>(r(),d("div",{key:e.id},[a(S,{onSubmit:Q(t=>B(e),["prevent"])},{default:l(()=>[a(x,{class:"no-padding"},{default:l(()=>[a(f,null,{default:l(()=>[y("div",R,[a(m,{label:"Ujian Ke-?",class:"col-3 q-pr-sm",dense:"",outlined:"",modelValue:e.ujian,"onUpdate:modelValue":t=>e.ujian=t,required:"",mask:"#",rules:[t=>!!t||"Harus diisi!",t=>t>=1&&t<=3||"1, 2, atau 3!"]},null,8,["modelValue","onUpdate:modelValue","rules"]),a(m,{label:"Bulan",class:"col-3 q-pr-sm",dense:"",outlined:"",modelValue:e.bulan,"onUpdate:modelValue":t=>e.bulan=t,required:"",mask:"##",rules:[t=>!!t||"Harus diisi!",t=>t>=1&&t<=12||"1 hingga 12!"]},null,8,["modelValue","onUpdate:modelValue","rules"]),a(m,{class:"col-6",dense:"",outlined:"","model-value":b.value.find(t=>Number(t.val2)==Number(e.bulan))?.val1||"",readonly:""},null,8,["model-value"])])]),_:2},1024),a(f,{side:"",class:"no-padding q-ml-sm"},{default:l(()=>[a(U,{push:"",class:"q-mb-lg"},{default:l(()=>[a(v,{color:"positive",glossy:"",icon:"save",type:"submit"}),a(v,{color:"negative",glossy:"",icon:"delete",onClick:t=>P(e.id)},null,8,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1032,["onSubmit"])]))),128)),a(S,{onSubmit:Q(h,["prevent"]),onReset:s[4]||(s[4]=e=>i.value={})},{default:l(()=>[a(x,{class:"no-padding",style:{"justify-content":"start"}},{default:l(()=>[a(f,null,{default:l(()=>[y("div",J,[a(m,{label:"Ujian Ke-?",class:"col-3 q-pr-sm",dense:"",outlined:"",modelValue:i.value.ujian,"onUpdate:modelValue":s[2]||(s[2]=e=>i.value.ujian=e),required:"",mask:"#",rules:[e=>!!e||"Harus diisi!",e=>e>=1&&e<=3||"1, 2, atau 3!"]},null,8,["modelValue","rules"]),a(m,{label:"Bulan",class:"col-3 q-pr-sm",dense:"",outlined:"",modelValue:i.value.bulan,"onUpdate:modelValue":s[3]||(s[3]=e=>i.value.bulan=e),required:"",mask:"##",rules:[e=>!!e||"Harus diisi!",e=>e>=1&&e<=12||"1 hingga 12!"]},null,8,["modelValue","rules"]),a(m,{class:"col-6",dense:"",outlined:"",readonly:"","model-value":b.value.find(e=>Number(e.val2)==Number(i.value.bulan))?.val1||""},null,8,["model-value"])])]),_:1}),a(f,{side:"",class:"no-padding q-ml-sm"},{default:l(()=>[a(U,{push:"",class:"q-mb-lg"},{default:l(()=>[a(v,{color:"positive",glossy:"",icon:"save",type:"submit"}),a(v,{color:"negative",glossy:"",icon:"undo",type:"reset"})]),_:1})]),_:1})]),_:1})]),_:1})]))])):(r(),d("div",O," Silakan pilih list tingkat pendidikan! "))]),_:1}),a(g,{class:"bg-green-7 text-green-1 text-caption text-italic q-pa-sm"},{default:l(()=>[...s[5]||(s[5]=[_(" Ujian (1, 2) jika menganut sistem semester atau kuartal (mid semester) ",-1),y("br",null,null,-1),_(" Ujian (1, 2, 3) jika menganut sistem catur wulan ",-1)])]),_:1})]),_:1})]))}};export{fe as default};
