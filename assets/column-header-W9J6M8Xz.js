import{x as p,R as $,y as x,c as f,o as m,w as t,b as e,a9 as A,a as S,n as C,a3 as N,s as F,ab as O,ar as P,q as Q,f as w,g as D,p as _,F as H,t as L,v as h,z as V,B as T}from"./index-Bf-p91mW.js";import{Q as j}from"./QSkeleton-DEYFlc1v.js";import{Q as v}from"./QItemLabel-sjS6zLD0.js";import{Q as q,a as b}from"./QItemSection-Bl4rOme3.js";import{Q as E}from"./QList-51Eu5HNp.js";import{a as R}from"./api-get-CiRdORW1.js";import{Q as K}from"./QSelect-Co09SqkM.js";import{Q as z}from"./QForm-OmDQHoiq.js";import{a as G}from"./api-post-CHcQycZS.js";import{a as W}from"./api-update-BYe6B3v5.js";import{a as J}from"./api-delete-BVHfd1pG.js";import{_ as U}from"./InputSelectArray-Jz4ksDX6.js";import{_ as X}from"./CardSantriSimple-JMo4QFGj.js";import{g as Y}from"./array-object-BytDdNh7.js";import{c as I}from"./format-date-DlwYCgkJ.js";import{a as Z}from"./hijri-BBdEhqDI.js";const aa={__name:"QuranMutaallimForm",props:{data:{type:Object,required:!0}},emits:["successDelete","successSubmit","successUpdate","successCreate"],setup(n,{emit:c}){const r=n,o=c,l=p({marhalah:"Ula",faslah:null,no_absen:null,aktif:1}),d=p(!1);$(async()=>{Object.assign(l.value,r.data)});const y=async()=>{const u={santri_id:l.value.santri_id,th_ajaran_h:l.value.th_ajaran_h,marhalah:l.value.marhalah,faslah:l.value.faslah,no_absen:l.value.no_absen,aktif:l.value.aktif};let a=null;const s=!l.value.id;s?a=await G({endPoint:"mutaallim",data:u,loading:d}):a=await W({endPoint:`mutaallim/${l.value.id}`,data:u,confirm:!0,notify:!0,loading:d}),a&&(document.getElementById("btn-close-form").click(),o("successSubmit",a?.mutaallim),o(s?"successCreate":"successUpdate",a?.mutaallim))},g=async()=>{const u=l.value.id;await J({endPoint:`mutaallim/${u}`,loading:d})&&(document.getElementById("btn-close-form").click(),o("successDelete",u))};return(u,a)=>{const s=x("FormHeader"),k=x("FormLoading"),M=x("FormActions");return m(),f(F,{class:"full-width",style:{"max-width":"425px"}},{default:t(()=>[e(z,{onSubmit:A(y,["prevent"])},{default:t(()=>[e(s,{title:"Input Pendidikan Quran","is-new":!l.value.id},null,8,["is-new"]),d.value?(m(),f(k,{key:0})):S("",!0),e(C,null,{default:t(()=>[e(N,{dense:"",outlined:"",label:"Nama","model-value":l.value?.nama+" ("+l.value?.santri_id+")",disable:"",filled:"",class:"q-my-sm"},null,8,["model-value"]),e(U,{modelValue:l.value.th_ajaran_h,"onUpdate:modelValue":a[0]||(a[0]=i=>l.value.th_ajaran_h=i),url:"tahun-ajaran",label:"Tahun Ajaran *",sort:"desc",class:"q-my-sm",rules:[i=>!!i||"Harus diisi!"],selected:l.value.th_ajaran_h},null,8,["modelValue","rules","selected"]),e(K,{dense:"",outlined:"",modelValue:l.value.marhalah,"onUpdate:modelValue":a[1]||(a[1]=i=>l.value.marhalah=i),label:"Marhalah *",class:"q-my-sm",rules:[i=>!!i||"Harus diisi!"],options:["Ula","Wustho","Ulya"]},null,8,["modelValue","rules"]),e(U,{modelValue:l.value.faslah,"onUpdate:modelValue":a[2]||(a[2]=i=>l.value.faslah=i),url:"faslah-quran",label:"Faslah/Kelas *",class:"q-my-sm",rules:[i=>!!i||"Harus diisi!"]},null,8,["modelValue","rules"]),e(F,{bordered:"",flat:"",class:"q-px-sm q-my-sm"},{default:t(()=>[e(O,{modelValue:l.value.aktif,"onUpdate:modelValue":a[3]||(a[3]=i=>l.value.aktif=i),color:"green","true-value":1,"false-value":0,label:"Aktif",disable:!l.value.id},null,8,["modelValue","disable"])]),_:1})]),_:1}),e(M,{"btn-delete":!!l.value.id,onOnDelete:g},null,8,["btn-delete"])]),_:1})]),_:1})}}},ea={key:0},_a={__name:"MutaallimCard",props:{santri:{type:Object}},setup(n){const c=p(!1),r=p({}),o=p([]),l=p(!1);async function d(u){const a=await R({endPoint:`mutaallim/santri/${u}`,loading:l});a&&(o.value=a.mutaallim)}P(async()=>{n.santri?.id?await d(n.santri.id):n.santri?.santri_id&&await d(n.santri.santri_id)});const y=()=>{r.value={santri_id:n.santri.id,nama:n.santri.nama},c.value=!0},g=u=>{r.value=Y(o,u),r.value.santri_id=n.santri.id,r.value.nama=n.santri.nama,c.value=!0};return(u,a)=>(m(),f(F,{flat:"",bordered:"",class:"",style:{width:"350px"}},{default:t(()=>[e(C,{class:"bg-green-7 text-green-11 q-pa-sm flex items-center justify-between"},{default:t(()=>[a[3]||(a[3]=Q("div",null,"Riwayat Mutaallim",-1)),e(w,{icon:"add",outline:"",dense:"",class:"q-px-sm",disabled:!n.santri.id,onClick:y},null,8,["disabled"])]),_:1}),e(C,{class:"q-pa-sm"},{default:t(()=>[n.santri.id?(m(),f(X,{key:0,id:n.santri.id,class:"q-mb-sm"},null,8,["id"])):S("",!0),e(E,{bordered:"",separator:"",class:"rounded-borders"},{default:t(()=>[l.value?(m(),f(q,{key:0,class:"q-px-sm"},{default:t(()=>[e(b,null,{default:t(()=>[e(v,null,{default:t(()=>[e(j,{type:"text"})]),_:1}),e(v,{caption:""},{default:t(()=>[e(j,{type:"text"})]),_:1})]),_:1}),e(b,{avatar:""},{default:t(()=>[e(j,{type:"QRadio"})]),_:1})]),_:1})):o.value?.length?(m(!0),D(H,{key:2},L(o.value,(s,k)=>(m(),f(q,{key:k,active:!!s.aktif,"active-class":"bg-green-1 text-green-10",class:"q-px-sm"},{default:t(()=>[e(b,null,{default:t(()=>[e(v,null,{default:t(()=>[_(h(s.th_ajaran_h)+" | "+h(s.marhalah)+" | "+h(s.faslah),1)]),_:2},1024),e(v,{caption:""},{default:t(()=>[_(h(V(I)(s.created_at,"dd-MM-yyyy"))+" | "+h(V(Z)(V(I)(s.created_at,"yyyy-MM-dd")))+" ",1),s.aktif?(m(),D("span",ea,[...a[6]||(a[6]=[Q("span",null,"|",-1),Q("span",{class:"text-weight-bold text-green-10"}," Aktif ",-1)])])):S("",!0)]),_:2},1024)]),_:2},1024),e(b,{avatar:""},{default:t(()=>[e(w,{icon:"edit",dense:"",outline:"",round:"",glossy:"",onClick:M=>g(s.id)},null,8,["onClick"])]),_:2},1024)]),_:2},1032,["active"]))),128)):(m(),f(q,{key:1,class:"q-px-sm"},{default:t(()=>[e(b,null,{default:t(()=>[e(v,null,{default:t(()=>[...a[4]||(a[4]=[_(" Tidak ada data ",-1)])]),_:1}),e(v,{caption:""},{default:t(()=>[...a[5]||(a[5]=[_(" untuk ditampilkan ",-1)])]),_:1})]),_:1}),e(b,{avatar:""},{default:t(()=>[e(w,{icon:"sym_o_exclamation",disable:"",dense:"",outline:"",round:"",color:"green-14"})]),_:1})]),_:1}))]),_:1})]),_:1}),e(T,{modelValue:c.value,"onUpdate:modelValue":a[2]||(a[2]=s=>c.value=s)},{default:t(()=>[e(aa,{data:r.value,onSuccessSubmit:a[0]||(a[0]=s=>d(r.value.santri_id)),onSuccessDelete:a[1]||(a[1]=s=>d(r.value.santri_id))},null,8,["data"])]),_:1},8,["modelValue"])]),_:1}))}},B=[{name:"nama",label:"Nama",align:"left",field:"nama",sortable:!0},{name:"data_akhir",label:"Data Akhir",align:"left",field:"data_akhir",sortable:!0},{name:"th_ajaran_h",label:"Tahun Ajaran",align:"left",field:"th_ajaran_h",sortable:!0},{name:"marhalah",label:"Marhalah",align:"left",field:"marhalah",sortable:!0},{name:"faslah",label:"Faslah/Kelas",align:"left",field:"faslah",sortable:!0}],ya=[{name:"id",label:"ID Santri",align:"center",field:"id",sortable:!0},...B],ga=[{name:"santri_id",label:"ID Santri",align:"center",field:"santri_id",sortable:!0},...B];export{_a as _,ga as a,ya as c};
