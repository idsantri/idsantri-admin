import{x as i,R as C,y as r,c,o as p,w as d,b as t,a9 as F,a as U,n as q,a3 as m,s as S}from"./index-Bf-p91mW.js";import{Q as x}from"./QForm-OmDQHoiq.js";import{l as _}from"./lists-store-F5P_xNBX.js";import{a as B}from"./api-post-CHcQycZS.js";import{a as K}from"./api-update-BYe6B3v5.js";import{a as A}from"./api-delete-BVHfd1pG.js";import{_ as v}from"./InputSelectArray-Jz4ksDX6.js";import{_ as D}from"./InputSelectTingkatPendidikan-C_EqL8ok.js";const L={__name:"KelasForm",props:{data:{type:Object,required:!0}},emits:["successDelete","successSubmit","successUpdate","successCreate"],setup(f,{emit:k}){const g=f,n=k,e=i({}),o=i(!1),b=i([]),y=i([]);C(async()=>{Object.assign(e.value,g.data),b.value=_().getStateByKey("tahun-ajaran"),y.value=_().getStateByKey("tingkat-pendidikan")});const V=async()=>{const s={santri_id:e.value.santri_id,th_ajaran_h:e.value.th_ajaran_h,tingkat_id:e.value.tingkat_id,kelas:e.value.kelas,no_absen:e.value.no_absen,keterangan:e.value.keterangan};let a=null;const u=!e.value.id;u?a=await B({endPoint:"kelas",data:s,loading:o}):a=await K({endPoint:`kelas/${e.value.id}`,data:s,confirm:!0,notify:!0,loading:o}),a&&(document.getElementById("btn-close-form").click(),n("successSubmit",a?.kelas),n(u?"successCreate":"successUpdate",a?.kelas))},w=async()=>{const s=e.value.id;await A({endPoint:`kelas/${s}`,loading:o})&&(document.getElementById("btn-close-form").click(),n("successDelete",s))};return(s,a)=>{const u=r("FormHeader"),j=r("FormLoading"),h=r("FormActions");return p(),c(S,{class:"full-width",style:{"max-width":"425px"}},{default:d(()=>[t(x,{onSubmit:F(V,["prevent"])},{default:d(()=>[t(u,{title:"Input Kelas","is-new":!e.value.id},null,8,["is-new"]),o.value?(p(),c(j,{key:0})):U("",!0),t(q,null,{default:d(()=>[t(m,{dense:"",outlined:"",label:"Nama","model-value":e.value?.nama+" ("+e.value?.santri_id+")",disable:"",filled:"",class:"q-my-sm"},null,8,["model-value"]),t(v,{modelValue:e.value.th_ajaran_h,"onUpdate:modelValue":a[0]||(a[0]=l=>e.value.th_ajaran_h=l),url:"tahun-ajaran",label:"Tahun Ajaran *",sort:"desc",class:"q-my-sm",rules:[l=>!!l||"Harus diisi!"],selected:e.value.th_ajaran_h},null,8,["modelValue","rules","selected"]),t(D,{modelValue:e.value.tingkat_id,"onUpdate:modelValue":a[1]||(a[1]=l=>e.value.tingkat_id=l),class:"q-my-sm",rules:[l=>!!l||"Harus diisi!"],selected:e.value.tingkat_id},null,8,["modelValue","rules","selected"]),t(v,{modelValue:e.value.kelas,"onUpdate:modelValue":a[2]||(a[2]=l=>e.value.kelas=l),url:"kelas",label:"Kelas *",rules:[l=>!!l||"Harus diisi!"],class:"q-my-sm"},null,8,["modelValue","rules"]),t(m,{dense:"",class:"q-my-sm",outlined:"",label:"Nomor Absen",modelValue:e.value.no_absen,"onUpdate:modelValue":a[3]||(a[3]=l=>e.value.no_absen=l),type:"number"},null,8,["modelValue"]),t(m,{dense:"",class:"q-my-sm",outlined:"",label:"Keterangan",modelValue:e.value.keterangan,"onUpdate:modelValue":a[4]||(a[4]=l=>e.value.keterangan=l),autogrow:""},null,8,["modelValue"])]),_:1}),t(h,{"btn-delete":!!e.value.id,onOnDelete:w},null,8,["btn-delete"])]),_:1})]),_:1})}}};export{L as _};
