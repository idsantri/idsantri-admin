import{B as z,c as g,o as d,w as e,b as a,Q,a as v,t as K,f as U,r as ta,F as M,z as na,y as B,A as V,l as w,v as q,a3 as O,a9 as oa,W as J,ad as sa,e as ia,G as W,a7 as x,C as $,k as ra,g as f,a8 as G,ab as X,ac as ua,q as E}from"./index-Bjf6jOrL.js";import{Q as da}from"./QPage-CdhCNm0R.js";import{f as H}from"./format-date-DlwYCgkJ.js";import{Q as F}from"./QSpace-CT-pwkHs.js";import{Q as Y}from"./QSpinnerCube-gZ5RTjBb.js";import{Q as ma}from"./QImg-B6Zk7vAt.js";import{_ as pa}from"./ImageUploader-A-PU7hUt.js";import{s as C}from"./santri-store-CQA3wJKJ.js";import{b as fa}from"./hijri--5qD4USW.js";import{Q as h}from"./QRouteTab-BbT6Cfz6.js";import{Q as I}from"./QItemLabel-Clz1Xits.js";import{Q as S,a as r}from"./QItemSection-D4HO8eJd.js";import{Q as Z}from"./QList-DrJ2aexG.js";import{Q as aa}from"./QBtnDropdown-CATaFFO-.js";import{Q as ca}from"./QTabs-BtnDgiOP.js";import{C as k}from"./ClosePopup-Ced6Y-Os.js";import{d as ga}from"./dialog-store-C3zBQC9e.js";import{a as va}from"./api-get-SNzLoUbu.js";import{a as j}from"./api-download-CVMK4Z0_.js";import{_ as _a}from"./ReportViewer-LM4oNrBP.js";import{Q as R}from"./QSelect-BCDk0qVl.js";import{Q as ba}from"./QForm-CQ61mLzh.js";import{_ as wa}from"./FormHeader-DNn4paXp.js";import{d as ka}from"./index-BRCx2Z00.js";import{_ as Va}from"./InputSelectArray-DTVIQacW.js";import{l as qa}from"./loading-store-BkVX4bDB.js";import{S as Ia}from"./Santri-DUg8M8r9.js";import{C as Sa}from"./CardListTabel-Bs8KDqAD.js";import{f as $a}from"./format-text-DnCGEu2I.js";import"./id-BuNGTsqN.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./index-DV84x6RN.js";import"./format-number-B34ySHL_.js";import"./QBtnGroup-BZf-O_co.js";import"./QMenu-DO2tkYnP.js";import"./selection-C-yT_gHt.js";import"./QResizeObserver-DNb83RcI.js";import"./rtl-DFPa-2ov.js";import"./api-error-C_UMNjEa.js";import"./QChip-CKBUwVMq.js";import"./format-CJebrXOQ.js";import"./QToolbarTitle-DexAJwlS.js";import"./QToolbar-Bk7787Iv.js";import"./lists-store-Ddm_j1AX.js";import"./DropDownAfter-BWotgQpI.js";import"./Lists-DcfSSLIw.js";import"./ApiCrud-Cz799mD5.js";import"./Api-v4AqqFFf.js";import"./QMarkupTable-DhfjFCDy.js";const Ca={class:"flex items-center"},Qa={class:"text-subtitle2"},ya={class:"col-4 q-pr-sm"},xa={key:0},Da={class:"col"},ha={class:"text-caption text-italic"},Ua={class:"q-mb-sm"},Ba={__name:"CardIdentity",props:{title:String,data:Object,image:String,loading:Boolean,loadingImage:Boolean},setup(_){return(l,n)=>{const s=z("CardLoading");return d(),g(B,{flat:"",bordered:""},{default:e(()=>[a(Q,{class:"bg-green-7 text-green-11 q-pa-sm"},{default:e(()=>[v("div",Ca,[v("div",Qa,K(_.title),1),a(F)])]),_:1}),a(Q,{class:"q-pa-sm row"},{default:e(()=>[v("div",ya,[_.loadingImage?(d(),U("div",xa,[a(Y,{color:"green-12",size:"4em",class:"flex q-ma-sm q-mx-auto"})])):(d(),g(ma,{key:1,src:_.image,ratio:3/4,alt:"santri"},null,8,["src"])),ta(l.$slots,"button")]),v("div",Da,[(d(!0),U(M,null,na(_.data,(i,c)=>(d(),U("div",{key:c},[v("div",ha,K(c),1),v("div",Ua,K(i),1)]))),128))]),a(s,{showing:_.loading},null,8,["showing"])]),_:3})]),_:3})}}},Pa={__name:"SantriRelations",props:{santriId:{default:null}},setup(_){const l=_,n=V(0);return(s,i)=>{const c=z("router-view");return d(),g(B,{key:n.value,bordered:"",flat:""},{default:e(()=>[a(Q,{class:"bg-green-7 text-green-11 no-padding"},{default:e(()=>[a(ca,{"no-caps":"","outside-arrows":"","mobile-arrows":"",dense:"","indicator-color":"green-13",align:"left"},{default:e(()=>[a(h,{name:"wali",label:"Wali",to:"/santri/"+l.santriId+"/wali"},null,8,["to"]),a(h,{name:"ortu",label:"Ortu",to:"/santri/"+l.santriId+"/ortu"},null,8,["to"]),a(h,{name:"status",label:"Status",to:"/santri/"+l.santriId+"/status"},null,8,["to"]),a(h,{name:"kelas",label:"Kelas",to:"/santri/"+l.santriId+"/kelas"},null,8,["to"]),a(h,{name:"domisili",label:"Domisili",to:"/santri/"+l.santriId+"/domisili"},null,8,["to"]),a(F),a(aa,{flat:"",dense:"","dropdown-icon":"more_vert",class:"q-pl-md",color:"green-11"},{default:e(()=>[a(Z,null,{default:e(()=>[w((d(),g(S,{to:"/iuran/santri/"+l.santriId},{default:e(()=>[a(r,null,{default:e(()=>[a(I,null,{default:e(()=>[...i[1]||(i[1]=[q("Iuran",-1)])]),_:1})]),_:1}),a(r,{avatar:""},{default:e(()=>[a(O,{name:"payments",flat:""})]),_:1})]),_:1},8,["to"])),[[k]]),w((d(),g(S,{to:"/keamanan/izin-pesantren/santri/"+l.santriId},{default:e(()=>[a(r,null,{default:e(()=>[a(I,null,{default:e(()=>[...i[2]||(i[2]=[q("Izin Pesantren",-1)])]),_:1})]),_:1}),a(r,{avatar:""},{default:e(()=>[a(O,{name:"transfer_within_a_station",flat:""})]),_:1})]),_:1},8,["to"])),[[k]]),w((d(),g(S,{to:"/keamanan/indisipliner/santri/"+l.santriId},{default:e(()=>[a(r,null,{default:e(()=>[a(I,null,{default:e(()=>[...i[3]||(i[3]=[q("Indisipliner",-1)])]),_:1})]),_:1}),a(r,{avatar:""},{default:e(()=>[a(O,{name:"directions_run",flat:""})]),_:1})]),_:1},8,["to"])),[[k]])]),_:1})]),_:1})]),_:1})]),_:1}),v("button",{onClick:i[0]||(i[0]=b=>n.value++),id:"btn-rerender-santri-relations",style:{display:"none"}},"rerender"),a(Q,{class:"q-pa-sm"},{default:e(()=>[a(c)]),_:1})]),_:1})}}},Na={key:0},ja={__name:"PermohonanBerhenti",emits:["submitted"],setup(_,{emit:l}){const n=V({jenis_permohonan:"Berhenti",tunggakan:"Lunas"}),{santri:s}=oa(C()),i=V(!1),c=l;J(async()=>{});async function b(){const p=JSON.parse(JSON.stringify(n.value));if(!p.tunggakan||!p.jenis_permohonan||!p.alasan||!p.wali_nama||!p.wali_status||!p.wali_hubungan)return ka("Isian tidak lengkap");p.id=s.id,c("submitted",p),document.getElementById("btn-close").click()}return(p,t)=>(d(),g(B,{class:"full-width",style:{"max-width":"425px"}},{default:e(()=>[a(ba,{onSubmit:sa(b,["prevent"])},{default:e(()=>[a(wa,{title:"Permohonan Berhenti","is-new":!0}),a(Q,{class:"q-pa-sm"},{default:e(()=>[i.value?(d(),U("div",Na,[a(W,{modelValue:i.value,"onUpdate:modelValue":t[0]||(t[0]=o=>i.value=o),persistent:""},{default:e(()=>[a(Y,{color:"green-12",size:"8em",class:"flex q-ma-lg q-mx-auto"})]),_:1},8,["modelValue"])])):ia("",!0),a(x,{dense:"",class:"",outlined:"",label:"Santri ID",modelValue:$(s).id,"onUpdate:modelValue":t[1]||(t[1]=o=>$(s).id=o),filled:"",disable:""},null,8,["modelValue"]),a(x,{dense:"",class:"q-mt-sm",outlined:"",label:"Nama",modelValue:$(s).nama,"onUpdate:modelValue":t[2]||(t[2]=o=>$(s).nama=o),filled:"",disable:""},null,8,["modelValue"]),a(R,{dense:"",class:"q-mt-sm",outlined:"",label:"Tunggakan*",modelValue:n.value.tunggakan,"onUpdate:modelValue":t[3]||(t[3]=o=>n.value.tunggakan=o),options:["Lunas","Belum Lunas"],clearable:"","use-input":"","new-value-mode":"add",behavior:"menu"},null,8,["modelValue"]),a(R,{dense:"",class:"q-mt-sm",outlined:"",label:"Jenis Permohonan*",modelValue:n.value.jenis_permohonan,"onUpdate:modelValue":t[4]||(t[4]=o=>n.value.jenis_permohonan=o),options:["Berhenti","Cuti/Istirahat"],clearable:"","use-input":"","new-value-mode":"add",behavior:"menu"},null,8,["modelValue"]),a(x,{dense:"",class:"q-mt-sm",outlined:"",label:"Alasan*",modelValue:n.value.alasan,"onUpdate:modelValue":t[5]||(t[5]=o=>n.value.alasan=o),autogrow:""},null,8,["modelValue"]),a(B,{class:"q-mt-sm",flat:"",bordered:""},{default:e(()=>[a(Q,{class:"q-pa-sm"},{default:e(()=>[t[12]||(t[12]=v("div",{class:"text-subtitle2"}," Identitas Pemohon (Wali) ",-1)),a(x,{dense:"",class:"",outlined:"",label:"Nama*",modelValue:n.value.wali_nama,"onUpdate:modelValue":t[6]||(t[6]=o=>n.value.wali_nama=o)},null,8,["modelValue"]),a(x,{dense:"",class:"q-mt-sm",outlined:"",label:"Nomor Telepon",modelValue:n.value.wali_no_telepon,"onUpdate:modelValue":t[7]||(t[7]=o=>n.value.wali_no_telepon=o)},null,8,["modelValue"]),a(R,{dense:"",class:"q-mt-sm",outlined:"",label:"Bukti Diri",modelValue:n.value.wali_bukti_diri,"onUpdate:modelValue":t[8]||(t[8]=o=>n.value.wali_bukti_diri=o),options:["KTP","SIM"],clearable:"","use-input":"","new-value-mode":"add",behavior:"menu"},null,8,["modelValue"]),a(x,{dense:"",class:"q-mt-sm",outlined:"",label:"Nomor / ID Bukti Diri",modelValue:n.value.wali_bukti_diri_id,"onUpdate:modelValue":t[9]||(t[9]=o=>n.value.wali_bukti_diri_id=o)},null,8,["modelValue"]),a(R,{dense:"",class:"q-mt-sm",outlined:"",label:"Status*",modelValue:n.value.wali_status,"onUpdate:modelValue":t[10]||(t[10]=o=>n.value.wali_status=o),options:["Wali","Wakil Wali"],clearable:"","use-input":"","new-value-mode":"add",behavior:"menu"},null,8,["modelValue"]),a(Va,{modelValue:n.value.wali_hubungan,"onUpdate:modelValue":t[11]||(t[11]=o=>n.value.wali_hubungan=o),url:"hubungan-wali",label:"Hubungan*",class:"q-mt-sm","use-input":"","new-value-mode":"add"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),a(ra,{class:"flex bg-green-6"},{default:e(()=>[a(F),w(a(f,{label:"Tutup",class:"bg-green-11","no-caps":"",id:"btn-close"},null,512),[[k]]),a(f,{type:"submit",label:"Print",class:"bg-green-10 text-green-11","no-caps":"",icon:"print"})]),_:1})]),_:1})]),_:1}))}},Ra={__name:"DropDownPrint",props:{santri:{type:Object,required:!0}},setup(_){const l=_,{loadingMain:n}=G(qa()),s=X(),i=V(!1),c=V(""),b=V(!1);async function p(){await j({endPoint:`reports/santri/registrasi/download?id=${s.params.id}`,loading:n,fileName:"registrasi-"+s.params.id,confirm:!0,message:"Download data registrasi?"})}async function t(){await j({endPoint:`reports/santri/standbook/download?id=${s.params.id}`,loading:n,fileName:"standbook-"+s.params.id,confirm:!0,message:"Download standbook?"})}async function o(){await j({endPoint:`reports/santri/keterangan-berhenti/download?id=${s.params.id}`,loading:n,fileName:"keterangan-berhenti-"+s.params.id,confirm:!0,message:"Download Keterangan Berhenti"})}async function P(){await j({endPoint:`reports/santri/id-card/download?id=${s.params.id}`,loading:n,fileName:"card-"+s.params.id+" ~ "+l.santri.nama,confirm:!0,message:"Download ID Card"})}function L(){c.value=`reports/santri/registrasi/view?id=${s.params.id}`,b.value=!0}function T(){c.value=`reports/santri/standbook/view?id=${s.params.id}`,b.value=!0}function A(D){i.value=!1;const u=new URLSearchParams(D).toString();c.value=`reports/santri/permohonan-berhenti/view?${u}`,b.value=!0}function y(){c.value=`reports/santri/keterangan-berhenti/view?id=${s.params.id}`,b.value=!0}return(D,u)=>(d(),U(M,null,[a(aa,{color:"green-10",label:D.$q.screen.lt.sm?"":"Cetak",icon:"print","no-caps":"",dense:"",outline:"",class:"q-px-sm text-green-11"},{default:e(()=>[a(Z,null,{default:e(()=>[w((d(),g(S,null,{default:e(()=>[a(r,null,{default:e(()=>[a(I,null,{default:e(()=>[...u[3]||(u[3]=[q("Registrasi",-1)])]),_:1})]),_:1}),a(r,{avatar:""},{default:e(()=>[a(f,{icon:"download",flat:"",onClick:p})]),_:1}),a(r,{avatar:""},{default:e(()=>[a(f,{icon:"print",flat:"",onClick:L})]),_:1})]),_:1})),[[k]]),w((d(),g(S,null,{default:e(()=>[a(r,null,{default:e(()=>[a(I,null,{default:e(()=>[...u[4]||(u[4]=[q("Standbook",-1)])]),_:1})]),_:1}),a(r,{avatar:""},{default:e(()=>[a(f,{icon:"download",flat:"",onClick:t})]),_:1}),a(r,{avatar:""},{default:e(()=>[a(f,{icon:"print",flat:"",onClick:T})]),_:1})]),_:1})),[[k]]),w((d(),g(S,null,{default:e(()=>[a(r,null,{default:e(()=>[a(I,null,{default:e(()=>[...u[5]||(u[5]=[q("Permohonan Berhenti",-1)])]),_:1})]),_:1}),a(r,{avatar:""},{default:e(()=>[a(f,{icon:"download",flat:"",disable:""})]),_:1}),a(r,{avatar:""},{default:e(()=>[a(f,{icon:"print",flat:"",onClick:u[0]||(u[0]=m=>i.value=!0)})]),_:1})]),_:1})),[[k]]),w((d(),g(S,null,{default:e(()=>[a(r,null,{default:e(()=>[a(I,null,{default:e(()=>[...u[6]||(u[6]=[q("Keterangan Berhenti",-1)])]),_:1})]),_:1}),a(r,{avatar:""},{default:e(()=>[a(f,{icon:"download",flat:"",onClick:o})]),_:1}),a(r,{avatar:""},{default:e(()=>[a(f,{icon:"print",flat:"",onClick:y})]),_:1})]),_:1})),[[k]]),w((d(),g(S,null,{default:e(()=>[a(r,null,{default:e(()=>[a(I,null,{default:e(()=>[...u[7]||(u[7]=[q("ID Card",-1)])]),_:1})]),_:1}),a(r,{avatar:""},{default:e(()=>[a(f,{icon:"download",flat:"",onClick:P})]),_:1}),a(r,{avatar:""},{default:e(()=>[a(f,{icon:"print",flat:"",disable:""})]),_:1})]),_:1})),[[k]])]),_:1})]),_:1},8,["label"]),a(W,{modelValue:i.value,"onUpdate:modelValue":u[1]||(u[1]=m=>i.value=m)},{default:e(()=>[a(ja,{onSubmitted:A})]),_:1},8,["modelValue"]),a(W,{modelValue:b.value,"onUpdate:modelValue":u[2]||(u[2]=m=>b.value=m)},{default:e(()=>[a(_a,{url:c.value},null,8,["url"])]),_:1},8,["modelValue"])],64))}},La={class:"q-ml-sm"},Ta={class:"row"},Aa={class:"col-12 col-sm-6 col-md-4 q-pa-sm"},Ka={class:"col-12 col-sm-6 col-md-5 q-pa-sm"},Re={__name:"SantriDetail",setup(_){const{santri:l}=ua(C()),s=X().params.id,i=ga(),{searchSantri:c,crudSantri:b}=G(i),p=V(!1),t=V(!1);async function o(){const m=await va({endPoint:`images/santri/${s}`,loading:t});l.image_url=m.image_url}async function P(){C().$reset();try{p.value=!0;const m=await Ia.getById({id:s});m&&(C().setSantri(m.santri),C().setOrtu(m.ortu),C().setWali(m.wali))}catch{}finally{p.value=!1}}const L=E(()=>[{label:"ID",value:l.value.id},{label:"Tanggal Daftar",value:H(l.value.tgl_daftar_m)+" | "+fa(l.value.tgl_daftar_h)},{label:"Tahun Ajaran",value:`${l.value.th_ajaran_h||"-"} | ${l.value.th_ajaran_m||"-"}`}]),T=E(()=>({Nama:`${l.value.nama?l.value.nama?.toUpperCase():""} (${l.value.sex?.toUpperCase()})`,Alamat:$a(l.value.jl,l.value.rt,l.value.rw,l.value.desa,l.value.kecamatan,l.value.kabupaten,l.value.provinsi,l.value.kode_pos),Kelahiran:`${l.value.tmp_lahir||"-"}, ${H(l.value.tgl_lahir)}`,"Data Akhir":l.value.data_akhir||"-"}));J(async()=>{await P()});function A(){C().setEdit(),b.value=!0}const y=V(!1),D=m=>y.value=m;async function u(){y.value=!1,await o()}return(m,N)=>{const ea=z("CardHeader");return d(),g(da,{class:"q-pa-sm"},{default:e(()=>[a(B,{class:""},{default:e(()=>[a(ea,{title:"Data Santri",onOnReload:P},{right:e(()=>[a(f,{label:m.$q.screen.lt.sm?"":"Cari",onClick:N[0]||(N[0]=la=>c.value=!0),color:"green-2","no-caps":"",dense:"",class:"q-px-sm text-green-10 q-ml-sm",icon:"search"},null,8,["label"]),a(f,{"no-caps":"",color:"green-2",dense:"",class:"q-px-sm text-green-10 q-ml-sm",icon:"edit",label:m.$q.screen.lt.sm?"":"Edit",onClick:A},null,8,["label"]),v("div",La,[a(Ra,{santri:$(l)},null,8,["santri"])])]),_:1}),a(Q,{class:"no-padding"},{default:e(()=>[v("div",Ta,[v("div",Aa,[a(Sa,{class:"q-mb-sm",data:L.value,loading:p.value,title:"Registrasi"},null,8,["data","loading"]),a(Ba,{class:"q-mb-sm",title:"Identitas",data:T.value,loading:p.value,loadingImage:t.value,image:$(l)?.image_url||"/user-default.png"},{button:e(()=>[a(f,{class:"q-mt-sm full-width",icon:"upload","no-caps":"",label:"Foto",dense:"",size:"sm",outline:"",color:"green-10",onClick:N[1]||(N[1]=la=>y.value=!0)})]),_:1},8,["data","loading","loadingImage","image"])]),v("div",Ka,[a(Pa,{"santri-id":$(s)},null,8,["santri-id"])])])]),_:1})]),_:1}),a(pa,{"img-format":"jpg","show-uploader":y.value,url:`/images/santri/${$(s)}`,onUpdateUploader:D,onSuccessUpload:u},null,8,["show-uploader","url"])]),_:1})}}};export{Re as default};
