import{q as u,ad as F,ae as K,A as v,ac as O,s as G,E as S,c as _,o as b,w as l,g as a,n as P,p as y,v as p,Q as k,l as h,a as w,t as D,bR as x,a9 as J,aq as W,e as X}from"./index-B_fOp8I2.js";import{Q as q,a as c}from"./QItem-BIr2qAQs.js";import{Q as f}from"./QItemLabel-Dzv1rcUf.js";import{Q as Y}from"./QList-Bhy1FtzV.js";import{Q as Z}from"./QSelect-udWnZaoN.js";import{Q as A}from"./QTd-CBe108Io.js";import{Q as ee}from"./QTable-Cxe79E5H.js";import{C as I}from"./ClosePopup-OWfInyoi.js";import{A as T}from"./ArrayCrud-CByp4EUn.js";import{A as ae}from"./ApiCrud-DVH4XNNQ.js";import{u as le}from"./pulangan-store-BoRzphPv.js";import"./QChip-5TM6hDLU.js";import"./QMenu-BsVEoqbp.js";import"./selection-CtPAXORa.js";import"./rtl-DFPa-2ov.js";import"./format-CJebrXOQ.js";import"./QMarkupTable-O1N7MMlJ.js";import"./use-fullscreen-B54qEUBN.js";import"./Api-BNo_L0HG.js";import"./index-Bv8s4jzG.js";import"./index-BF457XYG.js";import"./apiPost-TFI76I_W.js";class te extends ae{constructor(){super("pulangan/santri")}}const Q=new te,oe={class:"q-gutter-sm"},he={__name:"SantriPage",setup(U){const r=u([]),V=F().params.id,R=le(),{pulangan:B}=K(R),d=v(()=>B.value.find(t=>t.id==V||t.slug==V)),s=u(!1),m=u(null),g=u(null),n=u("all"),H=O(),N=v(()=>{const t=new Set(r.value.map(e=>e.domisili));return Array.from(t).filter(e=>e!==null).sort((e,i)=>e.localeCompare(i))}),j=v(()=>r.value.filter(t=>{const e=!m.value||t.domisili===m.value,i=n.value==="yes"?t.is_pulang==1:n.value==="no"?t.is_pulang==0:!0;return e&&i})),C=async()=>{try{s.value=!0;const t=await Q.getAll({params:{identity:d.value.slug}});r.value=t.santri_pulang}catch(t){console.log("ðŸš€ ~ reload ~ error:",t)}finally{s.value=!1}};G(async()=>{await C()});const M=async(t,e)=>{try{r.value=T.update(r.value,e,{is_pulang:t}),s.value=!0,await Q.update({id:e,data:{is_pulang:t}})}catch(i){console.log("ðŸš€ ~ togglePulang ~ error:",i),r.value=T.update(r.value,e,{is_pulang:t?0:1})}finally{s.value=!1}},z=async()=>{try{s.value=!0,await Q.remove({id:d.value.slug,message:"Hapus semua data ini?"}),H.go(-1)}catch(t){console.log("ðŸš€ ~ deleteData ~ error:",t)}finally{s.value=!1}},L=[{name:"santri_id",label:"ID Santri",field:"santri_id",sortable:!0,align:"center"},{name:"nama",label:"Nama",field:"nama",sortable:!0,align:"left"},{name:"domisili",label:"Domisili",field:"domisili",sortable:!0,align:"left"},{name:"kelas_tk",label:"Kelas",field:t=>(t.tingkat??"")+" ~ "+(t.kelas??""),sortable:!0,align:"left"},{name:"alamat_pendek",label:"Alamat",field:"alamat_pendek",sortable:!0,align:"left"},{name:"is_pulang",label:"Pulang",field:"is_pulang",sortable:!1,align:"center"}];return(t,e)=>{const i=S("CardHeader"),$=S("CardPage");return b(),_($,null,{default:l(()=>[a(i,{"show-reload":!0,title:"Data Santri Pulang",onOnReload:C},{more:l(()=>[a(Y,null,{default:l(()=>[P((b(),_(q,{clickable:"",to:"/info/download",class:""},{default:l(()=>[a(c,{avatar:"",class:"text-positive"},{default:l(()=>[a(y,{name:"print"})]),_:1}),a(c,null,{default:l(()=>[a(f,{overline:""},{default:l(()=>[...e[5]||(e[5]=[p(" Cetak ",-1)])]),_:1}),a(f,{caption:""},{default:l(()=>[...e[6]||(e[6]=[p(" Surat Izin Pulang ",-1)])]),_:1})]),_:1})]),_:1})),[[I]]),P((b(),_(q,{clickable:"",onClick:z,class:"bg-red-1"},{default:l(()=>[a(c,{avatar:"",class:"text-negative"},{default:l(()=>[a(y,{name:"delete_forever"})]),_:1}),a(c,null,{default:l(()=>[a(f,{overline:""},{default:l(()=>[...e[7]||(e[7]=[p(" Hapus ",-1)])]),_:1}),a(f,{caption:""},{default:l(()=>[...e[8]||(e[8]=[p(" Semua data ",-1)])]),_:1})]),_:1})]),_:1})),[[I]])]),_:1})]),_:1}),a(k,{class:"q-pa-sm"},{default:l(()=>[a(h,{class:"",flat:""},{default:l(()=>[a(k,{class:"bg-green-2 text-green-10 text-center text-subtitle2 q-pa-sm"},{default:l(()=>[w("div",null,D(d.value.th_ajaran_h)+" | "+D(d.value.nama),1)]),_:1}),a(k,{class:"tw:grid tw:sm:flex tw:sm:justify-between tw:gap-2 q-pa-sm bg-green-11"},{default:l(()=>[a(Z,{dense:"",class:"full-width",outlined:"",label:"Filter Domisili","emit-value":"","map-options":"",modelValue:m.value,"onUpdate:modelValue":e[0]||(e[0]=o=>m.value=o),options:N.value,loading:s.value,clearable:"",behavior:"menu",style:{"max-width":"450px"}},null,8,["modelValue","options","loading"]),a(h,{bordered:"",flat:"",class:"q-px-sm bg-transparent flex items-center justify-between full-width",style:{"max-width":"450px"}},{default:l(()=>[e[9]||(e[9]=w("div",{class:"text-caption"},"Status",-1)),w("div",oe,[a(x,{modelValue:n.value,"onUpdate:modelValue":e[1]||(e[1]=o=>n.value=o),val:"yes",label:"Pulang",color:"orange-10","checked-icon":"task_alt","unchecked-icon":"panorama_fish_eye"},null,8,["modelValue"]),a(x,{modelValue:n.value,"onUpdate:modelValue":e[2]||(e[2]=o=>n.value=o),val:"no",label:"Tidak",color:"orange-10","checked-icon":"task_alt","unchecked-icon":"panorama_fish_eye"},null,8,["modelValue"]),a(x,{modelValue:n.value,"onUpdate:modelValue":e[3]||(e[3]=o=>n.value=o),val:"all",label:"Semua",color:"orange-10","checked-icon":"task_alt","unchecked-icon":"panorama_fish_eye"},null,8,["modelValue"])])]),_:1}),a(J,{class:"full-width",outlined:"",dense:"",debounce:"300",modelValue:g.value,"onUpdate:modelValue":e[4]||(e[4]=o=>g.value=o),placeholder:"Cari data ...",clearable:"",style:{"max-width":"450px"}},{append:l(()=>[a(y,{name:"search"})]),_:1},8,["modelValue"])]),_:1})]),_:1}),a(ee,{class:"q-mt-sm",flat:"",bordered:"",rows:j.value,columns:L,loading:s.value,"row-key":"id","rows-per-page-options":[10,25,50,100,0],filter:g.value},{"body-cell-santri_id":l(o=>[a(A,{props:o},{default:l(()=>[a(X,{size:"sm","no-caps":"",outline:"",class:"text-green-10 q-px-sm",to:`/santri/${o.value}`,label:o.value},null,8,["to","label"])]),_:2},1032,["props"])]),"body-cell-is_pulang":l(o=>[a(A,{props:o},{default:l(()=>[a(W,{"model-value":o.value,"true-value":1,"false-value":0,"checked-icon":"check","unchecked-icon":"clear",color:"positive","onUpdate:modelValue":(E,se)=>M(E,o.row.id)},null,8,["model-value","onUpdate:modelValue"])]),_:2},1032,["props"])]),_:1},8,["rows","loading","filter"])]),_:1})]),_:1})}}};export{he as default};
