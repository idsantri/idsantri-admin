import{q as d,E as c,c as C,o as m,w as s,g as e,af as B,f as F,Q,a9 as q,l as I,s as E,a,b as k,e as h,v as S,t as y,F as G,D as H,ap as T,G as j,J as M}from"./index-DU_HTlLB.js";import{Q as O}from"./QImg-DkL3_Rkg.js";import{Q as v}from"./QItemLabel-L7dSSnSA.js";import{Q as P,a as A}from"./QItem-BbodOwCO.js";import{Q as R}from"./QList-DmBsZOwe.js";import{a as J}from"./api-get-C_HGQ1i3.js";import{t as z}from"./format-text-DnCGEu2I.js";import{b as K}from"./index-Bkc3wIyA.js";import{_ as W}from"./ImageUploader-DNqZWpIz.js";import{Q as X}from"./QForm-DITd0Hw9.js";import{A as Y}from"./Api-NxoWfBb3.js";import"./index-qAgkCKpN.js";import"./api-error-B8ANjOsk.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";class Z extends Y{constructor(){super("user")}async get(){return(await this._apiGet({endPoint:this._path})).data}async update(l,u=!1){if(u&&!await this._notifyConfirm("Update profil Anda?"))return!1;const p=await this._apiUpdate({endPoint:`${this._path}`,data:l});return this._showSuccess(p.message),p.data}}const D=new Z,ee={__name:"UserForm",props:{data:{type:Object,required:!0}},emits:["successDelete","successSubmit","successUpdate","successCreate"],setup(w,{emit:l}){const u=l,o=d({...w.data}),i=d(!1);async function x(){const _={username:o.value.username,name:o.value.name,phone:o.value.phone};try{i.value=!0;const r=await D.update(_,!0);r&&(document.getElementById("btn-close-form")?.click(),u("successSubmit",r.user),u("successUpdate",r.user))}catch{}finally{i.value=!1}}return(_,r)=>{const b=c("FormHeader"),f=c("FormLoading"),U=c("FormActions");return m(),C(I,{class:"full-width",style:{"max-width":"425px"}},{default:s(()=>[e(X,{onSubmit:B(x,["prevent"])},{default:s(()=>[e(b,{title:"Update Profil","is-new":!1}),i.value?(m(),C(f,{key:0})):F("",!0),e(Q,null,{default:s(()=>[e(q,{class:"q-my-sm",dense:"",outlined:"",label:"Nama",modelValue:o.value.name,"onUpdate:modelValue":r[0]||(r[0]=n=>o.value.name=n),hint:""},null,8,["modelValue"]),e(q,{class:"q-my-sm",dense:"",outlined:"",label:"Username",modelValue:o.value.username,"onUpdate:modelValue":r[1]||(r[1]=n=>o.value.username=n),hint:"Anda bisa login dengan username atau email"},null,8,["modelValue"]),e(q,{class:"q-my-sm",dense:"",outlined:"",label:"Nomor Telepon",modelValue:o.value.phone,"onUpdate:modelValue":r[2]||(r[2]=n=>o.value.phone=n),hint:"08123456789"},null,8,["modelValue"])]),_:1}),e(U,{"btn-delete":!1})]),_:1})]),_:1})}}},ae={class:"absolute-top-right q-ma-sm"},te={style:{"max-width":"150px"},class:"q-mx-auto"},se={key:0},le={class:"float-right"},oe={class:"fit row wrap justify-start items-start content-start"},we={__name:"ProfileIndex",setup(w){const l=d({}),u=d(!1),p=d(!1),o=d(!1),i=d(!1),x=n=>i.value=n;async function _(){i.value=!1,await b()}async function r(){try{u.value=!0;const n=await D.get();l.value=n.user}catch(n){console.log("ðŸš€ ~ loadData ~ error:",n)}finally{u.value=!1}}async function b(){const n=await J({endPoint:`images/users/${l.value.id}`,loading:p});l.value.image=n.image_url||"/user-default.png"}async function f(){await r(),await b()}E(async()=>{await f()});const U=async()=>{await K("Untuk mengganti password, silakan <strong>logout (keluar)</strong>. Pada halaman login, klik <strong>lupa password</strong>.<br/>Ikuti petunjuk yang diberikan.",0)};return(n,t)=>{const $=c("CardHeader"),L=c("CardLoading"),N=c("CardPage");return m(),C(N,null,{default:s(()=>[e($,{title:"Profil Pengguna",onOnReload:f}),e(Q,{class:"q-pa-sm"},{default:s(()=>[e(I,{class:"",flat:"",bordered:"",style:{"max-width":"600px"}},{default:s(()=>[e(Q,{class:"q-pa-sm"},{default:s(()=>[a("div",ae,[e(h,{icon:"camera",round:"","no-caps":"",dense:"",glossy:"",class:"q-ma-xs q-px-sm",onClick:t[0]||(t[0]=g=>i.value=!0)})]),a("div",te,[e(O,{src:l.value.image,ratio:1,alt:"user","img-style":{borderRadius:"50%",border:"3px",borderColor:"green",borderStyle:"solid"}},null,8,["src"])]),l.value.confirmed_at?F("",!0):(m(),k("div",se,[...t[3]||(t[3]=[a("div",{class:"text-center q-my-lg"},[a("div",{class:"q-pa-md text-negative bg-red-1",style:{"border-radius":"10px"}},[a("div",null,"Akun Anda belum terkonfirmasi."),a("div",null,"Silakan hubungi Admin!")])],-1)])])),e(R,{bordered:"",separator:"",class:"q-mt-sm"},{default:s(()=>[e(P,{class:"q-pa-sm"},{default:s(()=>[e(A,null,{default:s(()=>[e(v,{overline:""},{default:s(()=>[...t[4]||(t[4]=[S("User",-1)])]),_:1}),e(v,null,{default:s(()=>[a("table",null,[a("tbody",null,[a("tr",null,[t[5]||(t[5]=a("td",{class:"text-italic text-caption"},"Nama",-1)),a("td",null,y(l.value.name),1)]),a("tr",null,[t[6]||(t[6]=a("td",{class:"text-italic text-caption"},"Email",-1)),a("td",null,y(l.value.email),1)]),a("tr",null,[t[7]||(t[7]=a("td",{class:"text-italic text-caption"},"Username",-1)),a("td",null,y(l.value.username),1)]),a("tr",null,[t[8]||(t[8]=a("td",{class:"text-italic text-caption"},"Telepon",-1)),a("td",null,y(l.value.phone||"-"),1)])])])]),_:1}),e(v,{class:"bg-green-1"},{default:s(()=>[a("div",le,[e(h,{label:"User",icon:"edit","no-caps":"",dense:"",class:"q-my-xs q-mx-sm q-px-sm",onClick:t[1]||(t[1]=g=>o.value=!0)}),e(h,{label:"Password",icon:"edit","no-caps":"",dense:"",class:"q-my-xs q-mx-sm q-px-sm",onClick:U})])]),_:1})]),_:1})]),_:1}),e(P,{class:"q-pa-sm"},{default:s(()=>[e(A,null,{default:s(()=>[e(v,{overline:""},{default:s(()=>[...t[9]||(t[9]=[S("User Group",-1)])]),_:1}),e(v,null,{default:s(()=>[a("div",oe,[(m(!0),k(G,null,H(l.value.roles,(g,V)=>(m(),k("div",{key:V,class:"col-6"},[e(T,{"model-value":g,color:"green",label:j(z)(V),disable:""},null,8,["model-value","label"])]))),128))])]),_:1})]),_:1})]),_:1})]),_:1}),e(L,{showing:u.value},null,8,["showing"])]),_:1})]),_:1})]),_:1}),e(M,{modelValue:o.value,"onUpdate:modelValue":t[2]||(t[2]=g=>o.value=g)},{default:s(()=>[e(ee,{data:l.value,onSuccessSubmit:f},null,8,["data"])]),_:1},8,["modelValue"]),e(W,{"show-uploader":i.value,url:`/images/users/${l.value.id}`,width:300,height:300,"img-format":"webp",onUpdateUploader:x,onSuccessUpload:_},null,8,["show-uploader","url"])]),_:1})}}};export{we as default};
