import{q as i,N as M,E as w,c as G,o as N,w as t,g as a,af as j,f as O,G as V,Q as $,a9 as v,l as I,a as A,s as J,e as S,v as c,t as k,p as H,J as F}from"./index-B4cgRUYO.js";import{Q as m}from"./QTd-BSRHd_ZZ.js";import{Q as L}from"./QTr-BP2EaDPo.js";import{Q as P}from"./QTable-DLMPxYbt.js";import{d as T}from"./format-number-B34ySHL_.js";import{Q as R}from"./QSelect-Dur_NzhU.js";import{Q as E}from"./QForm-D5dn9dNC.js";import{_ as z}from"./InputCurrency-o0m7B4jK.js";import{u as W}from"./useCrudForm-B8AmedPK.js";import{A as X}from"./ApiCrud-DvdKryYe.js";import{U as Y}from"./UgtGt-BdY9aWXV.js";import{_ as Z}from"./ReportViewer-DT7o4Fhg.js";import{c as h}from"./format-date-OVhbBx9F.js";import{_ as ee}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./QList-B3oM_0ji.js";import"./QMarkupTable-Cr886gAl.js";import"./use-fullscreen-CQZIFs7F.js";import"./QChip-DCEkVw4n.js";import"./QItem-2FhwRmS0.js";import"./QItemLabel-CwfJ-FXf.js";import"./QMenu-BvZtuO17.js";import"./selection-DzMKN9sr.js";import"./rtl-DFPa-2ov.js";import"./format-CJebrXOQ.js";import"./Api-B2onMMsp.js";import"./index-C6wQ9iCE.js";import"./index-GF_WWTiL.js";import"./api-error-B6W5wGpQ.js";import"./id-BuNGTsqN.js";class ae extends X{constructor(){super("ugt/kas")}}const B=new ae,le={__name:"UgtKasForm",props:{data:Object},emits:["successDelete","successSubmit","successUpdate","successCreate"],setup(K,{emit:C}){const p=K,b=C,n=i({keperluan:"Biaya Administrasi GT",keterangan:"Lunas",flag:"+",...p.data}),g=i(!1),d=i({}),f=!p.data?.id,{handleDelete:q,handleCreate:y,handleUpdate:x,loading:U}=W(B,{emit:b,responseKey:"kas"}),Q=async()=>{const r=JSON.parse(JSON.stringify(n.value));return delete r.id,f?await y(r,!0):await x(p.data.id,r,!0)},s=async()=>await q(p.data.id);async function o(r){try{g.value=!0;const l=await Y.getById({id:r,notifySuccess:!1});d.value=l.gt}catch{d.value.nama="Data tidak ditemukan",d.value.pjgt_nama="Data tidak ditemukan"}finally{g.value=!1}}return M(()=>n.value.gt_id,async(r,l)=>{d.value.nama="",d.value.pjgt_nama="",r!=l&&await o(r)},{immediate:!0}),(r,l)=>{const e=w("FormHeader"),_=w("FormLoading"),D=w("FormActions");return N(),G(I,{class:"full-width",style:{"max-width":"425px"}},{default:t(()=>[a(E,{onSubmit:j(Q,["prevent"])},{default:t(()=>[a(e,{title:"Input Kas UGT","is-new":f}),V(U)?(N(),G(_,{key:0})):O("",!0),a($,{class:"q-pa-sm"},{default:t(()=>[a(v,{dense:"",hint:"Diisi oleh sistem",class:"",outlined:"",label:"ID",modelValue:n.value.id,"onUpdate:modelValue":l[0]||(l[0]=u=>n.value.id=u),disable:"",filled:""},null,8,["modelValue"]),a(I,{class:"q-my-sm",flat:"",bordered:""},{default:t(()=>[a($,{class:"q-pa-sm"},{default:t(()=>[l[8]||(l[8]=A("div",{class:"text-caption"},"Jika terkait dengan administrasi GT",-1)),a(v,{dense:"",class:"q-my-sm",outlined:"",label:"GT ID",modelValue:n.value.gt_id,"onUpdate:modelValue":l[1]||(l[1]=u=>n.value.gt_id=u),clearable:"",debounce:"500"},null,8,["modelValue"]),a(v,{dense:"",class:"q-my-sm",outlined:"",label:"Nama GT",modelValue:d.value.nama,"onUpdate:modelValue":l[2]||(l[2]=u=>d.value.nama=u),disable:"",filled:"",loading:g.value},null,8,["modelValue","loading"]),a(v,{dense:"",class:"q-my-sm",outlined:"",label:"Nama PJGT",modelValue:d.value.pjgt_nama,"onUpdate:modelValue":l[3]||(l[3]=u=>d.value.pjgt_nama=u),disable:"",filled:"",loading:g.value},null,8,["modelValue","loading"])]),_:1})]),_:1}),a(v,{dense:"",class:"q-my-sm",outlined:"",label:"Keperluan",modelValue:n.value.keperluan,"onUpdate:modelValue":l[4]||(l[4]=u=>n.value.keperluan=u)},null,8,["modelValue"]),a(R,{dense:"",class:"q-my-sm",outlined:"",label:"Kas Masuk/Keluar",modelValue:n.value.flag,"onUpdate:modelValue":l[5]||(l[5]=u=>n.value.flag=u),options:[{value:"+",label:"Masuk"},{value:"-",label:"Keluar"}],"emit-value":"","map-options":"","error-color":"negative",behavior:"menu"},null,8,["modelValue"]),a(z,{dense:"",class:"q-my-sm",outlined:"",modelValue:n.value.nominal,"onUpdate:modelValue":l[6]||(l[6]=u=>n.value.nominal=u),required:"",label:"Nominal"},null,8,["modelValue"]),a(v,{dense:"",class:"q-my-sm",outlined:"",label:"Keterangan",modelValue:n.value.keterangan,"onUpdate:modelValue":l[7]||(l[7]=u=>n.value.keterangan=u),autogrow:""},null,8,["modelValue"])]),_:1}),a(D,{"btn-delete":!f,onOnDelete:s},null,8,["btn-delete"])]),_:1})]),_:1})}}},te={class:"q-gutter-sm"},ne={__name:"KasIndex",setup(K){const C=i([]),p=i(!1),b=i(""),n=i(!1),g=i({}),d=i("");async function f(){try{p.value=!0;const s=await B.getAll();C.value=s.kas}catch{console.log("error get kas ugt")}finally{p.value=!1}}function q(){g.value={},n.value=!0}const y=i(!1);async function x(s){d.value=`reports/ugt/kuitansi/view?id=${s.id}`,y.value=!0}function U(s){const o=s.masuk?"+":"-",r=s.masuk||s.keluar,l={id:s.id,gt_id:s.gt_id,keperluan:s.keperluan,keterangan:s.keterangan,flag:o,nominal:r};g.value=l,n.value=!0}J(async()=>{await f()});const Q=[{name:"id",label:"ID",align:"left",field:"id",sortable:!0},{name:"tgl_m",label:"Tanggal",align:"left",field:"tgl_m",sortable:!0},{name:"keperluan",label:"Keperluan",align:"left",field:"keperluan",sortable:!0},{name:"keterangan",label:"Keterangan",align:"left",field:"keterangan",sortable:!0},{name:"masuk",label:"Masuk",align:"right",field:"masuk",sortable:!0},{name:"keluar",label:"Keluar",align:"right",field:"keluar",sortable:!0},{name:"saldo",label:"Saldo",align:"right",field:"saldo",sortable:!0},{name:"cr_by",label:"By",align:"left",field:"cr_by",sortable:!0},{name:"edit",label:"!",align:"center",field:"",sortable:!1}];return(s,o)=>{const r=w("CardHeader"),l=w("CardPage");return N(),G(l,null,{default:t(()=>[a(r,{title:"Kas UGT",onOnReload:f},{buttons:t(()=>[a(S,{dense:"",class:"q-px-md text-green-10",label:"Tambah","no-caps":"",icon:"add",color:"green-2",onClick:q})]),_:1}),a($,{class:"no-padding"},{default:t(()=>[a(P,{rows:C.value,loading:p.value,"rows-per-page-options":[10,25,50,100,0],pagination:{page:999},class:"dt q-px-sm",columns:Q,filter:b.value,"no-data-label":"Tidak ada data untuk ditampilkan!","no-results-label":"Tidak ditemukan kata kunci yang sesuai dengan pencarian Anda!","row-key":"name",onRowClick:o[1]||(o[1]=(e,_,D)=>U(e,_,D))},{"top-right":t(()=>[a(v,{outlined:"",dense:"",debounce:"300",modelValue:b.value,"onUpdate:modelValue":o[0]||(o[0]=e=>b.value=e),placeholder:"Cari"},{append:t(()=>[a(H,{name:"search"})]),_:1},8,["modelValue"])]),body:t(e=>[a(L,{props:e},{default:t(()=>[a(m,{key:"id",props:e},{default:t(()=>[c(k(e.row.id),1)]),_:2},1032,["props"]),a(m,{key:"tgl_m",props:e,title:"format tanggal dd/mm/yyyy"},{default:t(()=>[c(k(V(h)(e.row.tgl_m,"dd/MM/yyyy")),1)]),_:2},1032,["props"]),a(m,{key:"keperluan",props:e},{default:t(()=>[c(k(e.row.gt_id?`${e.row.keperluan} (${e.row.gt_id})`:e.row.keperluan),1)]),_:2},1032,["props"]),a(m,{key:"keterangan",props:e},{default:t(()=>[c(k(e.row.keterangan),1)]),_:2},1032,["props"]),a(m,{key:"masuk",props:e},{default:t(()=>[c(k(V(T)(e.row.masuk)),1)]),_:2},1032,["props"]),a(m,{key:"keluar",props:e},{default:t(()=>[c(k(V(T)(e.row.keluar)),1)]),_:2},1032,["props"]),a(m,{key:"saldo",props:e},{default:t(()=>[c(k(V(T)(e.row.saldo)),1)]),_:2},1032,["props"]),a(m,{key:"cr_by",props:e},{default:t(()=>[c(k(e.row.cr_by),1)]),_:2},1032,["props"]),a(m,{key:"edit",props:e},{default:t(()=>[A("div",te,[a(S,{icon:"edit","no-caps":"",color:"green-10",outline:"",dense:"",class:"q-px-md",onClick:_=>U(e.row)},null,8,["onClick"]),a(S,{icon:"print","no-caps":"",color:"green-10",outline:"",dense:"",class:"q-px-md",onClick:_=>x(e.row),disable:!e.row.gt_id},null,8,["onClick","disable"])])]),_:2},1032,["props"])]),_:2},1032,["props"])]),_:1},8,["rows","loading","filter"])]),_:1}),a(F,{persistent:"",modelValue:n.value,"onUpdate:modelValue":o[4]||(o[4]=e=>n.value=e)},{default:t(()=>[a(le,{data:g.value,onSuccessSubmit:o[2]||(o[2]=e=>f()),onSuccessDelete:o[3]||(o[3]=e=>f())},null,8,["data"])]),_:1},8,["modelValue"]),a(F,{modelValue:y.value,"onUpdate:modelValue":o[5]||(o[5]=e=>y.value=e)},{default:t(()=>[a(Z,{url:d.value},null,8,["url"])]),_:1},8,["modelValue"])]),_:1})}}},$e=ee(ne,[["__scopeId","data-v-496a7660"]]);export{$e as default};
