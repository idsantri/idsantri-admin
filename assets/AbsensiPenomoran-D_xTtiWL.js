import{q as c,ad as Q,s as C,b as I,o as N,g as e,w as t,Q as _,a as p,e as f,t as s,v as u,a9 as T,m as q,l as D}from"./index-CTu7YwFB.js";import{Q as r}from"./QTd-BVOgOqP-.js";import{Q as V}from"./QTr-DBSLj_5-.js";import{Q as $}from"./QTable-BphxH1qp.js";import{_ as B}from"./FilterKelas-DhqwAemS.js";import{K as g}from"./Kelas-nzJLl1rD.js";import{c as S,n as K}from"./index-C1IRoDfZ.js";import{_ as M}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./QList-_ILsuiZc.js";import"./QMarkupTable-BFYtV1jQ.js";import"./QSelect-JvTQ0dvX.js";import"./QField-Db_0jma7.js";import"./QChip-B5x4J8Y2.js";import"./QItem-D_Mc3Ybi.js";import"./QItemLabel-zF37nF6N.js";import"./QMenu-HlOjAWfh.js";import"./selection-ZKB3auoy.js";import"./rtl-DFPa-2ov.js";import"./format-CJebrXOQ.js";import"./use-fullscreen-D5Sjmuwo.js";import"./QToolbar-CCSAQV2r.js";import"./QSpace-Cc9seJp2.js";import"./lists-madrasah-store-BIUc5Fbj.js";import"./AbsensiSetting-CZjzASld.js";import"./ApiCrud-CA5HHKOk.js";import"./Api-D1K9Gq0l.js";import"./index-BkhcIjqz.js";import"./apiPost-DSA7pR-q.js";const j=["innerHTML"],E={__name:"AbsensiPenomoran",setup(F){const i=c(!1),{params:d}=Q(),l=c([]),b=c("");async function k(){if(!await S("Isi nomor Absen secara otomatis"))return;const a=[...document.getElementsByClassName("kelas-id")];let m=1;a.forEach(y=>{const v=y.innerText,h=l.value.findIndex(A=>A.id==v);l.value[h].no_absen=m,m++}),K("Isi otomatis berhasil! <br/>Data belum diupdate sampai Anda menekan tombol kirim/simpan!")}async function x(){const o=l.value.map(({id:n,no_absen:a})=>({id:n,no_absen:a}));try{i.value=!0;const n=await g.updateNoAbsen(o);l.value=n.murid}catch(n){console.error("ðŸš€ ~ updateNoAbsen ~ error:",n)}finally{i.value=!1}}C(async()=>{if(d.th_ajaran_h&&d.tingkat_id&&d.kelas)try{i.value=!0;const n=(await g.getAll({params:d})).murid.map(a=>({...a,alamat:`${a.desa} ${a.kecamatan} ${a.kabupaten}`}));l.value=n}catch(o){console.error("ðŸš€ ~ error:",o)}finally{i.value=!1}else l.value=[]});const w=[{name:"id",label:"ID Kelas",align:"left",field:"id",sortable:!0},{name:"santri_id",label:"ID Santri",align:"left",field:"santri_id",sortable:!0},{name:"no_absen",label:"No Absen",align:"center",field:"no_absen",sortable:!0,style:"width:44px",classes:"text-center"},{name:"nama",label:"Nama",align:"left",field:"nama",sortable:!0},{name:"domisili",label:"Dom.",align:"left",field:"domisili",sortable:!0},{name:"alamat",label:"Alamat",align:"left",field:"alamat",sortable:!0,classes:"alamat"}];return(o,n)=>(N(),I("div",null,[e(B,{"start-url":"/madrasah/absensi/penomoran",onDataFilter:n[0]||(n[0]=a=>b.value=a)}),e(D,{class:"q-mt-sm",flat:"",bordered:""},{default:t(()=>[e(_,{class:"bg-green-7 text-green-1 text-subtitle1 q-pa-sm flex"},{default:t(()=>[p("span",{innerHTML:b.value||"Tentukan filter!"},null,8,j)]),_:1}),e(_,{class:"no-padding"},{default:t(()=>[e($,{rows:l.value,columns:w,loading:i.value,"rows-per-page-options":[0],class:"dt q-pa-sm","no-data-label":"Silakan tentukan Tahun ajaran, tingkat pendidikan, dan kelas!","row-key":"name",flat:"","hide-pagination":""},{"top-left":t(()=>[...n[1]||(n[1]=[p("div",{class:"text-h6 text-green-10"},"Data Murid",-1)])]),"top-right":t(()=>[e(f,{label:"Isi Otomatis",dense:"","no-caps":"",class:"q-px-md text-green-10",color:"green-11",icon:"auto_fix_high",onClick:k,disable:l.value.length==0,title:"Isi otomatis nomor absen"},null,8,["disable"])]),body:t(a=>[e(V,{props:a},{default:t(()=>[e(r,{key:"id",props:a,class:"kelas-id"},{default:t(()=>[e(f,{flat:"",dense:"","no-caps":"",class:"text-green-10 bg-green-11 q-px-sm",style:{"min-width":"50px"},onClick:m=>o.$router.push(`/madrasah/kelas/${a.row.id}/riwayat`)},{default:t(()=>[p("small",null,s(a.row.id),1)]),_:2},1032,["onClick"])]),_:2},1032,["props"]),e(r,{key:"santri_id",props:a},{default:t(()=>[u(s(a.row.santri_id),1)]),_:2},1032,["props"]),e(r,{key:"no_absen",props:a},{default:t(()=>[e(T,{outlined:"",dense:"",modelValue:a.row.no_absen,"onUpdate:modelValue":m=>a.row.no_absen=m,"input-class":"text-center",mask:"##"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["props"]),e(r,{key:"nama",props:a},{default:t(()=>[u(s(a.row.nama)+" ("+s(a.row.sex)+") ",1)]),_:2},1032,["props"]),e(r,{key:"domisili",props:a},{default:t(()=>[u(s(a.row.domisili),1)]),_:2},1032,["props"]),e(r,{key:"alamat",props:a,title:a.row.alamat},{default:t(()=>[u(s(a.row.alamat?.length>30?a.row.alamat.substr(0,30)+"â€¦":a.row.alamat),1)]),_:2},1032,["props","title"])]),_:2},1032,["props"])]),_:1},8,["rows","loading"])]),_:1}),e(q,{class:"bg-green-6 text-green-11 text-subtitle1 q-pa-sm flex",align:"right"},{default:t(()=>[e(f,{dense:"",label:"Kirim/Simpan","no-caps":"",color:"green-11",class:"text-green-10 q-px-md",icon:"save",onClick:x})]),_:1})]),_:1})]))}},ba=M(E,[["__scopeId","data-v-3d511056"]]);export{ba as default};
