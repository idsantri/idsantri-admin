import{Q}from"./QSelect-D5tM8e3R.js";import{q as g,ae as j,s as q,N as v,E as y,c as C,o as A,w as o,g as l,Q as p,l as B,n as S,G as s,ag as f,a9 as _,a as $,a4 as H,e as N,v as U,p as I,t as M,J as R}from"./index-BGObraKh.js";import{Q as P}from"./QTd-Ccsm0kER.js";import{Q as K}from"./QTable-yNQtEhO1.js";import{u as O,_ as z}from"./apb-transactions-store-DDVGuh7M.js";import{_ as G}from"./InputSearch-BtFt3kFq.js";import{c as J}from"./format-date-DBaFa2rd.js";import{f as E,m as F}from"./hijri-CTUg_lXm.js";import"./QField-Br2Qbnc0.js";import"./QChip-Ai3wvF9-.js";import"./QItem-DfMJTwsS.js";import"./QItemLabel-B-_aW8yV.js";import"./QMenu-DmBcKTCH.js";import"./selection-DjrSooP-.js";import"./rtl-DFPa-2ov.js";import"./format-CJebrXOQ.js";import"./QList-BBsNFqg5.js";import"./QMarkupTable-CJNTueb6.js";import"./use-fullscreen-Dw8aA46T.js";import"./QForm-BsaO44hu.js";import"./useCrudForm-DDpDHX6R.js";import"./ApbTransaction-B0Rh5XDV.js";import"./ApiCrud-BSS5T12d.js";import"./Api-CDu9vKW9.js";import"./index-CWFlz0I4.js";import"./index-pzyLC6ns.js";import"./apiPost-B_iRVN6p.js";import"./ArrayCrud-CByp4EUn.js";import"./id-BuNGTsqN.js";import"./format-number-B34ySHL_.js";const Da={__name:"PageIndex",setup(L){const b=g(!1),m=g(!1),n=O(),{transactions:c,loadingTh:k,optionsThAjaran:w,loading:T,filter:d,thAjaranH:r,startDate:i,endDate:u}=j(n);q(async()=>{m.value=!1,w.value?.length||await n.listTahun()});async function x(){await n.listTahun(),r.value?(await n.loadByTahun(r.value),m.value=!0):i.value&&u.value&&(await n.loadByDate(i.value,u.value),m.value=!0)}v(r,async t=>{t?(i.value="",u.value="",await n.loadByTahun(t),m.value=!0):c.value=[]}),v([i,u],async([t,a])=>{t&&a?(r.value="",await n.loadByDate(t,a),m.value=!0):c.value=[]});const V=[{name:"id",label:"ID",align:"center",field:"id",sortable:!0},{name:"th_ajaran_h",label:"Th Ajaran",field:"th_ajaran_h",align:"left",sortable:!0},{name:"description",label:"Keterangan",align:"left",field:"description",sortable:!0,style:"white-space: normal; word-wrap: break-word;"},{name:"amount",label:"Nilai",align:"right",field:"amount",format:t=>`${t?t.toRupiah():0}`,sortable:!0},{name:"created_at",label:"Dibuat (M)",align:"left",field:"created_at",format:t=>J(t,"dd-MM-yyyy"),sortable:!0},{name:"hijri",label:"Dibuat (H)",align:"left",field:t=>F(t.created_at),format:t=>E(t),sortable:!0},{name:"by_name",label:"an.",align:"left",field:"by_name",sortable:!0}];return(t,a)=>{const h=y("CardHeader"),D=y("CardPage");return A(),C(D,null,{default:o(()=>[l(h,{title:"Daftar Transaksi",onOnReload:x,"show-add":!0,onOnAdd:a[0]||(a[0]=e=>b.value=!0)}),l(p,{class:"q-pt-sm q-pb-none q-px-sm"},{default:o(()=>[l(B,{bordered:"",flat:"",class:""},{default:o(()=>[l(p,{class:"tw:grid tw:sm:flex tw:sm:justify-between tw:gap-2 q-pa-sm"},{default:o(()=>[l(Q,{dense:"",class:"tw:w-full tw:sm:max-w-sm",outlined:"",label:"Tahun Ajaran","emit-value":"","map-options":"",modelValue:s(r),"onUpdate:modelValue":a[1]||(a[1]=e=>f(r)?r.value=e:null),options:s(w),loading:s(k),clearable:"",behavior:"menu"},null,8,["modelValue","options","loading"]),l(_,{type:"date",dense:"",class:"tw:w-full tw:sm:max-w-sm",outlined:"",label:"Tanggal Awal",modelValue:s(i),"onUpdate:modelValue":a[2]||(a[2]=e=>f(i)?i.value=e:null),clearable:""},null,8,["modelValue"]),l(_,{type:"date",dense:"",class:"tw:w-full tw:sm:max-w-sm",outlined:"",label:"Tanggal Akhir",modelValue:s(u),"onUpdate:modelValue":a[3]||(a[3]=e=>f(u)?u.value=e:null),clearable:""},null,8,["modelValue"]),l(G,{class:"tw:w-full tw:sm:max-w-sm",modelValue:s(d),"onUpdate:modelValue":a[4]||(a[4]=e=>f(d)?d.value=e:null),placeholder:"Cari data transaksi..."},null,8,["modelValue"])]),_:1}),S(l(p,{class:"bg-warning q-pa-xs text-black"},{default:o(()=>[...a[7]||(a[7]=[$("div",{class:"text-caption text-center"}," Data tidak realtime! Klik tombol muat ulang untuk mendapatkan data terbaru. ",-1)])]),_:1},512),[[H,!m.value]])]),_:1})]),_:1}),l(p,{class:"q-pa-sm"},{default:o(()=>[l(K,{bordered:"",flat:"",rows:s(c),loading:s(T),"rows-per-page-options":[10,25,50,100,0],class:"dt",columns:V,filter:s(d),"no-data-label":"Tidak ada data untuk ditampilkan!","no-results-label":"Tidak ditemukan kata kunci yang sesuai dengan pencarian Anda!","row-key":"name"},{"body-cell-id":o(e=>[l(P,{props:e},{default:o(()=>[l(N,{dense:"","no-caps":"",size:"sm",outline:"",class:"text-green-10 q-px-sm",to:`/apb/transactions/${e.value}`},{default:o(()=>[l(I,{name:"sym_o_info",class:"q-mr-xs"}),U(" "+M(e.value),1)]),_:2},1032,["to"])]),_:2},1032,["props"])]),_:1},8,["rows","loading","filter"])]),_:1}),l(R,{persistent:"",modelValue:b.value,"onUpdate:modelValue":a[6]||(a[6]=e=>b.value=e)},{default:o(()=>[l(z,{data:{},onSuccessSubmit:a[5]||(a[5]=e=>{s(n).add(e),t.$router.push(`/apb/transactions/${e.id}`)})})]),_:1},8,["modelValue"])]),_:1})}}};export{Da as default};
