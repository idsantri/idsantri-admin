import{Q as T}from"./QSpace-CoisEuyS.js";import{f,o as d,w as e,i as a,Q as y,k as g,t as A,r as x,a0 as la,F as G,s as na,q as h,v as V,x as oa,n as w,j as $,_ as E,ae as sa,a5 as ia,R as X,a8 as ra,y as ua,B as O,a3 as D,z as I,m as da,p as m,a4 as Y,a7 as Z,av as ma,b as J}from"./index-BOc7y3E3.js";import{Q as pa}from"./QPage-BVhxSLxX.js";import{f as H}from"./format-date-DlwYCgkJ.js";import{_ as fa}from"./CardColumn-DhQ2VI8W.js";import{Q as z}from"./QSpinnerCube-clsjI4Wm.js";import{Q as ca}from"./QImg-Bs0fh872.js";import{_ as ga}from"./ImageUploader-DU5TThtT.js";import{s as j}from"./santri-store-DkgYMx-T.js";import{b as va}from"./hijri-BBdEhqDI.js";import{Q as U}from"./QRouteTab-DQwNLqbb.js";import{Q as S}from"./QItemLabel-CrvmL7Ku.js";import{Q as q,a as u}from"./QItemSection-U4VUPMG0.js";import{Q as aa}from"./QList-DGdmu--E.js";import{Q as ea}from"./QBtnDropdown-BmLRcAl8.js";import{Q as _a}from"./QTabs-55yMxhUl.js";import{C as k}from"./ClosePopup-CcGROVC7.js";import{d as ba}from"./dialog-store-BozMjCmH.js";import{a as wa}from"./api-get-DUTCLQ7F.js";import{a as N}from"./api-download-CcrxpglF.js";import{_ as ka}from"./ReportViewer-BTxyJ1cu.js";import{Q as R}from"./QSelect-Br9kkI5Z.js";import{Q as Va}from"./QForm-CxO-I-hC.js";import{_ as $a}from"./FormHeader-pf3CU3SV.js";import{d as Sa}from"./index-CdkvXyXH.js";import{_ as qa}from"./InputSelectArray-GW0fQ7ez.js";import{l as Ia}from"./loading-store-Dk6OalC_.js";import{S as xa}from"./Santri-U8_GAXz5.js";import"./id-BuNGTsqN.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./index-CHOBZr16.js";import"./format-number-B34ySHL_.js";import"./QBtnGroup-CNPGzkQV.js";import"./QMenu-iXJrGXAP.js";import"./selection-CUoFkLvB.js";import"./QResizeObserver-VQR5g9Vo.js";import"./rtl-DFPa-2ov.js";import"./api-error-CtGrtfSx.js";import"./QChip-DferuxmN.js";import"./format-CJebrXOQ.js";import"./QToolbarTitle-DS7gKC4A.js";import"./QToolbar-DD9_B9vM.js";import"./api-get-lists-CRvCG-zL.js";import"./lists-store-BaLrngMx.js";import"./lists-data-L-iOlbK0.js";import"./DropDownAfter-DERgTKys.js";import"./ApiCrud-CwhLF6YL.js";const ya={class:"flex items-center"},Qa={class:"text-subtitle2"},Ca={key:0},Da={key:1,class:"row"},Ua={class:"col-4 q-pr-sm"},ha={key:0},Ba={class:"col"},Pa={class:"text-caption text-italic"},Na={class:"q-mb-sm"},Ra={__name:"CardImage",props:{title:String,data:Object,image:String,loading:Boolean,loadingImage:Boolean},setup(v){return(t,l)=>(d(),f(h,null,{default:e(()=>[a(y,{class:"bg-green-7 text-green-11 q-pa-sm"},{default:e(()=>[g("div",ya,[g("div",Qa,A(v.title),1),a(T)])]),_:1}),a(y,{class:"q-pa-sm"},{default:e(()=>[v.loading?(d(),x("div",Ca,[a(z,{color:"green-12",size:"8em",class:"flex q-ma-lg q-mx-auto"})])):(d(),x("div",Da,[g("div",Ua,[v.loadingImage?(d(),x("div",ha,[a(z,{color:"green-12",size:"4em",class:"flex q-ma-sm q-mx-auto"})])):(d(),f(ca,{key:1,src:v.image,ratio:3/4,alt:"santri"},null,8,["src"])),la(t.$slots,"button")]),g("div",Ba,[(d(!0),x(G,null,na(v.data,(i,r)=>(d(),x("div",{key:r},[g("div",Pa,A(r),1),g("div",Na,A(i),1)]))),128))])]))]),_:3})]),_:3}))}},ja={__name:"SantriRelations",props:{santriId:{default:null}},setup(v){const t=v,l=V(0);return(i,r)=>{const p=oa("router-view");return d(),f(h,{key:l.value},{default:e(()=>[g("button",{onClick:r[0]||(r[0]=_=>l.value++),id:"btn-rerender-santri-relations",style:{display:"none"}}," rerender "),a(_a,{"no-caps":"","outside-arrows":"","mobile-arrows":"",class:"bg-green-7 text-green-11 shadow-2",dense:"","indicator-color":"green-13",align:"left"},{default:e(()=>[a(U,{name:"wali",label:"Wali",to:"/santri/"+t.santriId+"/wali"},null,8,["to"]),a(U,{name:"ortu",label:"Ortu",to:"/santri/"+t.santriId+"/ortu"},null,8,["to"]),a(U,{name:"status",label:"Status",to:"/santri/"+t.santriId+"/status"},null,8,["to"]),a(U,{name:"kelas",label:"Kelas",to:"/santri/"+t.santriId+"/kelas"},null,8,["to"]),a(U,{name:"domisili",label:"Domisili",to:"/santri/"+t.santriId+"/domisili"},null,8,["to"]),a(T),a(ea,{flat:"",dense:"","dropdown-icon":"more_vert",class:"q-pl-md",color:"green-11"},{default:e(()=>[a(aa,null,{default:e(()=>[w((d(),f(q,{to:"/iuran/santri/"+t.santriId},{default:e(()=>[a(u,null,{default:e(()=>[a(S,null,{default:e(()=>[...r[1]||(r[1]=[$("Iuran",-1)])]),_:1})]),_:1}),a(u,{avatar:""},{default:e(()=>[a(E,{name:"payments",flat:""})]),_:1})]),_:1},8,["to"])),[[k]]),w((d(),f(q,{to:"/keamanan/izin-pesantren/santri/"+t.santriId},{default:e(()=>[a(u,null,{default:e(()=>[a(S,null,{default:e(()=>[...r[2]||(r[2]=[$("Izin Pesantren",-1)])]),_:1})]),_:1}),a(u,{avatar:""},{default:e(()=>[a(E,{name:"transfer_within_a_station",flat:""})]),_:1})]),_:1},8,["to"])),[[k]]),w((d(),f(q,{to:"/keamanan/indisipliner/santri/"+t.santriId},{default:e(()=>[a(u,null,{default:e(()=>[a(S,null,{default:e(()=>[...r[3]||(r[3]=[$("Indisipliner",-1)])]),_:1})]),_:1}),a(u,{avatar:""},{default:e(()=>[a(E,{name:"directions_run",flat:""})]),_:1})]),_:1},8,["to"])),[[k]])]),_:1})]),_:1})]),_:1}),a(y,{class:"q-pa-sm"},{default:e(()=>[(d(),f(sa,null,{default:e(()=>[a(p)]),fallback:e(()=>[a(z,{color:"green-12",size:"8em",class:"flex q-mx-auto"})]),_:1}))]),_:1})]),_:1})}}},za={key:0},Ta={__name:"PermohonanBerhenti",emits:["submitted"],setup(v,{emit:t}){const l=V({jenis_permohonan:"Berhenti",tunggakan:"Lunas"}),{santri:i}=ia(j()),r=V(!1),p=t;X(async()=>{});async function _(){const c=JSON.parse(JSON.stringify(l.value));if(!c.tunggakan||!c.jenis_permohonan||!c.alasan||!c.wali_nama||!c.wali_status||!c.wali_hubungan)return Sa("Isian tidak lengkap");c.id=i.id,p("submitted",c),document.getElementById("btn-close").click()}return(c,n)=>(d(),f(h,{class:"full-width",style:{"max-width":"425px"}},{default:e(()=>[a(Va,{onSubmit:ra(_,["prevent"])},{default:e(()=>[a($a,{title:"Permohonan Berhenti","is-new":!0}),a(y,{class:"q-pa-sm"},{default:e(()=>[r.value?(d(),x("div",za,[a(O,{modelValue:r.value,"onUpdate:modelValue":n[0]||(n[0]=o=>r.value=o),persistent:""},{default:e(()=>[a(z,{color:"green-12",size:"8em",class:"flex q-ma-lg q-mx-auto"})]),_:1},8,["modelValue"])])):ua("",!0),a(D,{dense:"",class:"",outlined:"",label:"Santri ID",modelValue:I(i).id,"onUpdate:modelValue":n[1]||(n[1]=o=>I(i).id=o),filled:"",disable:""},null,8,["modelValue"]),a(D,{dense:"",class:"q-mt-sm",outlined:"",label:"Nama",modelValue:I(i).nama,"onUpdate:modelValue":n[2]||(n[2]=o=>I(i).nama=o),filled:"",disable:""},null,8,["modelValue"]),a(R,{dense:"",class:"q-mt-sm",outlined:"",label:"Tunggakan*",modelValue:l.value.tunggakan,"onUpdate:modelValue":n[3]||(n[3]=o=>l.value.tunggakan=o),options:["Lunas","Belum Lunas"],clearable:"","use-input":"","new-value-mode":"add",behavior:"menu"},null,8,["modelValue"]),a(R,{dense:"",class:"q-mt-sm",outlined:"",label:"Jenis Permohonan*",modelValue:l.value.jenis_permohonan,"onUpdate:modelValue":n[4]||(n[4]=o=>l.value.jenis_permohonan=o),options:["Berhenti","Cuti/Istirahat"],clearable:"","use-input":"","new-value-mode":"add",behavior:"menu"},null,8,["modelValue"]),a(D,{dense:"",class:"q-mt-sm",outlined:"",label:"Alasan*",modelValue:l.value.alasan,"onUpdate:modelValue":n[5]||(n[5]=o=>l.value.alasan=o),autogrow:""},null,8,["modelValue"]),a(h,{class:"q-mt-sm",flat:"",bordered:""},{default:e(()=>[a(y,{class:"q-pa-sm"},{default:e(()=>[n[12]||(n[12]=g("div",{class:"text-subtitle2"}," Identitas Pemohon (Wali) ",-1)),a(D,{dense:"",class:"",outlined:"",label:"Nama*",modelValue:l.value.wali_nama,"onUpdate:modelValue":n[6]||(n[6]=o=>l.value.wali_nama=o)},null,8,["modelValue"]),a(D,{dense:"",class:"q-mt-sm",outlined:"",label:"Nomor Telepon",modelValue:l.value.wali_no_telepon,"onUpdate:modelValue":n[7]||(n[7]=o=>l.value.wali_no_telepon=o)},null,8,["modelValue"]),a(R,{dense:"",class:"q-mt-sm",outlined:"",label:"Bukti Diri",modelValue:l.value.wali_bukti_diri,"onUpdate:modelValue":n[8]||(n[8]=o=>l.value.wali_bukti_diri=o),options:["KTP","SIM"],clearable:"","use-input":"","new-value-mode":"add",behavior:"menu"},null,8,["modelValue"]),a(D,{dense:"",class:"q-mt-sm",outlined:"",label:"Nomor / ID Bukti Diri",modelValue:l.value.wali_bukti_diri_id,"onUpdate:modelValue":n[9]||(n[9]=o=>l.value.wali_bukti_diri_id=o)},null,8,["modelValue"]),a(R,{dense:"",class:"q-mt-sm",outlined:"",label:"Status*",modelValue:l.value.wali_status,"onUpdate:modelValue":n[10]||(n[10]=o=>l.value.wali_status=o),options:["Wali","Wakil Wali"],clearable:"","use-input":"","new-value-mode":"add",behavior:"menu"},null,8,["modelValue"]),a(qa,{modelValue:l.value.wali_hubungan,"onUpdate:modelValue":n[11]||(n[11]=o=>l.value.wali_hubungan=o),url:"hubungan-wali",label:"Hubungan*",class:"q-mt-sm","use-input":"","new-value-mode":"add"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),a(da,{class:"flex bg-green-6"},{default:e(()=>[a(T),w(a(m,{label:"Tutup",class:"bg-green-11","no-caps":"",id:"btn-close"},null,512),[[k]]),a(m,{type:"submit",label:"Print",class:"bg-green-10 text-green-11","no-caps":"",icon:"print"})]),_:1})]),_:1})]),_:1}))}},Ka={__name:"DropDownPrint",props:{santri:{type:Object,required:!0}},setup(v){const t=v,{loadingMain:l}=Y(Ia()),i=Z(),r=V(!1),p=V(""),_=V(!1);async function c(){await N({endPoint:`reports/santri/registrasi/download?id=${i.params.id}`,loading:l,fileName:"registrasi-"+i.params.id,confirm:!0,message:"Download data registrasi?"})}async function n(){await N({endPoint:`reports/santri/standbook/download?id=${i.params.id}`,loading:l,fileName:"standbook-"+i.params.id,confirm:!0,message:"Download standbook?"})}async function o(){await N({endPoint:`reports/santri/keterangan-berhenti/download?id=${i.params.id}`,loading:l,fileName:"keterangan-berhenti-"+i.params.id,confirm:!0,message:"Download Keterangan Berhenti"})}async function B(){await N({endPoint:`reports/santri/id-card/download?id=${i.params.id}`,loading:l,fileName:"card-"+i.params.id+" ~ "+t.santri.nama,confirm:!0,message:"Download ID Card"})}function K(){p.value=`reports/santri/registrasi/view?id=${i.params.id}`,_.value=!0}function L(){p.value=`reports/santri/standbook/view?id=${i.params.id}`,_.value=!0}function F(P){r.value=!1;const s=new URLSearchParams(P).toString();p.value=`reports/santri/permohonan-berhenti/view?${s}`,_.value=!0}function W(){p.value=`reports/santri/keterangan-berhenti/view?id=${i.params.id}`,_.value=!0}return(P,s)=>(d(),x(G,null,[a(ea,{color:"green-10",label:"Cetak",icon:"print","no-caps":"",class:"text-green-11 q-px-md",size:"sm"},{default:e(()=>[a(aa,null,{default:e(()=>[w((d(),f(q,null,{default:e(()=>[a(u,null,{default:e(()=>[a(S,null,{default:e(()=>[...s[3]||(s[3]=[$("Registrasi",-1)])]),_:1})]),_:1}),a(u,{avatar:""},{default:e(()=>[a(m,{icon:"download",flat:"",onClick:c})]),_:1}),a(u,{avatar:""},{default:e(()=>[a(m,{icon:"print",flat:"",onClick:K})]),_:1})]),_:1})),[[k]]),w((d(),f(q,null,{default:e(()=>[a(u,null,{default:e(()=>[a(S,null,{default:e(()=>[...s[4]||(s[4]=[$("Standbook",-1)])]),_:1})]),_:1}),a(u,{avatar:""},{default:e(()=>[a(m,{icon:"download",flat:"",onClick:n})]),_:1}),a(u,{avatar:""},{default:e(()=>[a(m,{icon:"print",flat:"",onClick:L})]),_:1})]),_:1})),[[k]]),w((d(),f(q,null,{default:e(()=>[a(u,null,{default:e(()=>[a(S,null,{default:e(()=>[...s[5]||(s[5]=[$("Permohonan Berhenti",-1)])]),_:1})]),_:1}),a(u,{avatar:""},{default:e(()=>[a(m,{icon:"download",flat:"",disable:""})]),_:1}),a(u,{avatar:""},{default:e(()=>[a(m,{icon:"print",flat:"",onClick:s[0]||(s[0]=Q=>r.value=!0)})]),_:1})]),_:1})),[[k]]),w((d(),f(q,null,{default:e(()=>[a(u,null,{default:e(()=>[a(S,null,{default:e(()=>[...s[6]||(s[6]=[$("Keterangan Berhenti",-1)])]),_:1})]),_:1}),a(u,{avatar:""},{default:e(()=>[a(m,{icon:"download",flat:"",onClick:o})]),_:1}),a(u,{avatar:""},{default:e(()=>[a(m,{icon:"print",flat:"",onClick:W})]),_:1})]),_:1})),[[k]]),w((d(),f(q,null,{default:e(()=>[a(u,null,{default:e(()=>[a(S,null,{default:e(()=>[...s[7]||(s[7]=[$("ID Card",-1)])]),_:1})]),_:1}),a(u,{avatar:""},{default:e(()=>[a(m,{icon:"download",flat:"",onClick:B})]),_:1}),a(u,{avatar:""},{default:e(()=>[a(m,{icon:"print",flat:"",disable:""})]),_:1})]),_:1})),[[k]])]),_:1})]),_:1}),a(O,{modelValue:r.value,"onUpdate:modelValue":s[1]||(s[1]=Q=>r.value=Q)},{default:e(()=>[a(Ta,{onSubmitted:F})]),_:1},8,["modelValue"]),a(O,{modelValue:_.value,"onUpdate:modelValue":s[2]||(s[2]=Q=>_.value=Q)},{default:e(()=>[a(ka,{url:p.value},null,8,["url"])]),_:1},8,["modelValue"])],64))}},La={class:"flex items-center"},Fa={class:"row"},Wa={class:"col-12 col-sm-6 col-md-4 q-pa-sm"},Aa={class:"col-12 col-sm-6 col-md-5 q-pa-sm"},ze={__name:"SantriDetail",setup(v){const{santri:t,wali:l,ortu:i}=ma(j()),p=Z().params.id,_=ba(),{searchSantri:c,crudSantri:n}=Y(_),o=V(!1),B=V(!1);async function K(){const b=await wa({endPoint:`images/santri/${p}`,loading:B});t.image_url=b.image_url}async function L(){j().$reset();try{o.value=!0;const b=await xa.getById({id:p});b&&(t.value=b.santri,i.value=b.ortu,l.value=b.wali)}catch{}finally{o.value=!1}}const F=J(()=>({ID:t.value.id,"Tanggal Daftar":H(t.value.tgl_daftar_m)+" | "+va(t.value.tgl_daftar_h),"Tahun Ajaran":`${t.value.th_ajaran_h||"-"} | ${t.value.th_ajaran_m||"-"}`})),W=J(()=>({Nama:`${t.value.nama?.toUpperCase()} (${t.value.sex?.toUpperCase()})`,Alamat:`${t.value.jl||" "} RT ${String(t.value.rt||0).padStart(3,0)} RW ${String(t.value.rw||0).padStart(3,"0")} ${t.value.desa||" "} ${t.value.kecamatan||" "} ${t.value.kabupaten||" "} ${t.value.provinsi||" "} ${t.value.kode_pos||" "}`.replace(/\s\s+/g," "),Kelahiran:`${t.value.tmp_lahir||"-"}, ${H(t.value.tgl_lahir)}`,"Data Akhir":t.value.data_akhir||"-"}));X(async()=>{await L()});function P(){j().setEdit(),n.value=!0}const s=V(!1),Q=b=>s.value=b;async function ta(){s.value=!1,await K()}return(b,C)=>(d(),f(pa,{class:"q-pa-sm"},{default:e(()=>[a(h,{class:""},{default:e(()=>[a(y,{class:"bg-green-8 text-green-11 q-pa-sm"},{default:e(()=>[g("div",La,[C[2]||(C[2]=g("div",{class:"text-subtitle1"},"Data Santri",-1)),a(T),a(m,{onClick:M=>null,size:"sm",color:"green-2",class:"text-green-10 q-mr-sm",icon:"sync",disable:""}),a(m,{label:"Cari",onClick:C[0]||(C[0]=M=>c.value=!0),size:"sm",color:"green-2",class:"text-green-10 q-mr-sm",icon:"search"}),a(m,{"no-caps":"",size:"sm",color:"green-2",class:"text-green-10 q-mr-sm",icon:"edit",label:"Edit",onClick:P}),a(Ka,{santri:I(t)},null,8,["santri"])])]),_:1}),a(y,{class:"no-padding"},{default:e(()=>[g("div",Fa,[g("div",Wa,[a(fa,{class:"q-mb-sm",data:F.value,loading:o.value,title:"Registrasi"},null,8,["data","loading"]),a(Ra,{class:"q-mb-sm",title:"Identitas",data:W.value,loading:o.value,loadingImage:B.value,image:I(t)?.image_url||"/user-default.png"},{button:e(()=>[a(m,{class:"q-mt-sm full-width",icon:"upload","no-caps":"",label:"Foto",dense:"",size:"sm",outline:"",color:"green-10",onClick:C[1]||(C[1]=M=>s.value=!0)})]),_:1},8,["data","loading","loadingImage","image"])]),g("div",Aa,[a(ja,{"santri-id":I(p)},null,8,["santri-id"])])])]),_:1})]),_:1}),a(ga,{"img-format":"jpg","show-uploader":s.value,url:`/images/santri/${I(p)}`,onUpdateUploader:Q,onSuccessUpload:ta},null,8,["show-uploader","url"])]),_:1}))}};export{ze as default};
