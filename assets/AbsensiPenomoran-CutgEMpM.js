import{A as p,ab as Q,W as A,f as C,o as I,b as e,w as t,Q as _,a as c,g as f,t as l,v as d,a7 as T,k as q,y as D}from"./index-0PBDf7I0.js";import{Q as i}from"./QTd-DvkorYHR.js";import{Q as N}from"./QTr-Bh2iSNP6.js";import{Q as V}from"./QTable-CnpmsB23.js";import{a as $}from"./api-get-CJU_3mwN.js";import{a as B}from"./api-update-C-LR0aqK.js";import{_ as S}from"./FilterKelas-DdbXwUX-.js";import{c as M,n as P}from"./index-BDNa_dSq.js";import{_ as j}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./QList-BR1VLd4M.js";import"./QMarkupTable-s8nx6cOi.js";import"./QSelect-Cpr8vW2V.js";import"./QChip-DG5_EyRB.js";import"./QItemSection-DpSW8XO7.js";import"./QItemLabel-DR97WW3U.js";import"./QMenu-3oalsLjd.js";import"./selection-DeDWR_N3.js";import"./rtl-DFPa-2ov.js";import"./format-CJebrXOQ.js";import"./use-fullscreen-u92Ep5d8.js";import"./index-BXLuJznK.js";import"./api-error-C1WPqECD.js";import"./QToolbarTitle-Bi7GnpK1.js";import"./QToolbar-CIornAnt.js";import"./QSpace-BYMtWShY.js";import"./lists-madrasah-store-k2SSsLMu.js";import"./api-get-lists-BbchY3y_.js";const E=["innerHTML"],U={__name:"AbsensiPenomoran",setup(F){const u=p(!1),{params:m}=Q(),s=p([]),b=p("");async function g(){if(!await M("Isi nomor Absen secara otomatis"))return;const a=[...document.getElementsByClassName("kelas-id")];let o=1;a.forEach(w=>{const y=w.innerText,h=s.value.findIndex(v=>v.id==y);s.value[h].no_absen=o,o++}),P("Isi otomatis berhasil! <br/>Data belum diupdate sampai Anda menekan tombol kirim/simpan!")}async function k(){const r=s.value.map(({id:a,no_absen:o})=>({id:a,no_absen:o})),n=await B({endPoint:"kelas/no-absen",data:r,loading:u,confirm:!0});n&&(s.value=n.murid)}A(async()=>{if(m.th_ajaran_h&&m.tingkat_id&&m.kelas){const n=(await $({endPoint:"kelas",params:m,loading:u})).murid.map(a=>({...a,alamat:`${a.desa} ${a.kecamatan} ${a.kabupaten}`}));s.value=n}else s.value=[]});const x=[{name:"id",label:"ID Kelas",align:"left",field:"id",sortable:!0},{name:"santri_id",label:"ID Santri",align:"left",field:"santri_id",sortable:!0},{name:"no_absen",label:"No Absen",align:"center",field:"no_absen",sortable:!0,style:"width:44px",classes:"text-center"},{name:"nama",label:"Nama",align:"left",field:"nama",sortable:!0},{name:"domisili",label:"Dom.",align:"left",field:"domisili",sortable:!0},{name:"alamat",label:"Alamat",align:"left",field:"alamat",sortable:!0,classes:"alamat"}];return(r,n)=>(I(),C("div",null,[e(S,{"start-url":"/madrasah/absensi/penomoran",onDataFilter:n[0]||(n[0]=a=>b.value=a)}),e(D,{class:"q-mt-sm"},{default:t(()=>[e(_,{class:"bg-green-7 text-green-1 text-subtitle1 q-pa-sm flex"},{default:t(()=>[c("span",{innerHTML:b.value||"Tentukan filter!"},null,8,E)]),_:1}),e(_,{class:"no-padding"},{default:t(()=>[e(V,{rows:s.value,columns:x,loading:u.value,"rows-per-page-options":[0],class:"dt q-pa-sm","no-data-label":"Silakan tentukan Tahun ajaran, tingkat pendidikan, dan kelas!","row-key":"name",flat:"","hide-pagination":""},{"top-left":t(()=>[...n[1]||(n[1]=[c("div",{class:"text-h6 text-green-10"},"Data Murid",-1)])]),"top-right":t(()=>[e(f,{label:"Isi Otomatis",dense:"","no-caps":"",class:"q-px-md text-green-10",color:"green-11",icon:"auto_fix_high",onClick:g,disable:s.value.length==0,title:"Isi otomatis nomor absen"},null,8,["disable"])]),body:t(a=>[e(N,{props:a},{default:t(()=>[e(i,{key:"id",props:a,class:"kelas-id"},{default:t(()=>[e(f,{flat:"",dense:"","no-caps":"",class:"text-green-10 bg-green-11 q-px-sm",style:{"min-width":"50px"},onClick:o=>r.$router.push(`/madrasah/kelas/${a.row.id}/riwayat`)},{default:t(()=>[c("small",null,l(a.row.id),1)]),_:2},1032,["onClick"])]),_:2},1032,["props"]),e(i,{key:"santri_id",props:a},{default:t(()=>[d(l(a.row.santri_id),1)]),_:2},1032,["props"]),e(i,{key:"no_absen",props:a},{default:t(()=>[e(T,{outlined:"",dense:"",modelValue:a.row.no_absen,"onUpdate:modelValue":o=>a.row.no_absen=o,"input-class":"text-center",mask:"##"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["props"]),e(i,{key:"nama",props:a},{default:t(()=>[d(l(a.row.nama)+" ("+l(a.row.sex)+") ",1)]),_:2},1032,["props"]),e(i,{key:"domisili",props:a},{default:t(()=>[d(l(a.row.domisili),1)]),_:2},1032,["props"]),e(i,{key:"alamat",props:a,title:a.row.alamat},{default:t(()=>[d(l(a.row.alamat.length>30?a.row.alamat.substr(0,30)+"â€¦":a.row.alamat),1)]),_:2},1032,["props","title"])]),_:2},1032,["props"])]),_:1},8,["rows","loading"])]),_:1}),e(q,{class:"bg-green-6 text-green-11 text-subtitle1 q-pa-sm flex",align:"right"},{default:t(()=>[e(f,{dense:"",label:"Kirim/Simpan","no-caps":"",color:"green-11",class:"text-green-10 q-px-md",icon:"save",onClick:k})]),_:1})]),_:1})]))}},ba=j(U,[["__scopeId","data-v-2040db23"]]);export{ba as default};
