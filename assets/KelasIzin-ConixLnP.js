import{v as s,R as D,f as q,o as V,w as o,i,a8 as N,Q as $,r as C,y as B,B as w,a4 as c,z as y,m as I,n as z,p as b,Z as U,q as P,a7 as H,F as K}from"./index-Cju_WcQt.js";import{i as E,f as M,b as F}from"./format-date-DlwYCgkJ.js";import{f as O,m as A}from"./hijri-BBdEhqDI.js";import{g as R}from"./array-object-BytDdNh7.js";import{a as T}from"./api-get-C-ZFMqL_.js";import{_ as G}from"./TemplateArray-5foy-9-c.js";import{Q as Z}from"./QSpinnerCube-BbU3LkI7.js";import{Q as J}from"./QSpace-e5nOhYJp.js";import{Q as L}from"./QForm-B-IeWzDf.js";import{C as W}from"./ClosePopup-POBKOZoS.js";import{a as X}from"./api-update-Dm-9pXju.js";import{a as Y}from"./api-post-P8g4q4LG.js";import{a as aa}from"./api-delete-BEmNpbPy.js";import{_ as S}from"./InputSelectArray-G7sFmwYz.js";import{_ as ea}from"./FormHeader-BlagXmst.js";import{_ as la}from"./ReportViewer-DDhmJ-uk.js";import"./id-BuNGTsqN.js";import"./format-number-B34ySHL_.js";import"./index-DgCvXGx8.js";import"./index-pFkrbuLE.js";import"./api-error-BS7WyEhR.js";import"./QItemSection-CL0X_XCy.js";import"./QItemLabel-97msGuv9.js";import"./QList-DJ6I4Xhf.js";import"./QSelect-D99lhOsm.js";import"./QChip-DJA81wTZ.js";import"./QMenu-BUIDrqEf.js";import"./selection-noklRUze.js";import"./rtl-DFPa-2ov.js";import"./format-CJebrXOQ.js";import"./api-get-lists-BfH1ZDRf.js";import"./lists-store-Bv-Q7-f0.js";import"./lists-data-L-iOlbK0.js";import"./DropDownAfter-UGjzP48R.js";import"./QBtnDropdown-69YMJW9Q.js";import"./QBtnGroup-oymYJuDk.js";import"./QToolbarTitle-DriFd-N5.js";import"./QToolbar-DOvpToKQ.js";const ta={key:0},ia={__name:"KelasIzinCrud",props:{data:{type:Object,required:!0},isNew:{type:Boolean,default:!0},title:{type:String,default:()=>"Input"}},emits:["successSubmit","successDelete"],setup(f,{emit:h}){const d=f,m=h,a=s({keperluan:"Sakit",durasi:1}),t=s(!1);D(async()=>{Object.assign(a.value,d.data)});const v=async()=>{const u={kelas_id:a.value.kelas_id,dari_tgl:a.value.dari_tgl,durasi:a.value.durasi,keperluan:a.value.keperluan,keterangan:a.value.keterangan,catatan:a.value.catatan};let e=null;d.isNew?e=await Y({endPoint:"izin-madrasah",data:u,loading:t}):e=await X({endPoint:`izin-madrasah/${a.value.id}`,data:u,confirm:!0,notify:!0,loading:t}),e&&(document.getElementById("btn-close-crud").click(),m("successSubmit"))},p=async()=>{await aa({endPoint:`izin-madrasah/${a.value.id}`,loading:t})&&(document.getElementById("btn-close-crud").click(),m("successDelete"))};return(u,e)=>(V(),q(P,{class:"full-width",style:{"max-width":"425px"}},{default:o(()=>[i(L,{onSubmit:N(v,["prevent"])},{default:o(()=>[i(ea,{title:d.title,"is-new":f.isNew},null,8,["title","is-new"]),i($,null,{default:o(()=>[t.value?(V(),C("div",ta,[i(w,{modelValue:t.value,"onUpdate:modelValue":e[0]||(e[0]=l=>t.value=l),persistent:""},{default:o(()=>[i(Z,{color:"green-12",size:"8em",class:"flex q-ma-lg q-mx-auto"})]),_:1},8,["modelValue"])])):B("",!0),i(c,{dense:"",outlined:"",label:"Nama","model-value":a.value?.nama+" ("+a.value?.santri_id+")",disable:"",filled:""},null,8,["model-value"]),i(c,{dense:"",class:"q-mt-sm",outlined:"",label:"Data Kelas","model-value":a.value?.th_ajaran_h+" | "+a.value?.tingkat_id+" | "+a.value?.kelas,disable:"",filled:""},null,8,["model-value"]),i(c,{dense:"",hint:y(E)(a.value.dari_tgl)?y(M)(a.value.dari_tgl):"",class:"q-mt-sm",outlined:"",label:"Tanggal (M)*",modelValue:a.value.dari_tgl,"onUpdate:modelValue":e[1]||(e[1]=l=>a.value.dari_tgl=l),type:"date",rules:[l=>!!l||"Harus diisi!"],"error-color":"negative"},null,8,["hint","modelValue","rules"]),i(c,{dense:"",class:"q-mt-sm",outlined:"",label:"Durasi (hari)*",modelValue:a.value.durasi,"onUpdate:modelValue":e[2]||(e[2]=l=>a.value.durasi=l),rules:[l=>!!l||"Harus diisi!",l=>!l||!isNaN(l)||"Hanya angka"],"error-color":"negative"},null,8,["modelValue","rules"]),i(S,{modelValue:a.value.keperluan,"onUpdate:modelValue":e[3]||(e[3]=l=>a.value.keperluan=l),url:"keperluan-izin",label:"Keperluan *",class:"q-mt-sm",rules:[l=>!!l||"Harus diisi!"]},null,8,["modelValue","rules"]),i(S,{modelValue:a.value.keterangan,"onUpdate:modelValue":e[4]||(e[4]=l=>a.value.keterangan=l),url:"keterangan-izin",label:"Keterangan",class:"q-mt-sm"},null,8,["modelValue"]),i(c,{dense:"",class:"q-mt-sm",outlined:"",label:"Catatan",modelValue:a.value.catatan,"onUpdate:modelValue":e[5]||(e[5]=l=>a.value.catatan=l),autogrow:""},null,8,["modelValue"])]),_:1}),i(I,{class:"flex bg-green-6"},{default:o(()=>[z(i(b,{label:"Hapus",class:"bg-red text-red-1","no-caps":"",onClick:p},null,512),[[U,!d.isNew]]),i(J),z(i(b,{label:"Tutup",class:"bg-green-11","no-caps":"",id:"btn-close-crud"},null,512),[[W]]),i(b,{type:"submit",label:"Simpan",class:"bg-green-10 text-green-11","no-caps":""})]),_:1})]),_:1})]),_:1}))}},Oa={__name:"KelasIzin",setup(f){const d=H().params,m=s([]),a=s([]),t=s({}),v=s(!1),p=s(!1),u=s(!1),e=s({}),l=s("");async function g(){const r=await T({endPoint:`izin-madrasah/kelas/${d.id}`,loading:v});r.izin_madrasah&&(m.value=r.izin_madrasah,e.value=r.kelas,a.value=r.izin_madrasah.map(n=>({Tanggal:F(n.dari_tgl)+" | "+O(A(n.dari_tgl)),Durasi:n.durasi+" hari",Keperluan:n.keperluan+`${n.keterangan?.length>0?" ("+n.keterangan+")":""}`,Catatan:n.catatan,id:n.id})))}D(async()=>{await g()});const Q=()=>{t.value={},t.value.santri_id=e.value.santri_id,t.value.nama=e.value.nama,t.value.th_ajaran_h=e.value.th_ajaran_h,t.value.tingkat_id=e.value.tingkat_id,t.value.kelas=e.value.kelas,t.value.kelas_id=e.value.id,p.value=!0,u.value=!0},x=({id:r})=>{t.value={},t.value=R(m,r),t.value.santri_id=e.value.santri_id,t.value.nama=e.value.nama,t.value.th_ajaran_h=e.value.th_ajaran_h,t.value.tingkat_id=e.value.tingkat_id,t.value.kelas=e.value.kelas,p.value=!1,u.value=!0},_=s(!1);function j(r){l.value=`reports/izin-madrasah/view?id=${r.id}}`,_.value=!0}return(r,n)=>(V(),C(K,null,[i(G,{data:a.value,spinner:v.value,"btn-print":!0,onAdd:Q,onEdit:x,onPrint:j},null,8,["data","spinner"]),i(w,{modelValue:u.value,"onUpdate:modelValue":n[0]||(n[0]=k=>u.value=k)},{default:o(()=>[i(ia,{data:t.value,"is-new":p.value,title:"Input Izin Madrasah",onSuccessSubmit:g,onSuccessDelete:g},null,8,["data","is-new"])]),_:1},8,["modelValue"]),i(w,{modelValue:_.value,"onUpdate:modelValue":n[1]||(n[1]=k=>_.value=k)},{default:o(()=>[i(la,{url:l.value},null,8,["url"])]),_:1},8,["modelValue"])],64))}};export{Oa as default};
