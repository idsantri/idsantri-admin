import{q as i,N as M,E as w,c as T,o as G,w as t,g as a,af as O,f as j,G as V,Q as N,a9 as v,l as $,a as A,s as J,v as c,t as k,e as I,p as H,J as F}from"./index-BeuhZ-ol.js";import{Q as m}from"./QTd-6Cq7GboW.js";import{Q as L}from"./QTr-DfM095CY.js";import{Q as P}from"./QTable-DhN6aArA.js";import{d as S}from"./format-number-B34ySHL_.js";import{Q as R}from"./QSelect-CSuiH4Z6.js";import{Q as E}from"./QForm-zVA3WIzN.js";import{_ as z}from"./InputCurrency-DxMkmL9O.js";import{u as W}from"./useCrudForm-DNtu3sdk.js";import{A as X}from"./ApiCrud-CEdYpkid.js";import{U as Y}from"./UgtGt-DrEQaI_O.js";import{_ as Z}from"./ReportViewer-38SoBeih.js";import{c as h}from"./format-date-OVhbBx9F.js";import{_ as ee}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./QList-SMP-2XJV.js";import"./QMarkupTable-D4fBkLtu.js";import"./use-fullscreen-DHuhaxT_.js";import"./QField-4_Uk7UCx.js";import"./QChip-CWLqqxtS.js";import"./QItem-qAKJqzX7.js";import"./QItemLabel-CMAJZVV_.js";import"./QMenu-8-e25rsX.js";import"./selection-DHH_NrKf.js";import"./rtl-DFPa-2ov.js";import"./format-CJebrXOQ.js";import"./Api-BhplmBSY.js";import"./index-BXhUsTyQ.js";import"./index-Cg0spb8C.js";import"./api-error-FN4ckS3j.js";import"./id-BuNGTsqN.js";class ae extends X{constructor(){super("ugt/kas")}}const B=new ae,le={__name:"UgtKasForm",props:{data:Object},emits:["successDelete","successSubmit","successUpdate","successCreate"],setup(K,{emit:U}){const p=K,b=U,n=i({keperluan:"Biaya Administrasi GT",keterangan:"Lunas",flag:"+",...p.data}),f=i(!1),d=i({}),g=!p.data?.id,{handleDelete:q,handleCreate:y,handleUpdate:Q,loading:C}=W(B,{emit:b,responseKey:"kas"}),x=async()=>{const u=JSON.parse(JSON.stringify(n.value));return delete u.id,g?await y(u,!0):await Q(p.data.id,u,!0)},s=async()=>await q(p.data.id);async function o(u){try{f.value=!0;const l=await Y.getById({id:u,notifySuccess:!1});d.value=l.gt}catch{d.value.nama="Data tidak ditemukan",d.value.pjgt_nama="Data tidak ditemukan"}finally{f.value=!1}}return M(()=>n.value.gt_id,async(u,l)=>{d.value.nama="",d.value.pjgt_nama="",u!=l&&await o(u)},{immediate:!0}),(u,l)=>{const e=w("FormHeader"),_=w("FormLoading"),D=w("FormActions");return G(),T($,{class:"full-width",style:{"max-width":"425px"}},{default:t(()=>[a(E,{onSubmit:O(x,["prevent"])},{default:t(()=>[a(e,{title:"Input Kas UGT","is-new":g}),V(C)?(G(),T(_,{key:0})):j("",!0),a(N,{class:"q-pa-sm"},{default:t(()=>[a(v,{dense:"",hint:"Diisi oleh sistem",class:"",outlined:"",label:"ID",modelValue:n.value.id,"onUpdate:modelValue":l[0]||(l[0]=r=>n.value.id=r),disable:"",filled:""},null,8,["modelValue"]),a($,{class:"q-my-sm",flat:"",bordered:""},{default:t(()=>[a(N,{class:"q-pa-sm"},{default:t(()=>[l[8]||(l[8]=A("div",{class:"text-caption"},"Jika terkait dengan administrasi GT",-1)),a(v,{dense:"",class:"q-my-sm",outlined:"",label:"GT ID",modelValue:n.value.gt_id,"onUpdate:modelValue":l[1]||(l[1]=r=>n.value.gt_id=r),clearable:"",debounce:"500"},null,8,["modelValue"]),a(v,{dense:"",class:"q-my-sm",outlined:"",label:"Nama GT",modelValue:d.value.nama,"onUpdate:modelValue":l[2]||(l[2]=r=>d.value.nama=r),disable:"",filled:"",loading:f.value},null,8,["modelValue","loading"]),a(v,{dense:"",class:"q-my-sm",outlined:"",label:"Nama PJGT",modelValue:d.value.pjgt_nama,"onUpdate:modelValue":l[3]||(l[3]=r=>d.value.pjgt_nama=r),disable:"",filled:"",loading:f.value},null,8,["modelValue","loading"])]),_:1})]),_:1}),a(v,{dense:"",class:"q-my-sm",outlined:"",label:"Keperluan",modelValue:n.value.keperluan,"onUpdate:modelValue":l[4]||(l[4]=r=>n.value.keperluan=r)},null,8,["modelValue"]),a(R,{dense:"",class:"q-my-sm",outlined:"",label:"Kas Masuk/Keluar",modelValue:n.value.flag,"onUpdate:modelValue":l[5]||(l[5]=r=>n.value.flag=r),options:[{value:"+",label:"Masuk"},{value:"-",label:"Keluar"}],"emit-value":"","map-options":"","error-color":"negative",behavior:"menu"},null,8,["modelValue"]),a(z,{dense:"",class:"q-my-sm",outlined:"",modelValue:n.value.nominal,"onUpdate:modelValue":l[6]||(l[6]=r=>n.value.nominal=r),required:"",label:"Nominal"},null,8,["modelValue"]),a(v,{dense:"",class:"q-my-sm",outlined:"",label:"Keterangan",modelValue:n.value.keterangan,"onUpdate:modelValue":l[7]||(l[7]=r=>n.value.keterangan=r),autogrow:""},null,8,["modelValue"])]),_:1}),a(D,{"btn-delete":!g,onOnDelete:s},null,8,["btn-delete"])]),_:1})]),_:1})}}},te={class:"q-gutter-sm"},ne={__name:"KasIndex",setup(K){const U=i([]),p=i(!1),b=i(""),n=i(!1),f=i({}),d=i("");async function g(){try{p.value=!0;const s=await B.getAll();U.value=s.kas}catch{console.log("error get kas ugt")}finally{p.value=!1}}function q(){f.value={},n.value=!0}const y=i(!1);async function Q(s){d.value=`reports/ugt/kuitansi/view?id=${s.id}`,y.value=!0}function C(s){const o=s.masuk?"+":"-",u=s.masuk||s.keluar,l={id:s.id,gt_id:s.gt_id,keperluan:s.keperluan,keterangan:s.keterangan,flag:o,nominal:u};f.value=l,n.value=!0}J(async()=>{await g()});const x=[{name:"id",label:"ID",align:"left",field:"id",sortable:!0},{name:"tgl_m",label:"Tanggal",align:"left",field:"tgl_m",sortable:!0},{name:"keperluan",label:"Keperluan",align:"left",field:"keperluan",sortable:!0},{name:"keterangan",label:"Keterangan",align:"left",field:"keterangan",sortable:!0},{name:"masuk",label:"Masuk",align:"right",field:"masuk",sortable:!0},{name:"keluar",label:"Keluar",align:"right",field:"keluar",sortable:!0},{name:"saldo",label:"Saldo",align:"right",field:"saldo",sortable:!0},{name:"cr_by",label:"By",align:"left",field:"cr_by",sortable:!0},{name:"edit",label:"!",align:"center",field:"",sortable:!1}];return(s,o)=>{const u=w("CardHeader"),l=w("CardPage");return G(),T(l,null,{default:t(()=>[a(u,{title:"Kas UGT",onOnReload:g,"show-add":!0,onOnAdd:q}),a(N,{class:"q-pa-sm"},{default:t(()=>[a(P,{bordered:"",flat:"",rows:U.value,loading:p.value,"rows-per-page-options":[10,25,50,100,0],pagination:{page:999},class:"dt q-px-sm",columns:x,filter:b.value,"no-data-label":"Tidak ada data untuk ditampilkan!","no-results-label":"Tidak ditemukan kata kunci yang sesuai dengan pencarian Anda!","row-key":"name",onRowClick:o[1]||(o[1]=(e,_,D)=>C(e,_,D))},{"top-right":t(()=>[a(v,{outlined:"",dense:"",debounce:"300",modelValue:b.value,"onUpdate:modelValue":o[0]||(o[0]=e=>b.value=e),placeholder:"Cari"},{append:t(()=>[a(H,{name:"search"})]),_:1},8,["modelValue"])]),body:t(e=>[a(L,{props:e},{default:t(()=>[a(m,{key:"id",props:e},{default:t(()=>[c(k(e.row.id),1)]),_:2},1032,["props"]),a(m,{key:"tgl_m",props:e,title:"format tanggal dd/mm/yyyy"},{default:t(()=>[c(k(V(h)(e.row.tgl_m,"dd/MM/yyyy")),1)]),_:2},1032,["props"]),a(m,{key:"keperluan",props:e},{default:t(()=>[c(k(e.row.gt_id?`${e.row.keperluan} (${e.row.gt_id})`:e.row.keperluan),1)]),_:2},1032,["props"]),a(m,{key:"keterangan",props:e},{default:t(()=>[c(k(e.row.keterangan),1)]),_:2},1032,["props"]),a(m,{key:"masuk",props:e},{default:t(()=>[c(k(V(S)(e.row.masuk)),1)]),_:2},1032,["props"]),a(m,{key:"keluar",props:e},{default:t(()=>[c(k(V(S)(e.row.keluar)),1)]),_:2},1032,["props"]),a(m,{key:"saldo",props:e},{default:t(()=>[c(k(V(S)(e.row.saldo)),1)]),_:2},1032,["props"]),a(m,{key:"cr_by",props:e},{default:t(()=>[c(k(e.row.cr_by),1)]),_:2},1032,["props"]),a(m,{key:"edit",props:e},{default:t(()=>[A("div",te,[a(I,{icon:"edit","no-caps":"",color:"green-10",outline:"",dense:"",class:"q-px-md",onClick:_=>C(e.row)},null,8,["onClick"]),a(I,{icon:"print","no-caps":"",color:"green-10",outline:"",dense:"",class:"q-px-md",onClick:_=>Q(e.row),disable:!e.row.gt_id},null,8,["onClick","disable"])])]),_:2},1032,["props"])]),_:2},1032,["props"])]),_:1},8,["rows","loading","filter"])]),_:1}),a(F,{persistent:"",modelValue:n.value,"onUpdate:modelValue":o[4]||(o[4]=e=>n.value=e)},{default:t(()=>[a(le,{data:f.value,onSuccessSubmit:o[2]||(o[2]=e=>g()),onSuccessDelete:o[3]||(o[3]=e=>g())},null,8,["data"])]),_:1},8,["modelValue"]),a(F,{modelValue:y.value,"onUpdate:modelValue":o[5]||(o[5]=e=>y.value=e)},{default:t(()=>[a(Z,{url:d.value},null,8,["url"])]),_:1},8,["modelValue"])]),_:1})}}},Ie=ee(ne,[["__scopeId","data-v-636b105b"]]);export{Ie as default};
