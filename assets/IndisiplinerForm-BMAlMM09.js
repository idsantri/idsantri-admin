import{x as b,R as B,c as _,o as S,w as c,b as t,y as V,a9 as F,a as H,n as I,q as Q,a3 as m,z as u,s as $}from"./index-Bf-p91mW.js";import{Q as j}from"./QRating-DjyrAv9b.js";import{Q as D}from"./QSelect-Co09SqkM.js";import{Q as C}from"./QForm-OmDQHoiq.js";import{b as w,m as U}from"./hijri-BBdEhqDI.js";import{i as q,f as x}from"./format-date-DlwYCgkJ.js";import{a as K}from"./api-post-CHcQycZS.js";import{a as L}from"./api-update-BYe6B3v5.js";import{a as O}from"./api-delete-BVHfd1pG.js";import{_ as P}from"./InputSelectSantriId-Dr_LO5a7.js";import{l as R}from"./lists-store-F5P_xNBX.js";import{_ as E}from"./DropDownAfter-wYSCUu7Z.js";import{L as N}from"./Lists-DSwT9YX9.js";import{_ as T}from"./InputSelectArray-Jz4ksDX6.js";const z="tatib-santri",h={__name:"InputSelectTatibSantri",props:{selected:{type:String}},setup(y){const g=y;function v(){let a="";return g.selected&&(a=r(g.selected)),a}function r(a){let s="";const o=/\[(.*?)\]/g,k=a.match(o);return k&&(s=k.map(l=>l.slice(1,-1)).join(", ")),s}const e=b(!1),n=b([]),p=R(),d=z.replace(/-/g,"_");function f(a){let s=[];return a.length&&(s=a.filter(o=>o.val0.length!=1).map(o=>`[${o.val0}] ${o.val1}`)),s}B(async()=>{const a=p.getStateByKey(d);if(a.length)n.value=f(a);else{await i();const s=p.getStateByKey(d);n.value=f(s)}});async function i(){try{e.value=!0;const a=await N.getByKey(z);p.$patch({[d]:a[d]})}catch(a){console.log("error get list ",a)}finally{e.value=!1}}return(a,s)=>(S(),_(D,{dense:"",outlined:"",label:"Pasal dilanggar","emit-value":"","map-options":"",options:n.value,loading:e.value,behavior:"menu",clearable:"",multiple:"",hint:v()},{after:c(()=>[t(E,{"route-to":"tatib-santri",onReload:i})]),_:1},8,["options","loading","hint"]))}},ne={__name:"IndisiplinerForm",props:{data:Object},emits:["successDelete","successSubmit","successUpdate","successCreate"],setup(y,{emit:g}){const v=y,r=g,e=b({kategori:3}),n=b(!1);async function p(){const i={santri_id:e.value.santri_id,tgl_kasus:e.value.tgl_kasus,tgl_sidang:e.value.tgl_sidang,kategori:e.value.kategori,pasal:e.value.pasal?.join("; "),deskripsi:e.value.deskripsi,eksekutor:e.value.eksekutor,saksi:e.value.saksi,takzir:e.value.takzir?.join("; "),keterangan:e.value.keterangan};let a=null;const s=!e.value.id;s?a=await K({endPoint:"indisipliner",data:i,loading:n}):a=await L({endPoint:`indisipliner/${e.value.id}`,data:i,confirm:!0,notify:!0,loading:n}),a&&(document.getElementById("btn-close-form").click(),r("successSubmit",a?.indisipliner),r(s?"successCreate":"successUpdate",a?.indisipliner))}const d=async()=>{const i=e.value.id;await O({endPoint:`indisipliner/${i}`,loading:n})&&(document.getElementById("btn-close-form").click(),r("successDelete",i))};B(async()=>{Object.assign(e.value,v.data),e.value.pasal&&(e.value.pasal=e.value.pasal.split(",")),e.value.takzir&&(e.value.takzir=e.value.takzir.split(","))});const f=[{value:1,label:"Sangat Ringan"},{value:2,label:"Ringan"},{value:3,label:"Sedang"},{value:4,label:"Berat"},{value:5,label:"Sangat Berat"}];return(i,a)=>{const s=V("FormHeader"),o=V("FormLoading"),k=V("FormActions");return S(),_($,{class:"full-width",style:{"max-width":"425px"}},{default:c(()=>[t(C,{onSubmit:F(p,["prevent"])},{default:c(()=>[t(s,{title:"Input Santri Indisipliner","is-new":!e.value.id},null,8,["is-new"]),n.value?(S(),_(o,{key:0})):H("",!0),t(I,{class:"q-pa-sm"},{default:c(()=>[Q("div",null,[t(P,{"active-only":!0,onEmitInput:a[0]||(a[0]=l=>Object.assign(e.value,l)),data:v.data,class:"q-my-sm"},null,8,["data"]),t(m,{dense:"",hint:u(q)(e.value.tgl_kasus)?u(x)(e.value.tgl_kasus)+" | "+u(w)(u(U)(e.value.tgl_kasus)):"",class:"q-my-sm",outlined:"",label:"Tanggal Kasus*",modelValue:e.value.tgl_kasus,"onUpdate:modelValue":a[1]||(a[1]=l=>e.value.tgl_kasus=l),type:"date",rules:[l=>!!l||"Harus diisi!"],"error-color":"negative"},null,8,["hint","modelValue","rules"]),t(m,{dense:"",hint:u(q)(e.value.tgl_sidang)?u(x)(e.value.tgl_sidang)+" | "+u(w)(u(U)(e.value.tgl_sidang)):"",class:"q-my-sm",outlined:"",label:"Tanggal Sidang*",modelValue:e.value.tgl_sidang,"onUpdate:modelValue":a[2]||(a[2]=l=>e.value.tgl_sidang=l),type:"date",rules:[l=>!!l||"Harus diisi!"],"error-color":"negative"},null,8,["hint","modelValue","rules"]),t(D,{dense:"",modelValue:e.value.kategori,"onUpdate:modelValue":a[4]||(a[4]=l=>e.value.kategori=l),class:"q-my-sm",outlined:"",label:"Kategori*",options:f,"emit-value":"","map-options":"",rules:[l=>!!l||"Harus diisi!"],"error-color":"negative",behavior:"menu"},{after:c(()=>[t(j,{class:"",name:"kategori",modelValue:e.value.kategori,"onUpdate:modelValue":a[3]||(a[3]=l=>e.value.kategori=l),max:"5",color:"red",icon:"thumb_down","icon-selected":"thumb_down",size:"1em"},null,8,["modelValue"])]),_:1},8,["modelValue","rules"]),t(h,{class:"q-my-sm",modelValue:e.value.pasal,"onUpdate:modelValue":a[5]||(a[5]=l=>e.value.pasal=l),rules:[l=>!!l||"Harus diisi!"],selected:e.value.pasal?e.value.pasal.join("; "):""},null,8,["modelValue","rules","selected"]),t(m,{dense:"",class:"q-my-sm",outlined:"",label:"Deskripsi",modelValue:e.value.deskripsi,"onUpdate:modelValue":a[6]||(a[6]=l=>e.value.deskripsi=l),autogrow:""},null,8,["modelValue"]),t(m,{dense:"",class:"q-my-sm",outlined:"",label:"Eksekutor",modelValue:e.value.eksekutor,"onUpdate:modelValue":a[7]||(a[7]=l=>e.value.eksekutor=l),rules:[l=>!!l||"Harus diisi!"],"error-color":"negative"},null,8,["modelValue","rules"]),t(m,{dense:"",class:"q-my-sm",outlined:"",label:"Saksi",modelValue:e.value.saksi,"onUpdate:modelValue":a[8]||(a[8]=l=>e.value.saksi=l)},null,8,["modelValue"]),t(T,{modelValue:e.value.takzir,"onUpdate:modelValue":a[9]||(a[9]=l=>e.value.takzir=l),url:"takzir-santri",label:"Takzir",class:"q-my-sm",multiple:""},null,8,["modelValue"]),t(m,{dense:"",class:"q-my-sm",outlined:"",label:"Keterangan",modelValue:e.value.keterangan,"onUpdate:modelValue":a[10]||(a[10]=l=>e.value.keterangan=l),autogrow:""},null,8,["modelValue"])])]),_:1}),t(k,{"btn-delete":!!e.value.id,onOnDelete:d},null,8,["btn-delete"])]),_:1})]),_:1})}}};export{ne as _};
