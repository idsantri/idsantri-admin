import{E as h,c as g,o as p,w as e,g as a,Q as y,a as _,t as A,r as la,b as K,F as J,D as ta,l as L,n as w,v as k,p as O,q,ae as na,a8 as Q,a9 as M,ac as z,e as f,J as E,ad as oa,A as H,s as ia,G as j}from"./index-FlJm5x9Y.js";import{f as W}from"./format-date-OVhbBx9F.js";import{Q as G}from"./QSpace-KzQMWHZt.js";import{Q as sa}from"./QImg-C9fhmyTO.js";import{_ as ra}from"./ImageUploader-DgzxVeTi.js";import{s as D}from"./santri-store-YfKFL568.js";import{b as ua}from"./hijri-Bs48DFvR.js";import{Q as B}from"./QRouteTab-agBpZ8Us.js";import{Q as V}from"./QItemLabel-C84jr6p3.js";import{Q as S,a as s}from"./QItem-DpLjSmAj.js";import{Q as X}from"./QList-Dcg8ef0O.js";import{Q as Y}from"./QBtnDropdown-D8iOyEF_.js";import{Q as da}from"./QTabs-MwX61JE1.js";import{C as I}from"./ClosePopup-C5XcSLzX.js";import{d as ma}from"./dialog-store-CzOE_qof.js";import{a as pa}from"./api-get-CdJGjSda.js";import{a as N}from"./api-download-cCSv9l39.js";import{_ as fa}from"./ReportViewer-DG44MBEq.js";import{Q as R}from"./QSelect-CT6LGHVZ.js";import{Q as ca}from"./QForm-C6qJDVDC.js";import{d as ga}from"./index-C2kK86wh.js";import{_ as va}from"./InputSelectArray-C5NVdN38.js";import{l as _a}from"./loading-store-CKa-jGPl.js";import{S as ba}from"./Santri-D_ZjJcLM.js";import{C as wa}from"./CardListTabel-DRLP6Myv.js";import{f as ka}from"./format-text-DnCGEu2I.js";import"./id-BuNGTsqN.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./index-DQ6FBOo_.js";import"./format-number-B34ySHL_.js";import"./QBtnGroup-BEOwvc4z.js";import"./QMenu-BFjvccLP.js";import"./selection-DAgYgrjx.js";import"./QResizeObserver-CXgEadBC.js";import"./rtl-DFPa-2ov.js";import"./api-error-Bzz-X3Hz.js";import"./QChip-BRisEBxx.js";import"./format-CJebrXOQ.js";import"./lists-store-YqjZcZdz.js";import"./ArrayCrud-CkcA-ixF.js";import"./DropDownAfter-BBtcFaFs.js";import"./Lists-CQoXpyW_.js";import"./ApiCrud-DNsr8hCV.js";import"./Api-BAtX-Yl2.js";import"./QMarkupTable-BsWt6TUx.js";const Va={class:"flex items-center"},Sa={class:"text-subtitle2"},Ia={class:"col-4 q-pr-sm relative-position"},qa={class:"col"},ya={class:"text-caption text-italic"},Ca={class:"q-mb-sm"},$a={__name:"CardIdentity",props:{title:String,data:Object,image:String,loading:Boolean,loadingImage:Boolean},setup(c){return(l,b)=>{const o=h("CardLoading");return p(),g(L,{flat:"",bordered:""},{default:e(()=>[a(y,{class:"bg-green-7 text-green-11 q-pa-sm"},{default:e(()=>[_("div",Va,[_("div",Sa,A(c.title),1),a(G)])]),_:1}),a(y,{class:"q-pa-sm row"},{default:e(()=>[_("div",Ia,[a(sa,{src:c.image,ratio:3/4,alt:"santri"},null,8,["src"]),la(l.$slots,"button"),a(o,{showing:c.loadingImage,message:""},null,8,["showing"])]),_("div",qa,[(p(!0),K(J,null,ta(c.data,(t,d)=>(p(),K("div",{key:d},[_("div",ya,A(d),1),_("div",Ca,A(t),1)]))),128))]),a(o,{showing:c.loading},null,8,["showing"])]),_:3})]),_:3})}}},Qa={__name:"SantriRelations",props:{santriId:{default:null}},setup(c){const l=c;return(b,o)=>{const t=h("router-view");return p(),g(L,{bordered:"",flat:""},{default:e(()=>[a(y,{class:"bg-green-7 text-green-11 no-padding"},{default:e(()=>[a(da,{"no-caps":"","outside-arrows":"","mobile-arrows":"",dense:"","indicator-color":"green-13",align:"left"},{default:e(()=>[a(B,{name:"wali",label:"Wali",to:"/santri/"+l.santriId+"/wali"},null,8,["to"]),a(B,{name:"ortu",label:"Ortu",to:"/santri/"+l.santriId+"/ortu"},null,8,["to"]),a(B,{name:"status",label:"Status",to:"/santri/"+l.santriId+"/status"},null,8,["to"]),a(B,{name:"kelas",label:"Kelas",to:"/santri/"+l.santriId+"/kelas"},null,8,["to"]),a(B,{name:"domisili",label:"Domisili",to:"/santri/"+l.santriId+"/domisili"},null,8,["to"]),a(G),a(Y,{flat:"",dense:"","dropdown-icon":"more_vert",class:"q-pl-md",color:"green-11"},{default:e(()=>[a(X,null,{default:e(()=>[w((p(),g(S,{to:"/iuran/santri/"+l.santriId},{default:e(()=>[a(s,null,{default:e(()=>[a(V,null,{default:e(()=>[...o[0]||(o[0]=[k("Iuran",-1)])]),_:1})]),_:1}),a(s,{avatar:""},{default:e(()=>[a(O,{name:"payments",flat:""})]),_:1})]),_:1},8,["to"])),[[I]]),w((p(),g(S,{to:"/keamanan/izin-pesantren/santri/"+l.santriId},{default:e(()=>[a(s,null,{default:e(()=>[a(V,null,{default:e(()=>[...o[1]||(o[1]=[k("Izin Pesantren",-1)])]),_:1})]),_:1}),a(s,{avatar:""},{default:e(()=>[a(O,{name:"transfer_within_a_station",flat:""})]),_:1})]),_:1},8,["to"])),[[I]]),w((p(),g(S,{to:"/keamanan/indisipliner/santri/"+l.santriId},{default:e(()=>[a(s,null,{default:e(()=>[a(V,null,{default:e(()=>[...o[2]||(o[2]=[k("Indisipliner",-1)])]),_:1})]),_:1}),a(s,{avatar:""},{default:e(()=>[a(O,{name:"directions_run",flat:""})]),_:1})]),_:1},8,["to"])),[[I]])]),_:1})]),_:1})]),_:1})]),_:1}),a(y,{class:"q-pa-sm"},{default:e(()=>[a(t)]),_:1})]),_:1})}}},Da={__name:"SantriPermohonanBerhentiForm",props:{data:{type:Object,required:!0}},emits:["successSubmit"],setup(c,{emit:l}){const b=l,o=c,t=q({jenis_permohonan:"Berhenti",tunggakan:"Lunas"}),d=q({...o.data});async function v(){const m=JSON.parse(JSON.stringify(t.value));if(!m.tunggakan||!m.jenis_permohonan||!m.alasan||!m.wali_nama||!m.wali_status||!m.wali_hubungan)return ga("Isian tidak lengkap");m.id=d.value.id,b("successSubmit",m),document.getElementById("btn-close-form")?.click()}return(m,n)=>{const U=h("FormHeader"),C=h("FormActions");return p(),g(L,{class:"full-width",style:{"max-width":"425px"}},{default:e(()=>[a(ca,{onSubmit:na(v,["prevent"])},{default:e(()=>[a(U,{title:"Permohonan Berhenti","is-new":!0}),a(y,{class:"q-pa-sm"},{default:e(()=>[a(Q,{dense:"",class:"q-my-sm",outlined:"",label:"Santri ID",modelValue:d.value.id,"onUpdate:modelValue":n[0]||(n[0]=i=>d.value.id=i),filled:"",disable:""},null,8,["modelValue"]),a(Q,{dense:"",class:"q-my-sm",outlined:"",label:"Nama",modelValue:d.value.nama,"onUpdate:modelValue":n[1]||(n[1]=i=>d.value.nama=i),filled:"",disable:""},null,8,["modelValue"]),a(R,{dense:"",class:"q-my-sm",outlined:"",label:"Tunggakan*",modelValue:t.value.tunggakan,"onUpdate:modelValue":n[2]||(n[2]=i=>t.value.tunggakan=i),options:["Lunas","Belum Lunas"],clearable:"","use-input":"","new-value-mode":"add",behavior:"menu"},null,8,["modelValue"]),a(R,{dense:"",class:"q-my-sm",outlined:"",label:"Jenis Permohonan*",modelValue:t.value.jenis_permohonan,"onUpdate:modelValue":n[3]||(n[3]=i=>t.value.jenis_permohonan=i),options:["Berhenti","Cuti/Istirahat"],clearable:"","use-input":"","new-value-mode":"add",behavior:"menu"},null,8,["modelValue"]),a(Q,{dense:"",class:"q-my-sm",outlined:"",label:"Alasan*",modelValue:t.value.alasan,"onUpdate:modelValue":n[4]||(n[4]=i=>t.value.alasan=i),autogrow:""},null,8,["modelValue"]),a(L,{class:"",flat:"",bordered:""},{default:e(()=>[a(y,{class:"q-py-none q-px-sm"},{default:e(()=>[n[11]||(n[11]=_("div",{class:"text-subtitle2 q-my-sm"},"Identitas Pemohon (Wali)",-1)),a(Q,{dense:"",class:"",outlined:"",label:"Nama*",modelValue:t.value.wali_nama,"onUpdate:modelValue":n[5]||(n[5]=i=>t.value.wali_nama=i)},null,8,["modelValue"]),a(Q,{dense:"",class:"q-my-sm",outlined:"",label:"Nomor Telepon",modelValue:t.value.wali_no_telepon,"onUpdate:modelValue":n[6]||(n[6]=i=>t.value.wali_no_telepon=i)},null,8,["modelValue"]),a(R,{dense:"",class:"q-my-sm",outlined:"",label:"Bukti Diri",modelValue:t.value.wali_bukti_diri,"onUpdate:modelValue":n[7]||(n[7]=i=>t.value.wali_bukti_diri=i),options:["KTP","SIM"],clearable:"","use-input":"","new-value-mode":"add",behavior:"menu"},null,8,["modelValue"]),a(Q,{dense:"",class:"q-my-sm",outlined:"",label:"Nomor / ID Bukti Diri",modelValue:t.value.wali_bukti_diri_id,"onUpdate:modelValue":n[8]||(n[8]=i=>t.value.wali_bukti_diri_id=i)},null,8,["modelValue"]),a(R,{dense:"",class:"q-my-sm",outlined:"",label:"Status*",modelValue:t.value.wali_status,"onUpdate:modelValue":n[9]||(n[9]=i=>t.value.wali_status=i),options:["Wali","Wakil Wali"],clearable:"","use-input":"","new-value-mode":"add",behavior:"menu"},null,8,["modelValue"]),a(va,{modelValue:t.value.wali_hubungan,"onUpdate:modelValue":n[10]||(n[10]=i=>t.value.wali_hubungan=i),url:"hubungan-wali",label:"Hubungan*",class:"q-my-sm","use-input":"","new-value-mode":"add"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),a(C,{"btn-delete":!1,labelSubmit:"Cetak",iconSubmit:"print"})]),_:1})]),_:1})}}},ha={__name:"DropDownPrint",props:{santri:{type:Object,required:!0}},setup(c){const l=c,{loadingMain:b}=M(_a()),o=z(),t=q(!1),d=q(""),v=q(!1);async function m(){await N({endPoint:`reports/santri/registrasi/download?id=${o.params.id}`,loading:b,fileName:"registrasi-"+o.params.id,confirm:!0,message:"Download data registrasi?"})}async function n(){await N({endPoint:`reports/santri/standbook/download?id=${o.params.id}`,loading:b,fileName:"standbook-"+o.params.id,confirm:!0,message:"Download standbook?"})}async function U(){await N({endPoint:`reports/santri/keterangan-berhenti/download?id=${o.params.id}`,loading:b,fileName:"keterangan-berhenti-"+o.params.id,confirm:!0,message:"Download Keterangan Berhenti"})}async function C(){await N({endPoint:`reports/santri/id-card/download?id=${o.params.id}`,loading:b,fileName:"card-"+o.params.id+" ~ "+l.santri.nama,confirm:!0,message:"Download ID Card"})}function i(){d.value=`reports/santri/registrasi/view?id=${o.params.id}`,v.value=!0}function F(){d.value=`reports/santri/standbook/view?id=${o.params.id}`,v.value=!0}function T(x){t.value=!1;const r=new URLSearchParams(x).toString();d.value=`reports/santri/permohonan-berhenti/view?${r}`,v.value=!0}function $(){d.value=`reports/santri/keterangan-berhenti/view?id=${o.params.id}`,v.value=!0}return(x,r)=>(p(),K(J,null,[a(Y,{color:"green-10",label:x.$q.screen.lt.sm?"":"Cetak",icon:"print","no-caps":"",dense:"",outline:"",class:"q-px-sm text-green-11"},{default:e(()=>[a(X,null,{default:e(()=>[w((p(),g(S,null,{default:e(()=>[a(s,null,{default:e(()=>[a(V,null,{default:e(()=>[...r[3]||(r[3]=[k("Registrasi",-1)])]),_:1})]),_:1}),a(s,{avatar:""},{default:e(()=>[a(f,{icon:"download",flat:"",onClick:m})]),_:1}),a(s,{avatar:""},{default:e(()=>[a(f,{icon:"print",flat:"",onClick:i})]),_:1})]),_:1})),[[I]]),w((p(),g(S,null,{default:e(()=>[a(s,null,{default:e(()=>[a(V,null,{default:e(()=>[...r[4]||(r[4]=[k("Standbook",-1)])]),_:1})]),_:1}),a(s,{avatar:""},{default:e(()=>[a(f,{icon:"download",flat:"",onClick:n})]),_:1}),a(s,{avatar:""},{default:e(()=>[a(f,{icon:"print",flat:"",onClick:F})]),_:1})]),_:1})),[[I]]),w((p(),g(S,null,{default:e(()=>[a(s,null,{default:e(()=>[a(V,null,{default:e(()=>[...r[5]||(r[5]=[k("Permohonan Berhenti",-1)])]),_:1})]),_:1}),a(s,{avatar:""},{default:e(()=>[a(f,{icon:"download",flat:"",disable:""})]),_:1}),a(s,{avatar:""},{default:e(()=>[a(f,{icon:"print",flat:"",onClick:r[0]||(r[0]=u=>t.value=!0)})]),_:1})]),_:1})),[[I]]),w((p(),g(S,null,{default:e(()=>[a(s,null,{default:e(()=>[a(V,null,{default:e(()=>[...r[6]||(r[6]=[k("Keterangan Berhenti",-1)])]),_:1})]),_:1}),a(s,{avatar:""},{default:e(()=>[a(f,{icon:"download",flat:"",onClick:U})]),_:1}),a(s,{avatar:""},{default:e(()=>[a(f,{icon:"print",flat:"",onClick:$})]),_:1})]),_:1})),[[I]]),w((p(),g(S,null,{default:e(()=>[a(s,null,{default:e(()=>[a(V,null,{default:e(()=>[...r[7]||(r[7]=[k("ID Card",-1)])]),_:1})]),_:1}),a(s,{avatar:""},{default:e(()=>[a(f,{icon:"download",flat:"",onClick:C})]),_:1}),a(s,{avatar:""},{default:e(()=>[a(f,{icon:"print",flat:"",disable:""})]),_:1})]),_:1})),[[I]])]),_:1})]),_:1},8,["label"]),a(E,{modelValue:t.value,"onUpdate:modelValue":r[1]||(r[1]=u=>t.value=u)},{default:e(()=>[a(Da,{onSuccessSubmit:T,data:l.santri},null,8,["data"])]),_:1},8,["modelValue"]),a(E,{modelValue:v.value,"onUpdate:modelValue":r[2]||(r[2]=u=>v.value=u)},{default:e(()=>[a(fa,{url:d.value},null,8,["url"])]),_:1},8,["modelValue"])],64))}},Ua={class:"row"},xa={class:"col-12 col-sm-6 col-md-4 q-pa-sm"},Ba={class:"col-12 col-sm-6 col-md-5 q-pa-sm"},ye={__name:"SantriDetail",setup(c){const{santri:l}=oa(D()),o=z().params.id,t=ma(),{searchSantri:d,crudSantri:v}=M(t),m=q(!1),n=q(!1);async function U(){const u=await pa({endPoint:`images/santri/${o}`,loading:n});l.image_url=u.image_url}async function C(){D().$reset();try{m.value=!0;const u=await ba.getById({id:o});u&&(D().setSantri(u.santri),D().setOrtu(u.ortu),D().setWali(u.wali))}catch{}finally{m.value=!1}}const i=H(()=>[{label:"ID",value:l.value.id},{label:"Tanggal Daftar",value:W(l.value.tgl_daftar_m)+" | "+ua(l.value.tgl_daftar_h)},{label:"Tahun Ajaran",value:`${l.value.th_ajaran_h||"-"} | ${l.value.th_ajaran_m||"-"}`}]),F=H(()=>({Nama:`${l.value.nama?l.value.nama?.toUpperCase():""} (${l.value.sex?.toUpperCase()})`,Alamat:ka(l.value.jl,l.value.rt,l.value.rw,l.value.desa,l.value.kecamatan,l.value.kabupaten,l.value.provinsi,l.value.kode_pos),Kelahiran:`${l.value.tmp_lahir||"-"}, ${W(l.value.tgl_lahir)}`,"Data Akhir":l.value.data_akhir||"-"}));ia(async()=>{await C()});function T(){D().setEdit(),v.value=!0}const $=q(!1),x=u=>$.value=u;async function r(){$.value=!1,await U()}return(u,P)=>{const Z=h("CardHeader"),aa=h("CardPage");return p(),g(aa,null,{default:e(()=>[a(Z,{title:"Data Santri",onOnReload:C},{buttons:e(()=>[a(f,{label:u.$q.screen.lt.sm?"":"Cari",onClick:P[0]||(P[0]=ea=>d.value=!0),color:"green-2","no-caps":"",dense:"",class:"q-px-sm text-green-10",icon:"search"},null,8,["label"]),a(f,{"no-caps":"",color:"green-2",dense:"",class:"q-px-sm text-green-10",icon:"edit",label:u.$q.screen.lt.sm?"":"Edit",onClick:T},null,8,["label"]),a(ha,{santri:j(l)},null,8,["santri"])]),_:1}),a(y,{class:"no-padding"},{default:e(()=>[_("div",Ua,[_("div",xa,[a(wa,{class:"q-mb-sm",data:i.value,loading:m.value,title:"Registrasi"},null,8,["data","loading"]),a($a,{class:"q-mb-sm",title:"Identitas",data:F.value,loading:m.value,loadingImage:n.value,image:j(l)?.image_url||"/user-default.png"},{button:e(()=>[a(f,{class:"q-mt-sm full-width",icon:"upload","no-caps":"",label:"Foto",dense:"",size:"sm",outline:"",color:"green-10",onClick:P[1]||(P[1]=ea=>$.value=!0)})]),_:1},8,["data","loading","loadingImage","image"])]),_("div",Ba,[a(Qa,{"santri-id":j(o)},null,8,["santri-id"])])])]),_:1}),a(ra,{"img-format":"jpg","show-uploader":$.value,url:`/images/santri/${j(o)}`,onUpdateUploader:x,onSuccessUpload:r},null,8,["show-uploader","url"])]),_:1})}}};export{ye as default};
