import{Q as P}from"./QList-C7O96Y4H.js";import{Q as G}from"./QSelect-BYyrPAR2.js";import{q as k,ap as O,s as N,Y as R,E as m,c as A,o as _,w as a,g as e,af as $,f as j,G as i,Q as y,a9 as I,l as B,ae as M,N as Y,n as J,ag as S,p as z,a as W,a4 as X,aq as Z,b as ee,F as ae,D as te,v as oe,t as U,e as le,J as se}from"./index-DM_jncYt.js";import{Q as F}from"./QTd-DNvxJACi.js";import{Q as ne}from"./QTable-Brlc3FfL.js";import{Q as re}from"./QForm-Zw-Amz9S.js";import{u as ue}from"./useCrudForm-CeutNyZG.js";import{A as ie,u as de}from"./apb-account-groups-store-BA79rbDC.js";import{T as ce}from"./ToAccount-CfbKZZSM.js";import{T as me}from"./ToAccountAsset-CBnyK2Hl.js";import{T as pe}from"./ToBudgetConfig-mvknpob6.js";import{T as fe}from"./ToBudget-BFBNrhXz.js";import"./QField-CMH2dchU.js";import"./QChip-fyYFzEry.js";import"./QItem-HDmkhoZf.js";import"./QItemLabel-UugIBA3Q.js";import"./QMenu-CrcesN8E.js";import"./selection-B5gSKtbS.js";import"./rtl-DFPa-2ov.js";import"./format-CJebrXOQ.js";import"./QMarkupTable-Bdc0Nhnt.js";import"./use-fullscreen-DunaNipg.js";import"./ApiCrud-CFKNXvgl.js";import"./Api-BiHTUPZy.js";import"./index-BpLO8DFE.js";import"./index-DvSXiYm3.js";import"./apiPost-k9GJBscs.js";import"./ArrayCrud-CByp4EUn.js";import"./ClosePopup-DsIrMGS2.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const ge={__name:"ApbAccountGroupForm",props:{data:{type:Object,required:!0}},emits:["successDelete","successSubmit","successUpdate","successCreate"],setup(q,{emit:w}){const o=q,d=w,l=k({...o.data}),v=!o.data?.id,r=O("firstInput");N(async()=>{await R(),r.value&&r.value.focus()});const{handleDelete:p,handleCreate:x,handleUpdate:C,loading:b}=ue(ie,{emit:d,responseKey:"group"}),V=async()=>{const f={id:l.value.id||null,name:l.value.name,category:l.value.category};return v?await x(f,!0):await C(o.data.id,f,!0)},T=async()=>await p(o.data.id);return(f,g)=>{const h=m("FormHeader"),Q=m("FormLoading"),D=m("FormActions");return _(),A(B,{class:"full-width",style:{"max-width":"425px"}},{default:a(()=>[e(re,{onSubmit:$(V,["prevent"])},{default:a(()=>[e(h,{title:"Input Grup Akun","is-new":v}),i(b)?(_(),A(Q,{key:0})):j("",!0),e(y,null,{default:a(()=>[e(G,{dense:"",outlined:"",modelValue:l.value.category,"onUpdate:modelValue":g[0]||(g[0]=u=>l.value.category=u),label:"Kategori",class:"q-my-sm",rules:[u=>!!u||"Harus diisi!"],options:["AKTIVA","PENDAPATAN","BIAYA"],ref_key:"firstInput",ref:r},null,8,["modelValue","rules"]),e(I,{dense:"",class:"q-my-sm",outlined:"",label:"Nama Grup",modelValue:l.value.name,"onUpdate:modelValue":g[1]||(g[1]=u=>l.value.name=u),autogrow:"",rules:[u=>!!u||"Harus diisi!"]},null,8,["modelValue","rules"])]),_:1}),e(D,{"btn-delete":!v,onOnDelete:T},null,8,["btn-delete"])]),_:1})]),_:1})}}},Me={__name:"PageGroup",setup(q){const w=k(!1),o=k(!1),d=de(),{loading:l,groups:v,filterText:r,filterCategory:p,optionsCategory:x,filteredGroups:C}=M(d),b=k({}),V=()=>{b.value={},o.value=!0},T=s=>{b.value=s,o.value=!0},f=async()=>{await d.loadAll(),w.value=!0};N(async()=>{v.value.length||(await f(),w.value=!0)}),Y(p,()=>{r.value=""});const g=async(s,n)=>{await d.updateActive(s,n)},h=async s=>{d.create(s),o.value=!1},Q=async s=>{d.update(s.id,s),o.value=!1},D=async s=>{d.remove(s),o.value=!1},u=[{name:"id",label:"Edit",align:"center",field:"id",sortable:!1},{name:"category",label:"Kategori",align:"left",field:"category",sortable:!0},{name:"name",label:"Nama Grup (Instansi)",align:"left",field:"name",sortable:!0,style:"white-space: normal; word-wrap: break-word;"},{name:"accounts",label:"Daftar Akun",align:"left",field:"accounts",sortable:!1,style:"white-space: normal; word-wrap: break-word; min-width: 300px;"},{name:"active",label:"Aktif",align:"center",field:"active",sortable:!1}];return(s,n)=>{const H=m("CardHeader"),K=m("CardLoading"),L=m("router-link"),E=m("CardPage");return _(),A(E,null,{default:a(()=>[e(H,{title:"Daftar Grup Akun",onOnReload:f,"show-add":!0,onOnAdd:V},{more:a(()=>[e(P,null,{default:a(()=>[e(ce),e(me),e(fe),e(pe)]),_:1})]),_:1}),e(K,{showing:i(l)},null,8,["showing"]),e(y,{class:"q-pt-sm q-pb-none q-px-sm"},{default:a(()=>[e(B,{bordered:"",flat:""},{default:a(()=>[e(y,{class:"tw:grid tw:sm:flex tw:sm:justify-between tw:gap-2 q-pa-sm"},{default:a(()=>[e(G,{dense:"",class:"full-width",style:{"max-width":"400px"},outlined:"",label:"Kategori","emit-value":"","map-options":"",modelValue:i(p),"onUpdate:modelValue":n[0]||(n[0]=t=>S(p)?p.value=t:null),options:i(x),loading:i(l),clearable:"",behavior:"menu"},null,8,["modelValue","options","loading"]),e(I,{class:"full-width",style:{"max-width":"400px"},type:"search",outlined:"",dense:"",debounce:"300",modelValue:i(r),"onUpdate:modelValue":n[1]||(n[1]=t=>S(r)?r.value=t:null),placeholder:"Cari data ...",clearable:""},{append:a(()=>[e(z,{name:"search"})]),_:1},8,["modelValue"])]),_:1}),J(e(y,{class:"bg-warning q-pa-xs text-black"},{default:a(()=>[...n[3]||(n[3]=[W("div",{class:"text-caption text-center"}," Data tidak realtime! Klik tombol muat ulang untuk mendapatkan data terbaru. ",-1)])]),_:1},512),[[X,!w.value]])]),_:1})]),_:1}),e(y,{class:"q-pa-sm"},{default:a(()=>[e(ne,{bordered:"",flat:"",rows:i(C),columns:u,loading:i(l),"rows-per-page-options":[10,25,50,100,0],class:"dt",filter:i(r),"no-data-label":"Tidak ada data untuk ditampilkan!","no-results-label":"Tidak ditemukan kata kunci yang sesuai dengan pencarian Anda!","row-key":"id"},{"body-cell-id":a(t=>[e(F,{props:t},{default:a(()=>[e(le,{"no-caps":"",flat:"",icon:"edit",color:"primary",onClick:c=>T(t.row)},null,8,["onClick"])]),_:2},1032,["props"])]),"body-cell-accounts":a(t=>[e(F,{props:t,class:"text-italic text-primary"},{default:a(()=>[(_(!0),ee(ae,null,te(t.row.accounts,c=>(_(),A(L,{key:c.id,to:`/apb/accounts/${c.id}`,class:"tw:text-xs"},{default:a(()=>[oe(U(c.id)+": "+U(c.name)+"; Â  ",1)]),_:2},1032,["to"]))),128))]),_:2},1032,["props"])]),"body-cell-active":a(t=>[e(F,{props:t},{default:a(()=>[e(Z,{"model-value":t.value,"true-value":!0,"false-value":!1,"checked-icon":"check","unchecked-icon":"clear",color:"positive","onUpdate:modelValue":(c,we)=>g(c,t.row)},null,8,["model-value","onUpdate:modelValue"])]),_:2},1032,["props"])]),_:1},8,["rows","loading","filter"])]),_:1}),e(se,{persistent:"",modelValue:o.value,"onUpdate:modelValue":n[2]||(n[2]=t=>o.value=t)},{default:a(()=>[e(ge,{data:b.value,onSuccessCreate:h,onSuccessUpdate:Q,onSuccessDelete:D},null,8,["data"])]),_:1},8,["modelValue"])]),_:1})}}};export{Me as default};
