import{A as _,U as H,B as V,c as m,o as u,w as e,b as a,ab as L,e as S,C as k,Q as F,a5 as T,x as U,ad as E,at as K,a as j,g as q,f as A,t as g,F as P,y as R,z as h,E as z}from"./index-DwrbA0R8.js";import{Q as C}from"./QSkeleton-BtQ289R_.js";import{Q as p}from"./QItemLabel-Dzdetwv2.js";import{Q as M,a as v}from"./QItemSection-CeSY4hvW.js";import{Q as G}from"./QList-Cc6jCv1k.js";import{a as W}from"./api-get-D4W4lze7.js";import{Q as J}from"./QSelect-CrgZ1FsI.js";import{Q as X}from"./QForm-DCEv1Ikv.js";import{_ as D}from"./InputSelectArray-DFe88pva.js";import{u as Y}from"./useCrudForm-DF0rM6hG.js";import{A as Z}from"./ApiCrud-KwrbSuI8.js";import{_ as aa}from"./CardSantriSimple-BCbE6ndP.js";import{g as ea}from"./array-object-BytDdNh7.js";import{c as I}from"./format-date-DlwYCgkJ.js";import{a as la}from"./hijri-BBdEhqDI.js";class ta extends Z{constructor(){super("mutaallim")}}const sa=new ta,na={__name:"QuranMutaallimForm",props:{data:{type:Object,required:!0}},emits:["successDelete","successSubmit","successUpdate","successCreate"],setup(s,{emit:f}){const i=s,c=f,l=_({marhalah:"Ula",faslah:null,no_absen:null,aktif:1}),d=!i.data?.id,{handleDelete:x,handleCreate:Q,handleUpdate:b,loading:t}=Y(sa,{emit:c,responseKey:"mutaallim"});H(async()=>{Object.assign(l.value,i.data)});const n=async()=>{const y={santri_id:l.value.santri_id,th_ajaran_h:l.value.th_ajaran_h,marhalah:l.value.marhalah,faslah:l.value.faslah,no_absen:l.value.no_absen,aktif:l.value.aktif};return d?await Q(y,!0):await b(i.data.id,y,!0)},w=async()=>await x(i.data.id);return(y,o)=>{const B=V("FormHeader"),N=V("FormLoading"),O=V("FormActions");return u(),m(U,{class:"full-width",style:{"max-width":"425px"}},{default:e(()=>[a(X,{onSubmit:L(n,["prevent"])},{default:e(()=>[a(B,{title:"Input Pendidikan Quran","is-new":d}),k(t)?(u(),m(N,{key:0})):S("",!0),a(F,null,{default:e(()=>[a(T,{dense:"",outlined:"",label:"Nama","model-value":l.value?.nama+" ("+l.value?.santri_id+")",disable:"",filled:"",class:"q-my-sm"},null,8,["model-value"]),a(D,{modelValue:l.value.th_ajaran_h,"onUpdate:modelValue":o[0]||(o[0]=r=>l.value.th_ajaran_h=r),url:"tahun-ajaran",label:"Tahun Ajaran *",sort:"desc",class:"q-my-sm",rules:[r=>!!r||"Harus diisi!"],selected:l.value.th_ajaran_h},null,8,["modelValue","rules","selected"]),a(J,{dense:"",outlined:"",modelValue:l.value.marhalah,"onUpdate:modelValue":o[1]||(o[1]=r=>l.value.marhalah=r),label:"Marhalah *",class:"q-my-sm",rules:[r=>!!r||"Harus diisi!"],options:["Ula","Wustho","Ulya"]},null,8,["modelValue","rules"]),a(D,{modelValue:l.value.faslah,"onUpdate:modelValue":o[2]||(o[2]=r=>l.value.faslah=r),url:"faslah-quran",label:"Faslah/Kelas *",class:"q-my-sm",rules:[r=>!!r||"Harus diisi!"]},null,8,["modelValue","rules"]),a(U,{bordered:"",flat:"",class:"q-px-sm q-my-sm"},{default:e(()=>[a(E,{modelValue:l.value.aktif,"onUpdate:modelValue":o[3]||(o[3]=r=>l.value.aktif=r),color:"green","true-value":1,"false-value":0,label:"Aktif",disable:!l.value.id},null,8,["modelValue","disable"])]),_:1})]),_:1}),a(O,{"btn-delete":!d,onOnDelete:w},null,8,["btn-delete"])]),_:1})]),_:1})}}},ra={key:0},xa={__name:"MutaallimCard",props:{santri:{type:Object}},setup(s){const f=_(!1),i=_({}),c=_([]),l=_(!1);async function d(b){const t=await W({endPoint:`mutaallim/santri/${b}`,loading:l});t&&(c.value=t.mutaallim)}K(async()=>{s.santri?.id?await d(s.santri.id):s.santri?.santri_id&&await d(s.santri.santri_id)});const x=()=>{i.value={santri_id:s.santri.id,nama:s.santri.nama},f.value=!0},Q=b=>{i.value=ea(c,b),i.value.santri_id=s.santri.id,i.value.nama=s.santri.nama,f.value=!0};return(b,t)=>(u(),m(U,{flat:"",bordered:"",class:"",style:{width:"350px"}},{default:e(()=>[a(F,{class:"bg-green-7 text-green-11 q-pa-sm flex items-center justify-between"},{default:e(()=>[t[3]||(t[3]=j("div",null,"Riwayat Mutaallim",-1)),a(q,{icon:"add",outline:"",dense:"",class:"q-px-sm",disabled:!s.santri.id,onClick:x},null,8,["disabled"])]),_:1}),a(F,{class:"q-pa-sm"},{default:e(()=>[s.santri.id?(u(),m(aa,{key:0,id:s.santri.id,class:"q-mb-sm"},null,8,["id"])):S("",!0),a(G,{bordered:"",separator:"",class:"rounded-borders"},{default:e(()=>[l.value?(u(),m(M,{key:0,class:"q-px-sm"},{default:e(()=>[a(v,null,{default:e(()=>[a(p,null,{default:e(()=>[a(C,{type:"text"})]),_:1}),a(p,{caption:""},{default:e(()=>[a(C,{type:"text"})]),_:1})]),_:1}),a(v,{avatar:""},{default:e(()=>[a(C,{type:"QRadio"})]),_:1})]),_:1})):c.value?.length?(u(!0),A(P,{key:2},R(c.value,(n,w)=>(u(),m(M,{key:w,active:!!n.aktif,"active-class":"bg-green-1 text-green-10",class:"q-px-sm"},{default:e(()=>[a(v,null,{default:e(()=>[a(p,null,{default:e(()=>[g(h(n.th_ajaran_h)+" | "+h(n.marhalah)+" | "+h(n.faslah),1)]),_:2},1024),a(p,{caption:""},{default:e(()=>[g(h(k(I)(n.created_at,"dd-MM-yyyy"))+" | "+h(k(la)(k(I)(n.created_at,"yyyy-MM-dd")))+" ",1),n.aktif?(u(),A("span",ra,[...t[6]||(t[6]=[j("span",null,"|",-1),j("span",{class:"text-weight-bold text-green-10"}," Aktif ",-1)])])):S("",!0)]),_:2},1024)]),_:2},1024),a(v,{avatar:""},{default:e(()=>[a(q,{icon:"edit",dense:"",outline:"",round:"",glossy:"",onClick:y=>Q(n.id)},null,8,["onClick"])]),_:2},1024)]),_:2},1032,["active"]))),128)):(u(),m(M,{key:1,class:"q-px-sm"},{default:e(()=>[a(v,null,{default:e(()=>[a(p,null,{default:e(()=>[...t[4]||(t[4]=[g(" Tidak ada data ",-1)])]),_:1}),a(p,{caption:""},{default:e(()=>[...t[5]||(t[5]=[g(" untuk ditampilkan ",-1)])]),_:1})]),_:1}),a(v,{avatar:""},{default:e(()=>[a(q,{icon:"sym_o_exclamation",disable:"",dense:"",outline:"",round:"",color:"green-14"})]),_:1})]),_:1}))]),_:1})]),_:1}),a(z,{modelValue:f.value,"onUpdate:modelValue":t[2]||(t[2]=n=>f.value=n)},{default:e(()=>[a(na,{data:i.value,onSuccessSubmit:t[0]||(t[0]=n=>d(i.value.santri_id)),onSuccessDelete:t[1]||(t[1]=n=>d(i.value.santri_id))},null,8,["data"])]),_:1},8,["modelValue"])]),_:1}))}},$=[{name:"nama",label:"Nama",align:"left",field:"nama",sortable:!0},{name:"data_akhir",label:"Data Akhir",align:"left",field:"data_akhir",sortable:!0},{name:"th_ajaran_h",label:"Tahun Ajaran",align:"left",field:"th_ajaran_h",sortable:!0},{name:"marhalah",label:"Marhalah",align:"left",field:"marhalah",sortable:!0},{name:"faslah",label:"Faslah/Kelas",align:"left",field:"faslah",sortable:!0}],Qa=[{name:"id",label:"ID Santri",align:"center",field:"id",sortable:!0},...$],wa=[{name:"santri_id",label:"ID Santri",align:"center",field:"santri_id",sortable:!0},...$];export{xa as _,wa as a,Qa as c};
