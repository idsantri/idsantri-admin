import{Q as c}from"./QItemLabel-DzKTdPfL.js";import{Q as S,a as T}from"./QItem-DUdfjGik.js";import{Q as x}from"./QSelect-EhaZVlxC.js";import{q as m,ap as D,s as N,Y as H,E as p,c as g,o as _,w as o,g as t,af as L,f as A,G as E,Q as O,bG as B,bH as J,v as y,t as f,a9 as i,l as K}from"./index-BqUVN04g.js";import{Q as M}from"./QForm-CS-c3dsq.js";import{_ as R}from"./InputSelectSantriId-CPvJ_n50.js";import{u as $}from"./useCrudForm-CTwMSVEY.js";import{U as z}from"./UgtGt-CBkUuGlo.js";import{_ as Y}from"./InputSelectTahunAjaran-DHsqcfN5.js";import{U as W}from"./UgtPjgt-Dn0dpVvE.js";const ie={__name:"UgtGtForm",props:{data:Object},emits:["successDelete","successSubmit","successUpdate","successCreate"],setup(j,{emit:V}){const s=j,b=V,e=m({...s.data}),u=m([]),r=m(!1),d=!s.data?.id,v=D("firstInput");async function w(){try{r.value=!0;const n=await W.getAll({notifySuccess:!1});u.value=n.pjgt}catch{}finally{r.value=!1}}N(async()=>{await w(),await H(),v.value&&v.value.focus()});function Q(){e.value.pjgt_nama=u.value.find(n=>n.id==e.value?.pjgt_id)?.nama,e.value.pjgt_wilayah=u.value.find(n=>n.id==e.value?.pjgt_id)?.wilayah}const{handleDelete:U,handleCreate:I,handleUpdate:h,loading:k}=$(z,{emit:b,responseKey:"gt"});async function F(){const n={pjgt_id:e.value.pjgt_id,santri_id:e.value.santri_id,th_ajaran_h:e.value.th_ajaran_h,telepon:e.value.telepon,email:e.value.email,keterangan:e.value.keterangan};return d?await I(n,!0):await h(s.data.id,n,!0)}const q=async()=>await U(s.data.id);return(n,l)=>{const C=p("FormHeader"),G=p("FormLoading"),P=p("FormActions");return _(),g(K,{class:"full-width",style:{"max-width":"425px"}},{default:o(()=>[t(M,{onSubmit:L(F,["prevent"])},{default:o(()=>[t(C,{title:"Input Data GT","is-new":d}),E(k)?(_(),g(G,{key:0})):A("",!0),t(O,null,{default:o(()=>[t(R,{"active-only":!0,onEmitInput:l[0]||(l[0]=a=>Object.assign(e.value,a)),data:s.data,class:"q-my-sm",ref:e.value.santri_id?null:"firstInput"},null,8,["data"]),t(x,{class:"q-my-sm",dense:"",outlined:"",label:"PJGT ID*",modelValue:e.value.pjgt_id,"onUpdate:modelValue":[l[1]||(l[1]=a=>e.value.pjgt_id=a),Q],options:u.value,"emit-value":"","map-options":"","option-value":"id","option-label":"id","error-color":"negative",loading:r.value,"use-input":"",clearable:"",behavior:"menu",rules:[a=>!!a||"Harus diisi!"],ref:e.value.santri_id?"firstInput":null},{option:o(a=>[t(S,B(J(a.itemProps)),{default:o(()=>[t(T,null,{default:o(()=>[t(c,null,{default:o(()=>[y(f(a.opt.id)+" â€” "+f(a.opt.nama),1)]),_:2},1024),t(c,{caption:""},{default:o(()=>[y(f(a.opt.wilayah),1)]),_:2},1024)]),_:2},1024)]),_:2},1040)]),_:1},8,["modelValue","options","loading","rules"]),t(i,{dense:"",hint:e.value.pjgt_wilayah,class:"q-my-sm",outlined:"",label:"Nama PJGT",modelValue:e.value.pjgt_nama,"onUpdate:modelValue":l[2]||(l[2]=a=>e.value.pjgt_nama=a),disable:"",filled:""},null,8,["hint","modelValue"]),t(Y,{modelValue:e.value.th_ajaran_h,"onUpdate:modelValue":l[3]||(l[3]=a=>e.value.th_ajaran_h=a),rules:[a=>!!a||"Harus diisi!"],class:"q-my-sm",sort:"desc"},null,8,["modelValue","rules"]),t(i,{dense:"",hint:"08123456789",class:"q-my-sm",outlined:"",label:"Telepon",modelValue:e.value.telepon,"onUpdate:modelValue":l[4]||(l[4]=a=>e.value.telepon=a),rules:[a=>!a||!isNaN(a)||"Hanya angka!"],"error-color":"negative"},null,8,["modelValue","rules"]),t(i,{dense:"",class:"q-my-sm",outlined:"",label:"Email GT",modelValue:e.value.email,"onUpdate:modelValue":l[5]||(l[5]=a=>e.value.email=a)},null,8,["modelValue"]),t(i,{dense:"",class:"q-my-sm",outlined:"",label:"Keterangan",modelValue:e.value.keterangan,"onUpdate:modelValue":l[6]||(l[6]=a=>e.value.keterangan=a),autogrow:""},null,8,["modelValue"])]),_:1}),t(P,{"btn-delete":!d,onOnDelete:q},null,8,["btn-delete"])]),_:1})]),_:1})}}};export{ie as _};
