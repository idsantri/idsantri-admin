import{q as m,ap as A,s as C,Y as Q,E as D,c as k,o as w,w as c,g as o,af as h,f as B,G as b,Q as U,a9 as V,l as $,ad as j,A as q,b as H,J as M}from"./index-BGObraKh.js";import{_ as E}from"./TemplateArray-w2-07V-b.js";import{c as N}from"./format-date-DBaFa2rd.js";import{f as O,m as T}from"./hijri-CTUg_lXm.js";import{r as K,d as G,g as L}from"./array-object-BytDdNh7.js";import{Q as R}from"./QForm-BsaO44hu.js";import{_ as J}from"./InputSelectArray-CcicKbUa.js";import{A as P}from"./ApiCrud-BSS5T12d.js";import{u as Y}from"./useCrudForm-DDpDHX6R.js";import"./QItem-DfMJTwsS.js";import"./QItemLabel-B-_aW8yV.js";import"./QList-BBsNFqg5.js";import"./id-BuNGTsqN.js";import"./format-number-B34ySHL_.js";import"./QSelect-D5tM8e3R.js";import"./QField-Br2Qbnc0.js";import"./QChip-Ai3wvF9-.js";import"./QMenu-DmBcKTCH.js";import"./selection-DjrSooP-.js";import"./rtl-DFPa-2ov.js";import"./format-CJebrXOQ.js";import"./lists-store-BIY5Pte8.js";import"./ArrayCrud-CByp4EUn.js";import"./DropDownAfter-bo7CSxZS.js";import"./QBtnDropdown-C__d8B2r.js";import"./QBtnGroup-zu-IcviX.js";import"./ClosePopup-C-G3Wbep.js";import"./Lists-Cwa5jAKq.js";import"./Api-CDu9vKW9.js";import"./index-CWFlz0I4.js";import"./index-pzyLC6ns.js";import"./apiPost-B_iRVN6p.js";class z extends P{constructor(){super("domisili")}async santri(l){return(await this._apiGet({endPoint:`${this._path}/santri/${l}`})).data}}const F=new z,W={__name:"DomisiliForm",props:{data:{type:Object,required:!0}},emits:["successDelete","successSubmit","successUpdate","successCreate"],setup(f,{emit:l}){const i=f,r=l,e=m({...i.data}),n=!i.data?.id,u=A("firstInput");C(async()=>{await Q(),u.value&&u.value.focus()});const{handleDelete:v,handleCreate:_,handleUpdate:y,loading:g}=Y(F,{emit:r,responseKey:"domisili"}),a=async()=>{const t={santri_id:e.value.santri_id,domisili:e.value.domisili,keterangan:e.value.keterangan};return n?await _(t,!0):await y(i.data.id,t,!0)},s=async()=>await v(i.data.id);return(t,p)=>{const I=D("FormHeader"),S=D("FormLoading"),x=D("FormActions");return w(),k($,{class:"full-width",style:{"max-width":"425px"}},{default:c(()=>[o(R,{onSubmit:h(a,["prevent"])},{default:c(()=>[o(I,{title:"Input Domisili","is-new":n}),b(g)?(w(),k(S,{key:0})):B("",!0),o(U,null,{default:c(()=>[o(V,{class:"q-my-sm",dense:"",outlined:"",label:"Nama","model-value":e.value?.nama+" ("+e.value?.santri_id+")",disable:"",filled:""},null,8,["model-value"]),o(J,{class:"q-my-sm",modelValue:e.value.domisili,"onUpdate:modelValue":p[0]||(p[0]=d=>e.value.domisili=d),url:"domisili",label:"Domisili *",rules:[d=>!!d||"Harus diisi!"],ref_key:"firstInput",ref:u},null,8,["modelValue","rules"]),o(V,{class:"q-my-sm",dense:"",outlined:"",label:"Keterangan",modelValue:e.value.keterangan,"onUpdate:modelValue":p[1]||(p[1]=d=>e.value.keterangan=d),autogrow:""},null,8,["modelValue"])]),_:1}),o(x,{"btn-delete":!n,onOnDelete:s},null,8,["btn-delete"])]),_:1})]),_:1})}}},Qe={__name:"SantriDomisili",setup(f){const l=m(!1),i=m(!1),r=m({}),e=m([]),n=m({}),{params:u}=j();async function v(){try{l.value=!0;const a=await F.santri(u.id);e.value=a.domisili,n.value=a.santri}catch{console.log("error get domisili")}finally{l.value=!1}}const _=q(()=>e.value.map(a=>({Tanggal:N(a.created_at,"dd-MM-yyyy")+" | "+O(T(a.created_at)),Domisili:a.domisili,Keterangan:a.keterangan||"-",id:a.id})));C(async()=>{await v()});const y=()=>{r.value={santri_id:n.value.id,nama:n.value.nama},i.value=!0},g=({id:a})=>{r.value=L(e,a),r.value.santri_id=n.value.id,r.value.nama=n.value.nama,i.value=!0};return(a,s)=>(w(),H("div",null,[o(E,{data:_.value,spinner:l.value,onAdd:y,onEdit:g},null,8,["data","spinner"]),o(M,{modelValue:i.value,"onUpdate:modelValue":s[3]||(s[3]=t=>i.value=t)},{default:c(()=>[o(W,{data:r.value,title:"Input Domisili",onSuccessDelete:s[0]||(s[0]=t=>b(G)(e.value,t)),onSuccessCreate:s[1]||(s[1]=t=>e.value.push(t)),onSuccessUpdate:s[2]||(s[2]=t=>b(K)(e.value,t.id,t))},null,8,["data"])]),_:1},8,["modelValue"])]))}};export{Qe as default};
