import{v as _,R as F,x as B,f as j,o as f,w as e,i as a,a8 as R,Q as T,r as V,y as O,n as N,B as D,Z as pa,a4 as H,q as L,a2 as ca,j as y,p as A,F as M,a7 as Y,C as fa,G as va,P as _a,k as c,t as C,z as P,s as sa,a9 as ta,l as ga,_ as la,a6 as oa,a0 as ba,bF as ka,bG as ya,ae as xa}from"./index-1h6WQa8x.js";import{Q as wa}from"./QSpace-CR7bsMEl.js";import{Q as z}from"./QSpinnerCube-CdFtSnRz.js";import{Q as Va}from"./QRouteTab-w1IThm_t.js";import{Q as $a}from"./QTabs-q7eXOXOC.js";import{a as G}from"./api-get-BY6mtHh6.js";import{Q as U,a as q}from"./QItemSection-CDMonx4a.js";import{Q as S}from"./QItemLabel-BCrbjFPh.js";import{Q as aa}from"./QList-DG4NG05A.js";import{a as J}from"./api-update-Damf_6Ly.js";import{c as qa}from"./format-date-DlwYCgkJ.js";import{Q as ea}from"./QForm-Dcqp4yj8.js";import{l as X}from"./lists-store-DUO5Gnb9.js";import{a as ha}from"./api-delete-BHdy2F2f.js";import{a as ua}from"./api-post-C74Y7wCj.js";import{_ as ia}from"./InputCurrency-C4S6SfTn.js";import{_ as ra}from"./InputSelectSantriId-DUlOhqsx.js";import{_ as E}from"./InputSelectArray-f2GqfPam.js";import{r as na,d as Sa}from"./array-object-BytDdNh7.js";import{s as ja,a as Ia,b as Ca,c as Pa}from"./utils-CiaEZYac.js";import{Q as da}from"./QBtnDropdown-BuGH-2yX.js";import{C as K}from"./ClosePopup-DlITPM1C.js";import{a as W}from"./api-download-DiJAjdRL.js";import{l as Ua}from"./loading-store-De2ZIFfx.js";import{_ as Qa}from"./ReportViewer-mjAysFQV.js";import{_ as Ta}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{Q as Aa}from"./QToolbarTitle-DdD-fGk3.js";import{Q as Da}from"./QToolbar-vKMNabI2.js";import{Q as Fa}from"./QSelect-DyXiAk3o.js";import{_ as Na}from"./CardSantriSimple-B4aE1WRE.js";import{_ as Ba}from"./InputSelectIuranPaket-CSKRHMzv.js";import"./QResizeObserver-BGqO9aRk.js";import"./rtl-DFPa-2ov.js";import"./index-CpzetzrR.js";import"./index-_Ec9HkD1.js";import"./api-error-B2Y93K9w.js";import"./id-BuNGTsqN.js";import"./lists-data-L-iOlbK0.js";import"./api-get-lists-BZgeu587.js";import"./DropDownAfter-vvhC7sAZ.js";import"./QBtnGroup-GiM85D-N.js";import"./QMenu-C8eKSCkY.js";import"./selection-Bkxc-DqK.js";import"./QChip-DJ1cSnO8.js";import"./format-CJebrXOQ.js";import"./QSkeleton-BA_8lTLb.js";import"./QImg-_Bkf3zut.js";import"./santri-store-B0W6NRUd.js";import"./QSlideTransition-36jRmBo3.js";const Oa={key:0},ma={__name:"IuranForm",props:{data:{type:Object,required:!1,default:()=>{}},disableSantriId:{type:Boolean,default:!1},disableThAjaran:{type:Boolean,default:!1}},emits:["successDelete","successSubmit","successUpdate","successCreate"],setup(h,{emit:m}){const b=h,g=m,t=_({}),n=_(!1),x=_([]),r=_([]);F(async()=>{Object.assign(t.value,b.data),x.value=X().getByStateName("tahun-ajaran"),r.value=X().getByStateName("iuran")});const u=p=>{const d=r.value.find(s=>s.val0===p);d&&(t.value.nominal=d.val1)},w=async()=>{const p={santri_id:t.value.santri_id,th_ajaran_h:t.value.th_ajaran_h,item:t.value.item,nominal:t.value.nominal,via:t.value.via,keterangan:t.value.keterangan};let d=null;const s=!t.value.id;s?d=await ua({endPoint:"iuran",data:p,loading:n}):d=await J({endPoint:`iuran/${t.value.id}`,data:p,confirm:!0,notify:!0,loading:n}),d&&(document.getElementById("btn-close-form").click(),g("successSubmit",d?.iuran),g(s?"successCreate":"successUpdate",d?.iuran))},k=async()=>{const p=t.value.id;await ha({endPoint:`iuran/${p}`,loading:n})&&(document.getElementById("btn-close-form").click(),g("successDelete",p))};return(p,d)=>{const s=B("FormHeader"),v=B("FormActions");return f(),j(L,{class:"full-width",style:{"max-width":"425px"}},{default:e(()=>[a(ea,{onSubmit:R(w,["prevent"])},{default:e(()=>[a(s,{title:"Input Iuran","is-new":!t.value.id},null,8,["is-new"]),a(T,null,{default:e(()=>[n.value?(f(),V("div",Oa,[a(D,{modelValue:n.value,"onUpdate:modelValue":d[0]||(d[0]=i=>n.value=i),persistent:""},{default:e(()=>[a(z,{color:"green-12",size:"8em",class:"flex q-ma-lg q-mx-auto"})]),_:1},8,["modelValue"])])):O("",!0),a(ra,{"active-only":!0,onEmitInput:d[1]||(d[1]=i=>Object.assign(t.value,i)),data:b.data},null,8,["data"]),a(E,{modelValue:t.value.th_ajaran_h,"onUpdate:modelValue":d[2]||(d[2]=i=>t.value.th_ajaran_h=i),url:"tahun-ajaran",label:"Tahun Ajaran",sort:"desc",class:"q-mt-sm",rules:[i=>!!i||"Harus diisi!"],selected:t.value.th_ajaran_h,disable:b.disableThAjaran},null,8,["modelValue","rules","selected","disable"]),a(E,{modelValue:t.value.item,"onUpdate:modelValue":[d[3]||(d[3]=i=>t.value.item=i),u],url:"iuran",label:"Nama Iuran",class:"q-mt-sm"},null,8,["modelValue"]),a(ia,{dense:"",class:"q-mt-sm",outlined:"",modelValue:t.value.nominal,"onUpdate:modelValue":d[4]||(d[4]=i=>t.value.nominal=i),required:"",label:"Nominal",rules:[i=>!!i||"Harus diisi!"]},null,8,["modelValue","rules"]),N(a(E,{modelValue:t.value.via,"onUpdate:modelValue":d[5]||(d[5]=i=>t.value.via=i),url:"metode-pembayaran",label:"Via",class:"q-mt-sm"},null,8,["modelValue"]),[[pa,t.value.id&&t.value.lunas]]),a(H,{label:"Keterangan",modelValue:t.value.keterangan,"onUpdate:modelValue":d[6]||(d[6]=i=>t.value.keterangan=i),dense:"",outlined:"",class:"q-mt-sm",autogrow:""},null,8,["modelValue"])]),_:1}),a(v,{"btn-delete":!!t.value.id,onOnDelete:k},null,8,["btn-delete"])]),_:1})]),_:1})}}},La={__name:"DropDownPrint",props:{data:{}},setup(h){const{loadingMain:m}=ca(Ua()),b=_(""),g=_(!1),t=h,n=_("");F(()=>{n.value=new URLSearchParams(t.data).toString()});async function x(){await W({endPoint:`reports/iuran-card/download?${n.value}`,loading:m,fileName:"iuran-card",confirm:!0,message:"Download kartu iuran?"})}async function r(){await W({endPoint:`reports/iuran-cover/download?${n.value}`,loading:m,fileName:"iuran-cover",confirm:!0,message:"Download cover kartu iuran?"})}async function u(){await W({endPoint:`reports/iuran-kuitansi/download?${n.value}`,loading:m,fileName:"iuran-kuitansi",confirm:!0,message:"Download kuitansi iuran?"})}function w(){b.value=`reports/iuran-card/view?${n.value}`,g.value=!0}function k(){b.value=`reports/iuran-cover/view?${n.value}`,g.value=!0}function p(){b.value=`reports/iuran-kuitansi/view?${n.value}`,g.value=!0}return(d,s)=>(f(),V(M,null,[a(da,{color:"green-11",label:"Cetak",icon:"print","no-caps":"",class:"text-green-10 q-px-md",dense:""},{default:e(()=>[a(aa,null,{default:e(()=>[N((f(),j(U,null,{default:e(()=>[a(q,null,{default:e(()=>[a(S,null,{default:e(()=>[...s[1]||(s[1]=[y("Kartu",-1)])]),_:1})]),_:1}),a(q,{avatar:""},{default:e(()=>[a(A,{icon:"download",flat:"",onClick:x})]),_:1}),a(q,{avatar:""},{default:e(()=>[a(A,{icon:"print",flat:"",onClick:w})]),_:1})]),_:1})),[[K]]),N((f(),j(U,null,{default:e(()=>[a(q,null,{default:e(()=>[a(S,null,{default:e(()=>[...s[2]||(s[2]=[y("Cover",-1)])]),_:1})]),_:1}),a(q,{avatar:""},{default:e(()=>[a(A,{icon:"download",flat:"",onClick:r})]),_:1}),a(q,{avatar:""},{default:e(()=>[a(A,{icon:"print",flat:"",onClick:k})]),_:1})]),_:1})),[[K]]),N((f(),j(U,null,{default:e(()=>[a(q,null,{default:e(()=>[a(S,null,{default:e(()=>[...s[3]||(s[3]=[y("Kuitansi",-1)])]),_:1})]),_:1}),a(q,{avatar:""},{default:e(()=>[a(A,{icon:"download",flat:"",onClick:u})]),_:1}),a(q,{avatar:""},{default:e(()=>[a(A,{icon:"print",flat:"",onClick:p})]),_:1})]),_:1})),[[K]])]),_:1})]),_:1}),a(D,{modelValue:g.value,"onUpdate:modelValue":s[0]||(s[0]=v=>g.value=v)},{default:e(()=>[a(Qa,{url:b.value},null,8,["url"])]),_:1},8,["modelValue"])],64))}},Ha={key:0},Ea={__name:"IuranLunasForm",props:{data:{type:Object,required:!0}},emits:["successSubmit","successUpdate"],setup(h,{emit:m}){const b=h,g=m,t=_({}),n=_(!1);F(async()=>{Object.assign(t.value,b.data)});const x=async()=>{const r={via:t.value.via},u=await J({endPoint:`iuran/${t.value.id}/lunas`,data:r,message:"Iuran/tagihan lunas?",notify:!0,loading:n});u&&(document.getElementById("btn-close-form").click(),g("successSubmit",u?.iuran),g("successUpdate",u?.iuran))};return(r,u)=>{const w=B("FormHeader"),k=B("FormActions");return f(),j(L,{class:"full-width",style:{"max-width":"425px"}},{default:e(()=>[a(ea,{onSubmit:R(x,["prevent"])},{default:e(()=>[a(w,{title:"Set Iuran Lunas","is-new":!1}),a(T,null,{default:e(()=>[n.value?(f(),V("div",Ha,[a(D,{modelValue:n.value,"onUpdate:modelValue":u[0]||(u[0]=p=>n.value=p),persistent:""},{default:e(()=>[a(z,{color:"green-12",size:"8em",class:"flex q-ma-lg q-mx-auto"})]),_:1},8,["modelValue"])])):O("",!0),a(H,{disable:"",label:"Nama",modelValue:t.value.nama,"onUpdate:modelValue":u[1]||(u[1]=p=>t.value.nama=p),dense:"",outlined:""},null,8,["modelValue"]),a(H,{disable:"",label:"Tahun Ajaran",modelValue:t.value.th_ajaran_h,"onUpdate:modelValue":u[2]||(u[2]=p=>t.value.th_ajaran_h=p),dense:"",outlined:"",class:"q-mt-sm"},null,8,["modelValue"]),a(H,{disable:"",label:"Nama Iuran",modelValue:t.value.item,"onUpdate:modelValue":u[3]||(u[3]=p=>t.value.item=p),dense:"",outlined:"",class:"q-mt-sm"},null,8,["modelValue"]),a(ia,{disable:"",dense:"",class:"q-mt-sm",outlined:"",modelValue:t.value.nominal,"onUpdate:modelValue":u[4]||(u[4]=p=>t.value.nominal=p),required:"",label:"Nominal"},null,8,["modelValue"]),a(E,{modelValue:t.value.via,"onUpdate:modelValue":u[5]||(u[5]=p=>t.value.via=p),url:"metode-pembayaran",label:"Via",class:"q-mt-sm",rules:[p=>!!p||"Harus diisi!"]},null,8,["modelValue","rules"])]),_:1}),a(k,{"btn-delete":!1})]),_:1})]),_:1})}}},Ka={key:0},Ra={key:1},Ma={key:0},za={class:"",style:{"min-width":"250px","max-width":"300px"}},Ga={class:"text-right"},Ja={class:"text-right"},Ya={class:"text-right text-weight-bold"},Za={class:"flex items-center q-gutter-x-sm"},Wa={class:"q-card--bordered rounded-borders q-px-sm"},Xa={class:"q-card--bordered rounded-borders q-px-sm"},ae={class:"text-subtitle1 text-weight-bold"},ee={class:"flex flex-center"},te={key:1,class:"q-ma-lg"},le={__name:"IuranSantriByTh",setup(h){const{params:m}=Y(),b=_(m.thAjaranH),g=_(m.id),t=_(!1),n=_([]),x=_(!1),r=_({}),u=fa("santri"),w=_(!1);function k($){r.value=$,r.value.nama=u.value.nama,r.value.data_akhir=u.value.data_akhir,x.value=!0}async function p(){if(b.value&&g.value){const $=await G({endPoint:`iuran/santri/${g.value}`,params:{th_ajaran_h:b.value},loading:t});$&&(n.value=i($.iuran))}}F(async()=>await p());async function d($,l,o,Q){await J({endPoint:`iuran/${o.id}/cetak`,confirm:!1,notify:!1})||(n.value[Q].cetak=$==1?0:1)}async function s($,l,o,Q){if($)return v(o,Q);const I=await J({endPoint:`iuran/${o.id}/not-lunas`,message:"Iuran/tagihan TIDAK lunas?",loading:t});I?n.value[Q]=I.iuran:n.value[Q].isLunas=$!=!0}async function v($,l){r.value=$,r.value.nama=u.value.nama,r.value.data_akhir=u.value.data_akhir,w.value=!0,n.value[l].isLunas=!1}va(n,async($,l)=>{await _a();const o=i([...$]);JSON.stringify(o)!==JSON.stringify(l)&&(n.value=o)},{deep:!0});function i($){return $.sort((l,o)=>l.lunas===null&&o.lunas===null?0:l.lunas===null?1:o.lunas===null?-1:new Date(l.lunas)-new Date(o.lunas)).map(l=>({...l,isLunas:!!l.lunas,show:Object.prototype.hasOwnProperty.call(l,"show")?l.show:!1}))}return($,l)=>(f(),V(M,null,[t.value?(f(),V("div",Ka,[a(z,{color:"green-12",size:"8em",class:"flex q-ma-lg q-mx-auto"})])):(f(),V("div",Ra,[n.value.length>0?(f(),V("div",Ma,[a(aa,null,{default:e(()=>[a(U,{class:"q-pa-sm bg-green-11"},{default:e(()=>[a(q,{class:"flex"},{default:e(()=>[c("table",za,[c("tbody",null,[c("tr",null,[l[6]||(l[6]=c("td",{class:"text-caption text-italic q-pr-md"}," Total Tagihan ",-1)),c("td",Ga,C(P(ja)(n.value).toRupiah()),1)]),c("tr",null,[l[7]||(l[7]=c("td",{class:"text-caption text-italic q-pr-md"}," Total Pembayaran ",-1)),c("td",Ja,C(P(Ia)(n.value).toRupiah()),1)]),c("tr",null,[l[8]||(l[8]=c("td",{class:"text-caption text-italic q-pr-md"}," Sisa Tagihan ",-1)),c("td",Ya,C(P(Ca)(n.value).toRupiah()),1)])])])]),_:1})]),_:1}),(f(!0),V(M,null,sa(n.value,(o,Q)=>(f(),V("div",{key:Q},[a(U,{class:"q-px-sm",clickable:"",onClick:R(I=>o.show=!o.show,["stop"])},{default:e(()=>[a(q,null,{default:e(()=>[a(S,{overline:""},{default:e(()=>[y(C(o.item),1)]),_:2},1024),a(S,null,{default:e(()=>[y(C(o.nominal.toRupiah()),1)]),_:2},1024)]),_:2},1024),a(q,{side:""},{default:e(()=>[c("div",Za,[c("div",Wa,[a(ta,{label:"Lunas",color:"green",class:"text-green-10",modelValue:o.isLunas,"onUpdate:modelValue":[I=>o.isLunas=I,(I,Z)=>s(I,Z,o,Q)],"checked-icon":"check","unchecked-icon":"clear","true-value":!0,"false-value":!1},null,8,["modelValue","onUpdate:modelValue"])]),c("div",Xa,[a(ta,{disable:!o.lunas,label:"Cetak",color:"green",class:"text-green-10",modelValue:o.cetak,"onUpdate:modelValue":[I=>o.cetak=I,(I,Z)=>d(I,Z,o,Q)],"checked-icon":"check","unchecked-icon":"clear","true-value":1,"false-value":0},null,8,["disable","modelValue","onUpdate:modelValue"])]),a(A,{icon:"edit",glossy:"",outline:"",dense:"",round:"",color:"green-8",unelevated:"",onClick:R(I=>k(o),["stop"])},null,8,["onClick"])])]),_:2},1024)]),_:2},1032,["onClick"]),o.show?(f(),j(U,{key:0,class:"q-px-sm q-pb-sm q-pt-none"},{default:e(()=>[a(q,null,{default:e(()=>[a(S,null,{default:e(()=>[l[9]||(l[9]=c("em",null,"Lunas:",-1)),y("  "+C(o.lunas?P(qa)(o.lunas,"'hari' EEEE, 'tanggal' dd MMMM yyyy, 'pukul' HH:mm"):"-"),1)]),_:2},1024),a(S,{caption:""},{default:e(()=>[l[10]||(l[10]=c("em",null,"Kasir:",-1)),l[11]||(l[11]=y(" ",-1)),c("strong",null,C(o.kasir||"-"),1),l[12]||(l[12]=y("; ",-1)),l[13]||(l[13]=c("em",null,"Via:",-1)),l[14]||(l[14]=y(" ",-1)),c("strong",null,C(o.via||"-"),1),l[15]||(l[15]=y("; ",-1)),l[16]||(l[16]=c("em",null,"Ket.:",-1)),l[17]||(l[17]=y(" ",-1)),c("strong",null,C(o.keterangan||"-"),1)]),_:2},1024)]),_:2},1024)]),_:2},1024)):O("",!0),a(ga)]))),128)),a(U,{class:"q-pa-sm bg-green-8"},{default:e(()=>[a(q,{class:"text-green-11"},{default:e(()=>[a(S,{overline:"",class:"text-green-1"},{default:e(()=>[l[18]||(l[18]=y(" TOTAL CETAK ",-1)),c("span",ae,C(P(Pa)(n.value).toRupiah()),1)]),_:1})]),_:1}),a(q,{side:"",class:""},{default:e(()=>[c("div",ee,[a(La,{data:{santri_id:g.value,th_ajaran_h:b.value}},null,8,["data"])])]),_:1})]),_:1})]),_:1})])):(f(),V("div",te,[...l[19]||(l[19]=[c("div",{class:"text-body2 text-italic text-center"}," Tidak ada data untuk ditampilkan! ",-1),c("hr",null,null,-1),c("div",{class:"text-weight-thin text-italic text-center"}," Klik angka tahun disamping, atau tambahkan data! ",-1)])]))])),a(D,{modelValue:x.value,"onUpdate:modelValue":l[3]||(l[3]=o=>x.value=o)},{default:e(()=>[a(ma,{data:r.value,onSuccessDelete:l[0]||(l[0]=o=>P(Sa)(n.value,o)),onSuccessCreate:l[1]||(l[1]=o=>n.value.push(o)),onSuccessUpdate:l[2]||(l[2]=o=>P(na)(n.value,o.id,o)),"disable-santri-id":!0,"disable-th-ajaran":!0},null,8,["data"])]),_:1},8,["modelValue"]),a(D,{modelValue:w.value,"onUpdate:modelValue":l[5]||(l[5]=o=>w.value=o)},{default:e(()=>[a(Ea,{data:r.value,onSuccessUpdate:l[4]||(l[4]=o=>P(na)(n.value,o.id,o))},null,8,["data"])]),_:1},8,["modelValue"])],64))}},ne={key:0},se={key:1,class:"row"},oe={class:"col bg-green-1",style:{"max-width":"90px"}},ue={class:"col"},ie={key:0,class:"q-ma-lg"},re={key:1},de={key:2,class:"q-ma-lg"},me={__name:"TabThAjaran",setup(h){const m=_([]),b=_(!1),{params:g}=Y(),t=_([]);async function n(){const x=await G({endPoint:"iuran/santri/"+g.id,loading:b});x&&(m.value=x.iuran??[],t.value=m.value.map(r=>r.th_ajaran_h))}return F(async()=>{g.id&&await n()}),(x,r)=>b.value?(f(),V("div",ne,[a(z,{color:"green-12",size:"8em",class:"flex q-ma-lg q-mx-auto"})])):m.value?.length>0?(f(),V("div",se,[c("div",oe,[a($a,{vertical:"",dense:"",align:"left","no-caps":"","active-bg-color":"green-11"},{default:e(()=>[(f(!0),V(M,null,sa(t.value,(u,w)=>(f(),V("div",{key:w},[a(Va,{name:u,label:u,to:`/iuran/santri/${P(g).id}/${u}`},null,8,["name","label","to"])]))),128))]),_:1})]),c("div",ue,[P(g).thAjaranH?(f(),V("div",re,[a(le)])):(f(),V("div",ie,[...r[0]||(r[0]=[c("div",{class:"text-italic text-center"}," Klik angka tahun disamping, atau tambahkan data! ",-1)])]))])])):(f(),V("div",de,[...r[1]||(r[1]=[c("div",{class:"text-body2 text-italic text-center"}," Tidak ada data untuk ditampilkan! ",-1),c("hr",null,null,-1),c("div",{class:"text-weight-thin text-italic text-center"},[y(" Yang bersangkutan belum pernah melakuan pembayaran. "),c("br"),y(" Silakan klik tombol tambah! ")],-1)])]))}},pe={};function ce(h,m){return f(),j(da,{split:"",dense:"",label:"Tambah","no-caps":"",icon:"add",color:"green-10",padding:"xs sm","text-color":"green-11",onClick:m[1]||(m[1]=b=>h.$emit("onAdd"))},{default:e(()=>[a(aa,null,{default:e(()=>[N((f(),j(U,{clickable:"",onClick:m[0]||(m[0]=b=>h.$emit("showPaket"))},{default:e(()=>[a(q,{avatar:""},{default:e(()=>[a(la,{name:"local_atm",color:"green"})]),_:1}),a(q,null,{default:e(()=>[a(S,null,{default:e(()=>[...m[2]||(m[2]=[y("Paket",-1)])]),_:1}),a(S,{caption:""},{default:e(()=>[...m[3]||(m[3]=[y("Pembayaran/Tagihan",-1)])]),_:1})]),_:1})]),_:1})),[[K]]),N((f(),j(U,{clickable:"",to:"/iuran/paket"},{default:e(()=>[a(q,{avatar:""},{default:e(()=>[a(la,{name:"settings",color:"green"})]),_:1}),a(q,null,{default:e(()=>[a(S,null,{default:e(()=>[...m[4]||(m[4]=[y("Setting",-1)])]),_:1}),a(S,{caption:""},{default:e(()=>[...m[5]||(m[5]=[y("Atur Paket",-1)])]),_:1})]),_:1})]),_:1})),[[K]])]),_:1})]),_:1})}const fe=Ta(pe,[["render",ce]]),ve={class:"flex content-start items-center",style:{"max-width":"1000px",width:"100%"}},_e={key:0,class:"q-pa-sm"},ge={key:1,class:"q-pa-sm text-negative"},be={__name:"FilterSantri",props:{startUrl:String,activeOnly:{type:Boolean}},emits:["dataFilter"],setup(h,{emit:m}){const b=h,g=m,t=Y(),n=oa(),x={id:t.params.id},r=_(x.id),u=_(!1),w=_([]),k=_(!1);F(async()=>{if(g("dataFilter",{display:'<div class="text-green-13 text-italic">Tentukan filter!</div>'}),r.value){const s=await G({endPoint:`santri/${r.value}`}),v={display:`
			➡️ ${r.value}
			| <strong>${s.santri.nama}</strong>
			| ${s.santri.data_akhir}
			`};g("dataFilter",v)}});function p(s){s?n.push(`${b.startUrl}/${s}`):n.push(`${b.startUrl}`)}async function d(s,v){if(!s){v(()=>{w.value=[]});return}const i=await G({endPoint:"santri/ids",loading:u,params:{active_only:!!b.activeOnly,q:s}});k.value=!i.lists.length,v(()=>w.value=i.lists,$=>{s!==""&&$.options.length&&($.setOptionIndex(-1),$.moveOptionSelection(1,!0))})}return(s,v)=>(f(),j(L,null,{default:e(()=>[a(T,{class:"q-px-sm q-py-sm bg-green-11"},{default:e(()=>[a(Da,{class:"no-padding",style:{"min-height":"0"}},{default:e(()=>[a(Aa,{class:"text-subtitle1"},{default:e(()=>[...v[1]||(v[1]=[c("div",{class:"text-subtitle2 text-weight-bold"}," Filter ID Santri ",-1)])]),_:1}),ba(s.$slots,"default")]),_:3})]),_:3}),a(T,{class:"no-padding"},{default:e(()=>[c("div",ve,[a(Fa,{class:"q-pa-sm",dense:"",outlined:"",label:"ID Santri",modelValue:r.value,"onUpdate:modelValue":[v[0]||(v[0]=i=>r.value=i),p],options:w.value,"emit-value":"","map-options":"","option-value":"id","option-label":"id","error-color":"negative",loading:u.value,"use-input":"",clearable:"",onFilter:d,behavior:"menu"},{option:e(i=>[a(U,ka(ya(i.itemProps)),{default:e(()=>[a(q,null,{default:e(()=>[a(S,null,{default:e(()=>[y(C(i.opt.id)+" — "+C(i.opt.nama),1)]),_:2},1024),a(S,{caption:""},{default:e(()=>[y(C(i.opt.data_akhir),1)]),_:2},1024)]),_:2},1024)]),_:2},1040)]),_:1},8,["modelValue","options","loading"]),r.value?O("",!0):(f(),V("div",_e,"Ketikkan ID Santri")),k.value?(f(),V("div",ge," Data Tidak ditemukan ")):O("",!0)])]),_:1})]),_:3}))}},ke={key:0},ye={__name:"IuranPaketSantriForm",props:{data:{type:Object,required:!1,default:()=>{}},title:{type:String,default:()=>"Input"}},emits:["successSubmit","successCreate"],setup(h,{emit:m}){const b=h,g=m,t=_({}),n=_(!1),x=_([]),r=_([]);F(async()=>{Object.assign(t.value,b.data),x.value=X().getByStateName("tahun-ajaran")});const u=async()=>{const w=r.value.map(d=>({item:d.item,nominal:d.nominal})),k={santri_id:t.value.santri_id,th_ajaran_h:t.value.th_ajaran_h,keterangan:t.value.keterangan||"",paket:w},p=await ua({endPoint:"iuran/paket",data:k,loading:n,message:"PERHATIAN<br/>Jika item iuran sudah terdapat dalam daftar maka akan diabaikan."});p&&(document.getElementById("btn-close-form").click(),g("successSubmit",p?.iuran),g("successCreate",p?.iuran))};return(w,k)=>{const p=B("FormHeader"),d=B("FormActions");return f(),j(L,{class:"full-width",style:{"max-width":"425px"}},{default:e(()=>[a(ea,{onSubmit:R(u,["prevent"])},{default:e(()=>[a(p,{title:"Modul Paket","is-new":!0}),a(T,null,{default:e(()=>[n.value?(f(),V("div",ke,[a(D,{modelValue:n.value,"onUpdate:modelValue":k[0]||(k[0]=s=>n.value=s),persistent:""},{default:e(()=>[a(z,{color:"green-12",size:"8em",class:"flex q-ma-lg q-mx-auto"})]),_:1},8,["modelValue"])])):O("",!0),a(ra,{"active-only":!0,onEmitInput:k[1]||(k[1]=s=>Object.assign(t.value,s)),data:b.data},null,8,["data"]),a(E,{modelValue:t.value.th_ajaran_h,"onUpdate:modelValue":k[2]||(k[2]=s=>t.value.th_ajaran_h=s),url:"tahun-ajaran",label:"Tahun Ajaran",sort:"desc",class:"q-mt-sm",rules:[s=>!!s||"Harus diisi!"],selected:t.value.th_ajaran_h,disable:b.disableThAjaran},null,8,["modelValue","rules","selected","disable"]),a(Ba,{class:"q-mt-sm",onOnInput:k[3]||(k[3]=s=>r.value=s)}),a(H,{label:"Keterangan",modelValue:t.value.keterangan,"onUpdate:modelValue":k[4]||(k[4]=s=>t.value.keterangan=s),dense:"",outlined:"",class:"q-mt-sm"},null,8,["modelValue"])]),_:1}),a(d)]),_:1})]),_:1})}}},xe={class:"q-mt-sm"},gt={__name:"PageIuranSantri",setup(h){const{params:m}=Y(),b=oa(),g=_({}),t=_(0),n=_({}),x=_(!1),r=_(!1),u=_({});xa("santri",u);function w(){n.value={santri_id:u.value.id,nama:u.value.nama,data_akhir:u.value.data_akhir,th_ajaran_h:m.thAjaranH||""}}function k(){w(),x.value=!0}function p(){w(),r.value=!0}const d=s=>{s.th_ajaran_h==m.thAjaranH&&t.value++,b.push(`/iuran/santri/${s.santri_id}/${s.th_ajaran_h}`)};return(s,v)=>(f(),V(M,null,[a(be,{"start-url":"/iuran/santri",onDataFilter:v[0]||(v[0]=i=>g.value=i),"active-only":!1,bordered:"",flat:"",class:""}),c("div",xe,[P(m).id?(f(),j(Na,{key:0,id:P(m).id,onLoaded:v[1]||(v[1]=i=>u.value=i)},null,8,["id"])):(f(),j(L,{key:1,bordered:"",flat:""},{default:e(()=>[a(T,{class:"q-pa-sm bg-green-11 text-subtitle2"},{default:e(()=>[...v[6]||(v[6]=[y(" No data ",-1)])]),_:1}),a(T,{class:"q-pa-lg text-body1 text-center"},{default:e(()=>[...v[7]||(v[7]=[y(" Pilih Santri ",-1)])]),_:1})]),_:1}))]),a(L,{flat:"",bordered:"",class:"q-mt-sm"},{default:e(()=>[a(T,{class:"q-pa-sm text-subtitle1 bg-green-6 text-green-11 flex items-center"},{default:e(()=>[v[8]||(v[8]=y(" Data Iuran ",-1)),a(wa),a(A,{icon:"sync",outline:"",dense:"",onClick:v[2]||(v[2]=i=>t.value++),class:"q-px-sm q-mr-sm"}),a(fe,{onOnAdd:k,onShowPaket:p})]),_:1}),a(T,{class:"no-padding"},{default:e(()=>[(f(),j(me,{key:t.value}))]),_:1})]),_:1}),a(D,{modelValue:x.value,"onUpdate:modelValue":v[3]||(v[3]=i=>x.value=i)},{default:e(()=>[a(ma,{data:n.value,onSuccessCreate:d,"disable-santri-id":!0},null,8,["data"])]),_:1},8,["modelValue"]),a(D,{modelValue:r.value,"onUpdate:modelValue":v[5]||(v[5]=i=>r.value=i)},{default:e(()=>[a(ye,{data:n.value,onSuccessSubmit:v[4]||(v[4]=i=>t.value++)},null,8,["data"])]),_:1},8,["modelValue"])],64))}};export{gt as default};
