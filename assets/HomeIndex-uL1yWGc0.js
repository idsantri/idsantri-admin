import{Q as N}from"./QPage-UGrmrneY.js";import{_ as j}from"./LogoCircle-CMXhvkuT.js";import{A as u,c as _,o as p,G as x,q as h,s as E,E as P,w as y,a as o,b as v,g,l as I,v as J,t as k,H as b}from"./index-B48kyTDV.js";import{C,p as $,a as S,b as A,A as L,P as M,B as q,c as K,L as W,d as F,S as H}from"./index-CgCY0dgl.js";import"./Api-C0manBLV.js";import"./index-DjEbxsAp.js";import"./index-CtANUnjw.js";import"./apiPost-DSpDAU24.js";const Q={__name:"ChartAsrama",props:{asrama:Array,total:Number},emits:["slice-click"],setup(f,{emit:l}){C.register($,S,A,L);const r=f,n=l,c=u(()=>{const a=r.asrama.map(i=>i.asrama),t=r.asrama.map(i=>i.jumlah),e=s(t.length);return{labels:a,datasets:[{label:"Jumlah per Asrama",data:t,backgroundColor:e,borderColor:"#ffffff",borderWidth:2}]}}),m=u(()=>({responsive:!0,plugins:{title:{display:!1,text:`Jumlah Penghuni: ${r.total}`},legend:{position:"right",labels:{generateLabels:a=>{const{labels:t,datasets:e}=a.data,i=e[0].data;return t.map((D,d)=>{const w=i[d],B=(w/r.total*100).toFixed(2);return{text:`${D}: ${w} (${B}%)`,fillStyle:e[0].backgroundColor[d],strokeStyle:e[0].borderColor?.[d]||e[0].backgroundColor[d],lineWidth:1,hidden:a.getDatasetMeta(0).data[d].hidden,index:d}})}}},tooltip:{callbacks:{title:a=>`Asrama ${a[0].label}`,label:a=>{const t=a.raw,e=(t/r.total*100).toFixed(1);return`${t} (${e}%)`}}}},onHover:(a,t)=>{if(t.length>0){const e=t[0].index;n("slice-click",r.asrama[e])}else n("slice-click",null)}}));function s(a){return Array.from({length:a},(t,e)=>`hsl(${Math.floor(360/a*e)}, 70%, 60%)`)}return(a,t)=>(p(),_(x(M),{data:c.value,options:m.value},null,8,["data","options"]))}},V={__name:"ChartKamar",props:{kamar:Array},setup(f){C.register($,S,A,q,K,W);const l=f,r=u(()=>l.kamar.reduce((s,a)=>s+a.jumlah,0)),n=u(()=>{const s=l.kamar.map(e=>e.kamar),a=l.kamar.map(e=>e.jumlah),t=m(a.length);return{labels:s,datasets:[{label:"Jumlah per Kamar",data:a,backgroundColor:t,borderColor:"#333",borderWidth:1}]}}),c=u(()=>({responsive:!0,plugins:{title:{display:!0,text:`Jumlah Penghuni: ${r.value}`},legend:{display:!1},tooltip:{callbacks:{title:s=>`Kamar ${s[0].label}`,label:s=>{const a=s.raw,t=(a/r.value*100).toFixed(1);return`${a} (${t}%)`}}}},scales:{x:{title:{display:!0,text:"Kamar"}},y:{beginAtZero:!0,title:{display:!0,text:"Jumlah Penghuni"}}}}));function m(s){return Array.from({length:s},(a,t)=>`hsl(${Math.floor(360/s*t)}, 70%, 60%)`)}return(s,a)=>(p(),_(x(F),{data:n.value,options:c.value},null,8,["data","options"]))}},O={key:0},T={class:"tw:flex tw:items-center tw:justify-center tw:gap-2 tw:max-w-md tw:mx-auto overflow-x-scroll tw:flex-wrap tw:md:flex-nowrap"},z={key:1,class:"text-negative text-center q-py-xl"},G={__name:"StatistikDomisili",setup(f){const l=h(!1),r=h([]),n=h([]),c=h(""),m=u(()=>r.value.reduce((t,e)=>t+e.jumlah,0));E(async()=>{try{l.value=!0;const t=await H.domisili();r.value=t.asrama,n.value=t.kamar}catch(t){console.error("ðŸš€ ~ error:",t)}finally{l.value=!1}});const s=u(()=>c.value?n.value.filter(t=>t.kamar.startsWith(c.value)):n.value);function a(t){c.value=t?.asrama||""}return(t,e)=>{const i=P("CardLoading");return p(),_(I,{bordered:"",flat:""},{default:y(()=>[e[0]||(e[0]=o("div",{class:"tw:text-center tw:font-light tw:text-xl tw:py-2 bg-green-7 text-green-11"}," Diagram Domisili Santri Aktif ",-1)),r.value.length?(p(),v("div",O,[o("div",T,[g(Q,{class:"tw:mx-2",asrama:r.value,total:m.value,onSliceClick:a},null,8,["asrama","total"]),g(V,{class:"tw:mx-2",kamar:s.value,total:m.value},null,8,["kamar","total"])])])):(p(),v("p",z,"Tidak ada data domisili santri aktif")),g(i,{showing:l.value},null,8,["showing"])]),_:1})}}},Z={class:"tw:flex tw:items-center tw:justify-center tw:flex-col tw:sm:flex-row tw:my-2 tw:text-xl"},R={class:"tw:text-center tw:sm:text-left tw:my-2"},U={class:"tw:font-semibold tw:-mt-1.5"},ot={__name:"HomeIndex",setup(f){return(l,r)=>(p(),_(N,{class:"q-pa-sm"},{default:y(()=>[o("div",Z,[g(j,{border:6,class:"q-mr-sm",size:150}),o("div",R,[r[0]||(r[0]=o("div",{class:"tw:font-light"},"Selamat Datang",-1)),r[1]||(r[1]=o("div",{class:"text-green-10 tw:text-xl tw:-mt-1.5"},[J(" di "),o("span",{class:"tw:font-semibold"},"ID Santri ")],-1)),r[2]||(r[2]=o("div",{class:"tw:text-lg tw:font-extralight"},"Sistem Informasi",-1)),o("div",U,k(x(b).INS_DESC)+" "+k(x(b).INS_NAME),1)])]),g(G)]),_:1}))}};export{ot as default};
